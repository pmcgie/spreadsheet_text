/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={38321:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Alternation:()=>ye,CstParser:()=>Tn,EMPTY_ALT:()=>kn,EOF:()=>re,EarlyExitException:()=>Ut,EmbeddedActionsParser:()=>Cn,Flat:()=>ce,GAstVisitor:()=>Se,Lexer:()=>Q,LexerDefinitionErrorType:()=>$,MismatchedTokenException:()=>jt,NoViableAltException:()=>Ft,NonTerminal:()=>ue,NotAllInputParsedException:()=>Yt,Option:()=>fe,Parser:()=>Rn,ParserDefinitionErrorType:()=>_n,Repetition:()=>pe,RepetitionMandatory:()=>he,RepetitionMandatoryWithSeparator:()=>de,RepetitionWithSeparator:()=>me,Rule:()=>le,Terminal:()=>ve,VERSION:()=>r,assignOccurrenceIndices:()=>Lt,clearCache:()=>jn,createSyntaxDiagramsCode:()=>Mn,createToken:()=>ne,createTokenInstance:()=>oe,defaultGrammarResolverErrorProvider:()=>Rt,defaultGrammarValidatorErrorProvider:()=>Tt,defaultLexerErrorProvider:()=>q,defaultParserErrorProvider:()=>kt,generateParserFactory:()=>Pn,generateParserModule:()=>Hn,isRecognitionException:()=>Ht,resolveGrammar:()=>Ot,serializeGrammar:()=>ge,serializeProduction:()=>be,tokenLabel:()=>Z,tokenMatcher:()=>ie,tokenName:()=>ee,validateGrammar:()=>At});var r="6.5.0",o=n(11150),i=n(60905),a={},s=new i.RegExpParser;function u(e){var t=e.toString();if(a.hasOwnProperty(t))return a[t];var n=s.pattern(t);return a[t]=n,n}var l,c=(l=function(e,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},l(e,t)},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f="Complement Sets are not supported for first char optimization",h='Unable to use "first char" lexer optimizations:\n';function d(e,t){void 0===t&&(t=!1);try{var n=u(e);return p(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===f)t&&(0,o.rr)(h+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var r="";t&&(r="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,o.WB)(h+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+r)}}return[]}function p(e,t,n){switch(e.type){case"Disjunction":for(var r=0;r<e.value.length;r++)p(e.value[r],t,n);break;case"Alternative":var i=e.value;for(r=0;r<i.length;r++){var a=i[r];switch(a.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=a;switch(s.type){case"Character":m(s.value,t,n);break;case"Set":if(!0===s.complement)throw Error(f);(0,o.Ed)(s.value,(function(e){if("number"==typeof e)m(e,t,n);else{var r=e;if(!0===n)for(var o=r.from;o<=r.to;o++)m(o,t,n);else{for(o=r.from;o<=r.to&&o<H;o++)m(o,t,n);if(r.to>=H)for(var i=r.from>=H?r.from:H,a=r.to,s=j(i),u=j(a),l=s;l<=u;l++)t[l]=l}}}));break;case"Group":p(s.value,t,n);break;default:throw Error("Non Exhaustive Match")}var u=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===v(s)||"Group"!==s.type&&!1===u)break}break;default:throw Error("non exhaustive match!")}return(0,o.VO)(t)}function m(e,t,n){var r=j(e);t[r]=r,!0===n&&function(e,t){var n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n)t[o=j(r.charCodeAt(0))]=o;else{var o,i=n.toLowerCase();i!==n&&(t[o=j(i.charCodeAt(0))]=o)}}(e,t)}function y(e,t){return(0,o.sE)(e.value,(function(e){if("number"==typeof e)return(0,o.r3)(t,e);var n=e;return void 0!==(0,o.sE)(t,(function(e){return n.from<=e&&e<=n.to}))}))}function v(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&((0,o.kJ)(e.value)?(0,o.yW)(e.value,v):v(e.value))}var g=function(e){function t(t){var n=e.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return c(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){(0,o.r3)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===y(e,this.targetCharCodes)&&(this.found=!0):void 0!==y(e,this.targetCharCodes)&&(this.found=!0)},t}(i.BaseRegExpVisitor);function b(e,t){if(t instanceof RegExp){var n=u(t),r=new g(e);return r.visit(n),r.found}return void 0!==(0,o.sE)(t,(function(t){return(0,o.r3)(e,t.charCodeAt(0))}))}var w=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_="defaultMode",S="modes",E="boolean"==typeof new RegExp("(?:)").sticky;function k(e,t){var n,r=(t=(0,o.ce)(t,{useSticky:E,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;r("initCharCodeToOptimizedIndexMap",(function(){!function(){if((0,o.xb)(F)){F=new Array(65536);for(var e=0;e<65536;e++)F[e]=e>255?255+~~(e/255):e}}()})),r("Reject Lexer.NA",(function(){n=(0,o.d1)(e,(function(e){return e.PATTERN===Q.NA}))}));var i,a,s,u,l,c,f,p,m,y,v,g=!1;r("Transform Patterns",(function(){g=!1,i=(0,o.UI)(n,(function(e){var n=e.PATTERN;if((0,o.Kj)(n)){var r=n.source;return 1===r.length&&"^"!==r&&"$"!==r&&"."!==r?r:2!==r.length||"\\"!==r[0]||(0,o.r3)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?t.useSticky?O(n):M(n):r[1]}if((0,o.mf)(n))return g=!0,{exec:n};if((0,o.e$)(n,"exec"))return g=!0,n;if("string"==typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(i);return t.useSticky?O(a):M(a)}throw Error("non exhaustive match")}))})),r("misc mapping",(function(){a=(0,o.UI)(n,(function(e){return e.tokenTypeIdx})),s=(0,o.UI)(n,(function(e){var t=e.GROUP;if(t!==Q.SKIPPED){if((0,o.HD)(t))return t;if((0,o.o8)(t))return!1;throw Error("non exhaustive match")}})),u=(0,o.UI)(n,(function(e){var t=e.LONGER_ALT;if(t)return(0,o.cq)(n,t)})),l=(0,o.UI)(n,(function(e){return e.PUSH_MODE})),c=(0,o.UI)(n,(function(e){return(0,o.e$)(e,"POP_MODE")}))})),r("Line Terminator Handling",(function(){var e=D(t.lineTerminatorCharacters);f=(0,o.UI)(n,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(f=(0,o.UI)(n,(function(t){return(0,o.e$)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===I(t,e)?b(e,t.PATTERN):void 0})))})),r("Misc Mapping #2",(function(){p=(0,o.UI)(n,L),m=(0,o.UI)(i,x),y=(0,o.u4)(n,(function(e,t){var n=t.GROUP;return(0,o.HD)(n)&&n!==Q.SKIPPED&&(e[n]=[]),e}),{}),v=(0,o.UI)(i,(function(e,t){return{pattern:i[t],longerAlt:u[t],canLineTerminator:f[t],isCustom:p[t],short:m[t],group:s[t],push:l[t],pop:c[t],tokenTypeIdx:a[t],tokenType:n[t]}}))}));var w=!0,_=[];return t.safeMode||r("First Char Optimization",(function(){_=(0,o.u4)(n,(function(e,n,r){if("string"==typeof n.PATTERN){var i=j(n.PATTERN.charCodeAt(0));P(e,i,v[r])}else if((0,o.kJ)(n.START_CHARS_HINT)){var a;(0,o.Ed)(n.START_CHARS_HINT,(function(t){var n=j("string"==typeof t?t.charCodeAt(0):t);a!==n&&(a=n,P(e,n,v[r]))}))}else if((0,o.Kj)(n.PATTERN))if(n.PATTERN.unicode)w=!1,t.ensureOptimizations&&(0,o.WB)(h+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=d(n.PATTERN,t.ensureOptimizations);(0,o.xb)(s)&&(w=!1),(0,o.Ed)(s,(function(t){P(e,t,v[r])}))}else t.ensureOptimizations&&(0,o.WB)(h+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),w=!1;return e}),[])})),r("ArrayPacking",(function(){_=(0,o.X0)(_)})),{emptyGroups:y,patternIdxToConfig:v,charCodeToPatternIdxToConfig:_,hasCustom:g,canBeOptimized:w}}function R(e,t){var n=[],r=function(e){var t=(0,o.hX)(e,(function(e){return!(0,o.e$)(e,"PATTERN")}));return{errors:(0,o.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:$.MISSING_PATTERN,tokenTypes:[e]}})),valid:(0,o.e5)(e,t)}}(e);n=n.concat(r.errors);var a=function(e){var t=(0,o.hX)(e,(function(e){var t=e.PATTERN;return!((0,o.Kj)(t)||(0,o.mf)(t)||(0,o.e$)(t,"exec")||(0,o.HD)(t))}));return{errors:(0,o.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:$.INVALID_PATTERN,tokenTypes:[e]}})),valid:(0,o.e5)(e,t)}}(r.valid),s=a.valid;return n=(n=n.concat(a.errors)).concat(function(e){var t=[],n=(0,o.hX)(e,(function(e){return(0,o.Kj)(e.PATTERN)}));return t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return w(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),n=(0,o.hX)(e,(function(e){var n=e.PATTERN;try{var r=u(n),o=new t;return o.visit(r),o.found}catch(e){return T.test(n.source)}}));return(0,o.UI)(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:$.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}(n)),t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return w(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),n=(0,o.hX)(e,(function(e){var n=e.PATTERN;try{var r=u(n),o=new t;return o.visit(r),o.found}catch(e){return C.test(n.source)}}));return(0,o.UI)(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:$.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}(n)),t=t.concat(function(e){var t=(0,o.hX)(e,(function(e){var t=e.PATTERN;return t instanceof RegExp&&(t.multiline||t.global)}));return(0,o.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:$.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}(n)),t=t.concat(function(e){var t=[],n=(0,o.UI)(e,(function(n){return(0,o.u4)(e,(function(e,r){return n.PATTERN.source!==r.PATTERN.source||(0,o.r3)(t,r)||r.PATTERN===Q.NA||(t.push(r),e.push(r)),e}),[])}));n=(0,o.oA)(n);var r=(0,o.hX)(n,(function(e){return e.length>1}));return(0,o.UI)(r,(function(e){var t=(0,o.UI)(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+(0,o.Ps)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:$.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}(n)),t=t.concat(function(e){var t=(0,o.hX)(e,(function(e){return e.PATTERN.test("")}));return(0,o.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:$.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}(n)),t}(s)),n=n.concat(function(e){var t=(0,o.hX)(e,(function(e){if(!(0,o.e$)(e,"GROUP"))return!1;var t=e.GROUP;return t!==Q.SKIPPED&&t!==Q.NA&&!(0,o.HD)(t)}));return(0,o.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:$.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}(s)),n=n.concat(function(e,t){var n=(0,o.hX)(e,(function(e){return void 0!==e.PUSH_MODE&&!(0,o.r3)(t,e.PUSH_MODE)}));return(0,o.UI)(n,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:$.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}(s,t)),n=n.concat(function(e){var t=[],n=(0,o.u4)(e,(function(e,t,n){var r,i,a=t.PATTERN;return a===Q.NA||((0,o.HD)(a)?e.push({str:a,idx:n,tokenType:t}):(0,o.Kj)(a)&&(r=a,i=[".","\\","[","]","|","^","$","(",")","?","*","+","{"],void 0===(0,o.sE)(i,(function(e){return-1!==r.source.indexOf(e)})))&&e.push({str:a.source,idx:n,tokenType:t})),e}),[]);return(0,o.Ed)(e,(function(e,r){(0,o.Ed)(n,(function(n){var i=n.str,a=n.idx,s=n.tokenType;if(r<a&&function(e,t){if((0,o.Kj)(t)){var n=t.exec(e);return null!==n&&0===n.index}if((0,o.mf)(t))return t(e,0,[],{});if((0,o.e$)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var u="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:u,type:$.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}(s)),n}var T=/[^\\][\$]/,C=/[^\\[][\^]|^\^/;function M(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function O(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function A(e,t,n){var r=[],i=!1,a=(0,o.oA)((0,o.xH)((0,o.Q8)(e.modes,(function(e){return e})))),s=(0,o.d1)(a,(function(e){return e.PATTERN===Q.NA})),u=D(n);return t&&(0,o.Ed)(s,(function(e){var t=I(e,u);if(!1!==t){var n=function(e,t){if(t.issue===$.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===$.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),a={message:n,type:t.issue,tokenType:e};r.push(a)}else(0,o.e$)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):b(u,e.PATTERN)&&(i=!0)})),t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:$.NO_LINE_BREAKS_FLAGS}),r}function L(e){var t=e.PATTERN;if((0,o.Kj)(t))return!1;if((0,o.mf)(t))return!0;if((0,o.e$)(t,"exec"))return!0;if((0,o.HD)(t))return!1;throw Error("non exhaustive match")}function x(e){return!(!(0,o.HD)(e)||1!==e.length)&&e.charCodeAt(0)}var N={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function I(e,t){if((0,o.e$)(e,"LINE_BREAKS"))return!1;if((0,o.Kj)(e.PATTERN)){try{b(t,e.PATTERN)}catch(e){return{issue:$.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if((0,o.HD)(e.PATTERN))return!1;if(L(e))return{issue:$.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function D(e){return(0,o.UI)(e,(function(e){return(0,o.HD)(e)&&e.length>0?e.charCodeAt(0):e}))}function P(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var H=256;function j(e){return e<H?e:F[e]}var F=[];function Y(e,t){var n=e.tokenTypeIdx;return n===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[n]}function U(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var B=1,V={};function W(e){var t=function(e){for(var t=(0,o.Qw)(e),n=e,r=!0;r;){n=(0,o.oA)((0,o.xH)((0,o.UI)(n,(function(e){return e.CATEGORIES}))));var i=(0,o.e5)(n,t);t=t.concat(i),(0,o.xb)(i)?r=!1:n=i}return t}(e);!function(e){(0,o.Ed)(e,(function(e){var t;G(e)||(V[B]=e,e.tokenTypeIdx=B++),K(e)&&!(0,o.kJ)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),K(e)||(e.CATEGORIES=[]),t=e,(0,o.e$)(t,"categoryMatches")||(e.categoryMatches=[]),function(e){return(0,o.e$)(e,"categoryMatchesMap")}(e)||(e.categoryMatchesMap={})}))}(t),function(e){(0,o.Ed)(e,(function(e){z([],e)}))}(t),function(e){(0,o.Ed)(e,(function(e){e.categoryMatches=[],(0,o.Ed)(e.categoryMatchesMap,(function(t,n){e.categoryMatches.push(V[n].tokenTypeIdx)}))}))}(t),(0,o.Ed)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function z(e,t){(0,o.Ed)(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),(0,o.Ed)(t.CATEGORIES,(function(n){var r=e.concat(t);(0,o.r3)(r,n)||z(r,n)}))}function G(e){return(0,o.e$)(e,"tokenTypeIdx")}function K(e){return(0,o.e$)(e,"CATEGORIES")}function X(e){return(0,o.e$)(e,"tokenTypeIdx")}var $,q={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+n+" characters."}};!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}($||($={}));var J={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:q,traceInitPerf:!1,skipValidations:!1};Object.freeze(J);var Q=function(){function e(e,t){var n=this;if(void 0===t&&(t=J),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,o.TS)(J,t);var r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var r,i=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===J.lineTerminatorsPattern)n.config.lineTerminatorsPattern=N;else if(n.config.lineTerminatorCharacters===J.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),(0,o.kJ)(e)?((r={modes:{}}).modes.defaultMode=(0,o.Qw)(e),r.defaultMode=_):(i=!1,r=(0,o.Cl)(e))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(function(e,t,n){var r=[];return(0,o.e$)(e,_)||r.push({message:"A MultiMode Lexer cannot be initialized without a <defaultMode> property in its definition\n",type:$.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,o.e$)(e,S)||r.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:$.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,o.e$)(e,S)&&(0,o.e$)(e,_)&&!(0,o.e$)(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a defaultMode: <"+e.defaultMode+">which does not exist\n",type:$.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,o.e$)(e,S)&&(0,o.Ed)(e.modes,(function(e,t){(0,o.Ed)(e,(function(e,n){(0,o.o8)(e)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+n+">\n",type:$.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),r}(r,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(A(r,n.trackStartLines,n.config.lineTerminatorCharacters))}))),r.modes=r.modes?r.modes:{},(0,o.Ed)(r.modes,(function(e,t){r.modes[t]=(0,o.d1)(e,(function(e){return(0,o.o8)(e)}))}));var s=(0,o.XP)(r.modes);if((0,o.Ed)(r.modes,(function(e,r){n.TRACE_INIT("Mode: <"+r+"> processing",(function(){var i;n.modes.push(r),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(R(e,s))})),(0,o.xb)(n.lexerDefinitionErrors)&&(W(e),n.TRACE_INIT("analyzeTokenTypes",(function(){i=k(e,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[r]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[r]=i.charCodeToPatternIdxToConfig,n.emptyGroups=(0,o.TS)(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[r]=i.canBeOptimized)}))})),n.defaultMode=r.defaultMode,!(0,o.xb)(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var u=(0,o.UI)(n.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+u)}(0,o.Ed)(n.lexerDefinitionWarning,(function(e){(0,o.rr)(e.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(E?(n.chopInput=o.Wd,n.match=n.matchWithTest):(n.updateLastIndex=o.dG,n.match=n.matchWithExec),i&&(n.handleModes=o.dG),!1===n.trackStartLines&&(n.computeNewColumn=o.Wd),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=o.dG),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var e=(0,o.u4)(n.canModeBeOptimized,(function(e,t,n){return!1===t&&e.push(n),e}),[]);if(t.ensureOptimizations&&!(0,o.xb)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){a={}})),n.TRACE_INIT("toFastProperties",(function(){(0,o.SV)(n)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!(0,o.xb)(this.lexerDefinitionErrors)){var n=(0,o.UI)(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+n)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var n,r,i,a,s,u,l,c,f,h,d,p,m,y,v,g,b,w=this,_=e,S=_.length,E=0,k=0,R=this.hasCustom?0:Math.floor(e.length/10),T=new Array(R),C=[],M=this.trackStartLines?1:void 0,O=this.trackStartLines?1:void 0,A=(v=this.emptyGroups,g={},b=(0,o.XP)(v),(0,o.Ed)(b,(function(e){var t=v[e];if(!(0,o.kJ)(t))throw Error("non exhaustive match");g[e]=[]})),g),L=this.trackStartLines,x=this.config.lineTerminatorsPattern,N=0,I=[],D=[],P=[],H=[];Object.freeze(H);var F=void 0;function Y(){return I}function U(e){var t=j(e),n=D[t];return void 0===n?H:n}var B,V=function(e){if(1===P.length&&void 0===e.tokenType.PUSH_MODE){var t=w.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);C.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{P.pop();var n=(0,o.Z$)(P);I=w.patternIdxToConfig[n],D=w.charCodeToPatternIdxToConfig[n],N=I.length;var r=w.canModeBeOptimized[n]&&!1===w.config.safeMode;F=D&&r?U:Y}};function W(e){P.push(e),D=this.charCodeToPatternIdxToConfig[e],I=this.patternIdxToConfig[e],N=I.length,N=I.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;F=D&&t?U:Y}for(W.call(this,t);E<S;){s=null;var z=_.charCodeAt(E),G=F(z),K=G.length;for(n=0;n<K;n++){var X=(B=G[n]).pattern;if(u=null,!1!==(oe=B.short)?z===oe&&(s=X):!0===B.isCustom?null!==(y=X.exec(_,E,T,A))?(s=y[0],void 0!==y.payload&&(u=y.payload)):s=null:(this.updateLastIndex(X,E),s=this.match(X,e,E)),null!==s){if(void 0!==(a=B.longerAlt)){var $=I[a],q=$.pattern;l=null,!0===$.isCustom?null!==(y=q.exec(_,E,T,A))?(i=y[0],void 0!==y.payload&&(l=y.payload)):i=null:(this.updateLastIndex(q,E),i=this.match(q,e,E)),i&&i.length>s.length&&(s=i,u=l,B=$)}break}}if(null!==s){if(c=s.length,void 0!==(f=B.group)&&(h=B.tokenTypeIdx,d=this.createTokenInstance(s,E,h,B.tokenType,M,O,c),this.handlePayload(d,u),!1===f?k=this.addToken(T,k,d):A[f].push(d)),e=this.chopInput(e,c),E+=c,O=this.computeNewColumn(O,c),!0===L&&!0===B.canLineTerminator){var J=0,Q=void 0,Z=void 0;x.lastIndex=0;do{!0===(Q=x.test(s))&&(Z=x.lastIndex-1,J++)}while(!0===Q);0!==J&&(M+=J,O=c-Z,this.updateTokenEndLineColumnLocation(d,f,Z,J,M,O,c))}this.handleModes(B,V,W,d)}else{for(var ee=E,te=M,ne=O,re=!1;!re&&E<S;)for(_.charCodeAt(E),e=this.chopInput(e,1),E++,r=0;r<N;r++){var oe,ie=I[r];if(X=ie.pattern,!1!==(oe=ie.short)?_.charCodeAt(E)===oe&&(re=!0):!0===ie.isCustom?re=null!==X.exec(_,E,T,A):(this.updateLastIndex(X,E),re=null!==X.exec(e)),!0===re)break}p=E-ee,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(_,ee,p,te,ne),C.push({offset:ee,line:te,column:ne,length:p,message:m})}}return this.hasCustom||(T.length=k),{tokens:T,groups:A,errors:C}},e.prototype.handleModes=function(e,t,n,r){if(!0===e.pop){var o=e.push;t(r),void 0!==o&&n.call(this,o)}else void 0!==e.push&&n.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,n,r,o,i,a){var s,u;void 0!==t&&(u=(s=n===a-1)?-1:0,1===r&&!0===s||(e.endLine=o+u,e.endColumn=i-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}},e.prototype.createStartOnlyToken=function(e,t,n,r,o,i){return{image:e,startOffset:t,startLine:o,startColumn:i,tokenTypeIdx:n,tokenType:r}},e.prototype.createFullToken=function(e,t,n,r,o,i,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:o,endLine:o,startColumn:i,endColumn:i+a-1,tokenTypeIdx:n,tokenType:r}},e.prototype.addToken=function(e,t,n){return 666},e.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},e.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,n){return null},e.prototype.matchWithTest=function(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var n=e.exec(t);return null!==n?n[0]:n},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=(0,o.HT)(t),i=r.time,a=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function Z(e){return te(e)?e.LABEL:e.name}function ee(e){return e.name}function te(e){return(0,o.HD)(e.LABEL)&&""!==e.LABEL}function ne(e){return function(e){var t=e.pattern,n={};if(n.name=e.name,(0,o.o8)(t)||(n.PATTERN=t),(0,o.e$)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,o.e$)(e,"categories")&&(n.CATEGORIES=e.categories),W([n]),(0,o.e$)(e,"label")&&(n.LABEL=e.label),(0,o.e$)(e,"group")&&(n.GROUP=e.group),(0,o.e$)(e,"pop_mode")&&(n.POP_MODE=e.pop_mode),(0,o.e$)(e,"push_mode")&&(n.PUSH_MODE=e.push_mode),(0,o.e$)(e,"longer_alt")&&(n.LONGER_ALT=e.longer_alt),(0,o.e$)(e,"line_breaks")&&(n.LINE_BREAKS=e.line_breaks),(0,o.e$)(e,"start_chars_hint")&&(n.START_CHARS_HINT=e.start_chars_hint),n}(e)}var re=ne({name:"EOF",pattern:Q.NA});function oe(e,t,n,r,o,i,a,s){return{image:t,startOffset:n,endOffset:r,startLine:o,endLine:i,startColumn:a,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function ie(e,t){return Y(e,t)}W([re]);var ae=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),(0,o.Ed)(this.definition,(function(t){t.accept(e)}))},e}(),ue=function(e){function t(t){var n=e.call(this,[])||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(se),le=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.orgText="",(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),ce=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),fe=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),he=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),de=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),pe=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),me=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),ye=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,(0,o.f0)(n,(0,o.ei)(t,(function(e){return void 0!==e}))),n}return ae(t,e),t}(se),ve=function(){function e(e){this.idx=1,(0,o.f0)(this,(0,o.ei)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function ge(e){return(0,o.UI)(e,be)}function be(e){function t(e){return(0,o.UI)(e,be)}if(e instanceof ue)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof ce)return{type:"Flat",definition:t(e.definition)};if(e instanceof fe)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof he)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof de)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:be(new ve({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof me)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:be(new ve({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof pe)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof ye)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof ve){var n={type:"Terminal",name:e.terminalType.name,label:Z(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=(0,o.Kj)(r)?r.source:r),n}if(e instanceof le)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var we=function(){function e(){}return e.prototype.walk=function(e,t){var n=this;void 0===t&&(t=[]),(0,o.Ed)(e.definition,(function(r,i){var a=(0,o.Cw)(e.definition,i+1);if(r instanceof ue)n.walkProdRef(r,a,t);else if(r instanceof ve)n.walkTerminal(r,a,t);else if(r instanceof ce)n.walkFlat(r,a,t);else if(r instanceof fe)n.walkOption(r,a,t);else if(r instanceof he)n.walkAtLeastOne(r,a,t);else if(r instanceof de)n.walkAtLeastOneSep(r,a,t);else if(r instanceof me)n.walkManySep(r,a,t);else if(r instanceof pe)n.walkMany(r,a,t);else{if(!(r instanceof ye))throw Error("non exhaustive match");n.walkOr(r,a,t)}}))},e.prototype.walkTerminal=function(e,t,n){},e.prototype.walkProdRef=function(e,t,n){},e.prototype.walkFlat=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkOption=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkAtLeastOne=function(e,t,n){var r=[new fe({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkAtLeastOneSep=function(e,t,n){var r=_e(e,t,n);this.walk(e,r)},e.prototype.walkMany=function(e,t,n){var r=[new fe({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkManySep=function(e,t,n){var r=_e(e,t,n);this.walk(e,r)},e.prototype.walkOr=function(e,t,n){var r=this,i=t.concat(n);(0,o.Ed)(e.definition,(function(e){var t=new ce({definition:[e]});r.walk(t,i)}))},e}();function _e(e,t,n){return[new fe({definition:[new ve({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}var Se=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case ue:return this.visitNonTerminal(t);case ce:return this.visitFlat(t);case fe:return this.visitOption(t);case he:return this.visitRepetitionMandatory(t);case de:return this.visitRepetitionMandatoryWithSeparator(t);case me:return this.visitRepetitionWithSeparator(t);case pe:return this.visitRepetition(t);case ye:return this.visitAlternation(t);case ve:return this.visitTerminal(t);case le:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),Ee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function ke(e,t){return void 0===t&&(t=[]),!!(e instanceof fe||e instanceof pe||e instanceof me)||(e instanceof ye?(0,o.G)(e.definition,(function(e){return ke(e,t)})):!(e instanceof ue&&(0,o.r3)(t,e))&&e instanceof se&&(e instanceof ue&&t.push(e),(0,o.yW)(e.definition,(function(e){return ke(e,t)}))))}function Re(e){if(e instanceof ue)return"SUBRULE";if(e instanceof fe)return"OPTION";if(e instanceof ye)return"OR";if(e instanceof he)return"AT_LEAST_ONE";if(e instanceof de)return"AT_LEAST_ONE_SEP";if(e instanceof me)return"MANY_SEP";if(e instanceof pe)return"MANY";if(e instanceof ve)return"CONSUME";throw Error("non exhaustive match")}var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return Ee(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";(0,o.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";(0,o.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(Se),Ce=new Te;function Me(e){if(e instanceof ue)return Me(e.referencedRule);if(e instanceof ve)return[e.terminalType];if(function(e){return e instanceof ce||e instanceof fe||e instanceof pe||e instanceof he||e instanceof de||e instanceof me||e instanceof ve||e instanceof le}(e))return function(e){for(var t,n=[],r=e.definition,i=0,a=r.length>i,s=!0;a&&s;)s=ke(t=r[i]),n=n.concat(Me(t)),i+=1,a=r.length>i;return(0,o.jj)(n)}(e);if(function(e){return e instanceof ye}(e))return function(e){var t=(0,o.UI)(e.definition,(function(e){return Me(e)}));return(0,o.jj)((0,o.xH)(t))}(e);throw Error("non exhaustive match")}var Oe="_~IN~_",Ae=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Le=function(e){function t(t){var n=e.call(this)||this;return n.topProd=t,n.follows={},n}return Ae(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,n){},t.prototype.walkProdRef=function(e,t,n){var r,o,i=(r=e.referencedRule,o=e.idx,r.name+o+Oe+this.topProd.name),a=t.concat(n),s=Me(new ce({definition:a}));this.follows[i]=s},t}(we),xe=256,Ne=512,Ie=768,De=1024,Pe=1280,He=1536;function je(e,t,n){return n|t|e}function Fe(e,t,n,r){var o=r+1<<24;return je(e,t,n)|o}var Ye=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function Ue(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset)}function Be(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function Ve(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)}var We=function(e){function t(t){var n=e.call(this)||this;return n.result=[],n.ruleIdx=t,n}return Ye(t,e),t.prototype.collectNamedDSLMethod=function(e,t,n){if(!(0,o.o8)(e.name)){var r=void 0;if(e instanceof fe||e instanceof pe||e instanceof he||e instanceof ye)r=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof de||e instanceof me))throw Error("non exhaustive match");r=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[r],a=je(this.ruleIdx,n,e.idx);this.result.push({def:i,key:a,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,fe,Ne)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,pe,Ie)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,he,De)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,de,He)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,me,Pe)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,ye,xe);var n=e.definition.length>1;(0,o.Ed)(e.definition,(function(r,i){if(!(0,o.o8)(r.name)){var a=r.definition;a=n?[new fe({definition:r.definition})]:r.definition;var s=Fe(t.ruleIdx,xe,e.idx,i);t.result.push({def:a,key:s,name:r.name,orgProd:r})}}))},t}(Se),ze=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return ze(t,e),t.prototype.walkTerminal=function(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var r=t.concat(n),o=new ce({definition:r});this.possibleTokTypes=Me(o),this.found=!0}},t}(function(e){function t(t,n){var r=e.call(this)||this;return r.topProd=t,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return ze(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,o.Qw)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,o.Qw)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,n){void 0===n&&(n=[]),this.found||e.prototype.walk.call(this,t,n)},t.prototype.walkProdRef=function(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var r=t.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,r)}},t.prototype.updateExpectedNext=function(){(0,o.xb)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(we)),Ke=function(e){function t(t,n){var r=e.call(this)||this;return r.topRule=t,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return ze(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(we),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.walkMany=function(t,n,r){if(t.idx===this.occurrence){var i=(0,o.Ps)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof ve&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,n,r)},t}(Ke),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.walkManySep=function(t,n,r){if(t.idx===this.occurrence){var i=(0,o.Ps)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof ve&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,n,r)},t}(Ke),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.walkAtLeastOne=function(t,n,r){if(t.idx===this.occurrence){var i=(0,o.Ps)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof ve&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,n,r)},t}(Ke),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.walkAtLeastOneSep=function(t,n,r){if(t.idx===this.occurrence){var i=(0,o.Ps)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof ve&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,n,r)},t}(Ke);function Qe(e,t,n){void 0===n&&(n=[]),n=(0,o.Qw)(n);var r=[],i=0;function a(a){var s=Qe(a.concat((0,o.Cw)(e,i+1)),t,n);return r.concat(s)}for(;n.length<t&&i<e.length;){var s=e[i];if(s instanceof ce)return a(s.definition);if(s instanceof ue)return a(s.definition);if(s instanceof fe)r=a(s.definition);else{if(s instanceof he)return a(u=s.definition.concat([new pe({definition:s.definition})]));if(s instanceof de)return a(u=[new ce({definition:s.definition}),new pe({definition:[new ve({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof me){var u=s.definition.concat([new pe({definition:[new ve({terminalType:s.separator})].concat(s.definition)})]);r=a(u)}else if(s instanceof pe)u=s.definition.concat([new pe({definition:s.definition})]),r=a(u);else{if(s instanceof ye)return(0,o.Ed)(s.definition,(function(e){r=a(e.definition)})),r;if(!(s instanceof ve))throw Error("non exhaustive match");n.push(s.terminalType)}}i++}return r.push({partialPath:n,suffixDef:(0,o.Cw)(e,i)}),r}function Ze(e,t,n,r){var i="EXIT_NONE_TERMINAL",a=[i],s="EXIT_ALTERNATIVE",u=!1,l=t.length,c=l-r-1,f=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!(0,o.xb)(h);){var d=h.pop();if(d!==s){var p=d.def,m=d.idx,y=d.ruleStack,v=d.occurrenceStack;if(!(0,o.xb)(p)){var g=p[0];if(g===i){var b={idx:m,def:(0,o.Cw)(p),ruleStack:(0,o.j7)(y),occurrenceStack:(0,o.j7)(v)};h.push(b)}else if(g instanceof ve)if(m<l-1){var w=m+1;n(t[w],g.terminalType)&&(b={idx:w,def:(0,o.Cw)(p),ruleStack:y,occurrenceStack:v},h.push(b))}else{if(m!==l-1)throw Error("non exhaustive match");f.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:y,occurrenceStack:v}),u=!0}else if(g instanceof ue){var _=(0,o.Qw)(y);_.push(g.nonTerminalName);var S=(0,o.Qw)(v);S.push(g.idx),b={idx:m,def:g.definition.concat(a,(0,o.Cw)(p)),ruleStack:_,occurrenceStack:S},h.push(b)}else if(g instanceof fe){var E={idx:m,def:(0,o.Cw)(p),ruleStack:y,occurrenceStack:v};h.push(E),h.push(s);var k={idx:m,def:g.definition.concat((0,o.Cw)(p)),ruleStack:y,occurrenceStack:v};h.push(k)}else if(g instanceof he){var R=new pe({definition:g.definition,idx:g.idx});b={idx:m,def:g.definition.concat([R],(0,o.Cw)(p)),ruleStack:y,occurrenceStack:v},h.push(b)}else if(g instanceof de){var T=new ve({terminalType:g.separator});R=new pe({definition:[T].concat(g.definition),idx:g.idx}),b={idx:m,def:g.definition.concat([R],(0,o.Cw)(p)),ruleStack:y,occurrenceStack:v},h.push(b)}else if(g instanceof me){E={idx:m,def:(0,o.Cw)(p),ruleStack:y,occurrenceStack:v},h.push(E),h.push(s),T=new ve({terminalType:g.separator});var C=new pe({definition:[T].concat(g.definition),idx:g.idx});k={idx:m,def:g.definition.concat([C],(0,o.Cw)(p)),ruleStack:y,occurrenceStack:v},h.push(k)}else if(g instanceof pe)E={idx:m,def:(0,o.Cw)(p),ruleStack:y,occurrenceStack:v},h.push(E),h.push(s),C=new pe({definition:g.definition,idx:g.idx}),k={idx:m,def:g.definition.concat([C],(0,o.Cw)(p)),ruleStack:y,occurrenceStack:v},h.push(k);else if(g instanceof ye)for(var M=g.definition.length-1;M>=0;M--){var O={idx:m,def:g.definition[M].definition.concat((0,o.Cw)(p)),ruleStack:y,occurrenceStack:v};h.push(O),h.push(s)}else if(g instanceof ce)h.push({idx:m,def:g.definition.concat((0,o.Cw)(p)),ruleStack:y,occurrenceStack:v});else{if(!(g instanceof le))throw Error("non exhaustive match");h.push(et(g,m,y,v))}}}else u&&(0,o.Z$)(h).idx<=c&&h.pop()}return f}function et(e,t,n,r){var i=(0,o.Qw)(n);i.push(e.name);var a=(0,o.Qw)(r);return a.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:a}}var tt,nt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(tt||(tt={}));var rt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=n,o.targetProdType=r,o}return nt(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)},t.prototype.walkOption=function(t,n,r){this.checkIsTarget(t,tt.OPTION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOne=function(t,n,r){this.checkIsTarget(t,tt.REPETITION_MANDATORY,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOneSep=function(t,n,r){this.checkIsTarget(t,tt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkMany=function(t,n,r){this.checkIsTarget(t,tt.REPETITION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkManySep=function(t,n,r){this.checkIsTarget(t,tt.REPETITION_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t}(we),ot=function(e){function t(t,n,r){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=n,o.targetRef=r,o.result=[],o}return nt(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,tt.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,tt.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,tt.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,tt.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,tt.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,tt.ALTERNATION)},t}(Se);function it(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function at(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],o=[],i=0;i<t.length;i++){var a=t[i];o.push(a+"_"+r.tokenTypeIdx);for(var s=0;s<r.categoryMatches.length;s++){var u="_"+r.categoryMatches[s];o.push(a+u)}}t=o}return t}function st(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var o=e[r],i=0;i<t.length;i++)if(!0===o[t[i]])return!1;return!0}function ut(e,t){for(var n=(0,o.UI)(e,(function(e){return Qe([e],1)})),r=it(n.length),i=(0,o.UI)(n,(function(e){var t={};return(0,o.Ed)(e,(function(e){var n=at(e.partialPath);(0,o.Ed)(n,(function(e){t[e]=!0}))})),t})),a=n,s=1;s<=t;s++){var u=a;a=it(u.length);for(var l=function(e){for(var n=u[e],l=0;l<n.length;l++){var c=n[l].partialPath,f=n[l].suffixDef,h=at(c);if(st(i,h,e)||(0,o.xb)(f)||c.length===t){var d=r[e];if(!1===ft(d,c)){d.push(c);for(var p=0;p<h.length;p++){var m=h[p];i[e][m]=!0}}}else{var y=Qe(f,s+1,c);a[e]=a[e].concat(y),(0,o.Ed)(y,(function(t){var n=at(t.partialPath);(0,o.Ed)(n,(function(t){i[e][t]=!0}))}))}}},c=0;c<u.length;c++)l(c)}return r}function lt(e,t,n,r){var o=new ot(e,tt.ALTERNATION,r);return t.accept(o),ut(o.result,n)}function ct(e,t,n,r){var o=new ot(e,n);t.accept(o);var i=o.result,a=new rt(t,e,n).startWalking();return ut([new ce({definition:i}),new ce({definition:a})],r)}function ft(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var o=0;o<r.length;o++){var i=t[o],a=r[o];if(!1==(i===a||void 0!==a.categoryMatchesMap[i.tokenTypeIdx]))continue e}return!0}}return!1}function ht(e){return(0,o.yW)(e,(function(e){return(0,o.yW)(e,(function(e){return(0,o.yW)(e,(function(e){return(0,o.xb)(e.categoryMatches)}))}))}))}var dt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function pt(e,t,n,r,i,a){var s=o.UI(e,(function(e){return function(e,t){var n=new vt;e.accept(n);var r=n.allProductions,i=o.vM(r,mt),a=o.ei(i,(function(e){return e.length>1}));return o.UI(o.VO(a),(function(n){var r=o.Ps(n),i=t.buildDuplicateFoundError(e,n),a=Re(r),s={message:i,type:_n.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:a,occurrence:r.idx},u=yt(r);return u&&(s.parameter=u),s}))}(e,i)})),u=o.UI(e,(function(e){return wt(e,e,i)})),l=[],c=[],f=[];(0,o.yW)(u,o.xb)&&(l=(0,o.UI)(e,(function(e){return function(e,t){var n=new St;e.accept(n);var r=n.alternations;return o.u4(r,(function(n,r){var i=o.j7(r.definition),a=o.UI(i,(function(n,i){var a=Ze([n],[],null,1);return o.xb(a)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:i}),type:_n.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:i+1}:null}));return n.concat(o.oA(a))}),[])}(e,i)})),c=(0,o.UI)(e,(function(e){return function(e,t,n,r){var i=new St;e.accept(i);var a=i.alternations,s=n[e.name];return s&&(a=(0,o.d1)(a,(function(e){return s[Re(e)+(0===e.idx?"":e.idx)]}))),a=(0,o.d1)(a,(function(e){return!0===e.ignoreAmbiguities})),o.u4(a,(function(n,i){var a=i.idx,s=i.maxLookahead||t,u=lt(a,e,s,i),l=function(e,t,n,r){var i=[],a=(0,o.u4)(e,(function(n,r,a){return!0===t.definition[a].ignoreAmbiguities||(0,o.Ed)(r,(function(r){var s=[a];(0,o.Ed)(e,(function(e,n){a!==n&&ft(e,r)&&!0!==t.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!ft(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n}),[]);return o.UI(a,(function(e){var i=(0,o.UI)(e.alts,(function(e){return e+1}));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:_n.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:[e.alts]}}))}(u,i,e,r),c=function(e,t,n,r){var i=[],a=(0,o.u4)(e,(function(e,t,n){var r=(0,o.UI)(t,(function(e){return{idx:n,path:e}}));return e.concat(r)}),[]);return(0,o.Ed)(a,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var s=e.idx,u=e.path,l=(0,o.Oq)(a,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<s&&(n=e.path,r=u,n.length<r.length&&(0,o.yW)(n,(function(e,t){var n=r[t];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})));var n,r})),c=(0,o.UI)(l,(function(e){var o=[e.idx+1,s+1],i=0===t.idx?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:_n.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:i,alternatives:o}}));i=i.concat(c)}})),i}(u,i,e,r);return n.concat(l,c)}),[])}(e,t,r,i)})),f=function(e,t,n){var r=[];return(0,o.Ed)(e,(function(e){var i=new Et;e.accept(i);var a=i.allProductions;(0,o.Ed)(a,(function(i){var a=function(e){if(e instanceof fe)return tt.OPTION;if(e instanceof pe)return tt.REPETITION;if(e instanceof he)return tt.REPETITION_MANDATORY;if(e instanceof de)return tt.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof me)return tt.REPETITION_WITH_SEPARATOR;if(e instanceof ye)return tt.ALTERNATION;throw Error("non exhaustive match")}(i),s=i.maxLookahead||t,u=ct(i.idx,e,a,s)[0];if((0,o.xb)((0,o.xH)(u))){var l=n.buildEmptyRepetitionError({topLevelRule:e,repetition:i});r.push({message:l,type:_n.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),r}(e,t,i));var h=function(e,t,n){var r=[],i=(0,o.UI)(t,(function(e){return e.name}));return(0,o.Ed)(e,(function(e){var t=e.name;if((0,o.r3)(i,t)){var a=n.buildNamespaceConflictError(e);r.push({message:a,type:_n.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),r}(e,n,i),d=o.UI(n,(function(e){return function(e,t){var n=[];return e.name.match(gt)||n.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:gt}),type:_n.INVALID_TOKEN_NAME}),n}(e,i)})),p=function(e,t){var n=[];return(0,o.Ed)(e,(function(e){var r=new We("");e.accept(r);var i=(0,o.UI)(r.result,(function(e){return e.orgProd}));n.push((0,o.UI)(i,(function(n){return function(e,t,n){var r,o=[];return t.name.match(bt)||(r=n.buildInvalidNestedRuleNameError(e,t),o.push({message:r,type:_n.INVALID_NESTED_RULE_NAME,ruleName:e.name})),o}(e,n,t)})))})),(0,o.xH)(n)}(e,i),m=function(e,t){var n=[];return(0,o.Ed)(e,(function(e){var r=new We("");e.accept(r);var i=(0,o.vM)(r.result,(function(e){return e.name})),a=(0,o.ei)(i,(function(e){return e.length>1}));(0,o.Ed)((0,o.VO)(a),(function(r){var i=(0,o.UI)(r,(function(e){return e.orgProd})),a=t.buildDuplicateNestedRuleNameError(e,i);n.push({message:a,type:_n.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),n}(e,i),y=(0,o.UI)(e,(function(e){return function(e,t){var n=new St;e.accept(n);var r=n.alternations;return o.u4(r,(function(n,r){return r.definition.length>255&&n.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:_n.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}),n}),[])}(e,i)})),v=(0,o.UI)(e,(function(e){return function(e,t){var n=[],r=e.name;return r.match(gt)||n.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:gt}),type:_n.INVALID_RULE_NAME,ruleName:r}),n}(e,i)})),g=(0,o.UI)(e,(function(t){return function(e,t,n,r){var i=[],a=(0,o.u4)(t,(function(t,n){return n.name===e.name?t+1:t}),0);if(a>1){var s=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:s,type:_n.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}(t,e,a,i)}));return o.xH(s.concat(d,p,m,f,u,l,c,h,y,v,g))}function mt(e){return Re(e)+"_#_"+e.idx+"_#_"+yt(e)}function yt(e){return e instanceof ve?e.terminalType.name:e instanceof ue?e.nonTerminalName:""}var vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return dt(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(Se),gt=/^[a-zA-Z_]\w*$/,bt=new RegExp(gt.source.replace("^","^\\$"));function wt(e,t,n,r){void 0===r&&(r=[]);var i=[],a=_t(t.definition);if(o.xb(a))return[];var s=e.name;o.r3(a,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:_n.LEFT_RECURSION,ruleName:s});var u=o.e5(a,r.concat([e])),l=o.UI(u,(function(t){var i=o.Qw(r);return i.push(t),wt(e,t,n,i)}));return i.concat(o.xH(l))}function _t(e){var t=[];if(o.xb(e))return t;var n=o.Ps(e);if(n instanceof ue)t.push(n.referencedRule);else if(n instanceof ce||n instanceof fe||n instanceof he||n instanceof de||n instanceof me||n instanceof pe)t=t.concat(_t(n.definition));else if(n instanceof ye)t=o.xH(o.UI(n.definition,(function(e){return _t(e.definition)})));else if(!(n instanceof ve))throw Error("non exhaustive match");var r=ke(n),i=e.length>1;if(r&&i){var a=o.Cw(e);return t.concat(_t(a))}return t}var St=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return dt(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(Se),Et=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return dt(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(Se),kt={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;return e.previous,e.ruleName,"Expecting "+(te(t)?"--\x3e "+Z(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual,r=(e.previous,e.customUserDescription),i=(e.ruleName,"Expecting: "),a="\nbut found: '"+(0,o.Ps)(n).image+"'";if(r)return i+r+a;var s=(0,o.u4)(t,(function(e,t){return e.concat(t)}),[]),u=(0,o.UI)(s,(function(e){return"["+(0,o.UI)(e,(function(e){return Z(e)})).join(", ")+"]"}));return i+"one of these possible Token sequences:\n"+(0,o.UI)(u,(function(e,t){return"  "+(t+1)+". "+e})).join("\n")+a},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription,i=(e.ruleName,"Expecting: "),a="\nbut found: '"+(0,o.Ps)(n).image+"'";return r?i+r+a:i+"expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,o.UI)(t,(function(e){return"["+(0,o.UI)(e,(function(e){return Z(e)})).join(",")+"]"})).join(" ,")+">"+a}};Object.freeze(kt);var Rt={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},Tt={buildDuplicateFoundError:function(e,t){var n,r=e.name,i=(0,o.Ps)(t),a=i.idx,s=Re(i),u=(n=i)instanceof ve?n.terminalType.name:n instanceof ue?n.nonTerminalName:"",l="->"+s+(a>0?a:"")+"<- "+(u?"with argument: ->"+u+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(l=l.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+bt.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+(0,o.Ps)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=(0,o.UI)(e.prefixPath,(function(e){return Z(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=(0,o.UI)(e.prefixPath,(function(e){return Z(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n"+"See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=Re(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+o.UI(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof le?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},Ct=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(e){function t(t,n){var r=e.call(this)||this;return r.nameToTopRule=t,r.errMsgProvider=n,r.errors=[],r}return Ct(t,e),t.prototype.resolveRefs=function(){var e=this;(0,o.Ed)((0,o.VO)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:_n.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(Se);function Ot(e){e=(0,o.ce)(e,{errMsgProvider:Rt});var t,n,r,i={};return(0,o.Ed)(e.rules,(function(e){i[e.name]=e})),t=i,n=e.errMsgProvider,(r=new Mt(t,n)).resolveRefs(),r.errors}function At(e){return pt((e=(0,o.ce)(e,{errMsgProvider:Tt,ignoredIssues:{}})).rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function Lt(e){(0,o.Ed)(e.rules,(function(e){var t=new Te;e.accept(t),(0,o.Ed)(t.dslMethods,(function(e){(0,o.Ed)(e,(function(e,t){e.idx=t+1}))}))}))}var xt="MismatchedTokenException",Nt="NoViableAltException",It="EarlyExitException",Dt="NotAllInputParsedException",Pt=[xt,Nt,It,Dt];function Ht(e){return(0,o.r3)(Pt,e.name)}function jt(e,t,n){this.name=xt,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function Ft(e,t,n){this.name=Nt,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function Yt(e,t){this.name=Dt,this.message=e,this.token=t,this.resyncedTokens=[]}function Ut(e,t,n){this.name=It,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(Pt),jt.prototype=Error.prototype,Ft.prototype=Error.prototype,Yt.prototype=Error.prototype,Ut.prototype=Error.prototype;var Bt={},Vt="InRuleRecoveryException";function Wt(e){this.name=Vt,this.message=e}Wt.prototype=Error.prototype;var zt=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,o.e$)(e,"recoveryEnabled")?e.recoveryEnabled:Sn.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Gt)},e.prototype.getTokenToInsert=function(e){var t=oe(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,n,r){for(var i=this,a=this.findReSyncTokenType(),s=this.exportLexerState(),u=[],l=!1,c=this.LA(1),f=this.LA(1),h=function(){var e=i.LA(0),t=new jt(i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:c,previous:e,ruleName:i.getCurrRuleFullName()}),c,i.LA(0));t.resyncedTokens=(0,o.j7)(u),i.SAVE_ERROR(t)};!l;){if(this.tokenMatcher(f,r))return void h();if(n.call(this))return h(),void e.apply(this,t);this.tokenMatcher(f,a)?l=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,u))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!1!==n&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(n)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new Wt("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if((0,o.xb)(t))return!1;var r=this.LA(1);return void 0!==(0,o.sE)(t,(function(e){return n.tokenMatcher(r,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return(0,o.r3)(n,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var r=t.tokenType;if((0,o.r3)(e,r))return r;t=this.LA(n),n++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return Bt;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return(0,o.xb)(this.LAST_EXPLICIT_RULE_STACK)||(t=(0,o.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),n=(0,o.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),(0,o.UI)(t,(function(r,o){return 0===o?Bt:{ruleName:e.shortRuleNameToFullName(r),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(t[o-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=(0,o.UI)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return(0,o.xH)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===Bt)return[re];var t=e.ruleName+e.idxInCallingRule+Oe+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,re)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return(0,o.j7)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,n,r,o,i,a){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,o.Qw)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return(0,o.xb)(this.LAST_EXPLICIT_RULE_STACK)?(0,o.UI)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):(0,o.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function Gt(e,t,n,r,o,i,a){var s=this.getKeyForAutomaticLookahead(r,o),u=this.firstAfterRepMap[s];if(void 0===u){var l=this.getCurrRuleFullName();u=new i(this.getGAstProductions()[l],o).startWalking(),this.firstAfterRepMap[s]=u}var c=u.token,f=u.occurrence,h=u.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===c&&(c=re,f=1),this.shouldInRepetitionRecoveryBeTried(c,f,a)&&this.tryInRepetitionRecovery(e,t,n,c)}var Kt,Xt=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=(0,o.e$)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Sn.dynamicTokensEnabled,this.maxLookahead=(0,o.e$)(e,"maxLookahead")?e.maxLookahead:Sn.maxLookahead,this.lookAheadFuncsCache=(0,o.dU)()?new Map:[],(0,o.dU)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;(0,o.Ed)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var n=function(e){Ce.reset(),e.accept(Ce);var t=Ce.dslMethods;return Ce.reset(),t}(e),r=n.alternation,i=n.repetition,a=n.option,s=n.repetitionMandatory,u=n.repetitionMandatoryWithSeparator,l=n.repetitionWithSeparator;(0,o.Ed)(r,(function(n){var r=0===n.idx?"":n.idx;t.TRACE_INIT(""+Re(n)+r,(function(){var r,o,i,a,s,u,l=(r=n.idx,o=e,i=n.maxLookahead||t.maxLookahead,a=n.hasPredicates,s=t.dynamicTokensEnabled,(0,t.lookAheadBuilderForAlternatives)(u=lt(r,o,i),a,ht(u)?U:Y,s)),c=je(t.fullRuleNameToShort[e.name],xe,n.idx);t.setLaFuncCache(c,l)}))})),(0,o.Ed)(i,(function(n){t.computeLookaheadFunc(e,n.idx,Ie,tt.REPETITION,n.maxLookahead,Re(n))})),(0,o.Ed)(a,(function(n){t.computeLookaheadFunc(e,n.idx,Ne,tt.OPTION,n.maxLookahead,Re(n))})),(0,o.Ed)(s,(function(n){t.computeLookaheadFunc(e,n.idx,De,tt.REPETITION_MANDATORY,n.maxLookahead,Re(n))})),(0,o.Ed)(u,(function(n){t.computeLookaheadFunc(e,n.idx,He,tt.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,Re(n))})),(0,o.Ed)(l,(function(n){t.computeLookaheadFunc(e,n.idx,Pe,tt.REPETITION_WITH_SEPARATOR,n.maxLookahead,Re(n))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,n,r,o,i){var a=this;this.TRACE_INIT(""+i+(0===t?"":t),(function(){var i=function(e,t,n,r,o,i){var a=ct(e,t,o,n),s=ht(a)?U:Y;return i(a[0],s,r)}(t,e,o||a.maxLookahead,a.dynamicTokensEnabled,r,a.lookAheadBuilderForOptional),s=je(a.fullRuleNameToShort[e.name],n,t);a.setLaFuncCache(s,i)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,n){return function(e,t,n){var r=(0,o.yW)(e,(function(e){return 1===e.length})),i=e.length;if(r&&!n){var a=(0,o.xH)(e);if(1===a.length&&(0,o.xb)(a[0].categoryMatches)){var s=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var u=(0,o.u4)(a,(function(e,t,n){return e[t.tokenTypeIdx]=!0,(0,o.Ed)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===u[e.tokenTypeIdx]}}return function(){e:for(var n=0;n<i;n++){for(var r=e[n],o=r.length,a=0;a<o;a++){var s=this.LA(a+1);if(!1===t(s,r[a]))continue e}return!0}return!1}}(e,t,n)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,n,r){return function(e,t,n,r){var i=e.length,a=(0,o.yW)(e,(function(e){return(0,o.yW)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var r=(0,o.UI)(t,(function(e){return e.GATE})),a=0;a<i;a++){var s=e[a],u=s.length,l=r[a];if(void 0===l||!1!==l.call(this))e:for(var c=0;c<u;c++){for(var f=s[c],h=f.length,d=0;d<h;d++){var p=this.LA(d+1);if(!1===n(p,f[d]))continue e}return a}}};if(a&&!r){var s=(0,o.UI)(e,(function(e){return(0,o.xH)(e)})),u=(0,o.u4)(s,(function(e,t,n){return(0,o.Ed)(t,(function(t){(0,o.e$)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=n),(0,o.Ed)(t.categoryMatches,(function(t){(0,o.e$)(e,t)||(e[t]=n)}))})),e}),[]);return function(){var e=this.LA(1);return u[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var r=e[t],o=r.length;e:for(var a=0;a<o;a++){for(var s=r[a],u=s.length,l=0;l<u;l++){var c=this.LA(l+1);if(!1===n(c,s[l]))continue e}return t}}}}(e,t,n,r)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return je(this.getLastExplicitRuleShortName(),e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}(),$t=/^\s*function\s*(\S*)\s*\(/,qt="name";function Jt(e){return e.name||e.toString().match($t)[1]}function Qt(e,t){var n=Object.getOwnPropertyDescriptor(e,qt);return!(!(0,o.o8)(n)&&!n.configurable||(Object.defineProperty(e,qt,{enumerable:!1,configurable:!0,writable:!1,value:t}),0))}function Zt(e,t){for(var n=(0,o.XP)(e),r=n.length,i=0;i<r;i++)for(var a=e[n[i]],s=a.length,u=0;u<s;u++){var l=a[u];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(Kt||(Kt={}));var en=["constructor","visit","validateVisitor"],tn=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=(0,o.e$)(e,"outputCst")?e.outputCst:Sn.outputCst,this.nodeLocationTracking=(0,o.e$)(e,"nodeLocationTracking")?e.nodeLocationTracking:Sn.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Be,this.setNodeLocationFromNode=Be,this.cstPostRule=o.dG,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.dG,this.setNodeLocationFromNode=o.dG,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ue,this.setNodeLocationFromNode=Ue,this.cstPostRule=o.dG,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.dG,this.setNodeLocationFromNode=o.dG,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.dG,this.setNodeLocationFromNode=o.dG,this.cstPostRule=o.dG,this.setInitialNodeLocation=o.dG}else this.cstInvocationStateUpdate=o.dG,this.cstFinallyStateUpdate=o.dG,this.cstPostTerminal=o.dG,this.cstPostNonTerminal=o.dG,this.cstPostRule=o.dG,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==1?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==1?n.endOffset=t.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var n,r,o,i=this.CST_STACK[this.CST_STACK.length-1];r=t,o=e,void 0===(n=i).children[o]?n.children[o]=[r]:n.children[o].push(r),this.setNodeLocationFromToken(i.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var n=this.CST_STACK[this.CST_STACK.length-1];Ve(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if((0,o.o8)(this.baseCstVisitorConstructor)){var e=function(e,t){var n=function(){};Qt(n,e+"BaseSemantics");var r={visit:function(e,t){if((0,o.kJ)(e)&&(e=e[0]),!(0,o.o8)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=function(e,t){var n=function(e,t){var n=(0,o.UI)(t,(function(t){if(!(0,o.mf)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+Jt(e.constructor)+" CST Visitor.",type:Kt.MISSING_METHOD,methodName:t}}));return(0,o.oA)(n)}(e,t),r=function(e,t){var n=[];for(var r in e)gt.test(r)&&(0,o.mf)(e[r])&&!(0,o.r3)(en,r)&&!(0,o.r3)(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+Jt(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+gt.source+"/.",type:Kt.REDUNDANT_METHOD,methodName:r});return n}(e,t);return n.concat(r)}(this,t);if(!(0,o.xb)(e)){var n=(0,o.UI)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+Jt(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}};return(n.prototype=r).constructor=n,n._RULE_NAMES=t,n}(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,o.o8)(this.baseCstVisitorWithDefaultsConstructor)){var e=function(e,t,n){var r=function(){};Qt(r,e+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return(0,o.Ed)(t,(function(e){i[e]=Zt})),(r.prototype=i).constructor=r,r}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var n;return void 0!==e.NAME?(n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n):void 0},e.prototype.nestedAltBeforeClause=function(e,t,n,r){var o,i=Fe(this.getLastExplicitRuleShortName(),n,t,r);return void 0!==e.NAME?(o=e.NAME,this.nestedRuleInvocationStateUpdate(o,i),{shortName:i,nestedName:o}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,r=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];Ve(o,t,r),this.setNodeLocationFromNode(o.location,r.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),nn=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):wn},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?wn:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),rn=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},e.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,n){if(void 0===n&&(n=En),(0,o.r3)(this.definedRulesNames,e)){var r={message:Tt.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:_n.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(r)}this.definedRulesNames.push(e);var i=this.defineRule(e,t,n);return this[e]=i,i},e.prototype.OVERRIDE_RULE=function(e,t,n){void 0===n&&(n=En);var r,i,a,s,u,l=[];l=l.concat((r=e,i=this.definedRulesNames,a=this.className,u=[],o.r3(i,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+a+"<-as it is not defined in any of the super grammars ",u.push({message:s,type:_n.INVALID_RULE_OVERRIDE,ruleName:r})),u)),this.definitionErrors.push.apply(this.definitionErrors,l);var c=this.defineRule(e,t,n);return this[e]=c,c},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(Ht(e))return!1;throw e}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return ge((0,o.VO)(this.gastProductionsCache))},e}(),on=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=Jt(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=U,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,o.e$)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,o.kJ)(e)){if((0,o.xb)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,o.kJ)(e))this.tokensMap=(0,o.u4)(e,(function(e,t){return e[t.name]=t,e}),{});else if((0,o.e$)(e,"modes")&&(0,o.yW)((0,o.xH)((0,o.VO)(e.modes)),X)){var n=(0,o.xH)((0,o.VO)(e.modes)),r=(0,o.jj)(n);this.tokensMap=(0,o.u4)(r,(function(e,t){return e[t.name]=t,e}),{})}else{if(!(0,o.Kn)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,o.Cl)(e)}this.tokensMap.EOF=re;var i=(0,o.yW)((0,o.VO)(e),(function(e){return(0,o.xb)(e.categoryMatches)}));this.tokenMatcher=i?U:Y,W((0,o.VO)(this.tokensMap))},e.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var r,i=(0,o.e$)(n,"resyncEnabled")?n.resyncEnabled:En.resyncEnabled,a=(0,o.e$)(n,"recoveryValueFunc")?n.recoveryValueFunc:En.recoveryValueFunc,s=this.ruleShortNameIdx<<12;function u(e){try{if(!0===this.outputCst){t.apply(this,e);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,a)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s,(r=function(t,n){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(s,e,t),u.call(this,n)}).ruleName=e,r.originalGrammarAction=t,r},e.prototype.invokeRuleCatch=function(e,t,n){var r=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Ht(e)){var i=e;if(o){var a,s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))return i.resyncedTokens=this.reSyncTo(s),this.outputCst?((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,a):n();throw this.outputCst&&((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=a),i}if(r)return this.moveToTerminatedState(),n();throw i}throw e},e.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Ne,t),r=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Ne,t);return this.optionInternalLogic(e,t,n)},e.prototype.optionInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(o=e.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=e;if(!0===a.call(this))return r.call(this)},e.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(De,e),r=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(De,e);this.atLeastOneInternalLogic(e,t,n)},e.prototype.atLeastOneInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(o=t.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=t;if(!0!==a.call(this))throw this.raiseEarlyExitException(e,tt.REPETITION_MANDATORY,t.ERR_MSG);for(var u=this.doSingleRepetition(r);!0===a.call(this)&&!0===u;)u=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],a,De,e,qe)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(He,e),r=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(He,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var r=this,o=t.DEF,i=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,tt.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,a,o,Je],a,He,e,Je)},e.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Ie,e),r=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Ie,e);return this.manyInternalLogic(e,t,n)},e.prototype.manyInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(o=t.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=t;for(var u=!0;!0===a.call(this)&&!0===u;)u=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],a,Ie,e,Xe,u)},e.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Pe,e),r=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Pe,e);this.manySepFirstInternalLogic(e,t,n)},e.prototype.manySepFirstInternalLogic=function(e,t,n){var r=this,o=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,a,o,$e],a,Pe,e,$e)}},e.prototype.repetitionSepSecondInternal=function(e,t,n,r,o){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,o],n,He,e,o)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var n=(0,o.kJ)(e)?e:e.DEF,r=this.getKeyForAutomaticLookahead(xe,t),i=this.getLaFuncFromCache(r).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(xe,t),r=this.nestedRuleBeforeClause(e,n);try{var i=(0,o.kJ)(e)?e:e.DEF,a=this.getLaFuncFromCache(n).call(this,i);if(void 0!==a){var s=i[a],u=this.nestedAltBeforeClause(s,t,xe,a);try{return s.ALT.call(this)}finally{void 0!==u&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Yt(t,e))}},e.prototype.subruleInternal=function(e,t,n){var r;try{var o=void 0!==n?n.ARGS:void 0;return r=e.call(this,t,o),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:e.ruleName),r}catch(t){this.subruleInternalError(t,n,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,n){throw Ht(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,n){var r;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),r=o):this.consumeInternalError(e,o,n)}catch(n){r=this.consumeInternalRecovery(e,t,n)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:e.name,r),r},e.prototype.consumeInternalError=function(e,t,n){var r,o=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new jt(r,t,o))},e.prototype.consumeInternalRecovery=function(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(e){throw e.name===Vt?n:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=(0,o.Qw)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),re)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),an=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,o.ce)(e.errorMessageProvider,Sn.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(Ht(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,o.Qw)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return(0,o.Qw)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,n){for(var r=this.getCurrRuleFullName(),o=ct(e,this.getGAstProductions()[r],t,this.maxLookahead)[0],i=[],a=1;a<=this.maxLookahead;a++)i.push(this.LA(a));var s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:i,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Ut(s,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),r=lt(e,this.getGAstProductions()[n],this.maxLookahead),o=[],i=1;i<=this.maxLookahead;i++)o.push(this.LA(i));var a=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:o,previous:a,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Ft(s,this.LA(1),a))},e}(),sn=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if((0,o.o8)(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Ze([n],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=(0,o.Ps)(e.ruleStack),n=this.getGAstProductions()[t];return new Ge(n,e).startWalking()},e}(),un={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(un);var ln=Math.pow(2,8)-1,cn=ne({name:"RECORDING_PHASE_TOKEN",pattern:Q.NA});W([cn]);var fn=oe(cn,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(fn);var hn={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},dn=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var n=t>0?t:"";e["CONSUME"+n]=function(e,n){return this.consumeInternalRecord(e,t,n)},e["SUBRULE"+n]=function(e,n){return this.subruleInternalRecord(e,t,n)},e["OPTION"+n]=function(e){return this.optionInternalRecord(e,t)},e["OR"+n]=function(e){return this.orInternalRecord(e,t)},e["MANY"+n]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+n]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+n]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+n]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},n=0;n<10;n++)t(n);e.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},e.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return wn},e.prototype.topLevelRuleRecord=function(e,t){try{var n=new le({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}},e.prototype.optionInternalRecord=function(e,t){return pn.call(this,fe,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){pn.call(this,he,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){pn.call(this,de,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){pn.call(this,pe,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){pn.call(this,me,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return mn.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,n){if(vn(t),!e||!1===(0,o.e$)(e,"ruleName")){var r=new Error("<SUBRULE"+yn(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=(0,o.fj)(this.recordingProdStack),a=e.ruleName,s=new ue({idx:t,nonTerminalName:a,referencedRule:void 0});return i.definition.push(s),this.outputCst?hn:un},e.prototype.consumeInternalRecord=function(e,t,n){if(vn(t),!G(e)){var r=new Error("<CONSUME"+yn(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=(0,o.fj)(this.recordingProdStack),a=new ve({idx:t,terminalType:e});return i.definition.push(a),fn},e}();function pn(e,t,n,r){void 0===r&&(r=!1),vn(n);var i=(0,o.fj)(this.recordingProdStack),a=(0,o.mf)(t)?t:t.DEF,s=new e({definition:[],idx:n});return(0,o.e$)(t,"NAME")&&(s.name=t.NAME),r&&(s.separator=t.SEP),(0,o.e$)(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),a.call(this),i.definition.push(s),this.recordingProdStack.pop(),un}function mn(e,t){var n=this;vn(t);var r=(0,o.fj)(this.recordingProdStack),i=!1===(0,o.kJ)(e),a=!1===i?e:e.DEF,s=new ye({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});(0,o.e$)(e,"NAME")&&(s.name=e.NAME),(0,o.e$)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var u=(0,o.G)(a,(function(e){return(0,o.mf)(e.GATE)}));return s.hasPredicates=u,r.definition.push(s),(0,o.Ed)(a,(function(e){var t=new ce({definition:[]});s.definition.push(t),(0,o.e$)(e,"NAME")&&(t.name=e.NAME),(0,o.e$)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:(0,o.e$)(e,"GATE")&&(t.ignoreAmbiguities=!0),n.recordingProdStack.push(t),e.ALT.call(n),n.recordingProdStack.pop()})),un}function yn(e){return 0===e?"":""+e}function vn(e){if(e<0||e>ln){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(ln+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var gn=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if((0,o.e$)(e,"traceInitPerf")){var t=e.traceInitPerf,n="number"==typeof t;this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Sn.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=(0,o.HT)(t),i=r.time,a=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}return t()},e}(),bn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wn=oe(re,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(wn);var _n,Sn=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:kt,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),En=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function kn(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(_n||(_n={}));var Rn=function(){function e(e,t){void 0===t&&(t=Sn),this.ignoredIssues=Sn.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),(0,o.e$)(t,"ignoredIssues")&&t.ignoredIssues!==Sn.ignoredIssues&&(0,o.rr)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=(0,o.e$)(t,"ignoredIssues")?t.ignoredIssues:Sn.ignoredIssues,this.skipValidations=(0,o.e$)(t,"skipValidations")?t.skipValidations:Sn.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",(function(){(0,o.SV)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),(0,o.Ed)(t.definedRulesNames,(function(e){var n=t[e].originalGrammarAction,r=void 0;t.TRACE_INIT(e+" Rule",(function(){r=t.topLevelRuleRecord(e,n)})),t.gastProductionsCache[e]=r}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=Ot({rules:(0,o.VO)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if((0,o.xb)(i)&&!1===t.skipValidations){var e=At({rules:(0,o.VO)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:(0,o.VO)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:Tt,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,e)}})),(0,o.xb)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e,n,r=(e=(0,o.VO)(t.gastProductionsCache),n={},(0,o.Ed)(e,(function(e){var t=new Le(e).startWalking();(0,o.f0)(n,t)})),n);t.resyncFollows=r})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions((0,o.VO)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e,n,r,i=(e=(0,o.VO)(t.gastProductionsCache),n=t.fullRuleNameToShort,r={allRuleNames:[]},(0,o.Ed)(e,(function(e){var t=n[e.name];r.allRuleNames.push(e.name);var i=new We(t);e.accept(i),(0,o.Ed)(i.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r);t.allRuleNames=i.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,o.xb)(t.definitionErrors))throw n=(0,o.UI)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();(0,o.ef)(Rn,[zt,Xt,tn,nn,on,rn,an,sn,dn,gn]);var Tn=function(e){function t(t,n){void 0===n&&(n=Sn);var r=(0,o.Cl)(n);return r.outputCst=!0,e.call(this,t,r)||this}return bn(t,e),t}(Rn),Cn=function(e){function t(t,n){void 0===n&&(n=Sn);var r=(0,o.Cl)(n);return r.outputCst=!1,e.call(this,t,r)||this}return bn(t,e),t}(Rn);function Mn(e,t){var n=void 0===t?{}:t,o=n.resourceBase,i=void 0===o?"https://unpkg.com/chevrotain@"+r+"/diagrams/":o,a=n.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===a?"https://unpkg.com/chevrotain@"+r+"/diagrams/diagrams.css":a)+"'>\n\n<script src='"+i+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+i+"src/diagrams_builder.js'><\/script>\n<script src='"+i+"src/diagrams_behavior.js'><\/script>\n<script src='"+i+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}var On="\n";function An(e){var t;return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(t=e.rules,(0,o.UI)(t,(function(e){return n=Dn(1,'$.RULE("'+(t=e).name+'", function() {')+On,(n+=In(t.definition,2))+(Dn(2,"})")+On);var t,n})).join("\n")+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n")+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function Ln(e,t){if(e instanceof ue)return function(e,t){return Dn(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+On)}(e,t);if(e instanceof fe)return xn("OPTION",e,t);if(e instanceof he)return xn("AT_LEAST_ONE",e,t);if(e instanceof de)return xn("AT_LEAST_ONE_SEP",e,t);if(e instanceof me)return xn("MANY_SEP",e,t);if(e instanceof pe)return xn("MANY",e,t);if(e instanceof ye)return function(e,t){var n=Dn(t,"$.OR"+e.idx+"([")+On,r=(0,o.UI)(e.definition,(function(e){return function(e,t){var n=Dn(t,"{")+On;return e.name&&(n+=Dn(t+1,'NAME: "'+e.name+'",')+On),n+=Dn(t+1,"ALT: function() {")+On,n+=In(e.definition,t+1),(n+=Dn(t+1,"}")+On)+Dn(t,"}")}(e,t+1)}));return(n+=r.join(",\n"))+(On+Dn(t,"])\n"))}(e,t);if(e instanceof ve)return function(e,t){var n=e.terminalType.name;return Dn(t,"$.CONSUME"+e.idx+"(this.tokensMap."+n+")"+On)}(e,t);if(e instanceof ce)return In(e.definition,t);throw Error("non exhaustive match")}function xn(e,t,n){var r=Dn(n,"$."+(e+t.idx)+"(");return t.name||t.separator?(r+="{\n",t.name&&(r+=Dn(n+1,'NAME: "'+t.name+'"')+","+On),t.separator&&(r+=Dn(n+1,"SEP: this.tokensMap."+t.separator.name)+","+On),r+="DEF: "+Nn(t.definition,n+2)+On,r+=Dn(n,"}")+On):r+=Nn(t.definition,n+1),r+(Dn(n,")")+On)}function Nn(e,t){var n="function() {\n";return(n+=In(e,t))+(Dn(t,"}")+On)}function In(e,t){var n="";return(0,o.Ed)(e,(function(e){n+=Ln(e,t+1)})),n}function Dn(e,t){return Array(4*e+1).join(" ")+t}function Pn(e){var t=function(e){return"    \n"+An(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}({name:e.name,rules:e.rules}),r=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return r(e.tokenVocabulary,t,n(38321))}}function Hn(e){return function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+An(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}({name:e.name,rules:e.rules})}function jn(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}},11150:(e,t,n)=>{"use strict";function r(e){return e&&0===e.length}function o(e){return null==e?[]:Object.keys(e)}function i(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function a(e,t){for(var n=[],r=o(e),i=0;i<r.length;i++){var a=r[i];n.push(t.call(null,e[a],a))}return n}function s(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function u(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(u(r)):t.push(r)}return t}function l(e){return r(e)?void 0:e[0]}function c(e){var t=e&&e.length;return t?e[t-1]:void 0}function f(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else{if(!L(e))throw Error("non exhaustive match");var r=o(e);for(n=0;n<r.length;n++){var i=r[n],a=e[i];t.call(null,a,i)}}}function h(e){return"string"==typeof e}function d(e){return void 0===e}function p(e){return e instanceof Function}function m(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function y(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function v(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function g(e,t){return v(e,(function(e){return!t(e)}))}function b(e,t){for(var n=Object.keys(e),r={},o=0;o<n.length;o++){var i=n[o],a=e[i];t(a)&&(r[i]=a)}return r}function w(e,t){return!!L(e)&&e.hasOwnProperty(t)}function _(e,t){return void 0!==k(e,(function(e){return e===t}))}function S(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function E(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function k(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function R(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function T(e,t,n){for(var r=Array.isArray(e),a=r?e:i(e),s=r?[]:o(e),u=n,l=0;l<a.length;l++)u=t.call(null,u,a[l],r?l:s[l]);return u}function C(e){return g(e,(function(e){return null==e}))}function M(e,t){void 0===t&&(t=function(e){return e});var n=[];return T(e,(function(e,r){var o=t(r);return _(n,o)?e:(n.push(o),e.concat(r))}),[])}function O(e){return Array.isArray(e)}function A(e){return e instanceof RegExp}function L(e){return e instanceof Object}function x(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function N(e,t){return g(e,(function(e){return _(t,e)}))}function I(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function D(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function P(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],a=o(i),s=0;s<a.length;s++){var u=a[s];e[u]=i[u]}return e}function H(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];if(!d(i))for(var a=o(i),s=0;s<a.length;s++){var u=a[s];w(e,u)||(e[u]=i[u])}}return e}function j(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return H.apply(null,[{}].concat(e))}function F(e,t){var n={};return f(e,(function(e){var r=t(e),o=n[r];o?o.push(e):n[r]=[e]})),n}function Y(e,t){for(var n=E(e),r=o(t),i=0;i<r.length;i++){var a=r[i],s=t[a];n[a]=s}return n}function U(){}function B(e){return e}function V(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(void 0!==r?r:void 0)}return t}function W(e){console&&console.error&&console.error("Error: "+e)}function z(e){console&&console.warn&&console.warn("Warning: "+e)}function G(){return"function"==typeof Map}function K(e,t){t.forEach((function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(r){if("constructor"!==r){var o=Object.getOwnPropertyDescriptor(n,r);o&&(o.get||o.set)?Object.defineProperty(e.prototype,r,o):e.prototype[r]=t.prototype[r]}}))}))}function X(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.bar}return r(),r(),e}function $(e){return e[e.length-1]}function q(e){var t=(new Date).getTime(),n=e();return{time:(new Date).getTime()-t,value:n}}n.d(t,{xb:()=>r,XP:()=>o,VO:()=>i,Q8:()=>a,UI:()=>s,xH:()=>u,Ps:()=>l,Z$:()=>c,Ed:()=>f,HD:()=>h,o8:()=>d,mf:()=>p,Cw:()=>m,j7:()=>y,hX:()=>v,d1:()=>g,ei:()=>b,e$:()=>w,r3:()=>_,Qw:()=>S,Cl:()=>E,sE:()=>k,Oq:()=>R,u4:()=>T,oA:()=>C,jj:()=>M,kJ:()=>O,Kj:()=>A,Kn:()=>L,yW:()=>x,e5:()=>N,G:()=>I,cq:()=>D,f0:()=>P,ce:()=>j,vM:()=>F,TS:()=>Y,dG:()=>U,Wd:()=>B,X0:()=>V,WB:()=>W,rr:()=>z,dU:()=>G,ef:()=>K,SV:()=>X,fj:()=>$,HT:()=>q})},18257:(e,t,n)=>{var r=n(47583),o=n(9212),i=n(75637),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not a function")}},41186:(e,t,n)=>{var r=n(47583),o=n(62097),i=n(75637),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not a constructor")}},79882:(e,t,n)=>{var r=n(47583),o=n(9212),i=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||o(e))return e;throw a("Can't set "+i(e)+" as a prototype")}},36288:(e,t,n)=>{var r=n(3649),o=n(3590),i=n(94615),a=r("unscopables"),s=Array.prototype;null==s[a]&&i.f(s,a,{configurable:!0,value:o(null)}),e.exports=function(e){s[a][e]=!0}},96733:(e,t,n)=>{"use strict";var r=n(96389).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},44761:(e,t,n)=>{var r=n(47583),o=n(22447),i=r.TypeError;e.exports=function(e,t){if(o(t,e))return e;throw i("Incorrect invocation")}},92569:(e,t,n)=>{var r=n(47583),o=n(90794),i=r.String,a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not an object")}},91537:(e,t,n)=>{var r=n(16544);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},93579:(e,t,n)=>{"use strict";var r=n(61324),o=n(96782),i=n(1825);e.exports=function(e){for(var t=r(this),n=i(t),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,l=void 0===u?n:o(u,n);l>s;)t[s++]=e;return t}},63200:(e,t,n)=>{"use strict";var r=n(24805).forEach,o=n(60906)("forEach");e.exports=o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},35513:(e,t,n)=>{"use strict";var r=n(47583),o=n(12938),i=n(38262),a=n(61324),s=n(65294),u=n(70114),l=n(62097),c=n(1825),f=n(65999),h=n(36307),d=n(38272),p=r.Array;e.exports=function(e){var t=a(e),n=l(this),r=arguments.length,m=r>1?arguments[1]:void 0,y=void 0!==m;y&&(m=o(m,r>2?arguments[2]:void 0));var v,g,b,w,_,S,E=d(t),k=0;if(!E||this==p&&u(E))for(v=c(t),g=n?new this(v):p(v);v>k;k++)S=y?m(t[k],k):t[k],f(g,k,S);else for(_=(w=h(t,E)).next,g=n?new this:[];!(b=i(_,w)).done;k++)S=y?s(w,m,[b.value,k],!0):b.value,f(g,k,S);return g.length=k,g}},15766:(e,t,n)=>{var r=n(22977),o=n(96782),i=n(1825),a=function(e){return function(t,n,a){var s,u=r(t),l=i(u),c=o(a,l);if(e&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},24805:(e,t,n)=>{var r=n(12938),o=n(7386),i=n(55044),a=n(61324),s=n(1825),u=n(44822),l=o([].push),c=function(e){var t=1==e,n=2==e,o=3==e,c=4==e,f=6==e,h=7==e,d=5==e||f;return function(p,m,y,v){for(var g,b,w=a(p),_=i(w),S=r(m,y),E=s(_),k=0,R=v||u,T=t?R(p,E):n||h?R(p,0):void 0;E>k;k++)if((d||k in _)&&(b=S(g=_[k],k,w),e))if(t)T[k]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return k;case 2:l(T,g)}else switch(e){case 4:return!1;case 7:l(T,g)}return f?-1:o||c?c:T}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},73161:(e,t,n)=>{"use strict";var r=n(71611),o=n(22977),i=n(87486),a=n(1825),s=n(60906),u=Math.min,l=[].lastIndexOf,c=!!l&&1/[1].lastIndexOf(1,-0)<0,f=s("lastIndexOf"),h=c||!f;e.exports=h?function(e){if(c)return r(l,this,arguments)||0;var t=o(this),n=a(t),s=n-1;for(arguments.length>1&&(s=u(s,i(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:l},69269:(e,t,n)=>{var r=n(16544),o=n(3649),i=n(24061),a=o("species");e.exports=function(e){return i>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},60906:(e,t,n)=>{"use strict";var r=n(16544);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},64325:(e,t,n)=>{var r=n(47583),o=n(18257),i=n(61324),a=n(55044),s=n(1825),u=r.TypeError,l=function(e){return function(t,n,r,l){o(n);var c=i(t),f=a(c),h=s(c),d=e?h-1:0,p=e?-1:1;if(r<2)for(;;){if(d in f){l=f[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw u("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in f&&(l=n(l,f[d],d,c));return l}};e.exports={left:l(!1),right:l(!0)}},74546:(e,t,n)=>{var r=n(47583),o=n(96782),i=n(1825),a=n(65999),s=r.Array,u=Math.max;e.exports=function(e,t,n){for(var r=i(e),l=o(t,r),c=o(void 0===n?r:n,r),f=s(u(c-l,0)),h=0;l<c;l++,h++)a(f,h,e[l]);return f.length=h,f}},46917:(e,t,n)=>{var r=n(7386);e.exports=r([].slice)},25744:(e,t,n)=>{var r=n(74546),o=Math.floor,i=function(e,t){var n=e.length,u=o(n/2);return n<8?a(e,t):s(e,i(r(e,0,u),t),i(r(e,u),t),t)},a=function(e,t){for(var n,r,o=e.length,i=1;i<o;){for(r=i,n=e[i];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var o=t.length,i=n.length,a=0,s=0;a<o||s<i;)e[a+s]=a<o&&s<i?r(t[a],n[s])<=0?t[a++]:n[s++]:a<o?t[a++]:n[s++];return e};e.exports=i},15289:(e,t,n)=>{var r=n(47583),o=n(54521),i=n(62097),a=n(90794),s=n(3649)("species"),u=r.Array;e.exports=function(e){var t;return o(e)&&(t=e.constructor,(i(t)&&(t===u||o(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?u:t}},44822:(e,t,n)=>{var r=n(15289);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},65294:(e,t,n)=>{var r=n(92569),o=n(47093);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},3616:(e,t,n)=>{var r=n(3649)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},e(i)}catch(e){}return n}},39624:(e,t,n)=>{var r=n(7386),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},33058:(e,t,n)=>{var r=n(47583),o=n(88191),i=n(9212),a=n(39624),s=n(3649)("toStringTag"),u=r.Object,l="Arguments"==a(function(){return arguments}());e.exports=o?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=u(e),s))?n:l?a(t):"Object"==(r=a(t))&&i(t.callee)?"Arguments":r}},26100:(e,t,n)=>{"use strict";var r=n(94615).f,o=n(3590),i=n(96893),a=n(12938),s=n(44761),u=n(54026),l=n(99012),c=n(7730),f=n(18494),h=n(51909).fastKey,d=n(42743),p=d.set,m=d.getterFor;e.exports={getConstructor:function(e,t,n,l){var c=e((function(e,r){s(e,d),p(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=r&&u(r,e[l],{that:e,AS_ENTRIES:n})})),d=c.prototype,y=m(t),v=function(e,t,n){var r,o,i=y(e),a=g(e,t);return a?a.value=n:(i.last=a={index:o=h(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),f?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},g=function(e,t){var n,r=y(e),o=h(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return i(d,{clear:function(){for(var e=y(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t=this,n=y(t),r=g(t,e);if(r){var o=r.next,i=r.previous;delete n.index[r.index],r.removed=!0,i&&(i.next=o),o&&(o.previous=i),n.first==r&&(n.first=o),n.last==r&&(n.last=i),f?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=y(this),r=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!g(this,e)}}),i(d,n?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),f&&r(d,"size",{get:function(){return y(this).size}}),c},setStrong:function(e,t,n){var r=t+" Iterator",o=m(t),i=m(r);l(e,t,(function(e,t){p(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(t)}}},57012:(e,t,n)=>{"use strict";var r=n(7386),o=n(96893),i=n(51909).getWeakData,a=n(92569),s=n(90794),u=n(44761),l=n(54026),c=n(24805),f=n(62870),h=n(42743),d=h.set,p=h.getterFor,m=c.find,y=c.findIndex,v=r([].splice),g=0,b=function(e){return e.frozen||(e.frozen=new w)},w=function(){this.entries=[]},_=function(e,t){return m(e.entries,(function(e){return e[0]===t}))};w.prototype={get:function(e){var t=_(this,e);if(t)return t[1]},has:function(e){return!!_(this,e)},set:function(e,t){var n=_(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=y(this.entries,(function(t){return t[0]===e}));return~t&&v(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var c=e((function(e,o){u(e,h),d(e,{type:t,id:g++,frozen:void 0}),null!=o&&l(o,e[r],{that:e,AS_ENTRIES:n})})),h=c.prototype,m=p(t),y=function(e,t,n){var r=m(e),o=i(a(t),!0);return!0===o?b(r).set(t,n):o[r.id]=n,e};return o(h,{delete:function(e){var t=m(this);if(!s(e))return!1;var n=i(e);return!0===n?b(t).delete(e):n&&f(n,t.id)&&delete n[t.id]},has:function(e){var t=m(this);if(!s(e))return!1;var n=i(e);return!0===n?b(t).has(e):n&&f(n,t.id)}}),o(h,n?{get:function(e){var t=m(this);if(s(e)){var n=i(e);return!0===n?b(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return y(this,e,t)}}:{add:function(e){return y(this,e,!0)}}),c}}},24802:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(7386),a=n(34451),s=n(61270),u=n(51909),l=n(54026),c=n(44761),f=n(9212),h=n(90794),d=n(16544),p=n(3616),m=n(98821),y=n(40434);e.exports=function(e,t,n){var v=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),b=v?"set":"add",w=o[e],_=w&&w.prototype,S=w,E={},k=function(e){var t=i(_[e]);s(_,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!h(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return g&&!h(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!h(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(a(e,!f(w)||!(g||_.forEach&&!d((function(){(new w).entries().next()})))))S=n.getConstructor(t,e,v,b),u.enable();else if(a(e,!0)){var R=new S,T=R[b](g?{}:-0,1)!=R,C=d((function(){R.has(1)})),M=p((function(e){new w(e)})),O=!g&&d((function(){for(var e=new w,t=5;t--;)e[b](t,t);return!e.has(-0)}));M||((S=t((function(e,t){c(e,_);var n=y(new w,e,S);return null!=t&&l(t,n[b],{that:n,AS_ENTRIES:v}),n}))).prototype=_,_.constructor=S),(C||O)&&(k("delete"),k("has"),v&&k("get")),(O||T)&&k(b),g&&_.clear&&delete _.clear}return E[e]=S,r({global:!0,forced:S!=w},E),m(S,e),g||n.setStrong(S,e,v),S}},83478:(e,t,n)=>{var r=n(62870),o=n(40929),i=n(46683),a=n(94615);e.exports=function(e,t,n){for(var s=o(t),u=a.f,l=i.f,c=0;c<s.length;c++){var f=s[c];r(e,f)||n&&r(n,f)||u(e,f,l(t,f))}}},83989:(e,t,n)=>{var r=n(3649)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},50926:(e,t,n)=>{var r=n(16544);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},35888:(e,t,n)=>{var r=n(7386),o=n(63955),i=n(28320),a=/"/g,s=r("".replace);e.exports=function(e,t,n,r){var u=i(o(e)),l="<"+t;return""!==n&&(l+=" "+n+'="'+s(i(r),a,"&quot;")+'"'),l+">"+u+"</"+t+">"}},24683:(e,t,n)=>{"use strict";var r=n(72365).IteratorPrototype,o=n(3590),i=n(54677),a=n(98821),s=n(60339),u=function(){return this};e.exports=function(e,t,n,l){var c=t+" Iterator";return e.prototype=o(r,{next:i(+!l,n)}),a(e,c,!1,!0),s[c]=u,e}},57:(e,t,n)=>{var r=n(18494),o=n(94615),i=n(54677);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},54677:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},65999:(e,t,n)=>{"use strict";var r=n(98734),o=n(94615),i=n(54677);e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},99012:(e,t,n)=>{"use strict";var r=n(37263),o=n(38262),i=n(86268),a=n(14340),s=n(9212),u=n(24683),l=n(80729),c=n(17496),f=n(98821),h=n(57),d=n(61270),p=n(3649),m=n(60339),y=n(72365),v=a.PROPER,g=a.CONFIGURABLE,b=y.IteratorPrototype,w=y.BUGGY_SAFARI_ITERATORS,_=p("iterator"),S="keys",E="values",k="entries",R=function(){return this};e.exports=function(e,t,n,a,p,y,T){u(n,t,a);var C,M,O,A=function(e){if(e===p&&D)return D;if(!w&&e in N)return N[e];switch(e){case S:case E:case k:return function(){return new n(this,e)}}return function(){return new n(this)}},L=t+" Iterator",x=!1,N=e.prototype,I=N[_]||N["@@iterator"]||p&&N[p],D=!w&&I||A(p),P="Array"==t&&N.entries||I;if(P&&(C=l(P.call(new e)))!==Object.prototype&&C.next&&(i||l(C)===b||(c?c(C,b):s(C[_])||d(C,_,R)),f(C,L,!0,!0),i&&(m[L]=R)),v&&p==E&&I&&I.name!==E&&(!i&&g?h(N,"name",E):(x=!0,D=function(){return o(I,this)})),p)if(M={values:A(E),keys:y?D:A(S),entries:A(k)},T)for(O in M)(w||x||!(O in N))&&d(N,O,M[O]);else r({target:t,proto:!0,forced:w||x},M);return i&&!T||N[_]===D||d(N,_,D,{name:p}),m[t]=D,M}},82219:(e,t,n)=>{var r=n(21287),o=n(62870),i=n(20491),a=n(94615).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||a(t,e,{value:i.f(e)})}},18494:(e,t,n)=>{var r=n(16544);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},26668:(e,t,n)=>{var r=n(47583),o=n(90794),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},86778:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},49307:(e,t,n)=>{var r=n(26668)("span").classList,o=r&&r.constructor&&r.constructor.prototype;e.exports=o===Object.prototype?void 0:o},15857:(e,t,n)=>{var r=n(46918).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},50924:(e,t,n)=>{var r=n(46918);e.exports=/MSIE|Trident/.test(r)},17020:(e,t,n)=>{var r=n(46918);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},45354:(e,t,n)=>{var r=n(39624),o=n(47583);e.exports="process"==r(o.process)},46918:(e,t,n)=>{var r=n(35897);e.exports=r("navigator","userAgent")||""},24061:(e,t,n)=>{var r,o,i=n(47583),a=n(46918),s=i.process,u=i.Deno,l=s&&s.versions||u&&u.version,c=l&&l.v8;c&&(o=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},20003:(e,t,n)=>{var r=n(46918).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},15690:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},37263:(e,t,n)=>{var r=n(47583),o=n(46683).f,i=n(57),a=n(61270),s=n(50460),u=n(83478),l=n(34451);e.exports=function(e,t){var n,c,f,h,d,p=e.target,m=e.global,y=e.stat;if(n=m?r:y?r[p]||s(p,{}):(r[p]||{}).prototype)for(c in t){if(h=t[c],f=e.noTargetGet?(d=o(n,c))&&d.value:n[c],!l(m?c:p+(y?".":"#")+c,e.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(e.sham||f&&f.sham)&&i(h,"sham",!0),a(n,c,h,e)}}},16544:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},90783:(e,t,n)=>{"use strict";n(62322);var r=n(7386),o=n(61270),i=n(48445),a=n(16544),s=n(3649),u=n(57),l=s("species"),c=RegExp.prototype;e.exports=function(e,t,n,f){var h=s(e),d=!a((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=d&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!d||!p||n){var m=r(/./[h]),y=t(h,""[e],(function(e,t,n,o,a){var s=r(e),u=t.exec;return u===i||u===c.exec?d&&!a?{done:!0,value:m(t,n,o)}:{done:!0,value:s(n,t,o)}:{done:!1}}));o(String.prototype,e,y[0]),o(c,h,y[1])}f&&u(c[h],"sham",!0)}},39974:(e,t,n)=>{var r=n(16544);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},71611:(e,t,n)=>{var r=n(88987),o=Function.prototype,i=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(i):function(){return a.apply(i,arguments)})},12938:(e,t,n)=>{var r=n(7386),o=n(18257),i=n(88987),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?a(e,t):function(){return e.apply(t,arguments)}}},88987:(e,t,n)=>{var r=n(16544);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},51335:(e,t,n)=>{"use strict";var r=n(47583),o=n(7386),i=n(18257),a=n(90794),s=n(62870),u=n(46917),l=n(88987),c=r.Function,f=o([].concat),h=o([].join),d={},p=function(e,t,n){if(!s(d,t)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";d[t]=c("C,a","return new C("+h(r,",")+")")}return d[t](e,n)};e.exports=l?c.bind:function(e){var t=i(this),n=t.prototype,r=u(arguments,1),o=function(){var n=f(r,u(arguments));return this instanceof o?p(t,n.length,n):t.apply(e,n)};return a(n)&&(o.prototype=n),o}},38262:(e,t,n)=>{var r=n(88987),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},14340:(e,t,n)=>{var r=n(18494),o=n(62870),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=o(i,"name"),u=s&&"something"===function(){}.name,l=s&&(!r||r&&a(i,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:l}},7386:(e,t,n)=>{var r=n(88987),o=Function.prototype,i=o.bind,a=o.call,s=r&&i.bind(a,a);e.exports=r?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},35897:(e,t,n)=>{var r=n(47583),o=n(9212),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},38272:(e,t,n)=>{var r=n(33058),o=n(60911),i=n(60339),a=n(3649)("iterator");e.exports=function(e){if(null!=e)return o(e,a)||o(e,"@@iterator")||i[r(e)]}},36307:(e,t,n)=>{var r=n(47583),o=n(38262),i=n(18257),a=n(92569),s=n(75637),u=n(38272),l=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?u(e):t;if(i(n))return a(o(n,e));throw l(s(e)+" is not iterable")}},60911:(e,t,n)=>{var r=n(18257);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},4305:(e,t,n)=>{var r=n(7386),o=n(61324),i=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,h){var d=n+e.length,p=r.length,m=c;return void 0!==f&&(f=o(f),m=l),s(h,m,(function(o,s){var l;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,d);case"<":l=f[u(s,1,-1)];break;default:var c=+s;if(0===c)return o;if(c>p){var h=i(c/10);return 0===h?o:h<=p?void 0===r[h-1]?a(s,1):r[h-1]+a(s,1):o}l=r[c-1]}return void 0===l?"":l}))}},47583:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},62870:(e,t,n)=>{var r=n(7386),o=n(61324),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},64639:e=>{e.exports={}},90482:(e,t,n)=>{var r=n(35897);e.exports=r("document","documentElement")},275:(e,t,n)=>{var r=n(18494),o=n(16544),i=n(26668);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},55044:(e,t,n)=>{var r=n(47583),o=n(7386),i=n(16544),a=n(39624),s=r.Object,u=o("".split);e.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?u(e,""):s(e)}:s},40434:(e,t,n)=>{var r=n(9212),o=n(90794),i=n(17496);e.exports=function(e,t,n){var a,s;return i&&r(a=t.constructor)&&a!==n&&o(s=a.prototype)&&s!==n.prototype&&i(e,s),e}},69734:(e,t,n)=>{var r=n(7386),o=n(9212),i=n(31314),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return a(e)}),e.exports=i.inspectSource},51909:(e,t,n)=>{var r=n(37263),o=n(7386),i=n(64639),a=n(90794),s=n(62870),u=n(94615).f,l=n(9275),c=n(63130),f=n(4766),h=n(98284),d=n(39974),p=!1,m=h("meta"),y=0,v=function(e){u(e,m,{value:{objectID:"O"+y++,weakData:{}}})},g=e.exports={enable:function(){g.enable=function(){},p=!0;var e=l.f,t=o([].splice),n={};n[m]=1,e(n).length&&(l.f=function(n){for(var r=e(n),o=0,i=r.length;o<i;o++)if(r[o]===m){t(r,o,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,m)){if(!f(e))return"F";if(!t)return"E";v(e)}return e[m].objectID},getWeakData:function(e,t){if(!s(e,m)){if(!f(e))return!0;if(!t)return!1;v(e)}return e[m].weakData},onFreeze:function(e){return d&&p&&f(e)&&!s(e,m)&&v(e),e}};i[m]=!0},42743:(e,t,n)=>{var r,o,i,a=n(89491),s=n(47583),u=n(7386),l=n(90794),c=n(57),f=n(62870),h=n(31314),d=n(89137),p=n(64639),m="Object already initialized",y=s.TypeError,v=s.WeakMap;if(a||h.state){var g=h.state||(h.state=new v),b=u(g.get),w=u(g.has),_=u(g.set);r=function(e,t){if(w(g,e))throw new y(m);return t.facade=e,_(g,e,t),t},o=function(e){return b(g,e)||{}},i=function(e){return w(g,e)}}else{var S=d("state");p[S]=!0,r=function(e,t){if(f(e,S))throw new y(m);return t.facade=e,c(e,S,t),t},o=function(e){return f(e,S)?e[S]:{}},i=function(e){return f(e,S)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=o(t)).type!==e)throw y("Incompatible receiver, "+e+" required");return n}}}},70114:(e,t,n)=>{var r=n(3649),o=n(60339),i=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},54521:(e,t,n)=>{var r=n(39624);e.exports=Array.isArray||function(e){return"Array"==r(e)}},9212:e=>{e.exports=function(e){return"function"==typeof e}},62097:(e,t,n)=>{var r=n(7386),o=n(16544),i=n(9212),a=n(33058),s=n(35897),u=n(69734),l=function(){},c=[],f=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),p=!h.exec(l),m=function(e){if(!i(e))return!1;try{return f(l,c,e),!0}catch(e){return!1}},y=function(e){if(!i(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(h,u(e))}catch(e){return!0}};y.sham=!0,e.exports=!f||o((function(){var e;return m(m.call)||!m(Object)||!m((function(){e=!0}))||e}))?y:m},78118:(e,t,n)=>{var r=n(62870);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},34451:(e,t,n)=>{var r=n(16544),o=n(9212),i=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==c||n!=l&&(o(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},u=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},69352:(e,t,n)=>{var r=n(90794),o=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&o(e)===e}},90794:(e,t,n)=>{var r=n(9212);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},86268:e=>{e.exports=!1},17574:(e,t,n)=>{var r=n(90794),o=n(39624),i=n(3649)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},35871:(e,t,n)=>{var r=n(47583),o=n(35897),i=n(9212),a=n(22447),s=n(67786),u=r.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=o("Symbol");return i(t)&&a(t.prototype,u(e))}},54026:(e,t,n)=>{var r=n(47583),o=n(12938),i=n(38262),a=n(92569),s=n(75637),u=n(70114),l=n(1825),c=n(22447),f=n(36307),h=n(38272),d=n(47093),p=r.TypeError,m=function(e,t){this.stopped=e,this.result=t},y=m.prototype;e.exports=function(e,t,n){var r,v,g,b,w,_,S,E=n&&n.that,k=!(!n||!n.AS_ENTRIES),R=!(!n||!n.IS_ITERATOR),T=!(!n||!n.INTERRUPTED),C=o(t,E),M=function(e){return r&&d(r,"normal",e),new m(!0,e)},O=function(e){return k?(a(e),T?C(e[0],e[1],M):C(e[0],e[1])):T?C(e,M):C(e)};if(R)r=e;else{if(!(v=h(e)))throw p(s(e)+" is not iterable");if(u(v)){for(g=0,b=l(e);b>g;g++)if((w=O(e[g]))&&c(y,w))return w;return new m(!1)}r=f(e,v)}for(_=r.next;!(S=i(_,r)).done;){try{w=O(S.value)}catch(e){d(r,"throw",e)}if("object"==typeof w&&w&&c(y,w))return w}return new m(!1)}},47093:(e,t,n)=>{var r=n(38262),o=n(92569),i=n(60911);e.exports=function(e,t,n){var a,s;o(e);try{if(!(a=i(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw n;if(s)throw a;return o(a),n}},72365:(e,t,n)=>{"use strict";var r,o,i,a=n(16544),s=n(9212),u=n(3590),l=n(80729),c=n(61270),f=n(3649),h=n(86268),d=f("iterator"),p=!1;[].keys&&("next"in(i=[].keys())?(o=l(l(i)))!==Object.prototype&&(r=o):p=!0),null==r||a((function(){var e={};return r[d].call(e)!==e}))?r={}:h&&(r=u(r)),s(r[d])||c(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},60339:e=>{e.exports={}},1825:(e,t,n)=>{var r=n(70097);e.exports=function(e){return r(e.length)}},1599:e=>{var t=Math.expm1,n=Math.exp;e.exports=!t||t(10)>22025.465794806718||t(10)<22025.465794806718||-2e-17!=t(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:n(e)-1}:t},52789:e=>{var t=Math.log,n=Math.LOG10E;e.exports=Math.log10||function(e){return t(e)*n}},40865:e=>{var t=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:t(1+e)}},88640:(e,t,n)=>{var r=n(24061),o=n(16544);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},89491:(e,t,n)=>{var r=n(47583),o=n(9212),i=n(69734),a=r.WeakMap;e.exports=o(a)&&/native code/.test(i(a))},59041:(e,t,n)=>{var r=n(47583),o=n(17574),i=r.TypeError;e.exports=function(e){if(o(e))throw i("The method doesn't accept regular expressions");return e}},79606:(e,t,n)=>{var r=n(47583).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&r(e)}},79304:(e,t,n)=>{"use strict";var r=n(18494),o=n(7386),i=n(38262),a=n(16544),s=n(75432),u=n(74012),l=n(20112),c=n(61324),f=n(55044),h=Object.assign,d=Object.defineProperty,p=o([].concat);e.exports=!h||a((function(){if(r&&1!==h({b:1},h(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=h({},e)[n]||s(h({},t)).join("")!=o}))?function(e,t){for(var n=c(e),o=arguments.length,a=1,h=u.f,d=l.f;o>a;)for(var m,y=f(arguments[a++]),v=h?p(s(y),h(y)):s(y),g=v.length,b=0;g>b;)m=v[b++],r&&!i(d,y,m)||(n[m]=y[m]);return n}:h},3590:(e,t,n)=>{var r,o=n(92569),i=n(28728),a=n(15690),s=n(64639),u=n(90482),l=n(26668),c=n(89137)("IE_PROTO"),f=function(){},h=function(e){return"<script>"+e+"<\/script>"},d=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;p="undefined"!=typeof document?document.domain&&r?d(r):((t=l("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):d(r);for(var n=a.length;n--;)delete p.prototype[a[n]];return p()};s[c]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=o(e),n=new f,f.prototype=null,n[c]=e):n=p(),void 0===t?n:i.f(n,t)}},28728:(e,t,n)=>{var r=n(18494),o=n(7670),i=n(94615),a=n(92569),s=n(22977),u=n(75432);t.f=r&&!o?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),o=u(t),l=o.length,c=0;l>c;)i.f(e,n=o[c++],r[n]);return e}},94615:(e,t,n)=>{var r=n(47583),o=n(18494),i=n(275),a=n(7670),s=n(92569),u=n(98734),l=r.TypeError,c=Object.defineProperty,f=Object.getOwnPropertyDescriptor;t.f=o?a?function(e,t,n){if(s(e),t=u(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=f(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(s(e),t=u(t),s(n),i)try{return c(e,t,n)}catch(e){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},46683:(e,t,n)=>{var r=n(18494),o=n(38262),i=n(20112),a=n(54677),s=n(22977),u=n(98734),l=n(62870),c=n(275),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=u(t),c)try{return f(e,t)}catch(e){}if(l(e,t))return a(!o(i.f,e,t),e[t])}},63130:(e,t,n)=>{var r=n(39624),o=n(22977),i=n(9275).f,a=n(74546),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==r(e)?function(e){try{return i(e)}catch(e){return a(s)}}(e):i(o(e))}},9275:(e,t,n)=>{var r=n(98356),o=n(15690).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},74012:(e,t)=>{t.f=Object.getOwnPropertySymbols},80729:(e,t,n)=>{var r=n(47583),o=n(62870),i=n(9212),a=n(61324),s=n(89137),u=n(50926),l=s("IE_PROTO"),c=r.Object,f=c.prototype;e.exports=u?c.getPrototypeOf:function(e){var t=a(e);if(o(t,l))return t[l];var n=t.constructor;return i(n)&&t instanceof n?n.prototype:t instanceof c?f:null}},4766:(e,t,n)=>{var r=n(16544),o=n(90794),i=n(39624),a=n(91537),s=Object.isExtensible,u=r((function(){s(1)}));e.exports=u||a?function(e){return!!o(e)&&(!a||"ArrayBuffer"!=i(e))&&(!s||s(e))}:s},22447:(e,t,n)=>{var r=n(7386);e.exports=r({}.isPrototypeOf)},98356:(e,t,n)=>{var r=n(7386),o=n(62870),i=n(22977),a=n(15766).indexOf,s=n(64639),u=r([].push);e.exports=function(e,t){var n,r=i(e),l=0,c=[];for(n in r)!o(s,n)&&o(r,n)&&u(c,n);for(;t.length>l;)o(r,n=t[l++])&&(~a(c,n)||u(c,n));return c}},75432:(e,t,n)=>{var r=n(98356),o=n(15690);e.exports=Object.keys||function(e){return r(e,o)}},20112:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},17496:(e,t,n)=>{var r=n(7386),o=n(92569),i=n(79882);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return o(n),i(r),t?e(n,r):n.__proto__=r,n}}():void 0)},69953:(e,t,n)=>{var r=n(18494),o=n(7386),i=n(75432),a=n(22977),s=o(n(20112).f),u=o([].push),l=function(e){return function(t){for(var n,o=a(t),l=i(o),c=l.length,f=0,h=[];c>f;)n=l[f++],r&&!s(o,n)||u(h,e?[n,o[n]]:o[n]);return h}};e.exports={entries:l(!0),values:l(!1)}},43060:(e,t,n)=>{"use strict";var r=n(88191),o=n(33058);e.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},76252:(e,t,n)=>{var r=n(47583),o=n(38262),i=n(9212),a=n(90794),s=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&i(n=e.toString)&&!a(r=o(n,e)))return r;if(i(n=e.valueOf)&&!a(r=o(n,e)))return r;if("string"!==t&&i(n=e.toString)&&!a(r=o(n,e)))return r;throw s("Can't convert object to primitive value")}},40929:(e,t,n)=>{var r=n(35897),o=n(7386),i=n(9275),a=n(74012),s=n(92569),u=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(s(e)),n=a.f;return n?u(t,n(e)):t}},21287:(e,t,n)=>{var r=n(47583);e.exports=r},96893:(e,t,n)=>{var r=n(61270);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},61270:(e,t,n)=>{var r=n(47583),o=n(9212),i=n(62870),a=n(57),s=n(50460),u=n(69734),l=n(42743),c=n(14340).CONFIGURABLE,f=l.get,h=l.enforce,d=String(String).split("String");(e.exports=function(e,t,n,u){var l,f=!!u&&!!u.unsafe,p=!!u&&!!u.enumerable,m=!!u&&!!u.noTargetGet,y=u&&void 0!==u.name?u.name:t;o(n)&&("Symbol("===String(y).slice(0,7)&&(y="["+String(y).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!i(n,"name")||c&&n.name!==y)&&a(n,"name",y),(l=h(n)).source||(l.source=d.join("string"==typeof y?y:""))),e!==r?(f?!m&&e[t]&&(p=!0):delete e[t],p?e[t]=n:a(e,t,n)):p?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return o(this)&&f(this).source||u(this)}))},74214:(e,t,n)=>{var r=n(47583),o=n(38262),i=n(92569),a=n(9212),s=n(39624),u=n(48445),l=r.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var r=o(n,e,t);return null!==r&&i(r),r}if("RegExp"===s(e))return o(u,e,t);throw l("RegExp#exec called on incompatible receiver")}},48445:(e,t,n)=>{"use strict";var r,o,i=n(38262),a=n(7386),s=n(28320),u=n(74061),l=n(35230),c=n(17836),f=n(3590),h=n(42743).get,d=n(74121),p=n(1712),m=c("native-string-replace",String.prototype.replace),y=RegExp.prototype.exec,v=y,g=a("".charAt),b=a("".indexOf),w=a("".replace),_=a("".slice),S=(o=/b*/g,i(y,r=/a/,"a"),i(y,o,"a"),0!==r.lastIndex||0!==o.lastIndex),E=l.BROKEN_CARET,k=void 0!==/()??/.exec("")[1];(S||k||E||d||p)&&(v=function(e){var t,n,r,o,a,l,c,d=this,p=h(d),R=s(e),T=p.raw;if(T)return T.lastIndex=d.lastIndex,t=i(v,T,R),d.lastIndex=T.lastIndex,t;var C=p.groups,M=E&&d.sticky,O=i(u,d),A=d.source,L=0,x=R;if(M&&(O=w(O,"y",""),-1===b(O,"g")&&(O+="g"),x=_(R,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==g(R,d.lastIndex-1))&&(A="(?: "+A+")",x=" "+x,L++),n=new RegExp("^(?:"+A+")",O)),k&&(n=new RegExp("^"+A+"$(?!\\s)",O)),S&&(r=d.lastIndex),o=i(y,M?n:d,x),M?o?(o.input=_(o.input,L),o[0]=_(o[0],L),o.index=d.lastIndex,d.lastIndex+=o[0].length):d.lastIndex=0:S&&o&&(d.lastIndex=d.global?o.index+o[0].length:r),k&&o&&o.length>1&&i(m,o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&C)for(o.groups=l=f(null),a=0;a<C.length;a++)l[(c=C[a])[0]]=o[c[1]];return o}),e.exports=v},74061:(e,t,n)=>{"use strict";var r=n(92569);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},35230:(e,t,n)=>{var r=n(16544),o=n(47583).RegExp,i=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=i||r((function(){return!o("a","y").sticky})),s=i||r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:i}},74121:(e,t,n)=>{var r=n(16544),o=n(47583).RegExp;e.exports=r((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},1712:(e,t,n)=>{var r=n(16544),o=n(47583).RegExp;e.exports=r((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},63955:(e,t,n)=>{var r=n(47583).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},8690:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},50460:(e,t,n)=>{var r=n(47583),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},7730:(e,t,n)=>{"use strict";var r=n(35897),o=n(94615),i=n(3649),a=n(18494),s=i("species");e.exports=function(e){var t=r(e),n=o.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},98821:(e,t,n)=>{var r=n(94615).f,o=n(62870),i=n(3649)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!o(e,i)&&r(e,i,{configurable:!0,value:t})}},89137:(e,t,n)=>{var r=n(17836),o=n(98284),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},31314:(e,t,n)=>{var r=n(47583),o=n(50460),i="__core-js_shared__",a=r[i]||o(i,{});e.exports=a},17836:(e,t,n)=>{var r=n(86268),o=n(31314);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:r?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},40564:(e,t,n)=>{var r=n(92569),o=n(41186),i=n(3649)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[i])?t:o(n)}},29578:(e,t,n)=>{var r=n(16544);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},96389:(e,t,n)=>{var r=n(7386),o=n(87486),i=n(28320),a=n(63955),s=r("".charAt),u=r("".charCodeAt),l=r("".slice),c=function(e){return function(t,n){var r,c,f=i(a(t)),h=o(n),d=f.length;return h<0||h>=d?e?"":void 0:(r=u(f,h))<55296||r>56319||h+1===d||(c=u(f,h+1))<56320||c>57343?e?s(f,h):r:e?l(f,h,h+2):c-56320+(r-55296<<10)+65536}};e.exports={codeAt:c(!1),charAt:c(!0)}},98040:(e,t,n)=>{var r=n(46918);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},70578:(e,t,n)=>{var r=n(7386),o=n(70097),i=n(28320),a=n(33812),s=n(63955),u=r(a),l=r("".slice),c=Math.ceil,f=function(e){return function(t,n,r){var a,f,h=i(s(t)),d=o(n),p=h.length,m=void 0===r?" ":i(r);return d<=p||""==m?h:((f=u(m,c((a=d-p)/m.length))).length>a&&(f=l(f,0,a)),e?h+f:f+h)}};e.exports={start:f(!1),end:f(!0)}},33812:(e,t,n)=>{"use strict";var r=n(47583),o=n(87486),i=n(28320),a=n(63955),s=r.RangeError;e.exports=function(e){var t=i(a(this)),n="",r=o(e);if(r<0||r==1/0)throw s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},65760:(e,t,n)=>{var r=n(14340).PROPER,o=n(16544),i=n(20771);e.exports=function(e){return o((function(){return!!i[e]()||""!==""[e]()||r&&i[e].name!==e}))}},68940:(e,t,n)=>{var r=n(7386),o=n(63955),i=n(28320),a=n(20771),s=r("".replace),u="["+a+"]",l=RegExp("^"+u+u+"*"),c=RegExp(u+u+"*$"),f=function(e){return function(t){var n=i(o(t));return 1&e&&(n=s(n,l,"")),2&e&&(n=s(n,c,"")),n}};e.exports={start:f(1),end:f(2),trim:f(3)}},48117:(e,t,n)=>{var r,o,i,a,s=n(47583),u=n(71611),l=n(12938),c=n(9212),f=n(62870),h=n(16544),d=n(90482),p=n(46917),m=n(26668),y=n(17020),v=n(45354),g=s.setImmediate,b=s.clearImmediate,w=s.process,_=s.Dispatch,S=s.Function,E=s.MessageChannel,k=s.String,R=0,T={};try{r=s.location}catch(e){}var C=function(e){if(f(T,e)){var t=T[e];delete T[e],t()}},M=function(e){return function(){C(e)}},O=function(e){C(e.data)},A=function(e){s.postMessage(k(e),r.protocol+"//"+r.host)};g&&b||(g=function(e){var t=p(arguments,1);return T[++R]=function(){u(c(e)?e:S(e),void 0,t)},o(R),R},b=function(e){delete T[e]},v?o=function(e){w.nextTick(M(e))}:_&&_.now?o=function(e){_.now(M(e))}:E&&!y?(a=(i=new E).port2,i.port1.onmessage=O,o=l(a.postMessage,a)):s.addEventListener&&c(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!h(A)?(o=A,s.addEventListener("message",O,!1)):o="onreadystatechange"in m("script")?function(e){d.appendChild(m("script")).onreadystatechange=function(){d.removeChild(this),C(e)}}:function(e){setTimeout(M(e),0)}),e.exports={set:g,clear:b}},38064:(e,t,n)=>{var r=n(7386);e.exports=r(1..valueOf)},96782:(e,t,n)=>{var r=n(87486),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},22977:(e,t,n)=>{var r=n(55044),o=n(63955);e.exports=function(e){return r(o(e))}},87486:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},70097:(e,t,n)=>{var r=n(87486),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},61324:(e,t,n)=>{var r=n(47583),o=n(63955),i=r.Object;e.exports=function(e){return i(o(e))}},22670:(e,t,n)=>{var r=n(47583),o=n(38262),i=n(90794),a=n(35871),s=n(60911),u=n(76252),l=n(3649),c=r.TypeError,f=l("toPrimitive");e.exports=function(e,t){if(!i(e)||a(e))return e;var n,r=s(e,f);if(r){if(void 0===t&&(t="default"),n=o(r,e,t),!i(n)||a(n))return n;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),u(e,t)}},98734:(e,t,n)=>{var r=n(22670),o=n(35871);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},88191:(e,t,n)=>{var r={};r[n(3649)("toStringTag")]="z",e.exports="[object z]"===String(r)},28320:(e,t,n)=>{var r=n(47583),o=n(33058),i=r.String;e.exports=function(e){if("Symbol"===o(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},75637:(e,t,n)=>{var r=n(47583).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},98284:(e,t,n)=>{var r=n(7386),o=0,i=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+i,36)}},67786:(e,t,n)=>{var r=n(88640);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7670:(e,t,n)=>{var r=n(18494),o=n(16544);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},20491:(e,t,n)=>{var r=n(3649);t.f=r},3649:(e,t,n)=>{var r=n(47583),o=n(17836),i=n(62870),a=n(98284),s=n(88640),u=n(67786),l=o("wks"),c=r.Symbol,f=c&&c.for,h=u?c:c&&c.withoutSetter||a;e.exports=function(e){if(!i(l,e)||!s&&"string"!=typeof l[e]){var t="Symbol."+e;s&&i(c,e)?l[e]=c[e]:l[e]=u&&f?f(t):h(t)}return l[e]}},20771:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},11646:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(16544),a=n(54521),s=n(90794),u=n(61324),l=n(1825),c=n(65999),f=n(44822),h=n(69269),d=n(3649),p=n(24061),m=d("isConcatSpreadable"),y=9007199254740991,v="Maximum allowed index exceeded",g=o.TypeError,b=p>=51||!i((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),w=h("concat"),_=function(e){if(!s(e))return!1;var t=e[m];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,forced:!b||!w},{concat:function(e){var t,n,r,o,i,a=u(this),s=f(a,0),h=0;for(t=-1,r=arguments.length;t<r;t++)if(_(i=-1===t?a:arguments[t])){if(h+(o=l(i))>y)throw g(v);for(n=0;n<o;n++,h++)n in i&&c(s,h,i[n])}else{if(h>=y)throw g(v);c(s,h++,i)}return s.length=h,s}})},51271:(e,t,n)=>{var r=n(37263),o=n(93579),i=n(36288);r({target:"Array",proto:!0},{fill:o}),i("fill")},38833:(e,t,n)=>{"use strict";var r=n(37263),o=n(24805).filter;r({target:"Array",proto:!0,forced:!n(69269)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},85375:(e,t,n)=>{"use strict";var r=n(37263),o=n(24805).findIndex,i=n(36288),a="findIndex",s=!0;a in[]&&Array(1).findIndex((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},47715:(e,t,n)=>{"use strict";var r=n(37263),o=n(24805).find,i=n(36288),a="find",s=!0;a in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},23675:(e,t,n)=>{var r=n(37263),o=n(35513);r({target:"Array",stat:!0,forced:!n(3616)((function(e){Array.from(e)}))},{from:o})},12076:(e,t,n)=>{"use strict";var r=n(37263),o=n(15766).includes,i=n(36288);r({target:"Array",proto:!0},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},27228:(e,t,n)=>{"use strict";var r=n(37263),o=n(7386),i=n(15766).indexOf,a=n(60906),s=o([].indexOf),u=!!s&&1/s([1],1,-0)<0,l=a("indexOf");r({target:"Array",proto:!0,forced:u||!l},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return u?s(this,e,t)||0:i(this,e,t)}})},55677:(e,t,n)=>{"use strict";var r=n(22977),o=n(36288),i=n(60339),a=n(42743),s=n(94615).f,u=n(99012),l=n(86268),c=n(18494),f="Array Iterator",h=a.set,d=a.getterFor(f);e.exports=u(Array,"Array",(function(e,t){h(this,{type:f,target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var p=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!l&&c&&"values"!==p.name)try{s(p,"name",{value:"values"})}catch(e){}},67441:(e,t,n)=>{"use strict";var r=n(37263),o=n(7386),i=n(55044),a=n(22977),s=n(60906),u=o([].join),l=i!=Object,c=s("join",",");r({target:"Array",proto:!0,forced:l||!c},{join:function(e){return u(a(this),void 0===e?",":e)}})},46825:(e,t,n)=>{var r=n(37263),o=n(73161);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},92070:(e,t,n)=>{"use strict";var r=n(37263),o=n(24805).map;r({target:"Array",proto:!0,forced:!n(69269)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},4363:(e,t,n)=>{"use strict";var r=n(37263),o=n(64325).left,i=n(60906),a=n(24061),s=n(45354);r({target:"Array",proto:!0,forced:!i("reduce")||!s&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},57021:(e,t,n)=>{"use strict";var r=n(37263),o=n(7386),i=n(54521),a=o([].reverse),s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a(this)}})},20288:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(54521),a=n(62097),s=n(90794),u=n(96782),l=n(1825),c=n(22977),f=n(65999),h=n(3649),d=n(69269),p=n(46917),m=d("slice"),y=h("species"),v=o.Array,g=Math.max;r({target:"Array",proto:!0,forced:!m},{slice:function(e,t){var n,r,o,h=c(this),d=l(h),m=u(e,d),b=u(void 0===t?d:t,d);if(i(h)&&(n=h.constructor,(a(n)&&(n===v||i(n.prototype))||s(n)&&null===(n=n[y]))&&(n=void 0),n===v||void 0===n))return p(h,m,b);for(r=new(void 0===n?v:n)(g(b-m,0)),o=0;m<b;m++,o++)m in h&&f(r,o,h[m]);return r.length=o,r}})},74486:(e,t,n)=>{"use strict";var r=n(37263),o=n(7386),i=n(18257),a=n(61324),s=n(1825),u=n(28320),l=n(16544),c=n(25744),f=n(60906),h=n(15857),d=n(50924),p=n(24061),m=n(20003),y=[],v=o(y.sort),g=o(y.push),b=l((function(){y.sort(void 0)})),w=l((function(){y.sort(null)})),_=f("sort"),S=!l((function(){if(p)return p<70;if(!(h&&h>3)){if(d)return!0;if(m)return m<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)y.push({k:t+r,v:n})}for(y.sort((function(e,t){return t.v-e.v})),r=0;r<y.length;r++)t=y[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));r({target:"Array",proto:!0,forced:b||!w||!_||!S},{sort:function(e){void 0!==e&&i(e);var t=a(this);if(S)return void 0===e?v(t):v(t,e);var n,r,o=[],l=s(t);for(r=0;r<l;r++)r in t&&g(o,t[r]);for(c(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}}(e)),n=o.length,r=0;r<n;)t[r]=o[r++];for(;r<l;)delete t[r++];return t}})},6429:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(96782),a=n(87486),s=n(1825),u=n(61324),l=n(44822),c=n(65999),f=n(69269)("splice"),h=o.TypeError,d=Math.max,p=Math.min,m=9007199254740991,y="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,o,f,v,g,b=u(this),w=s(b),_=i(e,w),S=arguments.length;if(0===S?n=r=0:1===S?(n=0,r=w-_):(n=S-2,r=p(d(a(t),0),w-_)),w+n-r>m)throw h(y);for(o=l(b,r),f=0;f<r;f++)(v=_+f)in b&&c(o,f,b[v]);if(o.length=r,n<r){for(f=_;f<w-r;f++)g=f+n,(v=f+r)in b?b[g]=b[v]:delete b[g];for(f=w;f>w-r+n;f--)delete b[f-1]}else if(n>r)for(f=w-r;f>_;f--)g=f+n-1,(v=f+r-1)in b?b[g]=b[v]:delete b[g];for(f=0;f<n;f++)b[f+_]=arguments[f+2];return b.length=w-r+n,o}})},54458:(e,t,n)=>{var r=n(18494),o=n(14340).EXISTS,i=n(7386),a=n(94615).f,s=Function.prototype,u=i(s.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,c=i(l.exec);r&&!o&&a(s,"name",{configurable:!0,get:function(){try{return c(l,u(this))[1]}catch(e){return""}}})},14327:(e,t,n)=>{"use strict";n(24802)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(26100))},27680:(e,t,n)=>{var r=n(37263),o=n(40865),i=Math.acosh,a=Math.log,s=Math.sqrt,u=Math.LN2;r({target:"Math",stat:!0,forced:!i||710!=Math.floor(i(Number.MAX_VALUE))||i(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?a(e)+u:o(e-1+s(e-1)*s(e+1))}})},28743:(e,t,n)=>{var r=n(37263),o=Math.asinh,i=Math.log,a=Math.sqrt;r({target:"Math",stat:!0,forced:!(o&&1/o(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):i(t+a(t*t+1)):t}})},59295:(e,t,n)=>{var r=n(37263),o=Math.atanh,i=Math.log;r({target:"Math",stat:!0,forced:!(o&&1/o(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:i((1+e)/(1-e))/2}})},74779:(e,t,n)=>{var r=n(37263),o=n(1599),i=Math.cosh,a=Math.abs,s=Math.E;r({target:"Math",stat:!0,forced:!i||i(710)===1/0},{cosh:function(e){var t=o(a(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},59630:(e,t,n)=>{n(37263)({target:"Math",stat:!0},{log10:n(52789)})},17388:(e,t,n)=>{var r=n(37263),o=n(16544),i=n(1599),a=Math.abs,s=Math.exp,u=Math.E;r({target:"Math",stat:!0,forced:o((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return a(e=+e)<1?(i(e)-i(-e))/2:(s(e-1)-s(-e-1))*(u/2)}})},94593:(e,t,n)=>{var r=n(37263),o=n(1599),i=Math.exp;r({target:"Math",stat:!0},{tanh:function(e){var t=o(e=+e),n=o(-e);return t==1/0?1:n==1/0?-1:(t-n)/(i(e)+i(-e))}})},45777:(e,t,n)=>{var r=n(37263),o=Math.ceil,i=Math.floor;r({target:"Math",stat:!0},{trunc:function(e){return(e>0?i:o)(e)}})},30717:(e,t,n)=>{"use strict";var r=n(18494),o=n(47583),i=n(7386),a=n(34451),s=n(61270),u=n(62870),l=n(40434),c=n(22447),f=n(35871),h=n(22670),d=n(16544),p=n(9275).f,m=n(46683).f,y=n(94615).f,v=n(38064),g=n(68940).trim,b="Number",w=o.Number,_=w.prototype,S=o.TypeError,E=i("".slice),k=i("".charCodeAt),R=function(e){var t=h(e,"number");return"bigint"==typeof t?t:T(t)},T=function(e){var t,n,r,o,i,a,s,u,l=h(e,"number");if(f(l))throw S("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=g(l),43===(t=k(l,0))||45===t){if(88===(n=k(l,2))||120===n)return NaN}else if(48===t){switch(k(l,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+l}for(a=(i=E(l,2)).length,s=0;s<a;s++)if((u=k(i,s))<48||u>o)return NaN;return parseInt(i,r)}return+l};if(a(b,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var C,M=function(e){var t=arguments.length<1?0:w(R(e)),n=this;return c(_,n)&&d((function(){v(n)}))?l(Object(t),n,M):t},O=r?p(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),A=0;O.length>A;A++)u(w,C=O[A])&&!u(M,C)&&y(M,C,m(w,C));M.prototype=_,_.constructor=M,s(o,b,M)}},74176:(e,t,n)=>{n(37263)({target:"Number",stat:!0},{isFinite:n(79606)})},12406:(e,t,n)=>{n(37263)({target:"Number",stat:!0},{isInteger:n(69352)})},66474:(e,t,n)=>{n(37263)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},56660:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(7386),a=n(87486),s=n(38064),u=n(33812),l=n(16544),c=o.RangeError,f=o.String,h=Math.floor,d=i(u),p=i("".slice),m=i(1..toFixed),y=function(e,t,n){return 0===t?n:t%2==1?y(e,t-1,n*e):y(e*e,t/2,n)},v=function(e,t,n){for(var r=-1,o=n;++r<6;)o+=t*e[r],e[r]=o%1e7,o=h(o/1e7)},g=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=h(r/t),r=r%t*1e7},b=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=f(e[t]);n=""===n?r:n+d("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:l((function(){return"0.000"!==m(8e-5,3)||"1"!==m(.9,0)||"1.25"!==m(1.255,2)||"1000000000000000128"!==m(0xde0b6b3a7640080,0)}))||!l((function(){m({})}))},{toFixed:function(e){var t,n,r,o,i=s(this),u=a(e),l=[0,0,0,0,0,0],h="",m="0";if(u<0||u>20)throw c("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return f(i);if(i<0&&(h="-",i=-i),i>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(i*y(2,69,1))-69)<0?i*y(2,-t,1):i/y(2,t,1),n*=4503599627370496,(t=52-t)>0){for(v(l,0,n),r=u;r>=7;)v(l,1e7,0),r-=7;for(v(l,y(10,r,1),0),r=t-1;r>=23;)g(l,1<<23),r-=23;g(l,1<<r),v(l,1,1),g(l,2),m=b(l)}else v(l,0,n),v(l,1<<-t,0),m=b(l)+d("0",u);return u>0?h+((o=m.length)<=u?"0."+d("0",u-o)+m:p(m,0,o-u)+"."+p(m,o-u)):h+m}})},74517:(e,t,n)=>{var r=n(37263),o=n(79304);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},86737:(e,t,n)=>{var r=n(37263),o=n(69953).entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},47561:(e,t,n)=>{var r=n(37263),o=n(39974),i=n(16544),a=n(90794),s=n(51909).onFreeze,u=Object.freeze;r({target:"Object",stat:!0,forced:i((function(){u(1)})),sham:!o},{freeze:function(e){return u&&a(e)?u(s(e)):e}})},10815:(e,t,n)=>{var r=n(37263),o=n(16544),i=n(22977),a=n(46683).f,s=n(18494),u=o((function(){a(1)}));r({target:"Object",stat:!0,forced:!s||u,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(i(e),t)}})},79174:(e,t,n)=>{var r=n(37263),o=n(18494),i=n(40929),a=n(22977),s=n(46683),u=n(65999);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),o=s.f,l=i(r),c={},f=0;l.length>f;)void 0!==(n=o(r,t=l[f++]))&&u(c,t,n);return c}})},5536:(e,t,n)=>{var r=n(37263),o=n(16544),i=n(63130).f;r({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:i})},25101:(e,t,n)=>{var r=n(37263),o=n(16544),i=n(61324),a=n(80729),s=n(50926);r({target:"Object",stat:!0,forced:o((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(i(e))}})},99751:(e,t,n)=>{var r=n(37263),o=n(61324),i=n(75432);r({target:"Object",stat:!0,forced:n(16544)((function(){i(1)}))},{keys:function(e){return i(o(e))}})},27867:(e,t,n)=>{n(37263)({target:"Object",stat:!0},{setPrototypeOf:n(17496)})},56394:(e,t,n)=>{var r=n(88191),o=n(61270),i=n(43060);r||o(Object.prototype,"toString",i,{unsafe:!0})},49628:(e,t,n)=>{var r=n(37263),o=n(69953).values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},13080:(e,t,n)=>{var r=n(37263),o=n(35897),i=n(71611),a=n(51335),s=n(41186),u=n(92569),l=n(90794),c=n(3590),f=n(16544),h=o("Reflect","construct"),d=Object.prototype,p=[].push,m=f((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),y=!f((function(){h((function(){}))})),v=m||y;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(e,t){s(e),u(t);var n=arguments.length<3?e:s(arguments[2]);if(y&&!m)return h(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return i(p,r,t),new(i(a,e,r))}var o=n.prototype,f=c(l(o)?o:d),v=i(e,f,t);return l(v)?v:f}})},36582:(e,t,n)=>{var r=n(37263),o=n(38262),i=n(90794),a=n(92569),s=n(78118),u=n(46683),l=n(80729);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,c,f=arguments.length<3?t:arguments[2];return a(t)===f?t[n]:(r=u.f(t,n))?s(r)?r.value:void 0===r.get?void 0:o(r.get,f):i(c=l(t))?e(c,n,f):void 0}})},7390:(e,t,n)=>{var r=n(18494),o=n(47583),i=n(7386),a=n(34451),s=n(40434),u=n(57),l=n(94615).f,c=n(9275).f,f=n(22447),h=n(17574),d=n(28320),p=n(74061),m=n(35230),y=n(61270),v=n(16544),g=n(62870),b=n(42743).enforce,w=n(7730),_=n(3649),S=n(74121),E=n(1712),k=_("match"),R=o.RegExp,T=R.prototype,C=o.SyntaxError,M=i(p),O=i(T.exec),A=i("".charAt),L=i("".replace),x=i("".indexOf),N=i("".slice),I=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,D=/a/g,P=/a/g,H=new R(D)!==D,j=m.MISSED_STICKY,F=m.UNSUPPORTED_Y;if(a("RegExp",r&&(!H||j||S||E||v((function(){return P[k]=!1,R(D)!=D||R(P)==P||"/a/i"!=R(D,"i")}))))){for(var Y=function(e,t){var n,r,o,i,a,l,c=f(T,this),p=h(e),m=void 0===t,y=[],v=e;if(!c&&p&&m&&e.constructor===Y)return e;if((p||f(T,e))&&(e=e.source,m&&(t="flags"in v?v.flags:M(v))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),v=e,S&&"dotAll"in D&&(r=!!t&&x(t,"s")>-1)&&(t=L(t,/s/g,"")),n=t,j&&"sticky"in D&&(o=!!t&&x(t,"y")>-1)&&F&&(t=L(t,/y/g,"")),E&&(i=function(e){for(var t,n=e.length,r=0,o="",i=[],a={},s=!1,u=!1,l=0,c="";r<=n;r++){if("\\"===(t=A(e,r)))t+=A(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:O(I,N(e,r+1))&&(r+=2,u=!0),o+=t,l++;continue;case">"===t&&u:if(""===c||g(a,c))throw new C("Invalid capture group name");a[c]=!0,i[i.length]=[c,l],u=!1,c="";continue}u?c+=t:o+=t}return[o,i]}(e),e=i[0],y=i[1]),a=s(R(e,t),c?this:T,Y),(r||o||y.length)&&(l=b(a),r&&(l.dotAll=!0,l.raw=Y(function(e){for(var t,n=e.length,r=0,o="",i=!1;r<=n;r++)"\\"!==(t=A(e,r))?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),o+=t):o+="[\\s\\S]":o+=t+A(e,++r);return o}(e),n)),o&&(l.sticky=!0),y.length&&(l.groups=y)),e!==v)try{u(a,"source",""===v?"(?:)":v)}catch(e){}return a},U=function(e){e in Y||l(Y,e,{configurable:!0,get:function(){return R[e]},set:function(t){R[e]=t}})},B=c(R),V=0;B.length>V;)U(B[V++]);T.constructor=Y,Y.prototype=T,y(o,"RegExp",Y)}w("RegExp")},62322:(e,t,n)=>{"use strict";var r=n(37263),o=n(48445);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},64669:(e,t,n)=>{"use strict";var r=n(7386),o=n(14340).PROPER,i=n(61270),a=n(92569),s=n(22447),u=n(28320),l=n(16544),c=n(74061),f="toString",h=RegExp.prototype,d=h.toString,p=r(c),m=l((function(){return"/a/b"!=d.call({source:"a",flags:"b"})})),y=o&&d.name!=f;(m||y)&&i(RegExp.prototype,f,(function(){var e=a(this),t=u(e.source),n=e.flags;return"/"+t+"/"+u(void 0===n&&s(h,e)&&!("flags"in h)?p(e):n)}),{unsafe:!0})},26922:(e,t,n)=>{"use strict";n(24802)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(26100))},619:(e,t,n)=>{"use strict";var r=n(37263),o=n(96389).codeAt;r({target:"String",proto:!0},{codePointAt:function(e){return o(this,e)}})},23223:(e,t,n)=>{"use strict";var r,o=n(37263),i=n(7386),a=n(46683).f,s=n(70097),u=n(28320),l=n(59041),c=n(63955),f=n(83989),h=n(86268),d=i("".endsWith),p=i("".slice),m=Math.min,y=f("endsWith");o({target:"String",proto:!0,forced:!(!h&&!y&&(r=a(String.prototype,"endsWith"),r&&!r.writable)||y)},{endsWith:function(e){var t=u(c(this));l(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,o=void 0===n?r:m(s(n),r),i=u(e);return d?d(t,i,o):p(t,o-i.length,o)===i}})},40594:(e,t,n)=>{var r=n(37263),o=n(47583),i=n(7386),a=n(96782),s=o.RangeError,u=String.fromCharCode,l=String.fromCodePoint,c=i([].join);r({target:"String",stat:!0,forced:!!l&&1!=l.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],a(t,1114111)!==t)throw s(t+" is not a valid code point");n[o]=t<65536?u(t):u(55296+((t-=65536)>>10),t%1024+56320)}return c(n,"")}})},97723:(e,t,n)=>{"use strict";var r=n(37263),o=n(7386),i=n(59041),a=n(63955),s=n(28320),u=n(83989),l=o("".indexOf);r({target:"String",proto:!0,forced:!u("includes")},{includes:function(e){return!!~l(s(a(this)),s(i(e)),arguments.length>1?arguments[1]:void 0)}})},92129:(e,t,n)=>{"use strict";var r=n(96389).charAt,o=n(28320),i=n(42743),a=n(99012),s="String Iterator",u=i.set,l=i.getterFor(s);a(String,"String",(function(e){u(this,{type:s,string:o(e),index:0})}),(function(){var e,t=l(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=r(n,o),t.index+=e.length,{value:e,done:!1})}))},59808:(e,t,n)=>{"use strict";var r=n(37263),o=n(35888);r({target:"String",proto:!0,forced:n(29578)("link")},{link:function(e){return o(this,"a","href",e)}})},55017:(e,t,n)=>{"use strict";var r=n(38262),o=n(90783),i=n(92569),a=n(70097),s=n(28320),u=n(63955),l=n(60911),c=n(96733),f=n(74214);o("match",(function(e,t,n){return[function(t){var n=u(this),o=null==t?void 0:l(t,e);return o?r(o,t,n):new RegExp(t)[e](s(n))},function(e){var r=i(this),o=s(e),u=n(t,r,o);if(u.done)return u.value;if(!r.global)return f(r,o);var l=r.unicode;r.lastIndex=0;for(var h,d=[],p=0;null!==(h=f(r,o));){var m=s(h[0]);d[p]=m,""===m&&(r.lastIndex=c(o,a(r.lastIndex),l)),p++}return 0===p?null:d}]}))},11932:(e,t,n)=>{"use strict";var r=n(37263),o=n(70578).start;r({target:"String",proto:!0,forced:n(98040)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},51142:(e,t,n)=>{n(37263)({target:"String",proto:!0},{repeat:n(33812)})},93296:(e,t,n)=>{"use strict";var r=n(71611),o=n(38262),i=n(7386),a=n(90783),s=n(16544),u=n(92569),l=n(9212),c=n(87486),f=n(70097),h=n(28320),d=n(63955),p=n(96733),m=n(60911),y=n(4305),v=n(74214),g=n(3649)("replace"),b=Math.max,w=Math.min,_=i([].concat),S=i([].push),E=i("".indexOf),k=i("".slice),R="$0"==="a".replace(/./,"$0"),T=!!/./[g]&&""===/./[g]("a","$0");a("replace",(function(e,t,n){var i=T?"$":"$0";return[function(e,n){var r=d(this),i=null==e?void 0:m(e,g);return i?o(i,e,r,n):o(t,h(r),e,n)},function(e,o){var a=u(this),s=h(e);if("string"==typeof o&&-1===E(o,i)&&-1===E(o,"$<")){var d=n(t,a,s,o);if(d.done)return d.value}var m=l(o);m||(o=h(o));var g=a.global;if(g){var R=a.unicode;a.lastIndex=0}for(var T=[];;){var C=v(a,s);if(null===C)break;if(S(T,C),!g)break;""===h(C[0])&&(a.lastIndex=p(s,f(a.lastIndex),R))}for(var M,O="",A=0,L=0;L<T.length;L++){for(var x=h((C=T[L])[0]),N=b(w(c(C.index),s.length),0),I=[],D=1;D<C.length;D++)S(I,void 0===(M=C[D])?M:String(M));var P=C.groups;if(m){var H=_([x],I,N,s);void 0!==P&&S(H,P);var j=h(r(o,void 0,H))}else j=y(x,s,N,I,P,o);N>=A&&(O+=k(s,A,N)+j,A=N+x.length)}return O+k(s,A)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!R||T)},79006:(e,t,n)=>{"use strict";var r=n(38262),o=n(90783),i=n(92569),a=n(63955),s=n(8690),u=n(28320),l=n(60911),c=n(74214);o("search",(function(e,t,n){return[function(t){var n=a(this),o=null==t?void 0:l(t,e);return o?r(o,t,n):new RegExp(t)[e](u(n))},function(e){var r=i(this),o=u(e),a=n(t,r,o);if(a.done)return a.value;var l=r.lastIndex;s(l,0)||(r.lastIndex=0);var f=c(r,o);return s(r.lastIndex,l)||(r.lastIndex=l),null===f?-1:f.index}]}))},49268:(e,t,n)=>{"use strict";var r=n(71611),o=n(38262),i=n(7386),a=n(90783),s=n(17574),u=n(92569),l=n(63955),c=n(40564),f=n(96733),h=n(70097),d=n(28320),p=n(60911),m=n(74546),y=n(74214),v=n(48445),g=n(35230),b=n(16544),w=g.UNSUPPORTED_Y,_=4294967295,S=Math.min,E=[].push,k=i(/./.exec),R=i(E),T=i("".slice);a("split",(function(e,t,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var i=d(l(this)),a=void 0===n?_:n>>>0;if(0===a)return[];if(void 0===e)return[i];if(!s(e))return o(t,i,e,a);for(var u,c,f,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),y=0,g=new RegExp(e.source,p+"g");(u=o(v,g,i))&&!((c=g.lastIndex)>y&&(R(h,T(i,y,u.index)),u.length>1&&u.index<i.length&&r(E,h,m(u,1)),f=u[0].length,y=c,h.length>=a));)g.lastIndex===u.index&&g.lastIndex++;return y===i.length?!f&&k(g,"")||R(h,""):R(h,T(i,y)),h.length>a?m(h,0,a):h}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var r=l(this),a=null==t?void 0:p(t,e);return a?o(a,t,r,n):o(i,d(r),t,n)},function(e,r){var o=u(this),a=d(e),s=n(i,o,a,r,i!==t);if(s.done)return s.value;var l=c(o,RegExp),p=o.unicode,m=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(w?"g":"y"),v=new l(w?"^(?:"+o.source+")":o,m),g=void 0===r?_:r>>>0;if(0===g)return[];if(0===a.length)return null===y(v,a)?[a]:[];for(var b=0,E=0,k=[];E<a.length;){v.lastIndex=w?0:E;var C,M=y(v,w?T(a,E):a);if(null===M||(C=S(h(v.lastIndex+(w?E:0)),a.length))===b)E=f(a,E,p);else{if(R(k,T(a,b,E)),k.length===g)return k;for(var O=1;O<=M.length-1;O++)if(R(k,M[O]),k.length===g)return k;E=b=C}}return R(k,T(a,b)),k}]}),!!b((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),w)},97754:(e,t,n)=>{"use strict";var r,o=n(37263),i=n(7386),a=n(46683).f,s=n(70097),u=n(28320),l=n(59041),c=n(63955),f=n(83989),h=n(86268),d=i("".startsWith),p=i("".slice),m=Math.min,y=f("startsWith");o({target:"String",proto:!0,forced:!(!h&&!y&&(r=a(String.prototype,"startsWith"),r&&!r.writable)||y)},{startsWith:function(e){var t=u(c(this));l(e);var n=s(m(arguments.length>1?arguments[1]:void 0,t.length)),r=u(e);return d?d(t,r,n):p(t,n,n+r.length)===r}})},13233:(e,t,n)=>{"use strict";var r=n(37263),o=n(68940).trim;r({target:"String",proto:!0,forced:n(65760)("trim")},{trim:function(){return o(this)}})},28407:(e,t,n)=>{"use strict";var r=n(37263),o=n(18494),i=n(47583),a=n(7386),s=n(62870),u=n(9212),l=n(22447),c=n(28320),f=n(94615).f,h=n(83478),d=i.Symbol,p=d&&d.prototype;if(o&&u(d)&&(!("description"in p)||void 0!==d().description)){var m={},y=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),t=l(p,this)?new d(e):void 0===e?d():d(e);return""===e&&(m[t]=!0),t};h(y,d),y.prototype=p,p.constructor=y;var v="Symbol(test)"==String(d("test")),g=a(p.toString),b=a(p.valueOf),w=/^Symbol\((.*)\)[^)]+$/,_=a("".replace),S=a("".slice);f(p,"description",{configurable:!0,get:function(){var e=b(this),t=g(e);if(s(m,e))return"";var n=v?S(t,7,-1):_(t,w,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:y})}},38288:(e,t,n)=>{n(82219)("iterator")},52004:(e,t,n)=>{"use strict";var r=n(37263),o=n(47583),i=n(35897),a=n(71611),s=n(38262),u=n(7386),l=n(86268),c=n(18494),f=n(88640),h=n(16544),d=n(62870),p=n(54521),m=n(9212),y=n(90794),v=n(22447),g=n(35871),b=n(92569),w=n(61324),_=n(22977),S=n(98734),E=n(28320),k=n(54677),R=n(3590),T=n(75432),C=n(9275),M=n(63130),O=n(74012),A=n(46683),L=n(94615),x=n(28728),N=n(20112),I=n(46917),D=n(61270),P=n(17836),H=n(89137),j=n(64639),F=n(98284),Y=n(3649),U=n(20491),B=n(82219),V=n(98821),W=n(42743),z=n(24805).forEach,G=H("hidden"),K="Symbol",X=Y("toPrimitive"),$=W.set,q=W.getterFor(K),J=Object.prototype,Q=o.Symbol,Z=Q&&Q.prototype,ee=o.TypeError,te=o.QObject,ne=i("JSON","stringify"),re=A.f,oe=L.f,ie=M.f,ae=N.f,se=u([].push),ue=P("symbols"),le=P("op-symbols"),ce=P("string-to-symbol-registry"),fe=P("symbol-to-string-registry"),he=P("wks"),de=!te||!te.prototype||!te.prototype.findChild,pe=c&&h((function(){return 7!=R(oe({},"a",{get:function(){return oe(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=re(J,t);r&&delete J[t],oe(e,t,n),r&&e!==J&&oe(J,t,r)}:oe,me=function(e,t){var n=ue[e]=R(Z);return $(n,{type:K,tag:e,description:t}),c||(n.description=t),n},ye=function(e,t,n){e===J&&ye(le,t,n),b(e);var r=S(t);return b(n),d(ue,r)?(n.enumerable?(d(e,G)&&e[G][r]&&(e[G][r]=!1),n=R(n,{enumerable:k(0,!1)})):(d(e,G)||oe(e,G,k(1,{})),e[G][r]=!0),pe(e,r,n)):oe(e,r,n)},ve=function(e,t){b(e);var n=_(t),r=T(n).concat(_e(n));return z(r,(function(t){c&&!s(ge,n,t)||ye(e,t,n[t])})),e},ge=function(e){var t=S(e),n=s(ae,this,t);return!(this===J&&d(ue,t)&&!d(le,t))&&(!(n||!d(this,t)||!d(ue,t)||d(this,G)&&this[G][t])||n)},be=function(e,t){var n=_(e),r=S(t);if(n!==J||!d(ue,r)||d(le,r)){var o=re(n,r);return!o||!d(ue,r)||d(n,G)&&n[G][r]||(o.enumerable=!0),o}},we=function(e){var t=ie(_(e)),n=[];return z(t,(function(e){d(ue,e)||d(j,e)||se(n,e)})),n},_e=function(e){var t=e===J,n=ie(t?le:_(e)),r=[];return z(n,(function(e){!d(ue,e)||t&&!d(J,e)||se(r,ue[e])})),r};if(f||(D(Z=(Q=function(){if(v(Z,this))throw ee("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?E(arguments[0]):void 0,t=F(e),n=function(e){this===J&&s(n,le,e),d(this,G)&&d(this[G],t)&&(this[G][t]=!1),pe(this,t,k(1,e))};return c&&de&&pe(J,t,{configurable:!0,set:n}),me(t,e)}).prototype,"toString",(function(){return q(this).tag})),D(Q,"withoutSetter",(function(e){return me(F(e),e)})),N.f=ge,L.f=ye,x.f=ve,A.f=be,C.f=M.f=we,O.f=_e,U.f=function(e){return me(Y(e),e)},c&&(oe(Z,"description",{configurable:!0,get:function(){return q(this).description}}),l||D(J,"propertyIsEnumerable",ge,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:Q}),z(T(he),(function(e){B(e)})),r({target:K,stat:!0,forced:!f},{for:function(e){var t=E(e);if(d(ce,t))return ce[t];var n=Q(t);return ce[t]=n,fe[n]=t,n},keyFor:function(e){if(!g(e))throw ee(e+" is not a symbol");if(d(fe,e))return fe[e]},useSetter:function(){de=!0},useSimple:function(){de=!1}}),r({target:"Object",stat:!0,forced:!f,sham:!c},{create:function(e,t){return void 0===t?R(e):ve(R(e),t)},defineProperty:ye,defineProperties:ve,getOwnPropertyDescriptor:be}),r({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:we,getOwnPropertySymbols:_e}),r({target:"Object",stat:!0,forced:h((function(){O.f(1)}))},{getOwnPropertySymbols:function(e){return O.f(w(e))}}),ne&&r({target:"JSON",stat:!0,forced:!f||h((function(){var e=Q();return"[null]"!=ne([e])||"{}"!=ne({a:e})||"{}"!=ne(Object(e))}))},{stringify:function(e,t,n){var r=I(arguments),o=t;if((y(t)||void 0!==e)&&!g(e))return p(t)||(t=function(e,t){if(m(o)&&(t=s(o,this,e,t)),!g(t))return t}),r[1]=t,a(ne,null,r)}}),!Z[X]){var Se=Z.valueOf;D(Z,X,(function(e){return s(Se,this)}))}V(Q,K),j[G]=!0},31770:(e,t,n)=>{"use strict";var r,o=n(47583),i=n(7386),a=n(96893),s=n(51909),u=n(24802),l=n(57012),c=n(90794),f=n(4766),h=n(42743).enforce,d=n(89491),p=!o.ActiveXObject&&"ActiveXObject"in o,m=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},y=u("WeakMap",m,l);if(d&&p){r=l.getConstructor(m,"WeakMap",!0),s.enable();var v=y.prototype,g=i(v.delete),b=i(v.has),w=i(v.get),_=i(v.set);a(v,{delete:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),g(this,e)||t.frozen.delete(e)}return g(this,e)},has:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),b(this,e)||t.frozen.has(e)}return b(this,e)},get:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),b(this,e)?w(this,e):t.frozen.get(e)}return w(this,e)},set:function(e,t){if(c(e)&&!f(e)){var n=h(this);n.frozen||(n.frozen=new r),b(this,e)?_(this,e,t):n.frozen.set(e,t)}else _(this,e,t);return this}})}},70435:(e,t,n)=>{"use strict";n(24802)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(57012))},55090:(e,t,n)=>{var r=n(47583),o=n(86778),i=n(49307),a=n(63200),s=n(57),u=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var l in o)o[l]&&u(r[l]&&r[l].prototype);u(i)},24655:(e,t,n)=>{var r=n(47583),o=n(86778),i=n(49307),a=n(55677),s=n(57),u=n(3649),l=u("iterator"),c=u("toStringTag"),f=a.values,h=function(e,t){if(e){if(e[l]!==f)try{s(e,l,f)}catch(t){e[l]=f}if(e[c]||s(e,c,t),o[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var d in o)h(r[d]&&r[d].prototype,d);h(i,"DOMTokenList")},68192:(e,t,n)=>{var r=n(37263),o=n(47583),i=n(48117);r({global:!0,bind:!0,enumerable:!0,forced:!o.setImmediate||!o.clearImmediate},{setImmediate:i.set,clearImmediate:i.clear})},60151:(e,t,n)=>{var r=n(37263),o=n(47583),i=n(71611),a=n(9212),s=n(46918),u=n(46917),l=/MSIE .\./.test(s),c=o.Function,f=function(e){return function(t,n){var r=arguments.length>2,o=r?u(arguments,2):void 0;return e(r?function(){i(a(t)?t:c(t),this,o)}:t,n)}};r({global:!0,bind:!0,forced:l},{setTimeout:f(o.setTimeout),setInterval:f(o.setInterval)})},77705:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var u=this[s][0];null!=u&&(a[u]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);r&&a[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),t.push(c))}},t}},86742:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},6738:e=>{"use strict";e.exports=function(e){return e[1]}},31199:function(e){e.exports=function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,n=Object.isFrozen,r=Object.getPrototypeOf,o=Object.getOwnPropertyDescriptor,i=Object.freeze,a=Object.seal,s=Object.create,u="undefined"!=typeof Reflect&&Reflect,l=u.apply,c=u.construct;l||(l=function(e,t,n){return e.apply(t,n)}),i||(i=function(e){return e}),a||(a=function(e){return e}),c||(c=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var f,h=S(Array.prototype.forEach),d=S(Array.prototype.pop),p=S(Array.prototype.push),m=S(String.prototype.toLowerCase),y=S(String.prototype.match),v=S(String.prototype.replace),g=S(String.prototype.indexOf),b=S(String.prototype.trim),w=S(RegExp.prototype.test),_=(f=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(f,t)});function S(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return l(e,t,r)}}function E(e,r){t&&t(e,null);for(var o=r.length;o--;){var i=r[o];if("string"==typeof i){var a=m(i);a!==i&&(n(r)||(r[o]=a),i=a)}e[i]=!0}return e}function k(t){var n=s(null),r=void 0;for(r in t)l(e,t,[r])&&(n[r]=t[r]);return n}function R(e,t){for(;null!==e;){var n=o(e,t);if(n){if(n.get)return S(n.get);if("function"==typeof n.value)return S(n.value)}e=r(e)}return function(e){return console.warn("fallback value for",e),null}}var T=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),C=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),M=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),O=i(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),A=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),L=i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),x=i(["#text"]),N=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),I=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),D=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),P=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=a(/\{\{[\s\S]*|[\s\S]*\}\}/gm),j=a(/<%[\s\S]*|[\s\S]*%>/gm),F=a(/^data-[\-\w.\u00B7-\uFFFF]/),Y=a(/^aria-[\-\w]+$/),U=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B=a(/^(?:\w+script|data):/i),V=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function z(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var G=function(){return"undefined"==typeof window?null:window},K=function(e,t){if("object"!==(void 0===e?"undefined":W(e))||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G(),n=function(t){return e(t)};if(n.version="2.3.4",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,a=t.DocumentFragment,s=t.HTMLTemplateElement,u=t.Node,l=t.Element,c=t.NodeFilter,f=t.NamedNodeMap,S=void 0===f?t.NamedNodeMap||t.MozNamedAttrMap:f,X=t.HTMLFormElement,$=t.DOMParser,q=t.trustedTypes,J=l.prototype,Q=R(J,"cloneNode"),Z=R(J,"nextSibling"),ee=R(J,"childNodes"),te=R(J,"parentNode");if("function"==typeof s){var ne=o.createElement("template");ne.content&&ne.content.ownerDocument&&(o=ne.content.ownerDocument)}var re=K(q,r),oe=re&&Pe?re.createHTML(""):"",ie=o,ae=ie.implementation,se=ie.createNodeIterator,ue=ie.createDocumentFragment,le=ie.getElementsByTagName,ce=r.importNode,fe={};try{fe=k(o).documentMode?o.documentMode:{}}catch(e){}var he={};n.isSupported="function"==typeof te&&ae&&void 0!==ae.createHTMLDocument&&9!==fe;var de=H,pe=j,me=F,ye=Y,ve=B,ge=V,be=U,we=null,_e=E({},[].concat(z(T),z(C),z(M),z(A),z(x))),Se=null,Ee=E({},[].concat(z(N),z(I),z(D),z(P))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Re=null,Te=null,Ce=!0,Me=!0,Oe=!1,Ae=!1,Le=!1,xe=!1,Ne=!1,Ie=!1,De=!1,Pe=!1,He=!0,je=!0,Fe=!1,Ye={},Ue=null,Be=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ve=null,We=E({},["audio","video","img","source","image","track"]),ze=null,Ge=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ke="http://www.w3.org/1998/Math/MathML",Xe="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml",qe=$e,Je=!1,Qe=void 0,Ze=["application/xhtml+xml","text/html"],et="text/html",tt=void 0,nt=null,rt=o.createElement("form"),ot=function(e){return e instanceof RegExp||e instanceof Function},it=function(e){nt&&nt===e||(e&&"object"===(void 0===e?"undefined":W(e))||(e={}),e=k(e),we="ALLOWED_TAGS"in e?E({},e.ALLOWED_TAGS):_e,Se="ALLOWED_ATTR"in e?E({},e.ALLOWED_ATTR):Ee,ze="ADD_URI_SAFE_ATTR"in e?E(k(Ge),e.ADD_URI_SAFE_ATTR):Ge,Ve="ADD_DATA_URI_TAGS"in e?E(k(We),e.ADD_DATA_URI_TAGS):We,Ue="FORBID_CONTENTS"in e?E({},e.FORBID_CONTENTS):Be,Re="FORBID_TAGS"in e?E({},e.FORBID_TAGS):{},Te="FORBID_ATTR"in e?E({},e.FORBID_ATTR):{},Ye="USE_PROFILES"in e&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,Me=!1!==e.ALLOW_DATA_ATTR,Oe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ae=e.SAFE_FOR_TEMPLATES||!1,Le=e.WHOLE_DOCUMENT||!1,Ie=e.RETURN_DOM||!1,De=e.RETURN_DOM_FRAGMENT||!1,Pe=e.RETURN_TRUSTED_TYPE||!1,Ne=e.FORCE_BODY||!1,He=!1!==e.SANITIZE_DOM,je=!1!==e.KEEP_CONTENT,Fe=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||be,qe=e.NAMESPACE||$e,e.CUSTOM_ELEMENT_HANDLING&&ot(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ot(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qe=Qe=-1===Ze.indexOf(e.PARSER_MEDIA_TYPE)?et:e.PARSER_MEDIA_TYPE,tt="application/xhtml+xml"===Qe?function(e){return e}:m,Ae&&(Me=!1),De&&(Ie=!0),Ye&&(we=E({},[].concat(z(x))),Se=[],!0===Ye.html&&(E(we,T),E(Se,N)),!0===Ye.svg&&(E(we,C),E(Se,I),E(Se,P)),!0===Ye.svgFilters&&(E(we,M),E(Se,I),E(Se,P)),!0===Ye.mathMl&&(E(we,A),E(Se,D),E(Se,P))),e.ADD_TAGS&&(we===_e&&(we=k(we)),E(we,e.ADD_TAGS)),e.ADD_ATTR&&(Se===Ee&&(Se=k(Se)),E(Se,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&E(ze,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(Ue===Be&&(Ue=k(Ue)),E(Ue,e.FORBID_CONTENTS)),je&&(we["#text"]=!0),Le&&E(we,["html","head","body"]),we.table&&(E(we,["tbody"]),delete Re.tbody),i&&i(e),nt=e)},at=E({},["mi","mo","mn","ms","mtext"]),st=E({},["foreignobject","desc","title","annotation-xml"]),ut=E({},C);E(ut,M),E(ut,O);var lt=E({},A);E(lt,L);var ct=function(e){var t=te(e);t&&t.tagName||(t={namespaceURI:$e,tagName:"template"});var n=m(e.tagName),r=m(t.tagName);if(e.namespaceURI===Xe)return t.namespaceURI===$e?"svg"===n:t.namespaceURI===Ke?"svg"===n&&("annotation-xml"===r||at[r]):Boolean(ut[n]);if(e.namespaceURI===Ke)return t.namespaceURI===$e?"math"===n:t.namespaceURI===Xe?"math"===n&&st[r]:Boolean(lt[n]);if(e.namespaceURI===$e){if(t.namespaceURI===Xe&&!st[r])return!1;if(t.namespaceURI===Ke&&!at[r])return!1;var o=E({},["title","style","font","a","script"]);return!lt[n]&&(o[n]||!ut[n])}return!1},ft=function(e){p(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=oe}catch(t){e.remove()}}},ht=function(e,t){try{p(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){p(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Se[e])if(Ie||De)try{ft(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},dt=function(e){var t=void 0,n=void 0;if(Ne)e="<remove></remove>"+e;else{var r=y(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===Qe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=re?re.createHTML(e):e;if(qe===$e)try{t=(new $).parseFromString(i,Qe)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(qe,"template",null);try{t.documentElement.innerHTML=Je?"":i}catch(e){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(o.createTextNode(n),a.childNodes[0]||null),qe===$e?le.call(t,Le?"html":"body")[0]:Le?t.documentElement:a},pt=function(e){return se.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},mt=function(e){return e instanceof X&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof S)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},yt=function(e){return"object"===(void 0===u?"undefined":W(u))?e instanceof u:e&&"object"===(void 0===e?"undefined":W(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},vt=function(e,t,r){he[e]&&h(he[e],(function(e){e.call(n,t,r,nt)}))},gt=function(e){var t=void 0;if(vt("beforeSanitizeElements",e,null),mt(e))return ft(e),!0;if(y(e.nodeName,/[\u0080-\uFFFF]/))return ft(e),!0;var r=tt(e.nodeName);if(vt("uponSanitizeElement",e,{tagName:r,allowedTags:we}),!yt(e.firstElementChild)&&(!yt(e.content)||!yt(e.content.firstElementChild))&&w(/<[/\w]/g,e.innerHTML)&&w(/<[/\w]/g,e.textContent))return ft(e),!0;if("select"===r&&w(/<template/i,e.innerHTML))return ft(e),!0;if(!we[r]||Re[r]){if(je&&!Ue[r]){var o=te(e)||e.parentNode,i=ee(e)||e.childNodes;if(i&&o)for(var a=i.length-1;a>=0;--a)o.insertBefore(Q(i[a],!0),Z(e))}if(!Re[r]&&wt(r)){if(ke.tagNameCheck instanceof RegExp&&w(ke.tagNameCheck,r))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(r))return!1}return ft(e),!0}return e instanceof l&&!ct(e)?(ft(e),!0):"noscript"!==r&&"noembed"!==r||!w(/<\/no(script|embed)/i,e.innerHTML)?(Ae&&3===e.nodeType&&(t=e.textContent,t=v(t,de," "),t=v(t,pe," "),e.textContent!==t&&(p(n.removed,{element:e.cloneNode()}),e.textContent=t)),vt("afterSanitizeElements",e,null),!1):(ft(e),!0)},bt=function(e,t,n){if(He&&("id"===t||"name"===t)&&(n in o||n in rt))return!1;if(Me&&!Te[t]&&w(me,t));else if(Ce&&w(ye,t));else if(!Se[t]||Te[t]){if(!(wt(e)&&(ke.tagNameCheck instanceof RegExp&&w(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&w(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&w(ke.tagNameCheck,n)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(n))))return!1}else if(ze[t]);else if(w(be,v(n,ge,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==g(n,"data:")||!Ve[e])if(Oe&&!w(ve,v(n,ge,"")));else if(n)return!1;return!0},wt=function(e){return e.indexOf("-")>0},_t=function(e){var t=void 0,r=void 0,o=void 0,i=void 0;vt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se};for(i=a.length;i--;){var u=t=a[i],l=u.name,c=u.namespaceURI;if(r=b(t.value),o=tt(l),s.attrName=o,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,vt("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(ht(l,e),s.keepAttr))if(w(/\/>/i,r))ht(l,e);else{Ae&&(r=v(r,de," "),r=v(r,pe," "));var f=tt(e.nodeName);if(bt(f,o,r))try{c?e.setAttributeNS(c,l,r):e.setAttribute(l,r),d(n.removed)}catch(e){}}}vt("afterSanitizeAttributes",e,null)}},St=function e(t){var n=void 0,r=pt(t);for(vt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)vt("uponSanitizeShadowNode",n,null),gt(n)||(n.content instanceof a&&e(n.content),_t(n));vt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,o){var i=void 0,s=void 0,l=void 0,c=void 0,f=void 0;if((Je=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!yt(e)){if("function"!=typeof e.toString)throw _("toString is not a function");if("string"!=typeof(e=e.toString()))throw _("dirty is not a string, aborting")}if(!n.isSupported){if("object"===W(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(yt(e))return t.toStaticHTML(e.outerHTML)}return e}if(xe||it(o),n.removed=[],"string"==typeof e&&(Fe=!1),Fe);else if(e instanceof u)1===(s=(i=dt("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!Ie&&!Ae&&!Le&&-1===e.indexOf("<"))return re&&Pe?re.createHTML(e):e;if(!(i=dt(e)))return Ie?null:oe}i&&Ne&&ft(i.firstChild);for(var h=pt(Fe?e:i);l=h.nextNode();)3===l.nodeType&&l===c||gt(l)||(l.content instanceof a&&St(l.content),_t(l),c=l);if(c=null,Fe)return e;if(Ie){if(De)for(f=ue.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return Se.shadowroot&&(f=ce.call(r,f,!0)),f}var d=Le?i.outerHTML:i.innerHTML;return Ae&&(d=v(d,de," "),d=v(d,pe," ")),re&&Pe?re.createHTML(d):d},n.setConfig=function(e){it(e),xe=!0},n.clearConfig=function(){nt=null,xe=!1},n.isValidAttribute=function(e,t,n){nt||it({});var r=tt(e),o=tt(t);return bt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],p(he[e],t))},n.removeHook=function(e){he[e]&&d(he[e])},n.removeHooks=function(e){he[e]&&(he[e]=[])},n.removeAllHooks=function(){he={}},n}()}()},49940:(e,t,n)=>{var r=n(43203)(n(44362),"DataView");e.exports=r},61979:(e,t,n)=>{var r=n(99129),o=n(19047),i=n(13486),a=n(64786),s=n(46444);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},52768:(e,t,n)=>{var r=n(83708),o=n(26993),i=n(40286),a=n(61678),s=n(19743);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},4804:(e,t,n)=>{var r=n(43203)(n(44362),"Map");e.exports=r},8423:(e,t,n)=>{var r=n(46977),o=n(97474),i=n(40727),a=n(23653),s=n(66140);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},87114:(e,t,n)=>{var r=n(43203)(n(44362),"Promise");e.exports=r},10689:(e,t,n)=>{var r=n(43203)(n(44362),"Set");e.exports=r},69832:(e,t,n)=>{var r=n(8423),o=n(29911),i=n(77447);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},70959:(e,t,n)=>{var r=n(52768),o=n(7553),i=n(86038),a=n(72397),s=n(2421),u=n(42936);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=o,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=s,l.prototype.set=u,e.exports=l},52773:(e,t,n)=>{var r=n(44362).Symbol;e.exports=r},92496:(e,t,n)=>{var r=n(44362).Uint8Array;e.exports=r},85284:(e,t,n)=>{var r=n(43203)(n(44362),"WeakMap");e.exports=r},56523:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},56193:(e,t,n)=>{var r=n(12123);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},58048:e=>{e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},28083:(e,t,n)=>{var r=n(25094),o=n(79246),i=n(43670),a=n(22343),s=n(24782),u=n(91589),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),c=!n&&o(e),f=!n&&!c&&a(e),h=!n&&!c&&!f&&u(e),d=n||c||f||h,p=d?r(e.length,String):[],m=p.length;for(var y in e)!t&&!l.call(e,y)||d&&("length"==y||f&&("offset"==y||"parent"==y)||h&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,m))||p.push(y);return p}},19258:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},18421:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},64481:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},76213:(e,t,n)=>{var r=n(67950);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},75806:(e,t,n)=>{var r=n(35645),o=n(93978)(r);e.exports=o},29319:(e,t,n)=>{var r=n(75806);e.exports=function(e,t){var n=[];return r(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}},65135:e=>{e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},7079:(e,t,n)=>{var r=n(57924)();e.exports=r},35645:(e,t,n)=>{var r=n(7079),o=n(63225);e.exports=function(e,t){return e&&r(e,t,o)}},5974:(e,t,n)=>{var r=n(36883),o=n(27102);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},60891:(e,t,n)=>{var r=n(18421),o=n(43670);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},1185:(e,t,n)=>{var r=n(52773),o=n(63888),i=n(82299),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},95529:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},12123:(e,t,n)=>{var r=n(65135),o=n(99574),i=n(84266);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,o,n)}},91075:(e,t,n)=>{var r=n(1185),o=n(44939);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},79856:(e,t,n)=>{var r=n(41829),o=n(44939);e.exports=function e(t,n,i,a,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,i,a,e,s))}},41829:(e,t,n)=>{var r=n(70959),o=n(83426),i=n(91402),a=n(54572),s=n(42417),u=n(43670),l=n(22343),c=n(91589),f="[object Arguments]",h="[object Array]",d="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,m,y,v){var g=u(e),b=u(t),w=g?h:s(e),_=b?h:s(t),S=(w=w==f?d:w)==d,E=(_=_==f?d:_)==d,k=w==_;if(k&&l(e)){if(!l(t))return!1;g=!0,S=!1}if(k&&!S)return v||(v=new r),g||c(e)?o(e,t,n,m,y,v):i(e,t,w,n,m,y,v);if(!(1&n)){var R=S&&p.call(e,"__wrapped__"),T=E&&p.call(t,"__wrapped__");if(R||T){var C=R?e.value():e,M=T?t.value():t;return v||(v=new r),y(C,M,n,m,v)}}return!!k&&(v||(v=new r),a(e,t,n,m,y,v))}},74656:(e,t,n)=>{var r=n(70959),o=n(79856);e.exports=function(e,t,n,i){var a=n.length,s=a,u=!i;if(null==e)return!s;for(e=Object(e);a--;){var l=n[a];if(u&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<s;){var c=(l=n[a])[0],f=e[c],h=l[1];if(u&&l[2]){if(void 0===f&&!(c in e))return!1}else{var d=new r;if(i)var p=i(f,h,c,e,t,d);if(!(void 0===p?o(h,f,3,i,d):p))return!1}}return!0}},99574:e=>{e.exports=function(e){return e!=e}},94106:(e,t,n)=>{var r=n(33626),o=n(49249),i=n(70071),a=n(51214),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,f=l.hasOwnProperty,h=RegExp("^"+c.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:s).test(a(e))}},43638:(e,t,n)=>{var r=n(1185),o=n(27100),i=n(44939),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},29047:(e,t,n)=>{var r=n(68334),o=n(85941),i=n(41559),a=n(43670),s=n(28886);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?o(e[0],e[1]):r(e):s(e)}},27521:(e,t,n)=>{var r=n(62803),o=n(63865),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},75901:(e,t,n)=>{var r=n(75806),o=n(16175);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}},68334:(e,t,n)=>{var r=n(74656),o=n(22811),i=n(24248);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},85941:(e,t,n)=>{var r=n(79856),o=n(20643),i=n(69059),a=n(80837),s=n(83631),u=n(24248),l=n(27102);e.exports=function(e,t){return a(e)&&s(t)?u(l(e),t):function(n){var a=o(n,e);return void 0===a&&a===t?i(n,e):r(t,a,3)}}},47067:(e,t,n)=>{var r=n(19258),o=n(5974),i=n(29047),a=n(75901),s=n(49244),u=n(19081),l=n(74937),c=n(41559),f=n(43670);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return f(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[c];var h=-1;t=r(t,u(i));var d=a(e,(function(e,n,o){return{criteria:r(t,(function(t){return t(e)})),index:++h,value:e}}));return s(d,(function(e,t){return l(e,t,n)}))}},63184:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},40886:(e,t,n)=>{var r=n(5974);e.exports=function(e){return function(t){return r(t,e)}}},49244:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},25094:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},38257:(e,t,n)=>{var r=n(52773),o=n(19258),i=n(43670),a=n(34655),s=r?r.prototype:void 0,u=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},71432:(e,t,n)=>{var r=n(19751),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},19081:e=>{e.exports=function(e){return function(t){return e(t)}}},66174:(e,t,n)=>{var r=n(69832),o=n(56193),i=n(58048),a=n(93159),s=n(69637),u=n(66983);e.exports=function(e,t,n){var l=-1,c=o,f=e.length,h=!0,d=[],p=d;if(n)h=!1,c=i;else if(f>=200){var m=t?null:s(e);if(m)return u(m);h=!1,c=a,p=new r}else p=t?[]:d;e:for(;++l<f;){var y=e[l],v=t?t(y):y;if(y=n||0!==y?y:0,h&&v==v){for(var g=p.length;g--;)if(p[g]===v)continue e;t&&p.push(v),d.push(y)}else c(p,v,n)||(p!==d&&p.push(v),d.push(y))}return d}},93159:e=>{e.exports=function(e,t){return e.has(t)}},36883:(e,t,n)=>{var r=n(43670),o=n(80837),i=n(50376),a=n(72049);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(a(e))}},99179:(e,t,n)=>{var r=n(34655);e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,i=e==e,a=r(e),s=void 0!==t,u=null===t,l=t==t,c=r(t);if(!u&&!c&&!a&&e>t||a&&s&&l&&!u&&!c||o&&s&&l||!n&&l||!i)return 1;if(!o&&!a&&!c&&e<t||c&&n&&i&&!o&&!a||u&&n&&i||!s&&i||!l)return-1}return 0}},74937:(e,t,n)=>{var r=n(99179);e.exports=function(e,t,n){for(var o=-1,i=e.criteria,a=t.criteria,s=i.length,u=n.length;++o<s;){var l=r(i[o],a[o]);if(l)return o>=u?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}},11741:(e,t,n)=>{var r=n(44362)["__core-js_shared__"];e.exports=r},93978:(e,t,n)=>{var r=n(16175);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==o(s[a],a,s););return n}}},57924:e=>{e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++o];if(!1===n(i[u],u,i))break}return t}}},87780:(e,t,n)=>{var r=n(29047),o=n(16175),i=n(63225);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!o(t)){var u=r(n,3);t=i(t),n=function(e){return u(s[e],e,s)}}var l=e(t,n,a);return l>-1?s[u?t[l]:l]:void 0}}},69637:(e,t,n)=>{var r=n(10689),o=n(19157),i=n(66983),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=a},83426:(e,t,n)=>{var r=n(69832),o=n(64481),i=n(93159);e.exports=function(e,t,n,a,s,u){var l=1&n,c=e.length,f=t.length;if(c!=f&&!(l&&f>c))return!1;var h=u.get(e),d=u.get(t);if(h&&d)return h==t&&d==e;var p=-1,m=!0,y=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<c;){var v=e[p],g=t[p];if(a)var b=l?a(g,v,p,t,e,u):a(v,g,p,e,t,u);if(void 0!==b){if(b)continue;m=!1;break}if(y){if(!o(t,(function(e,t){if(!i(y,t)&&(v===e||s(v,e,n,a,u)))return y.push(t)}))){m=!1;break}}else if(v!==g&&!s(v,g,n,a,u)){m=!1;break}}return u.delete(e),u.delete(t),m}},91402:(e,t,n)=>{var r=n(52773),o=n(92496),i=n(67950),a=n(83426),s=n(88961),u=n(66983),l=r?r.prototype:void 0,c=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,f,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!f(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var p=1&r;if(d||(d=u),e.size!=t.size&&!p)return!1;var m=h.get(e);if(m)return m==t;r|=2,h.set(e,t);var y=a(d(e),d(t),r,l,f,h);return h.delete(e),y;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},54572:(e,t,n)=>{var r=n(55788),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,a,s){var u=1&n,l=r(e),c=l.length;if(c!=r(t).length&&!u)return!1;for(var f=c;f--;){var h=l[f];if(!(u?h in t:o.call(t,h)))return!1}var d=s.get(e),p=s.get(t);if(d&&p)return d==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var y=u;++f<c;){var v=e[h=l[f]],g=t[h];if(i)var b=u?i(g,v,h,t,e,s):i(v,g,h,e,t,s);if(!(void 0===b?v===g||a(v,g,n,i,s):b)){m=!1;break}y||(y="constructor"==h)}if(m&&!y){var w=e.constructor,_=t.constructor;w==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _||(m=!1)}return s.delete(e),s.delete(t),m}},88556:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},55788:(e,t,n)=>{var r=n(60891),o=n(97976),i=n(63225);e.exports=function(e){return r(e,i,o)}},90404:(e,t,n)=>{var r=n(54480);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},22811:(e,t,n)=>{var r=n(83631),o=n(63225);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,r(a)]}return t}},43203:(e,t,n)=>{var r=n(94106),o=n(17338);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},63888:(e,t,n)=>{var r=n(52773),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o}},97976:(e,t,n)=>{var r=n(56523),o=n(64043),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return i.call(e,t)})))}:o;e.exports=s},42417:(e,t,n)=>{var r=n(49940),o=n(4804),i=n(87114),a=n(10689),s=n(85284),u=n(1185),l=n(51214),c="[object Map]",f="[object Promise]",h="[object Set]",d="[object WeakMap]",p="[object DataView]",m=l(r),y=l(o),v=l(i),g=l(a),b=l(s),w=u;(r&&w(new r(new ArrayBuffer(1)))!=p||o&&w(new o)!=c||i&&w(i.resolve())!=f||a&&w(new a)!=h||s&&w(new s)!=d)&&(w=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case m:return p;case y:return c;case v:return f;case g:return h;case b:return d}return t}),e.exports=w},17338:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},14727:(e,t,n)=>{var r=n(36883),o=n(79246),i=n(43670),a=n(24782),s=n(27100),u=n(27102);e.exports=function(e,t,n){for(var l=-1,c=(t=r(t,e)).length,f=!1;++l<c;){var h=u(t[l]);if(!(f=null!=e&&n(e,h)))break;e=e[h]}return f||++l!=c?f:!!(c=null==e?0:e.length)&&s(c)&&a(h,c)&&(i(e)||o(e))}},99129:(e,t,n)=>{var r=n(26326);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},19047:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},13486:(e,t,n)=>{var r=n(26326),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},64786:(e,t,n)=>{var r=n(26326),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},46444:(e,t,n)=>{var r=n(26326);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},24782:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},80837:(e,t,n)=>{var r=n(43670),o=n(34655),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}},54480:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},49249:(e,t,n)=>{var r,o=n(11741),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},62803:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},83631:(e,t,n)=>{var r=n(70071);e.exports=function(e){return e==e&&!r(e)}},83708:e=>{e.exports=function(){this.__data__=[],this.size=0}},26993:(e,t,n)=>{var r=n(76213),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},40286:(e,t,n)=>{var r=n(76213);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},61678:(e,t,n)=>{var r=n(76213);e.exports=function(e){return r(this.__data__,e)>-1}},19743:(e,t,n)=>{var r=n(76213);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},46977:(e,t,n)=>{var r=n(61979),o=n(52768),i=n(4804);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},97474:(e,t,n)=>{var r=n(90404);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},40727:(e,t,n)=>{var r=n(90404);e.exports=function(e){return r(this,e).get(e)}},23653:(e,t,n)=>{var r=n(90404);e.exports=function(e){return r(this,e).has(e)}},66140:(e,t,n)=>{var r=n(90404);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},88961:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},24248:e=>{e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},35933:(e,t,n)=>{var r=n(40104);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},26326:(e,t,n)=>{var r=n(43203)(Object,"create");e.exports=r},63865:(e,t,n)=>{var r=n(15290)(Object.keys,Object);e.exports=r},51985:(e,t,n)=>{e=n.nmd(e);var r=n(88556),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},82299:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},15290:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},44362:(e,t,n)=>{var r=n(88556),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},29911:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},77447:e=>{e.exports=function(e){return this.__data__.has(e)}},66983:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},7553:(e,t,n)=>{var r=n(52768);e.exports=function(){this.__data__=new r,this.size=0}},86038:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},72397:e=>{e.exports=function(e){return this.__data__.get(e)}},2421:e=>{e.exports=function(e){return this.__data__.has(e)}},42936:(e,t,n)=>{var r=n(52768),o=n(4804),i=n(8423);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(e,t),this.size=n.size,this}},84266:e=>{e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},50376:(e,t,n)=>{var r=n(35933),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)})),t}));e.exports=a},27102:(e,t,n)=>{var r=n(34655);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},51214:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},19751:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},67950:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},29045:(e,t,n)=>{var r=n(56523),o=n(29319),i=n(29047),a=n(43670);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},85066:(e,t,n)=>{var r=n(87780)(n(59377));e.exports=r},59377:(e,t,n)=>{var r=n(65135),o=n(29047),i=n(92826),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var u=null==n?0:i(n);return u<0&&(u=a(s+u,0)),r(e,o(t,3),u)}},20643:(e,t,n)=>{var r=n(5974);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},69059:(e,t,n)=>{var r=n(95529),o=n(14727);e.exports=function(e,t){return null!=e&&o(e,t,r)}},41559:e=>{e.exports=function(e){return e}},79246:(e,t,n)=>{var r=n(91075),o=n(44939),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},43670:e=>{var t=Array.isArray;e.exports=t},16175:(e,t,n)=>{var r=n(33626),o=n(27100);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},22343:(e,t,n)=>{e=n.nmd(e);var r=n(44362),o=n(53444),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||o;e.exports=u},7120:(e,t,n)=>{var r=n(79856);e.exports=function(e,t){return r(e,t)}},33626:(e,t,n)=>{var r=n(1185),o=n(70071);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},27100:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},70071:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},44939:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},34655:(e,t,n)=>{var r=n(1185),o=n(44939);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},91589:(e,t,n)=>{var r=n(43638),o=n(19081),i=n(51985),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},63225:(e,t,n)=>{var r=n(28083),o=n(27521),i=n(16175);e.exports=function(e){return i(e)?r(e):o(e)}},40104:(e,t,n)=>{var r=n(8423);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},19157:e=>{e.exports=function(){}},35224:(e,t,n)=>{var r=n(47067),o=n(43670);e.exports=function(e,t,n,i){return null==e?[]:(o(t)||(t=null==t?[]:[t]),o(n=i?void 0:n)||(n=null==n?[]:[n]),r(e,t,n))}},28886:(e,t,n)=>{var r=n(63184),o=n(40886),i=n(80837),a=n(27102);e.exports=function(e){return i(e)?r(a(e)):o(e)}},64043:e=>{e.exports=function(){return[]}},53444:e=>{e.exports=function(){return!1}},61286:(e,t,n)=>{var r=n(56705);e.exports=function(e){return e?Infinity===(e=r(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},92826:(e,t,n)=>{var r=n(61286);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},56705:(e,t,n)=>{var r=n(71432),o=n(70071),i=n(34655),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||u.test(e)?l(e.slice(2),n?2:8):a.test(e)?NaN:+e}},72049:(e,t,n)=>{var r=n(38257);e.exports=function(e){return null==e?"":r(e)}},84849:(e,t,n)=>{var r=n(66174);e.exports=function(e){return e&&e.length?r(e):[]}},89127:function(e,t,n){!function(e){"use strict";e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"vm":"VM":n?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(90421))},72633:function(e,t,n){!function(e){"use strict";e.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}})}(n(90421))},63215:function(e,t,n){!function(e){"use strict";e.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}})}(n(90421))},96968:function(e,t,n){!function(e){"use strict";var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},n=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},r={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},o=function(e){return function(t,o,i,a){var s=n(t),u=r[e][n(t)];return 2===s&&(u=u[o?0:1]),u.replace(/%d/i,t)}},i=["","","","","","","","","","","",""];e.defineLocale("ar-ly",{months:i,monthsShort:i,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:o("s"),ss:o("s"),m:o("m"),mm:o("m"),h:o("h"),hh:o("h"),d:o("d"),dd:o("d"),M:o("M"),MM:o("M"),y:o("y"),yy:o("y")},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(90421))},52572:function(e,t,n){!function(e){"use strict";e.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(n(90421))},68319:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:0,doy:6}})}(n(90421))},75629:function(e,t,n){!function(e){"use strict";e.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})}(n(90421))},67006:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},r=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},o={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},i=function(e){return function(t,n,i,a){var s=r(t),u=o[e][r(t)];return 2===s&&(u=u[n?0:1]),u.replace(/%d/i,t)}},a=["","","","","","","","","","","",""];e.defineLocale("ar",{months:a,monthsShort:a,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:i("s"),ss:i("s"),m:i("m"),mm:i("m"),h:i("h"),hh:i("h"),d:i("d"),dd:i("d"),M:i("M"),MM:i("M"),y:i("y"),yy:i("y")},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(90421))},76722:function(e,t,n){!function(e){"use strict";var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(e){return/^(gndz|axam)$/.test(e)},meridiem:function(e,t,n){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var n=e%10;return e+(t[n]||t[e%100-n]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(90421))},15958:function(e,t,n){!function(e){"use strict";function t(e,t,n){return"m"===n?t?"":"":"h"===n?t?"":"":e+" "+(r=+e,o={ss:t?"__":"__",mm:t?"__":"__",hh:t?"__":"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),r%10==1&&r%100!=11?o[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?o[1]:o[2]);var r,o}e.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:t,mm:t,h:t,hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!=2&&e%10!=3||e%100==12||e%100==13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})}(n(90421))},74921:function(e,t,n){!function(e){"use strict";e.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})}(n(90421))},17293:function(e,t,n){!function(e){"use strict";e.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}})}(n(90421))},52288:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},82127:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},43922:function(e,t,n){!function(e){"use strict";function t(e,t,n){return e+" "+function(e,t){return 2===t?function(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}(e):e}({mm:"munutenn",MM:"miz",dd:"devezh"}[n],e)}function n(e){return e>9?n(e%10):e}e.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:function(e){switch(n(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(e){return e+(1===e?"a":"vet")},week:{dow:1,doy:4}})}(n(90421))},78932:function(e,t,n){!function(e){"use strict";function t(e,t,n){var r=e+" ";switch(n){case"ss":return r+(1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi");case"m":return t?"jedna minuta":"jedne minute";case"mm":return r+(1===e?"minuta":2===e||3===e||4===e?"minute":"minuta");case"h":return t?"jedan sat":"jednog sata";case"hh":return r+(1===e?"sat":2===e||3===e||4===e?"sata":"sati");case"dd":return r+(1===e?"dan":"dana");case"MM":return r+(1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci");case"yy":return r+(1===e?"godina":2===e||3===e||4===e?"godine":"godina")}}e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},13246:function(e,t,n){!function(e){"use strict";e.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var n=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(n="a"),e+n},week:{dow:1,doy:4}})}(n(90421))},18208:function(e,t,n){!function(e){"use strict";var t="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),n="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),r=[/^led/i,/^no/i,/^be/i,/^dub/i,/^kv/i,/^(vn|erven$|ervna)/i,/^(vc|ervenec|ervence)/i,/^srp/i,/^z/i,/^j/i,/^lis/i,/^pro/i],o=/^(leden|nor|bezen|duben|kvten|ervenec|ervence|erven|ervna|srpen|z|jen|listopad|prosinec|led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i;function i(e){return e>1&&e<5&&1!=~~(e/10)}function a(e,t,n,r){var o=e+" ";switch(n){case"s":return t||r?"pr sekund":"pr sekundami";case"ss":return t||r?o+(i(e)?"sekundy":"sekund"):o+"sekundami";case"m":return t?"minuta":r?"minutu":"minutou";case"mm":return t||r?o+(i(e)?"minuty":"minut"):o+"minutami";case"h":return t?"hodina":r?"hodinu":"hodinou";case"hh":return t||r?o+(i(e)?"hodiny":"hodin"):o+"hodinami";case"d":return t||r?"den":"dnem";case"dd":return t||r?o+(i(e)?"dny":"dn"):o+"dny";case"M":return t||r?"msc":"mscem";case"MM":return t||r?o+(i(e)?"msce":"msc"):o+"msci";case"y":return t||r?"rok":"rokem";case"yy":return t||r?o+(i(e)?"roky":"let"):o+"lety"}}e.defineLocale("cs",{months:t,monthsShort:n,monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(leden|ledna|nora|nor|bezen|bezna|duben|dubna|kvten|kvtna|ervenec|ervence|erven|ervna|srpen|srpna|z|jen|jna|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:a,ss:a,m:a,mm:a,h:a,hh:a,d:a,dd:a,M:a,MM:a,y:a,yy:a},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},26492:function(e,t,n){!function(e){"use strict";e.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){return e+(/$/i.exec(e)?"":/$/i.exec(e)?"":"")},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}})}(n(90421))},71883:function(e,t,n){!function(e){"use strict";e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t="";return e>20?t=40===e||50===e||60===e||80===e||100===e?"fed":"ain":e>0&&(t=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"][e]),e+t},week:{dow:1,doy:4}})}(n(90421))},12285:function(e,t,n){!function(e){"use strict";e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},3082:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[n][0]:o[n][1]}e.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},9076:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[n][0]:o[n][1]}e.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},6454:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[n][0]:o[n][1]}e.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},9016:function(e,t,n){!function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("dv",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}})}(n(90421))},83093:function(e,t,n){!function(e){"use strict";e.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,t){return e?"string"==typeof t&&/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(e,t,n){return e>11?n?"":"":n?"":""},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){return 6===this.day()?"[ ] dddd [{}] LT":"[ ] dddd [{}] LT"},sameElse:"L"},calendar:function(e,t){var n,r=this._calendarEl[e],o=t&&t.hours();return((n=r)instanceof Function||"[object Function]"===Object.prototype.toString.call(n))&&(r=r.apply(t)),r.replace("{}",o%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},90820:function(e,t,n){!function(e){"use strict";e.defineLocale("en-SG",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},85535:function(e,t,n){!function(e){"use strict";e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},12610:function(e,t,n){!function(e){"use strict";e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})}(n(90421))},78386:function(e,t,n){!function(e){"use strict";e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},35272:function(e,t,n){!function(e){"use strict";e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},73563:function(e,t,n){!function(e){"use strict";e.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})}(n(90421))},82140:function(e,t,n){!function(e){"use strict";e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},59823:function(e,t,n){!function(e){"use strict";e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,n){return e>11?n?"p.t.m.":"P.T.M.":n?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",ss:"%d sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}})}(n(90421))},69546:function(e,t,n){!function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),r=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},37781:function(e,t,n){!function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),r=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}})}(n(90421))},30312:function(e,t,n){!function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),r=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},58563:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return t?o[n][2]?o[n][2]:o[n][1]:r?o[n][0]:o[n][1]}e.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d peva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},64003:function(e,t,n){!function(e){"use strict";e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},40463:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(e){return/  /.test(e)},meridiem:function(e,t,n){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:" d%",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[-]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}})}(n(90421))},68941:function(e,t,n){!function(e){"use strict";var t="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),n=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",t[7],t[8],t[9]];function r(e,r,o,i){var a="";switch(o){case"s":return i?"muutaman sekunnin":"muutama sekunti";case"ss":return i?"sekunnin":"sekuntia";case"m":return i?"minuutin":"minuutti";case"mm":a=i?"minuutin":"minuuttia";break;case"h":return i?"tunnin":"tunti";case"hh":a=i?"tunnin":"tuntia";break;case"d":return i?"pivn":"piv";case"dd":a=i?"pivn":"piv";break;case"M":return i?"kuukauden":"kuukausi";case"MM":a=i?"kuukauden":"kuukautta";break;case"y":return i?"vuoden":"vuosi";case"yy":a=i?"vuoden":"vuotta"}return function(e,r){return e<10?r?n[e]:t[e]:e}(e,i)+" "+a}e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:r,ss:r,m:r,mm:r,h:r,hh:r,d:r,dd:r,M:r,MM:r,y:r,yy:r},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},40006:function(e,t,n){!function(e){"use strict";e.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minuttur",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnaur",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},60761:function(e,t,n){!function(e){"use strict";e.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}})}(n(90421))},10982:function(e,t,n){!function(e){"use strict";e.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(n(90421))},32346:function(e,t,n){!function(e){"use strict";e.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(n(90421))},24934:function(e,t,n){!function(e){"use strict";var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),n="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(90421))},34804:function(e,t,n){!function(e){"use strict";e.defineLocale("ga",{months:["Eanir","Feabhra","Mrta","Aibren","Bealtaine","Mitheamh","Iil","Lnasa","Men Fmhair","Deaireadh Fmhair","Samhain","Nollaig"],monthsShort:["Ean","Feab","Mrt","Aibr","Beal","Mit","Iil","Lna","Men","Deai","Samh","Noll"],monthsParseExact:!0,weekdays:["D Domhnaigh","D Luain","D Mirt","D Cadaoin","Dardaoin","D hAoine","D Satharn"],weekdaysShort:["Dom","Lua","Mi","Ca","Da","hAo","Sat"],weekdaysMin:["Do","Lu","M","Ce","D","hA","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Inniu ag] LT",nextDay:"[Amrach ag] LT",nextWeek:"dddd [ag] LT",lastDay:"[Inn aig] LT",lastWeek:"dddd [seo caite] [ag] LT",sameElse:"L"},relativeTime:{future:"i %s",past:"%s  shin",s:"cpla soicind",ss:"%d soicind",m:"nimad",mm:"%d nimad",h:"uair an chloig",hh:"%d uair an chloig",d:"l",dd:"%d l",M:"m",MM:"%d m",y:"bliain",yy:"%d bliain"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})}(n(90421))},41733:function(e,t,n){!function(e){"use strict";e.defineLocale("gd",{months:["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],monthsShort:["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],monthsParseExact:!0,weekdays:["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],weekdaysShort:["Did","Dil","Dim","Dic","Dia","Dih","Dis"],weekdaysMin:["D","Lu","M","Ci","Ar","Ha","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})}(n(90421))},72271:function(e,t,n){!function(e){"use strict";e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},70763:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={s:["thodde secondanim","thodde second"],ss:[e+" secondanim",e+" second"],m:["eka mintan","ek minute"],mm:[e+" mintanim",e+" mintam"],h:["eka voran","ek vor"],hh:[e+" voranim",e+" voram"],d:["eka disan","ek dis"],dd:[e+" disanim",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineanim",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsanim",e+" vorsam"]};return t?o[n][0]:o[n][1]}e.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){return"D"===t?e+"er":e},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokalli"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"rati":e<12?"sokalli":e<16?"donparam":e<20?"sanje":"rati"}})}(n(90421))},84125:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},81651:function(e,t,n){!function(e){"use strict";e.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:"",yy:function(e){return 2===e?"":e%10==0&&10!==e?e+" ":e+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(e){return/^("| |)$/.test(e)},meridiem:function(e,t,n){return e<5?" ":e<10?"":e<12?n?'"':" ":e<18?n?'"':" ":""}})}(n(90421))},18602:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},8641:function(e,t,n){!function(e){"use strict";function t(e,t,n){var r=e+" ";switch(n){case"ss":return r+(1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi");case"m":return t?"jedna minuta":"jedne minute";case"mm":return r+(1===e?"minuta":2===e||3===e||4===e?"minute":"minuta");case"h":return t?"jedan sat":"jednog sata";case"hh":return r+(1===e?"sat":2===e||3===e||4===e?"sata":"sati");case"dd":return r+(1===e?"dan":"dana");case"MM":return r+(1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci");case"yy":return r+(1===e?"godina":2===e||3===e||4===e?"godine":"godina")}}e.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},3079:function(e,t,n){!function(e){"use strict";var t="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");function n(e,t,n,r){var o=e;switch(n){case"s":return r||t?"nhny msodperc":"nhny msodperce";case"ss":return o+(r||t)?" msodperc":" msodperce";case"m":return"egy"+(r||t?" perc":" perce");case"mm":return o+(r||t?" perc":" perce");case"h":return"egy"+(r||t?" ra":" rja");case"hh":return o+(r||t?" ra":" rja");case"d":return"egy"+(r||t?" nap":" napja");case"dd":return o+(r||t?" nap":" napja");case"M":return"egy"+(r||t?" hnap":" hnapja");case"MM":return o+(r||t?" hnap":" hnapja");case"y":return"egy"+(r||t?" v":" ve");case"yy":return o+(r||t?" v":" ve")}return""}function r(e){return(e?"":"[mlt] ")+"["+t[this.day()]+"] LT[-kor]"}e.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,n){return e<12?!0===n?"de":"DE":!0===n?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return r.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return r.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:n,ss:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},60443:function(e,t,n){!function(e){"use strict";e.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}})}(n(90421))},8963:function(e,t,n){!function(e){"use strict";e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(n(90421))},11343:function(e,t,n){!function(e){"use strict";function t(e){return e%100==11||e%10!=1}function n(e,n,r,o){var i=e+" ";switch(r){case"s":return n||o?"nokkrar sekndur":"nokkrum sekndum";case"ss":return t(e)?i+(n||o?"sekndur":"sekndum"):i+"seknda";case"m":return n?"mnta":"mntu";case"mm":return t(e)?i+(n||o?"mntur":"mntum"):n?i+"mnta":i+"mntu";case"hh":return t(e)?i+(n||o?"klukkustundir":"klukkustundum"):i+"klukkustund";case"d":return n?"dagur":o?"dag":"degi";case"dd":return t(e)?n?i+"dagar":i+(o?"daga":"dgum"):n?i+"dagur":i+(o?"dag":"degi");case"M":return n?"mnuur":o?"mnu":"mnui";case"MM":return t(e)?n?i+"mnuir":i+(o?"mnui":"mnuum"):n?i+"mnuur":i+(o?"mnu":"mnui");case"y":return n||o?"r":"ri";case"yy":return t(e)?i+(n||o?"r":"rum"):i+(n||o?"r":"ri")}}e.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:n,ss:n,m:n,mm:n,h:"klukkustund",hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},33115:function(e,t,n){!function(e){"use strict";e.defineLocale("it-ch",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){return 0===this.day()?"[la scorsa] dddd [alle] LT":"[lo scorso] dddd [alle] LT"},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},28072:function(e,t,n){!function(e){"use strict";e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){return 0===this.day()?"[la scorsa] dddd [alle] LT":"[lo scorso] dddd [alle] LT"},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},58183:function(e,t,n){!function(e){"use strict";e.defineLocale("ja",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(e){return e.week()<this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(e){return this.week()<e.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})}(n(90421))},71064:function(e,t,n){!function(e){"use strict";e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}})}(n(90421))},81999:function(e,t,n){!function(e){"use strict";e.defineLocale("ka",{months:{standalone:"___________".split("_"),format:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return/(|||)/.test(e)?e.replace(/$/,""):e+""},past:function(e){return/(||||)/.test(e)?e.replace(/(|)$/," ")://.test(e)?e.replace(/$/," "):void 0},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20==0||e%100==0?"-"+e:e+"-"},week:{dow:1,doy:7}})}(n(90421))},29360:function(e,t,n){!function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(90421))},43667:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},week:{dow:1,doy:4}})}(n(90421))},41882:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e){return e+""},week:{dow:0,doy:6}})}(n(90421))},42401:function(e,t,n){!function(e){"use strict";e.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""}})}(n(90421))},42583:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},r=[" ","","","","","","","",""," "," "," "];e.defineLocale("ku",{months:r,monthsShort:r,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return//.test(e)},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:" ",ss:" %d",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(90421))},66751:function(e,t,n){!function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(90421))},81193:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?o[n][0]:o[n][1]}function n(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10;return n(0===t?e/10:t)}if(e<1e4){for(;e>=10;)e/=10;return n(e)}return n(e/=1e3)}e.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:function(e){return n(e.substr(0,e.indexOf(" ")))?"a "+e:"an "+e},past:function(e){return n(e.substr(0,e.indexOf(" ")))?"viru "+e:"virun "+e},s:"e puer Sekonnen",ss:"%d Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Mint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},80769:function(e,t,n){!function(e){"use strict";e.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(e){return""+e}})}(n(90421))},44409:function(e,t,n){!function(e){"use strict";var t={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};function n(e,t,n,r){return t?o(n)[0]:r?o(n)[1]:o(n)[2]}function r(e){return e%10==0||e>10&&e<20}function o(e){return t[e].split("_")}function i(e,t,i,a){var s=e+" ";return 1===e?s+n(0,t,i[0],a):t?s+(r(e)?o(i)[1]:o(i)[0]):a?s+o(i)[1]:s+(r(e)?o(i)[1]:o(i)[2])}e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:function(e,t,n,r){return t?"kelios sekunds":r?"keli sekundi":"kelias sekundes"},ss:i,m:n,mm:i,h:n,hh:i,d:n,dd:i,M:n,MM:i,y:n,yy:i},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}})}(n(90421))},9262:function(e,t,n){!function(e){"use strict";var t={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};function n(e,t,n){return n?t%10==1&&t%100!=11?e[2]:e[3]:t%10==1&&t%100!=11?e[0]:e[1]}function r(e,r,o){return e+" "+n(t[o],e,r)}function o(e,r,o){return n(t[o],e,r)}e.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:function(e,t){return t?"daas sekundes":"dam sekundm"},ss:r,m:o,mm:r,h:o,hh:r,d:o,dd:r,M:o,MM:r,y:o,yy:r},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},97514:function(e,t,n){!function(e){"use strict";var t={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,r){var o=t.words[r];return 1===r.length?n?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}};e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},83434:function(e,t,n){!function(e){"use strict";e.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},70610:function(e,t,n){!function(e){"use strict";e.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})}(n(90421))},71654:function(e,t,n){!function(e){"use strict";e.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||" "===t||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?" ":e<20?"":""}})}(n(90421))},86730:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){switch(n){case"s":return t?" ":" ";case"ss":return e+(t?" ":" ");case"m":case"mm":return e+(t?" ":" ");case"h":case"hh":return e+(t?" ":" ");case"d":case"dd":return e+(t?" ":" ");case"M":case"MM":return e+(t?" ":" ");case"y":case"yy":return e+(t?" ":" ");default:return e}}e.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+" ";default:return e}}})}(n(90421))},47196:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function r(e,t,n,r){var o="";if(t)switch(n){case"s":o=" ";break;case"ss":o="%d ";break;case"m":o=" ";break;case"mm":o="%d ";break;case"h":o=" ";break;case"hh":o="%d ";break;case"d":o=" ";break;case"dd":o="%d ";break;case"M":o=" ";break;case"MM":o="%d ";break;case"y":o=" ";break;case"yy":o="%d "}else switch(n){case"s":o=" ";break;case"ss":o="%d ";break;case"m":o=" ";break;case"mm":o="%d ";break;case"h":o=" ";break;case"hh":o="%d ";break;case"d":o=" ";break;case"dd":o="%d ";break;case"M":o=" ";break;case"MM":o="%d ";break;case"y":o=" ";break;case"yy":o="%d "}return o.replace(/%d/i,e)}e.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:r,ss:r,m:r,mm:r,h:r,hh:r,d:r,dd:r,M:r,MM:r,y:r,yy:r},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},14750:function(e,t,n){!function(e){"use strict";e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(n(90421))},20487:function(e,t,n){!function(e){"use strict";e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(n(90421))},58856:function(e,t,n){!function(e){"use strict";e.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},21240:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},week:{dow:1,doy:4}})}(n(90421))},12121:function(e,t,n){!function(e){"use strict";e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},89802:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}})}(n(90421))},93497:function(e,t,n){!function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),r=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(90421))},80737:function(e,t,n){!function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),r=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,r){return e?/-MMM-/.test(r)?n[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(90421))},18153:function(e,t,n){!function(e){"use strict";e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},10499:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},53629:function(e,t,n){!function(e){"use strict";var t="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),n="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");function r(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function o(e,t,n){var o=e+" ";switch(n){case"ss":return o+(r(e)?"sekundy":"sekund");case"m":return t?"minuta":"minut";case"mm":return o+(r(e)?"minuty":"minut");case"h":return t?"godzina":"godzin";case"hh":return o+(r(e)?"godziny":"godzin");case"MM":return o+(r(e)?"miesice":"miesicy");case"yy":return o+(r(e)?"lata":"lat")}}e.defineLocale("pl",{months:function(e,r){return e?""===r?"("+n[e.month()]+"|"+t[e.month()]+")":/D MMMM/.test(r)?n[e.month()]:t[e.month()]:t},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:o,m:o,mm:o,h:o,hh:o,d:"1 dzie",dd:"%d dni",M:"miesic",MM:o,y:"rok",yy:o},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},23312:function(e,t,n){!function(e){"use strict";e.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"})}(n(90421))},95702:function(e,t,n){!function(e){"use strict";e.defineLocale("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},10719:function(e,t,n){!function(e){"use strict";function t(e,t,n){var r=" ";return(e%100>=20||e>=100&&e%100==0)&&(r=" de "),e+r+{ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"}[n]}e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:t,m:"un minut",mm:t,h:"o or",hh:t,d:"o zi",dd:t,M:"o lun",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}})}(n(90421))},33778:function(e,t,n){!function(e){"use strict";function t(e,t,n){return"m"===n?t?"":"":e+" "+(r=+e,o={ss:t?"__":"__",mm:t?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),r%10==1&&r%100!=11?o[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?o[1]:o[2]);var r,o}var n=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];e.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:n,longMonthsParse:n,shortMonthsParse:n,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:t,m:t,mm:t,h:"",hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/i,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}})}(n(90421))},25545:function(e,t,n){!function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("sd",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})}(n(90421))},35811:function(e,t,n){!function(e){"use strict";e.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},12015:function(e,t,n){!function(e){"use strict";e.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e){return e+" "},meridiemParse:/ | |.|../,isPM:function(e){return".."===e||" "===e},meridiem:function(e,t,n){return e>11?n?"..":" ":n?"..":" "}})}(n(90421))},21587:function(e,t,n){!function(e){"use strict";var t="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),n="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");function r(e){return e>1&&e<5}function o(e,t,n,o){var i=e+" ";switch(n){case"s":return t||o?"pr seknd":"pr sekundami";case"ss":return t||o?i+(r(e)?"sekundy":"seknd"):i+"sekundami";case"m":return t?"minta":o?"mintu":"mintou";case"mm":return t||o?i+(r(e)?"minty":"mint"):i+"mintami";case"h":return t?"hodina":o?"hodinu":"hodinou";case"hh":return t||o?i+(r(e)?"hodiny":"hodn"):i+"hodinami";case"d":return t||o?"de":"dom";case"dd":return t||o?i+(r(e)?"dni":"dn"):i+"dami";case"M":return t||o?"mesiac":"mesiacom";case"MM":return t||o?i+(r(e)?"mesiace":"mesiacov"):i+"mesiacmi";case"y":return t||o?"rok":"rokom";case"yy":return t||o?i+(r(e)?"roky":"rokov"):i+"rokmi"}}e.defineLocale("sk",{months:t,monthsShort:n,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:case 4:case 5:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:o,ss:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},20147:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o=e+" ";switch(n){case"s":return t||r?"nekaj sekund":"nekaj sekundami";case"ss":return o+(1===e?t?"sekundo":"sekundi":2===e?t||r?"sekundi":"sekundah":e<5?t||r?"sekunde":"sekundah":"sekund");case"m":return t?"ena minuta":"eno minuto";case"mm":return o+(1===e?t?"minuta":"minuto":2===e?t||r?"minuti":"minutama":e<5?t||r?"minute":"minutami":t||r?"minut":"minutami");case"h":return t?"ena ura":"eno uro";case"hh":return o+(1===e?t?"ura":"uro":2===e?t||r?"uri":"urama":e<5?t||r?"ure":"urami":t||r?"ur":"urami");case"d":return t||r?"en dan":"enim dnem";case"dd":return o+(1===e?t||r?"dan":"dnem":2===e?t||r?"dni":"dnevoma":t||r?"dni":"dnevi");case"M":return t||r?"en mesec":"enim mesecem";case"MM":return o+(1===e?t||r?"mesec":"mesecem":2===e?t||r?"meseca":"mesecema":e<5?t||r?"mesece":"meseci":t||r?"mesecev":"meseci");case"y":return t||r?"eno leto":"enim letom";case"yy":return o+(1===e?t||r?"leto":"letom":2===e?t||r?"leti":"letoma":e<5?t||r?"leta":"leti":t||r?"let":"leti")}}e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},36821:function(e,t,n){!function(e){"use strict";e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,n){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},37792:function(e,t,n){!function(e){"use strict";var t={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,r){var o=t.words[r];return 1===r.length?n?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}};e.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"",dd:t.translate,M:"",MM:t.translate,y:"",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},63019:function(e,t,n){!function(e){"use strict";var t={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,r){var o=t.words[r];return 1===r.length?n?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}};e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(90421))},15078:function(e,t,n){!function(e){"use strict";e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,n){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(90421))},13593:function(e,t,n){!function(e){"use strict";e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"e":1===t||2===t?"a":"e")},week:{dow:1,doy:4}})}(n(90421))},57655:function(e,t,n){!function(e){"use strict";e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}})}(n(90421))},51553:function(e,t,n){!function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||||/,meridiem:function(e,t,n){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<2?e:e+12:""===t||""===t||""===t&&e>=10?e:e+12},week:{dow:0,doy:6}})}(n(90421))},65967:function(e,t,n){!function(e){"use strict";e.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(90421))},39236:function(e,t,n){!function(e){"use strict";e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",ss:"minutu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},82091:function(e,t,n){!function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=11?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<11?"":e<16?"":e<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(90421))},44141:function(e,t,n){!function(e){"use strict";e.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(90421))},98941:function(e,t,n){!function(e){"use strict";e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})}(n(90421))},99565:function(e,t,n){!function(e){"use strict";var t="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");function n(e,n,r,o){var i=function(e){var n=Math.floor(e%1e3/100),r=Math.floor(e%100/10),o=e%10,i="";return n>0&&(i+=t[n]+"vatlh"),r>0&&(i+=(""!==i?" ":"")+t[r]+"maH"),o>0&&(i+=(""!==i?" ":"")+t[o]),""===i?"pagh":i}(e);switch(r){case"ss":return i+" lup";case"mm":return i+" tup";case"hh":return i+" rep";case"dd":return i+" jaj";case"MM":return i+" jar";case"yy":return i+" DIS"}}e.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:function(e){var t=e;return-1!==e.indexOf("jaj")?t.slice(0,-3)+"leS":-1!==e.indexOf("jar")?t.slice(0,-3)+"waQ":-1!==e.indexOf("DIS")?t.slice(0,-3)+"nem":t+" pIq"},past:function(e){var t=e;return-1!==e.indexOf("jaj")?t.slice(0,-3)+"Hu":-1!==e.indexOf("jar")?t.slice(0,-3)+"wen":-1!==e.indexOf("DIS")?t.slice(0,-3)+"ben":t+" ret"},s:"puS lup",ss:n,m:"wa tup",mm:n,h:"wa rep",hh:n,d:"wa jaj",dd:n,M:"wa jar",MM:n,y:"wa DIS",yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},6075:function(e,t,n){!function(e){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};e.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(e,n){switch(n){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'nc";var r=e%10;return e+(t[r]||t[e%100-r]||t[e>=100?100:null])}},week:{dow:1,doy:7}})}(n(90421))},91637:function(e,t,n){!function(e){"use strict";function t(e,t,n,r){var o={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",e+" ars"]};return r||t?o[n][0]:o[n][1]}e.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,n){return e>11?n?"d'o":"D'O":n?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(90421))},84943:function(e,t,n){!function(e){"use strict";e.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}(n(90421))},48231:function(e,t,n){!function(e){"use strict";e.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(n(90421))},27822:function(e,t,n){!function(e){"use strict";e.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/ || || |/,meridiemHour:function(e,t){return 12===e&&(e=0)," "===t||""===t||" "===t?e:" "===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var r=100*e+t;return r<600?" ":r<900?"":r<1130?" ":r<1230?"":r<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-|-|-)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"-";case"w":case"W":return e+"-";default:return e}},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:7}})}(n(90421))},17263:function(e,t,n){!function(e){"use strict";function t(e,t,n){return"m"===n?t?"":"":"h"===n?t?"":"":e+" "+(r=+e,o={ss:t?"__":"__",mm:t?"__":"__",hh:t?"__":"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),r%10==1&&r%100!=11?o[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?o[1]:o[2]);var r,o}function n(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}e.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:function(e,t){var n={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return!0===e?n.nominative.slice(1,7).concat(n.nominative.slice(0,1)):e?n[/(\[[]\]) ?dddd/.test(t)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(t)?"genitive":"nominative"][e.day()]:n.nominative},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:n("[ "),nextDay:n("[ "),lastDay:n("[ "),nextWeek:n("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return n("[] dddd [").call(this);case 1:case 2:case 4:return n("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:t,m:t,mm:t,h:"",hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})}(n(90421))},71769:function(e,t,n){!function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("ur",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})}(n(90421))},24725:function(e,t,n){!function(e){"use strict";e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}})}(n(90421))},29736:function(e,t,n){!function(e){"use strict";e.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})}(n(90421))},9562:function(e,t,n){!function(e){"use strict";e.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"sa":"SA":n?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})}(n(90421))},7219:function(e,t,n){!function(e){"use strict";e.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(90421))},76195:function(e,t,n){!function(e){"use strict";e.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}})}(n(90421))},37289:function(e,t,n){!function(e){"use strict";e.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}})}(n(90421))},51589:function(e,t,n){!function(e){"use strict";e.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(90421))},23384:function(e,t,n){!function(e){"use strict";e.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var r=100*e+t;return r<600?"":r<900?"":r<1130?"":r<1230?"":r<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(90421))},90421:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,r;function o(){return t.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function l(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function c(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var n in t)f(t,n)&&(e[n]=t[n]);return f(t,"toString")&&(e.toString=t.toString),f(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,n,r){return kt(e,t,n,r,!0).utc()}function p(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function m(e){if(null==e._isValid){var t=p(e),n=r.call(t.parsedDateParts,(function(e){return null!=e})),o=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return o;e._isValid=o}return e._isValid}function y(e){var t=d(NaN);return null!=e?h(p(t),e):p(t).userInvalidated=!0,t}r=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var v=o.momentProperties=[];function g(e,t){var n,r,o;if(s(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),s(t._i)||(e._i=t._i),s(t._f)||(e._f=t._f),s(t._l)||(e._l=t._l),s(t._strict)||(e._strict=t._strict),s(t._tzm)||(e._tzm=t._tzm),s(t._isUTC)||(e._isUTC=t._isUTC),s(t._offset)||(e._offset=t._offset),s(t._pf)||(e._pf=p(t)),s(t._locale)||(e._locale=t._locale),v.length>0)for(n=0;n<v.length;n++)s(o=t[r=v[n]])||(e[r]=o);return e}var b=!1;function w(e){g(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===b&&(b=!0,o.updateOffset(this),b=!1)}function _(e){return e instanceof w||null!=e&&null!=e._isAMomentObject}function S(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function E(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=S(t)),n}function k(e,t,n){var r,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(r=0;r<o;r++)(n&&e[r]!==t[r]||!n&&E(e[r])!==E(t[r]))&&a++;return a+i}function R(e){!1===o.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function T(e,t){var n=!0;return h((function(){if(null!=o.deprecationHandler&&o.deprecationHandler(null,e),n){for(var r,i=[],a=0;a<arguments.length;a++){if(r="","object"==typeof arguments[a]){for(var s in r+="\n["+a+"] ",arguments[0])r+=s+": "+arguments[0][s]+", ";r=r.slice(0,-2)}else r=arguments[a];i.push(r)}R(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var C,M={};function O(e,t){null!=o.deprecationHandler&&o.deprecationHandler(e,t),M[e]||(R(t),M[e]=!0)}function A(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function L(e,t){var n,r=h({},e);for(n in t)f(t,n)&&(a(e[n])&&a(t[n])?(r[n]={},h(r[n],e[n]),h(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)f(e,n)&&!f(t,n)&&a(e[n])&&(r[n]=h({},r[n]));return r}function x(e){null!=e&&this.set(e)}o.suppressDeprecationWarnings=!1,o.deprecationHandler=null,C=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)f(e,t)&&n.push(t);return n};var N={};function I(e,t){var n=e.toLowerCase();N[n]=N[n+"s"]=N[t]=e}function D(e){return"string"==typeof e?N[e]||N[e.toLowerCase()]:void 0}function P(e){var t,n,r={};for(n in e)f(e,n)&&(t=D(n))&&(r[t]=e[n]);return r}var H={};function j(e,t){H[e]=t}function F(e,t,n){var r=""+Math.abs(e),o=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}var Y=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,U=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,B={},V={};function W(e,t,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),e&&(V[e]=o),t&&(V[t[0]]=function(){return F(o.apply(this,arguments),t[1],t[2])}),n&&(V[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function z(e,t){return e.isValid()?(t=G(t,e.localeData()),B[t]=B[t]||function(e){var t,n,r,o=e.match(Y);for(t=0,n=o.length;t<n;t++)V[o[t]]?o[t]=V[o[t]]:o[t]=(r=o[t]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(t){var r,i="";for(r=0;r<n;r++)i+=A(o[r])?o[r].call(t,e):o[r];return i}}(t),B[t](e)):e.localeData().invalidDate()}function G(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(U.lastIndex=0;n>=0&&U.test(e);)e=e.replace(U,r),U.lastIndex=0,n-=1;return e}var K=/\d/,X=/\d\d/,$=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,Q=/\d\d?/,Z=/\d\d\d\d?/,ee=/\d\d\d\d\d\d?/,te=/\d{1,3}/,ne=/\d{1,4}/,re=/[+-]?\d{1,6}/,oe=/\d+/,ie=/[+-]?\d+/,ae=/Z|[+-]\d\d:?\d\d/gi,se=/Z|[+-]\d\d(?::?\d\d)?/gi,ue=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,le={};function ce(e,t,n){le[e]=A(t)?t:function(e,r){return e&&n?n:t}}function fe(e,t){return f(le,e)?le[e](t._strict,t._locale):new RegExp(he(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,o){return t||n||r||o}))))}function he(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var de={};function pe(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),u(t)&&(r=function(e,n){n[t]=E(e)}),n=0;n<e.length;n++)de[e[n]]=r}function me(e,t){pe(e,(function(e,n,r,o){r._w=r._w||{},t(e,r._w,r,o)}))}function ye(e,t,n){null!=t&&f(de,e)&&de[e](t,n._a,n,e)}function ve(e){return ge(e)?366:365}function ge(e){return e%4==0&&e%100!=0||e%400==0}W("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),W(0,["YY",2],0,(function(){return this.year()%100})),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),I("year","y"),j("year",1),ce("Y",ie),ce("YY",Q,X),ce("YYYY",ne,q),ce("YYYYY",re,J),ce("YYYYYY",re,J),pe(["YYYYY","YYYYYY"],0),pe("YYYY",(function(e,t){t[0]=2===e.length?o.parseTwoDigitYear(e):E(e)})),pe("YY",(function(e,t){t[0]=o.parseTwoDigitYear(e)})),pe("Y",(function(e,t){t[0]=parseInt(e,10)})),o.parseTwoDigitYear=function(e){return E(e)+(E(e)>68?1900:2e3)};var be,we=_e("FullYear",!0);function _e(e,t){return function(n){return null!=n?(Ee(this,e,n),o.updateOffset(this,t),this):Se(this,e)}}function Se(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ee(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ge(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),ke(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function ke(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,r=(t%(n=12)+n)%n;return e+=(t-r)/12,1===r?ge(e)?29:28:31-r%7%2}be=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},W("M",["MM",2],"Mo",(function(){return this.month()+1})),W("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),W("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),I("month","M"),j("month",8),ce("M",Q),ce("MM",Q,X),ce("MMM",(function(e,t){return t.monthsShortRegex(e)})),ce("MMMM",(function(e,t){return t.monthsRegex(e)})),pe(["M","MM"],(function(e,t){t[1]=E(e)-1})),pe(["MMM","MMMM"],(function(e,t,n,r){var o=n._locale.monthsParse(e,r,n._strict);null!=o?t[1]=o:p(n).invalidMonth=e}));var Re=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Te="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Ce="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Me(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=d([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(o=be.call(this._shortMonthsParse,a))?o:null:-1!==(o=be.call(this._longMonthsParse,a))?o:null:"MMM"===t?-1!==(o=be.call(this._shortMonthsParse,a))||-1!==(o=be.call(this._longMonthsParse,a))?o:null:-1!==(o=be.call(this._longMonthsParse,a))||-1!==(o=be.call(this._shortMonthsParse,a))?o:null}function Oe(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=E(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),ke(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Ae(e){return null!=e?(Oe(this,e),o.updateOffset(this,!0),this):Se(this,"Month")}var Le=ue;var xe=ue;function Ne(){function e(e,t){return t.length-e.length}var t,n,r=[],o=[],i=[];for(t=0;t<12;t++)n=d([2e3,t]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)r[t]=he(r[t]),o[t]=he(o[t]);for(t=0;t<24;t++)i[t]=he(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Ie(e,t,n,r,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,n,r,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,r,o,i,a),s}function De(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Pe(e,t,n){var r=7+t-n;return-(7+De(e,0,r).getUTCDay()-t)%7+r-1}function He(e,t,n,r,o){var i,a,s=1+7*(t-1)+(7+n-r)%7+Pe(e,r,o);return s<=0?a=ve(i=e-1)+s:s>ve(e)?(i=e+1,a=s-ve(e)):(i=e,a=s),{year:i,dayOfYear:a}}function je(e,t,n){var r,o,i=Pe(e.year(),t,n),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?r=a+Fe(o=e.year()-1,t,n):a>Fe(e.year(),t,n)?(r=a-Fe(e.year(),t,n),o=e.year()+1):(o=e.year(),r=a),{week:r,year:o}}function Fe(e,t,n){var r=Pe(e,t,n),o=Pe(e+1,t,n);return(ve(e)-r+o)/7}W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),I("week","w"),I("isoWeek","W"),j("week",5),j("isoWeek",5),ce("w",Q),ce("ww",Q,X),ce("W",Q),ce("WW",Q,X),me(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=E(e)}));function Ye(e,t){return e.slice(t,7).concat(e.slice(0,t))}W("d",0,"do","day"),W("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),W("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),W("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),I("day","d"),I("weekday","e"),I("isoWeekday","E"),j("day",11),j("weekday",11),j("isoWeekday",11),ce("d",Q),ce("e",Q),ce("E",Q),ce("dd",(function(e,t){return t.weekdaysMinRegex(e)})),ce("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),ce("dddd",(function(e,t){return t.weekdaysRegex(e)})),me(["dd","ddd","dddd"],(function(e,t,n,r){var o=n._locale.weekdaysParse(e,r,n._strict);null!=o?t.d=o:p(n).invalidWeekday=e})),me(["d","e","E"],(function(e,t,n,r){t[r]=E(e)}));var Ue="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Be="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var Ve="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function We(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=d([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(o=be.call(this._weekdaysParse,a))?o:null:"ddd"===t?-1!==(o=be.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=be.call(this._minWeekdaysParse,a))?o:null:"dddd"===t?-1!==(o=be.call(this._weekdaysParse,a))||-1!==(o=be.call(this._shortWeekdaysParse,a))||-1!==(o=be.call(this._minWeekdaysParse,a))?o:null:"ddd"===t?-1!==(o=be.call(this._shortWeekdaysParse,a))||-1!==(o=be.call(this._weekdaysParse,a))||-1!==(o=be.call(this._minWeekdaysParse,a))?o:null:-1!==(o=be.call(this._minWeekdaysParse,a))||-1!==(o=be.call(this._weekdaysParse,a))||-1!==(o=be.call(this._shortWeekdaysParse,a))?o:null}var ze=ue;var Ge=ue;var Ke=ue;function Xe(){function e(e,t){return t.length-e.length}var t,n,r,o,i,a=[],s=[],u=[],l=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),a.push(r),s.push(o),u.push(i),l.push(r),l.push(o),l.push(i);for(a.sort(e),s.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)s[t]=he(s[t]),u[t]=he(u[t]),l[t]=he(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function $e(){return this.hours()%12||12}function qe(e,t){W(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Je(e,t){return t._meridiemParse}W("H",["HH",2],0,"hour"),W("h",["hh",2],0,$e),W("k",["kk",2],0,(function(){return this.hours()||24})),W("hmm",0,0,(function(){return""+$e.apply(this)+F(this.minutes(),2)})),W("hmmss",0,0,(function(){return""+$e.apply(this)+F(this.minutes(),2)+F(this.seconds(),2)})),W("Hmm",0,0,(function(){return""+this.hours()+F(this.minutes(),2)})),W("Hmmss",0,0,(function(){return""+this.hours()+F(this.minutes(),2)+F(this.seconds(),2)})),qe("a",!0),qe("A",!1),I("hour","h"),j("hour",13),ce("a",Je),ce("A",Je),ce("H",Q),ce("h",Q),ce("k",Q),ce("HH",Q,X),ce("hh",Q,X),ce("kk",Q,X),ce("hmm",Z),ce("hmmss",ee),ce("Hmm",Z),ce("Hmmss",ee),pe(["H","HH"],3),pe(["k","kk"],(function(e,t,n){var r=E(e);t[3]=24===r?0:r})),pe(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),pe(["h","hh"],(function(e,t,n){t[3]=E(e),p(n).bigHour=!0})),pe("hmm",(function(e,t,n){var r=e.length-2;t[3]=E(e.substr(0,r)),t[4]=E(e.substr(r)),p(n).bigHour=!0})),pe("hmmss",(function(e,t,n){var r=e.length-4,o=e.length-2;t[3]=E(e.substr(0,r)),t[4]=E(e.substr(r,2)),t[5]=E(e.substr(o)),p(n).bigHour=!0})),pe("Hmm",(function(e,t,n){var r=e.length-2;t[3]=E(e.substr(0,r)),t[4]=E(e.substr(r))})),pe("Hmmss",(function(e,t,n){var r=e.length-4,o=e.length-2;t[3]=E(e.substr(0,r)),t[4]=E(e.substr(r,2)),t[5]=E(e.substr(o))}));var Qe,Ze=_e("Hours",!0),et={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Te,monthsShort:Ce,week:{dow:0,doy:6},weekdays:Ue,weekdaysMin:Ve,weekdaysShort:Be,meridiemParse:/[ap]\.?m?\.?/i},tt={},nt={};function rt(e){return e?e.toLowerCase().replace("_","-"):e}function ot(t){var r=null;if(!tt[t]&&e&&e.exports)try{r=Qe._abbr,n(46700)("./"+t),it(r)}catch(e){}return tt[t]}function it(e,t){var n;return e&&((n=s(t)?st(e):at(e,t))?Qe=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Qe._abbr}function at(e,t){if(null!==t){var n,r=et;if(t.abbr=e,null!=tt[e])O("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=tt[e]._config;else if(null!=t.parentLocale)if(null!=tt[t.parentLocale])r=tt[t.parentLocale]._config;else{if(null==(n=ot(t.parentLocale)))return nt[t.parentLocale]||(nt[t.parentLocale]=[]),nt[t.parentLocale].push({name:e,config:t}),null;r=n._config}return tt[e]=new x(L(r,t)),nt[e]&&nt[e].forEach((function(e){at(e.name,e.config)})),it(e),tt[e]}return delete tt[e],null}function st(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Qe;if(!i(e)){if(t=ot(e))return t;e=[e]}return function(e){for(var t,n,r,o,i=0;i<e.length;){for(t=(o=rt(e[i]).split("-")).length,n=(n=rt(e[i+1]))?n.split("-"):null;t>0;){if(r=ot(o.slice(0,t).join("-")))return r;if(n&&n.length>=t&&k(o,n,!0)>=t-1)break;t--}i++}return Qe}(e)}function ut(e){var t,n=e._a;return n&&-2===p(e).overflow&&(t=n[1]<0||n[1]>11?1:n[2]<1||n[2]>ke(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,p(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),p(e)._overflowWeeks&&-1===t&&(t=7),p(e)._overflowWeekday&&-1===t&&(t=8),p(e).overflow=t),e}function lt(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var t,n,r,i,a,s=[];if(!e._d){for(r=function(e){var t=new Date(o.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,n,r,o,i,a,s,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)i=1,a=4,n=lt(t.GG,e._a[0],je(Rt(),1,4).year),r=lt(t.W,1),((o=lt(t.E,1))<1||o>7)&&(u=!0);else{i=e._locale._week.dow,a=e._locale._week.doy;var l=je(Rt(),i,a);n=lt(t.gg,e._a[0],l.year),r=lt(t.w,l.week),null!=t.d?((o=t.d)<0||o>6)&&(u=!0):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(u=!0)):o=i}r<1||r>Fe(n,i,a)?p(e)._overflowWeeks=!0:null!=u?p(e)._overflowWeekday=!0:(s=He(n,r,o,i,a),e._a[0]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(a=lt(e._a[0],r[0]),(e._dayOfYear>ve(a)||0===e._dayOfYear)&&(p(e)._overflowDayOfYear=!0),n=De(a,0,e._dayOfYear),e._a[1]=n.getUTCMonth(),e._a[2]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?De:Ie).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(p(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ht=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dt=/Z|[+-]\d\d(?::?\d\d)?/,pt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],mt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],yt=/^\/?Date\((\-?\d+)/i;function vt(e){var t,n,r,o,i,a,s=e._i,u=ft.exec(s)||ht.exec(s);if(u){for(p(e).iso=!0,t=0,n=pt.length;t<n;t++)if(pt[t][1].exec(u[1])){o=pt[t][0],r=!1!==pt[t][2];break}if(null==o)return void(e._isValid=!1);if(u[3]){for(t=0,n=mt.length;t<n;t++)if(mt[t][1].exec(u[3])){i=(u[2]||" ")+mt[t][0];break}if(null==i)return void(e._isValid=!1)}if(!r&&null!=i)return void(e._isValid=!1);if(u[4]){if(!dt.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=o+(i||"")+(a||""),St(e)}else e._isValid=!1}var gt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function bt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}var wt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function _t(e){var t,n,r,o,i,a,s,u=gt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){var l=(t=u[4],n=u[3],r=u[2],o=u[5],i=u[6],a=u[7],s=[bt(t),Ce.indexOf(n),parseInt(r,10),parseInt(o,10),parseInt(i,10)],a&&s.push(parseInt(a,10)),s);if(!function(e,t,n){return!e||Be.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(p(n).weekdayMismatch=!0,n._isValid=!1,!1)}(u[1],l,e))return;e._a=l,e._tzm=function(e,t,n){if(e)return wt[e];if(t)return 0;var r=parseInt(n,10),o=r%100;return(r-o)/100*60+o}(u[8],u[9],u[10]),e._d=De.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),p(e).rfc2822=!0}else e._isValid=!1}function St(e){if(e._f!==o.ISO_8601)if(e._f!==o.RFC_2822){e._a=[],p(e).empty=!0;var t,n,r,i,a,s=""+e._i,u=s.length,l=0;for(r=G(e._f,e._locale).match(Y)||[],t=0;t<r.length;t++)i=r[t],(n=(s.match(fe(i,e))||[])[0])&&((a=s.substr(0,s.indexOf(n))).length>0&&p(e).unusedInput.push(a),s=s.slice(s.indexOf(n)+n.length),l+=n.length),V[i]?(n?p(e).empty=!1:p(e).unusedTokens.push(i),ye(i,n,e)):e._strict&&!n&&p(e).unusedTokens.push(i);p(e).charsLeftOver=u-l,s.length>0&&p(e).unusedInput.push(s),e._a[3]<=12&&!0===p(e).bigHour&&e._a[3]>0&&(p(e).bigHour=void 0),p(e).parsedDateParts=e._a.slice(0),p(e).meridiem=e._meridiem,e._a[3]=function(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),ct(e),ut(e)}else _t(e);else vt(e)}function Et(e){var t=e._i,n=e._f;return e._locale=e._locale||st(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),_(t)?new w(ut(t)):(l(t)?e._d=t:i(n)?function(e){var t,n,r,o,i;if(0===e._f.length)return p(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)i=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],St(t),m(t)&&(i+=p(t).charsLeftOver,i+=10*p(t).unusedTokens.length,p(t).score=i,(null==r||i<r)&&(r=i,n=t));h(e,n||t)}(e):n?St(e):function(e){var t=e._i;s(t)?e._d=new Date(o.now()):l(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=yt.exec(e._i);null===t?(vt(e),!1===e._isValid&&(delete e._isValid,_t(e),!1===e._isValid&&(delete e._isValid,o.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):i(t)?(e._a=c(t.slice(0),(function(e){return parseInt(e,10)})),ct(e)):a(t)?function(e){if(!e._d){var t=P(e._i);e._a=c([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),ct(e)}}(e):u(t)?e._d=new Date(t):o.createFromInputFallback(e)}(e),m(e)||(e._d=null),e))}function kt(e,t,n,r,o){var s,u={};return!0!==n&&!1!==n||(r=n,n=void 0),(a(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||i(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=o,u._l=n,u._i=e,u._f=t,u._strict=r,(s=new w(ut(Et(u))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function Rt(e,t,n,r){return kt(e,t,n,r,!1)}o.createFromInputFallback=T("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),o.ISO_8601=function(){},o.RFC_2822=function(){};var Tt=T("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Rt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()})),Ct=T("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Rt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}));function Mt(e,t){var n,r;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Rt();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}var Ot=["year","quarter","month","week","day","hour","minute","second","millisecond"];function At(e){var t=P(e),n=t.year||0,r=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,u=t.minute||0,l=t.second||0,c=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===be.call(Ot,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<Ot.length;++r)if(e[Ot[r]]){if(n)return!1;parseFloat(e[Ot[r]])!==E(e[Ot[r]])&&(n=!0)}return!0}(t),this._milliseconds=+c+1e3*l+6e4*u+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=st(),this._bubble()}function Lt(e){return e instanceof At}function xt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Nt(e,t){W(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+F(~~(e/60),2)+t+F(~~e%60,2)}))}Nt("Z",":"),Nt("ZZ",""),ce("Z",se),ce("ZZ",se),pe(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=Dt(se,e)}));var It=/([\+\-]|\d\d)/gi;function Dt(e,t){var n=(t||"").match(e);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(It)||["-",0,0],o=60*r[1]+E(r[2]);return 0===o?0:"+"===r[0]?o:-o}function Pt(e,t){var n,r;return t._isUTC?(n=t.clone(),r=(_(e)||l(e)?e.valueOf():Rt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),o.updateOffset(n,!1),n):Rt(e).local()}function Ht(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function jt(){return!!this.isValid()&&this._isUTC&&0===this._offset}o.updateOffset=function(){};var Ft=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Yt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ut(e,t){var n,r,o,i,a,s,l=e,c=null;return Lt(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:u(e)?(l={},t?l[t]=e:l.milliseconds=e):(c=Ft.exec(e))?(n="-"===c[1]?-1:1,l={y:0,d:E(c[2])*n,h:E(c[3])*n,m:E(c[4])*n,s:E(c[5])*n,ms:E(xt(1e3*c[6]))*n}):(c=Yt.exec(e))?(n="-"===c[1]?-1:1,l={y:Bt(c[2],n),M:Bt(c[3],n),w:Bt(c[4],n),d:Bt(c[5],n),h:Bt(c[6],n),m:Bt(c[7],n),s:Bt(c[8],n)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(i=Rt(l.from),a=Rt(l.to),o=i.isValid()&&a.isValid()?(a=Pt(a,i),i.isBefore(a)?s=Vt(i,a):((s=Vt(a,i)).milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0},(l={}).ms=o.milliseconds,l.M=o.months),r=new At(l),Lt(e)&&f(e,"_locale")&&(r._locale=e._locale),r}function Bt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Vt(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Wt(e,t){return function(n,r){var o;return null===r||isNaN(+r)||(O(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),zt(this,Ut(n="string"==typeof n?+n:n,r),e),this}}function zt(e,t,n,r){var i=t._milliseconds,a=xt(t._days),s=xt(t._months);e.isValid()&&(r=null==r||r,s&&Oe(e,Se(e,"Month")+s*n),a&&Ee(e,"Date",Se(e,"Date")+a*n),i&&e._d.setTime(e._d.valueOf()+i*n),r&&o.updateOffset(e,a||s))}Ut.fn=At.prototype,Ut.invalid=function(){return Ut(NaN)};var Gt=Wt(1,"add"),Kt=Wt(-1,"subtract");function Xt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function $t(e){var t;return void 0===e?this._locale._abbr:(null!=(t=st(e))&&(this._locale=t),this)}o.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",o.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var qt=T("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function Jt(){return this._locale}var Qt=1e3,Zt=6e4,en=36e5,tn=126227808e5;function nn(e,t){return(e%t+t)%t}function rn(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-tn:new Date(e,t,n).valueOf()}function on(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-tn:Date.UTC(e,t,n)}function an(e,t){W(0,[e,e.length],0,t)}function sn(e,t,n,r,o){var i;return null==e?je(this,r,o).year:(t>(i=Fe(e,r,o))&&(t=i),un.call(this,e,t,n,r,o))}function un(e,t,n,r,o){var i=He(e,t,n,r,o),a=De(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}W(0,["gg",2],0,(function(){return this.weekYear()%100})),W(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),an("gggg","weekYear"),an("ggggg","weekYear"),an("GGGG","isoWeekYear"),an("GGGGG","isoWeekYear"),I("weekYear","gg"),I("isoWeekYear","GG"),j("weekYear",1),j("isoWeekYear",1),ce("G",ie),ce("g",ie),ce("GG",Q,X),ce("gg",Q,X),ce("GGGG",ne,q),ce("gggg",ne,q),ce("GGGGG",re,J),ce("ggggg",re,J),me(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=E(e)})),me(["gg","GG"],(function(e,t,n,r){t[r]=o.parseTwoDigitYear(e)})),W("Q",0,"Qo","quarter"),I("quarter","Q"),j("quarter",7),ce("Q",K),pe("Q",(function(e,t){t[1]=3*(E(e)-1)})),W("D",["DD",2],"Do","date"),I("date","D"),j("date",9),ce("D",Q),ce("DD",Q,X),ce("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),pe(["D","DD"],2),pe("Do",(function(e,t){t[2]=E(e.match(Q)[0])}));var ln=_e("Date",!0);W("DDD",["DDDD",3],"DDDo","dayOfYear"),I("dayOfYear","DDD"),j("dayOfYear",4),ce("DDD",te),ce("DDDD",$),pe(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=E(e)})),W("m",["mm",2],0,"minute"),I("minute","m"),j("minute",14),ce("m",Q),ce("mm",Q,X),pe(["m","mm"],4);var cn=_e("Minutes",!1);W("s",["ss",2],0,"second"),I("second","s"),j("second",15),ce("s",Q),ce("ss",Q,X),pe(["s","ss"],5);var fn,hn=_e("Seconds",!1);for(W("S",0,0,(function(){return~~(this.millisecond()/100)})),W(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),W(0,["SSS",3],0,"millisecond"),W(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),W(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),W(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),W(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),W(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),W(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),I("millisecond","ms"),j("millisecond",16),ce("S",te,K),ce("SS",te,X),ce("SSS",te,$),fn="SSSS";fn.length<=9;fn+="S")ce(fn,oe);function dn(e,t){t[6]=E(1e3*("0."+e))}for(fn="S";fn.length<=9;fn+="S")pe(fn,dn);var pn=_e("Milliseconds",!1);W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");var mn=w.prototype;function yn(e){return e}mn.add=Gt,mn.calendar=function(e,t){var n=e||Rt(),r=Pt(n,this).startOf("day"),i=o.calendarFormat(this,r)||"sameElse",a=t&&(A(t[i])?t[i].call(this,n):t[i]);return this.format(a||this.localeData().calendar(i,this,Rt(n)))},mn.clone=function(){return new w(this)},mn.diff=function(e,t,n){var r,o,i;if(!this.isValid())return NaN;if(!(r=Pt(e,this)).isValid())return NaN;switch(o=6e4*(r.utcOffset()-this.utcOffset()),t=D(t)){case"year":i=Xt(this,r)/12;break;case"month":i=Xt(this,r);break;case"quarter":i=Xt(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-o)/864e5;break;case"week":i=(this-r-o)/6048e5;break;default:i=this-r}return n?i:S(i)},mn.endOf=function(e){var t;if(void 0===(e=D(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?on:rn;switch(e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=en-nn(t+(this._isUTC?0:this.utcOffset()*Zt),en)-1;break;case"minute":t=this._d.valueOf(),t+=Zt-nn(t,Zt)-1;break;case"second":t=this._d.valueOf(),t+=Qt-nn(t,Qt)-1}return this._d.setTime(t),o.updateOffset(this,!0),this},mn.format=function(e){e||(e=this.isUtc()?o.defaultFormatUtc:o.defaultFormat);var t=z(this,e);return this.localeData().postformat(t)},mn.from=function(e,t){return this.isValid()&&(_(e)&&e.isValid()||Rt(e).isValid())?Ut({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},mn.fromNow=function(e){return this.from(Rt(),e)},mn.to=function(e,t){return this.isValid()&&(_(e)&&e.isValid()||Rt(e).isValid())?Ut({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},mn.toNow=function(e){return this.to(Rt(),e)},mn.get=function(e){return A(this[e=D(e)])?this[e]():this},mn.invalidAt=function(){return p(this).overflow},mn.isAfter=function(e,t){var n=_(e)?e:Rt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=D(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},mn.isBefore=function(e,t){var n=_(e)?e:Rt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=D(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},mn.isBetween=function(e,t,n,r){var o=_(e)?e:Rt(e),i=_(t)?t:Rt(t);return!!(this.isValid()&&o.isValid()&&i.isValid())&&("("===(r=r||"()")[0]?this.isAfter(o,n):!this.isBefore(o,n))&&(")"===r[1]?this.isBefore(i,n):!this.isAfter(i,n))},mn.isSame=function(e,t){var n,r=_(e)?e:Rt(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=D(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},mn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},mn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},mn.isValid=function(){return m(this)},mn.lang=qt,mn.locale=$t,mn.localeData=Jt,mn.max=Ct,mn.min=Tt,mn.parsingFlags=function(){return h({},p(this))},mn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:H[n]});return t.sort((function(e,t){return e.priority-t.priority})),t}(e=P(e)),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit]);else if(A(this[e=D(e)]))return this[e](t);return this},mn.startOf=function(e){var t;if(void 0===(e=D(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?on:rn;switch(e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=nn(t+(this._isUTC?0:this.utcOffset()*Zt),en);break;case"minute":t=this._d.valueOf(),t-=nn(t,Zt);break;case"second":t=this._d.valueOf(),t-=nn(t,Qt)}return this._d.setTime(t),o.updateOffset(this,!0),this},mn.subtract=Kt,mn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},mn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},mn.toDate=function(){return new Date(this.valueOf())},mn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?z(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):A(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",z(n,"Z")):z(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},mn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=t+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)},mn.toJSON=function(){return this.isValid()?this.toISOString():null},mn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},mn.unix=function(){return Math.floor(this.valueOf()/1e3)},mn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},mn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},mn.year=we,mn.isLeapYear=function(){return ge(this.year())},mn.weekYear=function(e){return sn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},mn.isoWeekYear=function(e){return sn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},mn.quarter=mn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},mn.month=Ae,mn.daysInMonth=function(){return ke(this.year(),this.month())},mn.week=mn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},mn.isoWeek=mn.isoWeeks=function(e){var t=je(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},mn.weeksInYear=function(){var e=this.localeData()._week;return Fe(this.year(),e.dow,e.doy)},mn.isoWeeksInYear=function(){return Fe(this.year(),1,4)},mn.date=ln,mn.day=mn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},mn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},mn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},mn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},mn.hour=mn.hours=Ze,mn.minute=mn.minutes=cn,mn.second=mn.seconds=hn,mn.millisecond=mn.milliseconds=pn,mn.utcOffset=function(e,t,n){var r,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Dt(se,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=Ht(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?zt(this,Ut(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,o.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Ht(this)},mn.utc=function(e){return this.utcOffset(0,e)},mn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ht(this),"m")),this},mn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Dt(ae,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},mn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Rt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},mn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},mn.isLocal=function(){return!!this.isValid()&&!this._isUTC},mn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},mn.isUtc=jt,mn.isUTC=jt,mn.zoneAbbr=function(){return this._isUTC?"UTC":""},mn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},mn.dates=T("dates accessor is deprecated. Use date instead.",ln),mn.months=T("months accessor is deprecated. Use month instead",Ae),mn.years=T("years accessor is deprecated. Use year instead",we),mn.zone=T("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),mn.isDSTShifted=T("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!s(this._isDSTShifted))return this._isDSTShifted;var e={};if(g(e,this),(e=Et(e))._a){var t=e._isUTC?d(e._a):Rt(e._a);this._isDSTShifted=this.isValid()&&k(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var vn=x.prototype;function gn(e,t,n,r){var o=st(),i=d().set(r,t);return o[n](i,e)}function bn(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return gn(e,t,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=gn(e,r,n,"month");return o}function wn(e,t,n,r){"boolean"==typeof e?(u(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,u(t)&&(n=t,t=void 0),t=t||"");var o,i=st(),a=e?i._week.dow:0;if(null!=n)return gn(t,(n+a)%7,r,"day");var s=[];for(o=0;o<7;o++)s[o]=gn(t,(o+a)%7,r,"day");return s}vn.calendar=function(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return A(r)?r.call(t,n):r},vn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])},vn.invalidDate=function(){return this._invalidDate},vn.ordinal=function(e){return this._ordinal.replace("%d",e)},vn.preparse=yn,vn.postformat=yn,vn.relativeTime=function(e,t,n,r){var o=this._relativeTime[n];return A(o)?o(e,t,n,r):o.replace(/%d/i,e)},vn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return A(n)?n(t):n.replace(/%s/i,t)},vn.set=function(e){var t,n;for(n in e)A(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},vn.months=function(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Re).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone},vn.monthsShort=function(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Re.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},vn.monthsParse=function(e,t,n){var r,o,i;if(this._monthsParseExact)return Me.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=d([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},vn.monthsRegex=function(e){return this._monthsParseExact?(f(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(f(this,"_monthsRegex")||(this._monthsRegex=xe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},vn.monthsShortRegex=function(e){return this._monthsParseExact?(f(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(f(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},vn.week=function(e){return je(e,this._week.dow,this._week.doy).week},vn.firstDayOfYear=function(){return this._week.doy},vn.firstDayOfWeek=function(){return this._week.dow},vn.weekdays=function(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ye(n,this._week.dow):e?n[e.day()]:n},vn.weekdaysMin=function(e){return!0===e?Ye(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},vn.weekdaysShort=function(e){return!0===e?Ye(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},vn.weekdaysParse=function(e,t,n){var r,o,i;if(this._weekdaysParseExact)return We.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=d([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}},vn.weekdaysRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(f(this,"_weekdaysRegex")||(this._weekdaysRegex=ze),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},vn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(f(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ge),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},vn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(f(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ke),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},vn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},vn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},it("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===E(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),o.lang=T("moment.lang is deprecated. Use moment.locale instead.",it),o.langData=T("moment.langData is deprecated. Use moment.localeData instead.",st);var _n=Math.abs;function Sn(e,t,n,r){var o=Ut(t,n);return e._milliseconds+=r*o._milliseconds,e._days+=r*o._days,e._months+=r*o._months,e._bubble()}function En(e){return e<0?Math.floor(e):Math.ceil(e)}function kn(e){return 4800*e/146097}function Rn(e){return 146097*e/4800}function Tn(e){return function(){return this.as(e)}}var Cn=Tn("ms"),Mn=Tn("s"),On=Tn("m"),An=Tn("h"),Ln=Tn("d"),xn=Tn("w"),Nn=Tn("M"),In=Tn("Q"),Dn=Tn("y");function Pn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Hn=Pn("milliseconds"),jn=Pn("seconds"),Fn=Pn("minutes"),Yn=Pn("hours"),Un=Pn("days"),Bn=Pn("months"),Vn=Pn("years");var Wn=Math.round,zn={ss:44,s:45,m:45,h:22,d:26,M:11};function Gn(e,t,n,r,o){return o.relativeTime(t||1,!!n,e,r)}var Kn=Math.abs;function Xn(e){return(e>0)-(e<0)||+e}function $n(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Kn(this._milliseconds)/1e3,r=Kn(this._days),o=Kn(this._months);e=S(n/60),t=S(e/60),n%=60,e%=60;var i=S(o/12),a=o%=12,s=r,u=t,l=e,c=n?n.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var h=f<0?"-":"",d=Xn(this._months)!==Xn(f)?"-":"",p=Xn(this._days)!==Xn(f)?"-":"",m=Xn(this._milliseconds)!==Xn(f)?"-":"";return h+"P"+(i?d+i+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(u||l||c?"T":"")+(u?m+u+"H":"")+(l?m+l+"M":"")+(c?m+c+"S":"")}var qn=At.prototype;return qn.isValid=function(){return this._isValid},qn.abs=function(){var e=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),e.milliseconds=_n(e.milliseconds),e.seconds=_n(e.seconds),e.minutes=_n(e.minutes),e.hours=_n(e.hours),e.months=_n(e.months),e.years=_n(e.years),this},qn.add=function(e,t){return Sn(this,e,t,1)},qn.subtract=function(e,t){return Sn(this,e,t,-1)},qn.as=function(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=D(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+kn(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Rn(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},qn.asMilliseconds=Cn,qn.asSeconds=Mn,qn.asMinutes=On,qn.asHours=An,qn.asDays=Ln,qn.asWeeks=xn,qn.asMonths=Nn,qn.asQuarters=In,qn.asYears=Dn,qn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*E(this._months/12):NaN},qn._bubble=function(){var e,t,n,r,o,i=this._milliseconds,a=this._days,s=this._months,u=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*En(Rn(s)+a),a=0,s=0),u.milliseconds=i%1e3,e=S(i/1e3),u.seconds=e%60,t=S(e/60),u.minutes=t%60,n=S(t/60),u.hours=n%24,a+=S(n/24),s+=o=S(kn(a)),a-=En(Rn(o)),r=S(s/12),s%=12,u.days=a,u.months=s,u.years=r,this},qn.clone=function(){return Ut(this)},qn.get=function(e){return e=D(e),this.isValid()?this[e+"s"]():NaN},qn.milliseconds=Hn,qn.seconds=jn,qn.minutes=Fn,qn.hours=Yn,qn.days=Un,qn.weeks=function(){return S(this.days()/7)},qn.months=Bn,qn.years=Vn,qn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var r=Ut(e).abs(),o=Wn(r.as("s")),i=Wn(r.as("m")),a=Wn(r.as("h")),s=Wn(r.as("d")),u=Wn(r.as("M")),l=Wn(r.as("y")),c=o<=zn.ss&&["s",o]||o<zn.s&&["ss",o]||i<=1&&["m"]||i<zn.m&&["mm",i]||a<=1&&["h"]||a<zn.h&&["hh",a]||s<=1&&["d"]||s<zn.d&&["dd",s]||u<=1&&["M"]||u<zn.M&&["MM",u]||l<=1&&["y"]||["yy",l];return c[2]=t,c[3]=+e>0,c[4]=n,Gn.apply(null,c)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},qn.toISOString=$n,qn.toString=$n,qn.toJSON=$n,qn.locale=$t,qn.localeData=Jt,qn.toIsoString=T("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$n),qn.lang=qt,W("X",0,0,"unix"),W("x",0,0,"valueOf"),ce("x",ie),ce("X",/[+-]?\d+(\.\d{1,3})?/),pe("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))})),pe("x",(function(e,t,n){n._d=new Date(E(e))})),o.version="2.24.0",t=Rt,o.fn=mn,o.min=function(){return Mt("isBefore",[].slice.call(arguments,0))},o.max=function(){return Mt("isAfter",[].slice.call(arguments,0))},o.now=function(){return Date.now?Date.now():+new Date},o.utc=d,o.unix=function(e){return Rt(1e3*e)},o.months=function(e,t){return bn(e,t,"months")},o.isDate=l,o.locale=it,o.invalid=y,o.duration=Ut,o.isMoment=_,o.weekdays=function(e,t,n){return wn(e,t,n,"weekdays")},o.parseZone=function(){return Rt.apply(null,arguments).parseZone()},o.localeData=st,o.isDuration=Lt,o.monthsShort=function(e,t){return bn(e,t,"monthsShort")},o.weekdaysMin=function(e,t,n){return wn(e,t,n,"weekdaysMin")},o.defineLocale=at,o.updateLocale=function(e,t){if(null!=t){var n,r,o=et;null!=(r=ot(e))&&(o=r._config),(n=new x(t=L(o,t))).parentLocale=tt[e],tt[e]=n,it(e)}else null!=tt[e]&&(null!=tt[e].parentLocale?tt[e]=tt[e].parentLocale:null!=tt[e]&&delete tt[e]);return tt[e]},o.locales=function(){return C(tt)},o.weekdaysShort=function(e,t,n){return wn(e,t,n,"weekdaysShort")},o.normalizeUnits=D,o.relativeTimeRounding=function(e){return void 0===e?Wn:"function"==typeof e&&(Wn=e,!0)},o.relativeTimeThreshold=function(e,t){return void 0!==zn[e]&&(void 0===t?zn[e]:(zn[e]=t,"s"===e&&(zn.ss=t-1),!0))},o.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},o.prototype=mn,o.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},o}()},8551:e=>{e.exports=function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){return o(t[a][1][e]||e)}),l,l.exports,e,t,n,r)}return n[a].exports}for(var i=void 0,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){!function(e){"use strict";var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,i=Math.floor,a="[BigNumber Error] ",s=a+"Number primitive has more than 15 significant digits: ",u=1e14,l=14,c=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(e){var t=0|e;return 0<e||e===t?t:t-1}function m(e){for(var t,n,r=1,o=e.length,i=e[0]+"";r<o;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);i+=t}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function y(e,t){var n,r,o=e.c,i=t.c,a=e.s,s=t.s,u=e.e,l=t.e;if(!a||!s)return null;if(n=o&&!o[0],r=i&&!i[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=u==l,!o||!i)return r?0:!o^n?1:-1;if(!r)return l<u^n?1:-1;for(s=(u=o.length)<(l=i.length)?u:l,a=0;a<s;a++)if(o[a]!=i[a])return o[a]>i[a]^n?1:-1;return u==l?0:l<u^n?1:-1}function v(e,t,n,r){if(e<t||n<e||e!==(e<0?o(e):i(e)))throw Error(a+(r||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function g(e){var t=e.c.length-1;return p(e.e/l)==t&&e.c[t]%2!=0}function b(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,n){var r,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(++t>(r=e.length)){for(o=n,t-=r;--t;o+=n);e+=o}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var n,_,S,E,k,R,T,C,M,O,A=V.prototype={constructor:V,toString:null,valueOf:null},L=new V(1),x=20,N=4,I=-7,D=21,P=-1e7,H=1e7,j=!1,F=1,Y=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz";function V(e,t){var n,o,a,u,f,h,d,p,m=this;if(!(m instanceof V))return new V(e,t);if(null==t){if(e instanceof V)return m.s=e.s,m.e=e.e,void(m.c=(e=e.c)?e.slice():e);if((h="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,f=e;10<=f;f/=10,u++);return m.e=u,void(m.c=[e])}p=String(e)}else{if(p=String(e),!r.test(p))return S(m,p,h);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}-1<(u=p.indexOf("."))&&(p=p.replace(".","")),0<(f=p.search(/e/i))?(u<0&&(u=f),u+=+p.slice(f+1),p=p.substring(0,f)):u<0&&(u=p.length)}else{if(v(t,2,B.length,"Base"),p=String(e),10==t)return K(m=new V(e instanceof V?e:p),x+m.e+1,N);if(h="number"==typeof e){if(0*e!=0)return S(m,p,h,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,V.DEBUG&&15<p.replace(/^0\.0*|\./,"").length)throw Error(s+e);h=!1}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=B.slice(0,t),u=f=0,d=p.length;f<d;f++)if(n.indexOf(o=p.charAt(f))<0){if("."==o){if(u<f){u=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,u=0;continue}return S(m,String(e),h,t)}-1<(u=(p=_(p,t,10,m.s)).indexOf("."))?p=p.replace(".",""):u=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&V.DEBUG&&15<d&&(c<e||e!==i(e)))throw Error(s+m.s*e);if(H<(u=u-f-1))m.c=m.e=null;else if(u<P)m.c=[m.e=0];else{if(m.e=u,m.c=[],f=(u+1)%l,u<0&&(f+=l),f<d){for(f&&m.c.push(+p.slice(0,f)),d-=l;f<d;)m.c.push(+p.slice(f,f+=l));p=p.slice(f),f=l-p.length}else f-=d;for(;f--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function W(e,t,n,r){var o,i,a,s,u;if(null==n?n=N:v(n,0,8),!e.c)return e.toString();if(o=e.c[0],a=e.e,null==t)u=m(e.c),u=1==r||2==r&&(a<=I||D<=a)?b(u,a):w(u,a,"0");else if(i=(e=K(new V(e),t,n)).e,s=(u=m(e.c)).length,1==r||2==r&&(t<=i||i<=I)){for(;s<t;u+="0",s++);u=b(u,i)}else if(t-=a,u=w(u,i,"0"),s<i+1){if(0<--t)for(u+=".";t--;u+="0");}else if(0<(t+=i-s))for(i+1==s&&(u+=".");t--;u+="0");return e.s<0&&o?"-"+u:u}function z(e,t){for(var n,r=1,o=new V(e[0]);r<e.length;r++){if(!(n=new V(e[r])).s){o=n;break}t.call(o,n)&&(o=n)}return o}function G(e,t,n){for(var r=1,o=t.length;!t[--o];t.pop());for(o=t[0];10<=o;o/=10,r++);return(n=r+n*l-1)>H?e.c=e.e=null:e.c=n<P?[e.e=0]:(e.e=n,t),e}function K(e,t,n,r){var a,s,c,h,d,p,m,y=e.c,v=f;if(y){e:{for(a=1,h=y[0];10<=h;h/=10,a++);if((s=t-a)<0)s+=l,c=t,m=(d=y[p=0])/v[a-c-1]%10|0;else if((p=o((s+1)/l))>=y.length){if(!r)break e;for(;y.length<=p;y.push(0));d=m=0,c=(s%=l)-l+(a=1)}else{for(d=h=y[p],a=1;10<=h;h/=10,a++);m=(c=(s%=l)-l+a)<0?0:d/v[a-c-1]%10|0}if(r=r||t<0||null!=y[p+1]||(c<0?d:d%v[a-c-1]),r=n<4?(m||r)&&(0==n||n==(e.s<0?3:2)):5<m||5==m&&(4==n||r||6==n&&(0<s?0<c?d/v[a-c]:0:y[p-1])%10&1||n==(e.s<0?8:7)),t<1||!y[0])return y.length=0,r?(t-=e.e+1,y[0]=v[(l-t%l)%l],e.e=-t||0):y[0]=e.e=0,e;if(0==s?(y.length=p,h=1,p--):(y.length=p+1,h=v[l-s],y[p]=0<c?i(d/v[a-c]%v[c])*h:0),r)for(;;){if(0==p){for(s=1,c=y[0];10<=c;c/=10,s++);for(c=y[0]+=h,h=1;10<=c;c/=10,h++);s!=h&&(e.e++,y[0]==u&&(y[0]=1));break}if(y[p]+=h,y[p]!=u)break;y[p--]=0,h=1}for(s=y.length;0===y[--s];y.pop());}e.e>H?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function X(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=I||D<=n?b(t,n):w(t,n,"0"),e.s<0?"-"+t:t)}return V.clone=e,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(v(n=e[t],0,d,t),x=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(v(n=e[t],0,8,t),N=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(v(n[0],-d,0,t),v(n[1],0,d,t),I=n[0],D=n[1]):(v(n,-d,d,t),I=-(D=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)v(n[0],-d,-1,t),v(n[1],1,d,t),P=n[0],H=n[1];else{if(v(n,-d,d,t),!n)throw Error(a+t+" cannot be zero: "+n);P=-(H=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(a+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!n,Error(a+"crypto unavailable");j=n}else j=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(v(n=e[t],0,9,t),F=n),e.hasOwnProperty(t="POW_PRECISION")&&(v(n=e[t],0,d,t),Y=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(a+t+" not an object: "+n);U=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(a+t+" invalid: "+n);B=n}}return{DECIMAL_PLACES:x,ROUNDING_MODE:N,EXPONENTIAL_AT:[I,D],RANGE:[P,H],CRYPTO:j,MODULO_MODE:F,POW_PRECISION:Y,FORMAT:U,ALPHABET:B}},V.isBigNumber=function(e){return e instanceof V||e&&!0===e._isBigNumber||!1},V.maximum=V.max=function(){return z(arguments,A.lt)},V.minimum=V.min=function(){return z(arguments,A.gt)},V.random=(E=9007199254740992,k=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,s,u,c=0,h=[],p=new V(L);if(null==e?e=x:v(e,0,d),s=o(e/l),j)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));c<s;)9e15<=(u=131072*t[c]+(t[c+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[c]=n[0],t[c+1]=n[1]):(h.push(u%1e14),c+=2);c=s/2}else{if(!crypto.randomBytes)throw j=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(s*=7);c<s;)9e15<=(u=281474976710656*(31&t[c])+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])?crypto.randomBytes(7).copy(t,c):(h.push(u%1e14),c+=7);c=s/7}if(!j)for(;c<s;)(u=k())<9e15&&(h[c++]=u%1e14);for(s=h[--c],e%=l,s&&e&&(u=f[l-e],h[c]=i(s/u)*u);0===h[c];h.pop(),c--);if(c<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=l);for(c=1,u=h[0];10<=u;u/=10,c++);c<l&&(r-=l-c)}return p.e=r,p.c=h,p}),V.sum=function(){for(var e=1,t=arguments,n=new V(t[0]);e<t.length;)n=n.plus(t[e++]);return n},_=function(){var e="0123456789";function t(e,t,n,r){for(var o,i,a=[0],s=0,u=e.length;s<u;){for(i=a.length;i--;a[i]*=t);for(a[0]+=r.indexOf(e.charAt(s++)),o=0;o<a.length;o++)a[o]>n-1&&(null==a[o+1]&&(a[o+1]=0),a[o+1]+=a[o]/n|0,a[o]%=n)}return a.reverse()}return function(r,o,i,a,s){var u,l,c,f,h,d,p,y,v=r.indexOf("."),g=x,b=N;for(0<=v&&(f=Y,Y=0,r=r.replace(".",""),d=(y=new V(o)).pow(r.length-v),Y=f,y.c=t(w(m(d.c),d.e,"0"),10,i,e),y.e=y.c.length),c=f=(p=t(r,o,i,s?(u=B,e):(u=e,B))).length;0==p[--f];p.pop());if(!p[0])return u.charAt(0);if(v<0?--c:(d.c=p,d.e=c,d.s=a,p=(d=n(d,y,g,b,i)).c,h=d.r,c=d.e),v=p[l=c+g+1],f=i/2,h=h||l<0||null!=p[l+1],h=b<4?(null!=v||h)&&(0==b||b==(d.s<0?3:2)):f<v||v==f&&(4==b||h||6==b&&1&p[l-1]||b==(d.s<0?8:7)),l<1||!p[0])r=h?w(u.charAt(1),-g,u.charAt(0)):u.charAt(0);else{if(p.length=l,h)for(--i;++p[--l]>i;)p[l]=0,l||(++c,p=[1].concat(p));for(f=p.length;!p[--f];);for(v=0,r="";v<=f;r+=u.charAt(p[v++]));r=w(r,c,u.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,o,i,a,s=0,u=e.length,l=t%h,c=t/h|0;for(e=e.slice();u--;)s=((o=l*(i=e[u]%h)+(r=c*i+(a=e[u]/h|0)*l)%h*h+s)/n|0)+(r/h|0)+c*a,e[u]=o%n;return s&&(e=[s].concat(e)),e}function t(e,t,n,r){var o,i;if(n!=r)i=r<n?1:-1;else for(o=i=0;o<n;o++)if(e[o]!=t[o]){i=e[o]>t[o]?1:-1;break}return i}function n(e,t,n,r){for(var o=0;n--;)e[n]-=o,o=e[n]<t[n]?1:0,e[n]=o*r+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(r,o,a,s,c){var f,h,d,m,y,v,g,b,w,_,S,E,k,R,T,C,M,O=r.s==o.s?1:-1,A=r.c,L=o.c;if(!(A&&A[0]&&L&&L[0]))return new V(r.s&&o.s&&(A?!L||A[0]!=L[0]:L)?A&&0==A[0]||!L?0*O:O/0:NaN);for(w=(b=new V(O)).c=[],O=a+(h=r.e-o.e)+1,c||(c=u,h=p(r.e/l)-p(o.e/l),O=O/l|0),d=0;L[d]==(A[d]||0);d++);if(L[d]>(A[d]||0)&&h--,O<0)w.push(1),m=!0;else{for(R=A.length,C=L.length,O+=2,1<(y=i(c/(L[d=0]+1)))&&(L=e(L,y,c),A=e(A,y,c),C=L.length,R=A.length),k=C,S=(_=A.slice(0,C)).length;S<C;_[S++]=0);M=L.slice(),M=[0].concat(M),T=L[0],L[1]>=c/2&&T++;do{if(y=0,(f=t(L,_,C,S))<0){if(E=_[0],C!=S&&(E=E*c+(_[1]||0)),1<(y=i(E/T)))for(c<=y&&(y=c-1),g=(v=e(L,y,c)).length,S=_.length;1==t(v,_,g,S);)y--,n(v,C<g?M:L,g,c),g=v.length,f=1;else 0==y&&(f=y=1),g=(v=L.slice()).length;if(g<S&&(v=[0].concat(v)),n(_,v,S,c),S=_.length,-1==f)for(;t(L,_,C,S)<1;)y++,n(_,C<S?M:L,S,c),S=_.length}else 0===f&&(y++,_=[0]);w[d++]=y,_[0]?_[S++]=A[k]||0:(_=[A[k]],S=1)}while((k++<R||null!=_[0])&&O--);m=null!=_[0],w[0]||w.splice(0,1)}if(c==u){for(d=1,O=w[0];10<=O;O/=10,d++);K(b,a+(b.e=d+h*l-1)+1,s,m)}else b.e=h,b.r=+m;return b}}(),R=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,C=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(e,t,n,r){var o,i=n?t:t.replace(O,"");if(M.test(i))e.s=isNaN(i)?null:i<0?-1:1,e.c=e.e=null;else{if(!n&&(i=i.replace(R,(function(e,t,n){return o="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=o?e:t})),r&&(o=r,i=i.replace(T,"$1").replace(C,"0.$1")),t!=i))return new V(i,o);if(V.DEBUG)throw Error(a+"Not a"+(r?" base "+r:"")+" number: "+t);e.c=e.e=e.s=null}},A.absoluteValue=A.abs=function(){var e=new V(this);return e.s<0&&(e.s=1),e},A.comparedTo=function(e,t){return y(this,new V(e,t))},A.decimalPlaces=A.dp=function(e,t){var n,r,o;if(null!=e)return v(e,0,d),null==t?t=N:v(t,0,8),K(new V(this),e+this.e+1,t);if(!(n=this.c))return null;if(r=((o=n.length-1)-p(this.e/l))*l,o=n[o])for(;o%10==0;o/=10,r--);return r<0&&(r=0),r},A.dividedBy=A.div=function(e,t){return n(this,new V(e,t),x,N)},A.dividedToIntegerBy=A.idiv=function(e,t){return n(this,new V(e,t),0,1)},A.exponentiatedBy=A.pow=function(e,t){var n,r,s,u,c,f,h,d,p=this;if((e=new V(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+X(e));if(null!=t&&(t=new V(t)),c=14<e.e,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new V(Math.pow(+X(p),c?2-g(e):+X(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new V(NaN);(r=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(9<e.e&&(0<p.e||p.e<-1||(0==p.e?1<p.c[0]||c&&24e7<=p.c[1]:p.c[0]<8e13||c&&p.c[0]<=9999975e7)))return u=p.s<0&&g(e)?-0:0,-1<p.e&&(u=1/u),new V(f?1/u:u);Y&&(u=o(Y/l+2))}for(h=c?(n=new V(.5),f&&(e.s=1),g(e)):(s=Math.abs(+X(e)))%2,d=new V(L);;){if(h){if(!(d=d.times(p)).c)break;u?d.c.length>u&&(d.c.length=u):r&&(d=d.mod(t))}if(s){if(0===(s=i(s/2)))break;h=s%2}else if(K(e=e.times(n),e.e+1,1),14<e.e)h=g(e);else{if(0==(s=+X(e)))break;h=s%2}p=p.times(p),u?p.c&&p.c.length>u&&(p.c.length=u):r&&(p=p.mod(t))}return r?d:(f&&(d=L.div(d)),t?d.mod(t):u?K(d,Y,N,void 0):d)},A.integerValue=function(e){var t=new V(this);return null==e?e=N:v(e,0,8),K(t,t.e+1,e)},A.isEqualTo=A.eq=function(e,t){return 0===y(this,new V(e,t))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(e,t){return 0<y(this,new V(e,t))},A.isGreaterThanOrEqualTo=A.gte=function(e,t){return 1===(t=y(this,new V(e,t)))||0===t},A.isInteger=function(){return!!this.c&&p(this.e/l)>this.c.length-2},A.isLessThan=A.lt=function(e,t){return y(this,new V(e,t))<0},A.isLessThanOrEqualTo=A.lte=function(e,t){return-1===(t=y(this,new V(e,t)))||0===t},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return 0<this.s},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(e,t){var n,r,o,i,a=this,s=a.s;if(t=(e=new V(e,t)).s,!s||!t)return new V(NaN);if(s!=t)return e.s=-t,a.plus(e);var c=a.e/l,f=e.e/l,h=a.c,d=e.c;if(!c||!f){if(!h||!d)return h?(e.s=-t,e):new V(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new V(h[0]?a:3==N?-0:0)}if(c=p(c),f=p(f),h=h.slice(),s=c-f){for((o=(i=s<0)?(s=-s,h):(f=c,d)).reverse(),t=s;t--;o.push(0));o.reverse()}else for(r=(i=(s=h.length)<(t=d.length))?s:t,s=t=0;t<r;t++)if(h[t]!=d[t]){i=h[t]<d[t];break}if(i&&(o=h,h=d,d=o,e.s=-e.s),0<(t=(r=d.length)-(n=h.length)))for(;t--;h[n++]=0);for(t=u-1;s<r;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=u}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?G(e,h,f):(e.s=3==N?-1:1,e.c=[e.e=0],e)},A.modulo=A.mod=function(e,t){var r,o,i=this;return e=new V(e,t),!i.c||!e.s||e.c&&!e.c[0]?new V(NaN):!e.c||i.c&&!i.c[0]?new V(i):(9==F?(o=e.s,e.s=1,r=n(i,e,0,3),e.s=o,r.s*=o):r=n(i,e,0,F),(e=i.minus(r.times(e))).c[0]||1!=F||(e.s=i.s),e)},A.multipliedBy=A.times=function(e,t){var n,r,o,i,a,s,c,f,d,m,y,v,g,b,w,_=this,S=_.c,E=(e=new V(e,t)).c;if(!(S&&E&&S[0]&&E[0]))return!_.s||!e.s||S&&!S[0]&&!E||E&&!E[0]&&!S?e.c=e.e=e.s=null:(e.s*=_.s,S&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(_.e/l)+p(e.e/l),e.s*=_.s,(c=S.length)<(m=E.length)&&(g=S,S=E,E=g,o=c,c=m,m=o),o=c+m,g=[];o--;g.push(0));for(b=u,w=h,o=m;0<=--o;){for(n=0,y=E[o]%w,v=E[o]/w|0,i=o+(a=c);o<i;)n=((f=y*(f=S[--a]%w)+(s=v*f+(d=S[a]/w|0)*y)%w*w+g[i]+n)/b|0)+(s/w|0)+v*d,g[i--]=f%b;g[i]=n}return n?++r:g.splice(0,1),G(e,g,r)},A.negated=function(){var e=new V(this);return e.s=-e.s||null,e},A.plus=function(e,t){var n,r=this,o=r.s;if(t=(e=new V(e,t)).s,!o||!t)return new V(NaN);if(o!=t)return e.s=-t,r.minus(e);var i=r.e/l,a=e.e/l,s=r.c,c=e.c;if(!i||!a){if(!s||!c)return new V(o/0);if(!s[0]||!c[0])return c[0]?e:new V(s[0]?r:0*o)}if(i=p(i),a=p(a),s=s.slice(),o=i-a){for((n=0<o?(a=i,c):(o=-o,s)).reverse();o--;n.push(0));n.reverse()}for((o=s.length)-(t=c.length)<0&&(n=c,c=s,s=n,t=o),o=0;t;)o=(s[--t]=s[t]+c[t]+o)/u|0,s[t]=u===s[t]?0:s[t]%u;return o&&(s=[o].concat(s),++a),G(e,s,a)},A.precision=A.sd=function(e,t){var n,r,o;if(null!=e&&e!==!!e)return v(e,1,d),null==t?t=N:v(t,0,8),K(new V(this),e,t);if(!(n=this.c))return null;if(r=(o=n.length-1)*l+1,o=n[o]){for(;o%10==0;o/=10,r--);for(o=n[0];10<=o;o/=10,r++);}return e&&this.e+1>r&&(r=this.e+1),r},A.shiftedBy=function(e){return v(e,-c,c),this.times("1e"+e)},A.squareRoot=A.sqrt=function(){var e,t,r,o,i,a=this,s=a.c,u=a.s,l=a.e,c=x+4,f=new V("0.5");if(1!==u||!s||!s[0])return new V(!u||u<0&&(!s||s[0])?NaN:s?a:1/0);if((r=0==(u=Math.sqrt(+X(a)))||u==1/0?(((t=m(s)).length+l)%2==0&&(t+="0"),u=Math.sqrt(+t),l=p((l+1)/2)-(l<0||l%2),new V(t=u==1/0?"1e"+l:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+l)):new V(u+"")).c[0])for((u=(l=r.e)+c)<3&&(u=0);;)if(i=r,r=f.times(i.plus(n(a,i,c,1))),m(i.c).slice(0,u)===(t=m(r.c)).slice(0,u)){if(r.e<l&&--u,"9999"!=(t=t.slice(u-3,u+1))&&(o||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(r,r.e+x+2,1),e=!r.times(r).eq(a));break}if(!o&&(K(i,i.e+x+2,0),i.times(i).eq(a))){r=i;break}c+=4,u+=4,o=1}return K(r,r.e+x+1,N,e)},A.toExponential=function(e,t){return null!=e&&(v(e,0,d),e++),W(this,e,t,1)},A.toFixed=function(e,t){return null!=e&&(v(e,0,d),e=e+this.e+1),W(this,e,t)},A.toFormat=function(e,t,n){var r;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=U;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(r=this.toFixed(e,t),this.c){var o,i=r.split("."),s=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",c=i[0],f=i[1],h=this.s<0,d=h?c.slice(1):c,p=d.length;if(u&&(o=s,s=u,p-=u=o),0<s&&0<p){for(o=p%s||s,c=d.substr(0,o);o<p;o+=s)c+=l+d.substr(o,s);0<u&&(c+=l+d.slice(o)),h&&(c="-"+c)}r=f?c+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):c}return(n.prefix||"")+r+(n.suffix||"")},A.toFraction=function(e){var t,r,o,i,s,u,c,h,d,p,y,v,g=this,b=g.c;if(null!=e&&(!(c=new V(e)).isInteger()&&(c.c||1!==c.s)||c.lt(L)))throw Error(a+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+X(c));if(!b)return new V(g);for(t=new V(L),d=r=new V(L),o=h=new V(L),v=m(b),s=t.e=v.length-g.e-1,t.c[0]=f[(u=s%l)<0?l+u:u],e=!e||0<c.comparedTo(t)?0<s?t:d:c,u=H,H=1/0,c=new V(v),h.c[0]=0;p=n(c,t,0,1),1!=(i=r.plus(p.times(o))).comparedTo(e);)r=o,o=i,d=h.plus(p.times(i=d)),h=i,t=c.minus(p.times(i=t)),c=i;return i=n(e.minus(r),o,0,1),h=h.plus(i.times(d)),r=r.plus(i.times(o)),h.s=d.s=g.s,y=n(d,o,s*=2,N).minus(g).abs().comparedTo(n(h,r,s,N).minus(g).abs())<1?[d,o]:[h,r],H=u,y},A.toNumber=function(){return+X(this)},A.toPrecision=function(e,t){return null!=e&&v(e,1,d),W(this,e,t,2)},A.toString=function(e){var t,n=this,r=n.s,o=n.e;return null===o?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(t=null==e?o<=I||D<=o?b(m(n.c),o):w(m(n.c),o,"0"):10===e?w(m((n=K(new V(n),x+o+1,N)).c),n.e,"0"):(v(e,2,B.length,"Base"),_(w(m(n.c),o,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},A.valueOf=A.toJSON=function(){return X(this)},A._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(A[Symbol.toStringTag]="BigNumber",A[Symbol.for("nodejs.util.inspect.custom")]=A.valueOf),null!=t&&V.set(t),V}()).default=n.BigNumber=n,void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)},{}],2:[function(e,t,n){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("./globalState"),i=e("./validating"),a=e("./parsing"),s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u={general:{scale:1024,suffixes:s,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:s,marker:"d"}},l={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=a.parseFormat(t)),!i.validateFormat(t))return"ERROR: invalid format";var r=t.prefix||"",s=t.postfix||"",c=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){var r=n.currentCurrency(),o=Object.assign({},l,t),i=void 0,a="",s=!!o.totalLength||!!o.forceAverage||o.average,u=t.currencyPosition||r.position,c=t.currencySymbol||r.symbol;o.spaceSeparated&&(a=" "),"infix"===u&&(i=a+c+a);var f=p({instance:e,providedFormat:t,state:n,decimalSeparator:i});return"prefix"===u&&(f=e._value<0&&"sign"===o.negative?"-".concat(a).concat(c).concat(f.slice(1)):c+a+f),u&&"postfix"!==u||(f=f+(a=s?"":a)+c),f}(e,t=m(t,o.currentCurrencyDefaultFormat()),o);case"percent":return function(e,t,n,r){var o=t.prefixSymbol,i=p({instance:r(100*e._value),providedFormat:t,state:n}),a=Object.assign({},l,t);return o?"%".concat(a.spaceSeparated?" ":"").concat(i):"".concat(i).concat(a.spaceSeparated?" ":"","%")}(e,t=m(t,o.currentPercentageDefaultFormat()),o,n);case"byte":return t=m(t,o.currentByteDefaultFormat()),w=e,S=o,E=n,k=(_=t).base||"binary",R=u[k],C=(T=f(w._value,R.suffixes,R.scale)).value,M=T.suffix,O=p({instance:E(C),providedFormat:_,state:S,defaults:S.currentByteDefaultFormat()}),A=S.currentAbbreviations(),"".concat(O).concat(A.spaced?" ":"").concat(M);case"time":return t=m(t,o.currentTimeDefaultFormat()),y=e,v=Math.floor(y._value/60/60),g=Math.floor((y._value-60*v*60)/60),b=Math.round(y._value-60*v*60-60*g),"".concat(v,":").concat(g<10?"0":"").concat(g,":").concat(b<10?"0":"").concat(b);case"ordinal":return r=e,i=t=m(t,o.currentOrdinalDefaultFormat()),s=(a=o).currentOrdinal(),c=Object.assign({},l,i),h=p({instance:r,providedFormat:i,state:a}),d=s(r._value),"".concat(h).concat(c.spaceSeparated?" ":"").concat(d);default:return p({instance:e,providedFormat:t,numbro:n})}var r,i,a,s,c,h,d,y,v,g,b,w,_,S,E,k,R,T,C,M,O,A}(e,t,n);return(c=r+c)+s}function f(e,t,n){var r=t[0],o=Math.abs(e);if(n<=o){for(var i=1;i<t.length;++i){var a=Math.pow(n,i),s=Math.pow(n,i+1);if(a<=o&&o<s){r=t[i],e/=a;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function h(e){for(var t="",n=0;n<e;n++)t+="0";return t}function d(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var n=e.toString(),o=r(n.split("e"),2),i=o[0],a=o[1],s=r(i.split("."),2),u=s[0],l=s[1],c=void 0===l?"":l;if(0<+a)n=u+c+h(a-c.length);else{var f=".";f=+u<0?"-0".concat(f):"0".concat(f);var d=(h(-a-1)+Math.abs(u)+c).substr(0,t);d.length<t&&(d+=h(t-d.length)),n=f+d}return 0<+a&&0<t&&(n+=".".concat(h(t))),n}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function p(e){var t=e.instance,n=e.providedFormat,i=e.state,a=void 0===i?o:i,s=e.decimalSeparator,u=e.defaults,c=void 0===u?a.currentDefaults():u,f=t._value;if(0===f&&a.hasZeroFormat())return a.getZeroFormat();if(!isFinite(f))return f.toString();var h,p,m,y,v,g,b,w,_=Object.assign({},l,c,n),S=_.totalLength,E=S?0:_.characteristic,k=_.optionalCharacteristic,R=_.forceAverage,T=!!S||!!R||_.average,C=S?-1:T&&void 0===n.mantissa?0:_.mantissa,M=!S&&(void 0===n.optionalMantissa?-1===C:_.optionalMantissa),O=_.trimMantissa,A=_.thousandSeparated,L=_.spaceSeparated,x=_.negative,N=_.forceSign,I=_.exponential,D="";if(T){var P=function(e){var t=e.value,n=e.forceAverage,r=e.abbreviations,o=e.spaceSeparated,i=void 0!==o&&o,a=e.totalLength,s=void 0===a?0:a,u="",l=Math.abs(t),c=-1;if(l>=Math.pow(10,12)&&!n||"trillion"===n?(u=r.trillion,t/=Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)&&!n||"billion"===n?(u=r.billion,t/=Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)&&!n||"million"===n?(u=r.million,t/=Math.pow(10,6)):(l<Math.pow(10,6)&&l>=Math.pow(10,3)&&!n||"thousand"===n)&&(u=r.thousand,t/=Math.pow(10,3)),u&&(u=(i?" ":"")+u),s){var f=t.toString().split(".")[0];c=Math.max(s-f.length,0)}return{value:t,abbreviation:u,mantissaPrecision:c}}({value:f,forceAverage:R,abbreviations:a.currentAbbreviations(),spaceSeparated:L,totalLength:S});f=P.value,D+=P.abbreviation,S&&(C=P.mantissaPrecision)}if(I){var H=(p=(h={value:f,characteristicPrecision:E}).value,y=void 0===(m=h.characteristicPrecision)?0:m,g=(v=r(p.toExponential().split("e"),2))[0],b=v[1],w=+g,y&&1<y&&(w*=Math.pow(10,y-1),b=0<=(b=+b-(y-1))?"+".concat(b):b),{value:w,abbreviation:"e".concat(b)});f=H.value,D=H.abbreviation+D}var j,F,Y,U=function(e,t,n,o,i){if(-1===o)return e;var a=d(t,o),s=r(a.toString().split("."),2),u=s[0],l=s[1],c=void 0===l?"":l;if(c.match(/^0+$/)&&(n||i))return u;var f=c.match(/0+$/);return i&&f?"".concat(u,".").concat(c.toString().slice(0,f.index)):a.toString()}(f.toString(),f,M,C,O);return U=function(e,t,n,r,o){var i=r.currentDelimiters(),a=i.thousands;o=o||i.decimal;var s=i.thousandsSize||3,u=e.toString(),l=u.split(".")[0],c=u.split(".")[1];return n&&(t<0&&(l=l.slice(1)),function(e,t){for(var n=[],r=0,o=e;0<o;o--)r===t&&(n.unshift(o),r=0),r++;return n}(l.length,s).forEach((function(e,t){l=l.slice(0,e+t)+a+l.slice(e+t)})),t<0&&(l="-".concat(l))),c?l+o+c:l}(U=function(e,t,n,o){var i=e,a=r(i.toString().split("."),2),s=a[0],u=a[1];if(s.match(/^-?0$/)&&n)return u?"".concat(s.replace("0",""),".").concat(u):s.replace("0","");if(s.length<o)for(var l=o-s.length,c=0;c<l;c++)i="0".concat(i);return i.toString()}(U,0,k,E),f,A,a,s),(T||I)&&(U+=D),(N||f<0)&&(j=U,Y=x,U=0===(F=f)?j:0==+j?j.replace("-",""):0<F?"+".concat(j):"sign"===Y?j:"(".concat(j.replace("-",""),")")),U}function m(e,t){if(!e)return t;var n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c.apply(void 0,n.concat([e]))},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=u.general;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=u.binary;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=u.decimal;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){"use strict";var r=e("./en-US"),o=e("./validating"),i=e("./parsing"),a={},s=void 0,u={},l=null,c={};function f(e){s=e}function h(){return u[s]}a.languages=function(){return Object.assign({},u)},a.currentLanguage=function(){return s},a.currentCurrency=function(){return h().currency},a.currentAbbreviations=function(){return h().abbreviations},a.currentDelimiters=function(){return h().delimiters},a.currentOrdinal=function(){return h().ordinal},a.currentDefaults=function(){return Object.assign({},h().defaults,c)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().timeFormat)},a.setDefaults=function(e){e=i.parseFormat(e),o.validateFormat(e)&&(c=e)},a.getZeroFormat=function(){return l},a.setZeroFormat=function(e){return l="string"==typeof e?e:null},a.hasZeroFormat=function(){return null!==l},a.languageData=function(e){if(e){if(u[e])return u[e];throw new Error('Unknown tag "'.concat(e,'"'))}return h()},a.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(e))throw new Error("Invalid language data");u[e.languageTag]=e,t&&f(e.languageTag)},a.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.languageTag;if(!u[e]){var n=e.split("-")[0],o=Object.keys(u).find((function(e){return e.split("-")[0]===n}));return u[o]?void f(o):void f(t)}f(e)},a.registerLanguage(r),s=r.languageTag,t.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,n){"use strict";t.exports=function(t){return{loadLanguagesInNode:function(n){return r=t,void n.forEach((function(t){var n=void 0;try{n=e("../languages/".concat(t))}catch(n){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}n&&r.registerLanguage(n)}));var r}}}},{}],6:[function(e,t,n){"use strict";var r=e("bignumber.js");function o(e,t,n){var o=new r(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new r(i),e._value=o.minus(i).toNumber(),e}t.exports=function(e){return{add:function(t,n){return i=n,a=e,s=new r((o=t)._value),u=i,a.isNumbro(i)&&(u=i._value),u=new r(u),o._value=s.plus(u).toNumber(),o;var o,i,a,s,u},subtract:function(t,n){return o(t,n,e)},multiply:function(t,n){return i=n,a=e,s=new r((o=t)._value),u=i,a.isNumbro(i)&&(u=i._value),u=new r(u),o._value=s.times(u).toNumber(),o;var o,i,a,s,u},divide:function(t,n){return i=n,a=e,s=new r((o=t)._value),u=i,a.isNumbro(i)&&(u=i._value),u=new r(u),o._value=s.dividedBy(u).toNumber(),o;var o,i,a,s,u},set:function(t,n){return r=t,i=o=n,e.isNumbro(o)&&(i=o._value),r._value=i,r;var r,o,i},difference:function(t,n){return r=n,o(a=(i=e)(t._value),r,i),Math.abs(a._value);var r,i,a}}}},{"bignumber.js":1}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("./globalState"),i=e("./validating"),a=e("./loading")(d),s=e("./unformatting"),u=e("./formatting")(d),l=e("./manipulating")(d),c=e("./parsing"),f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t,n;return t=e,(n=[{key:"clone",value:function(){return d(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return u.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=u.formatOrDefault(e,o.currentCurrencyDefaultFormat())).output="currency",u.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",u.format(this,e)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(e){return l.difference(this,e)}},{key:"add",value:function(e){return l.add(this,e)}},{key:"subtract",value:function(e){return l.subtract(this,e)}},{key:"multiply",value:function(e){return l.multiply(this,e)}},{key:"divide",value:function(e){return l.divide(this,e)}},{key:"set",value:function(e){return l.set(this,h(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(t.prototype,n),e}();function h(e){var t=e;return d.isNumbro(e)?t=e._value:"string"==typeof e?t=d.unformat(e):isNaN(e)&&(t=NaN),t}function d(e){return new f(h(e))}d.version="2.1.2",d.isNumbro=function(e){return e instanceof f},d.language=o.currentLanguage,d.registerLanguage=o.registerLanguage,d.setLanguage=o.setLanguage,d.languages=o.languages,d.languageData=o.languageData,d.zeroFormat=o.setZeroFormat,d.defaultFormat=o.currentDefaults,d.setDefaults=o.setDefaults,d.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,d.validate=i.validate,d.loadLanguagesInNode=a.loadLanguagesInNode,d.unformat=s.unformat,t.exports=d},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){"use strict";t.exports={parseFormat:function(e){var t,n,r,o,i,a,s,u,l,c,f,h,d,p,m,y,v,g,b,w,_=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(n=_,i=_,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(a=(o=e=(r=(t=e).match(/^{([^}]*)}/))?(n.prefix=r[1],t.slice(r[0].length)):t).match(/{([^}]*)}$/))?(i.postfix=a[1],o.slice(0,-a[0].length)):o,_),s=_,(u=e.match(/[1-9]+[0-9]*/))&&(s.totalLength=+u[0]),l=_,(c=e.split(".")[0].match(/0+/))&&(l.characteristic=c[0].length),function(e,t){if(-1!==e.indexOf(".")){var n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,_),f=_,-1!==e.indexOf("a")&&(f.average=!0),d=_,-1!==(h=e).indexOf("K")?d.forceAverage="thousand":-1!==h.indexOf("M")?d.forceAverage="million":-1!==h.indexOf("B")?d.forceAverage="billion":-1!==h.indexOf("T")&&(d.forceAverage="trillion"),function(e,t){var n=e.split(".")[1];if(n){var r=n.match(/0+/);r&&(t.mantissa=r[0].length)}}(e,_),m=_,(p=e).match(/\[\.]/)?m.optionalMantissa=!0:p.match(/\./)&&(m.optionalMantissa=!1),y=_,-1!==e.indexOf(",")&&(y.thousandSeparated=!0),v=_,-1!==e.indexOf(" ")&&(v.spaceSeparated=!0),b=_,(g=e).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),g.match(/^\+?-/)&&(b.negative="sign"),w=_,e.match(/^\+/)&&(w.forceSign=!0),_)}}},{}],9:[function(e,t,n){"use strict";var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}t.exports={unformat:function(t,n){var i,a,s,u=e("./globalState"),l=u.currentDelimiters(),c=u.currentCurrency().symbol,f=u.currentOrdinal(),h=u.getZeroFormat(),d=u.currentAbbreviations(),p=void 0;if("string"==typeof t)p=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var n=e.split(":");if(3!==n.length)return!1;var r=+n[0],o=+n[1],i=+n[2];return!isNaN(r)&&!isNaN(o)&&!isNaN(i)}(t,l)?(a=+(i=t.split(":"))[0],s=+i[1],+i[2]+60*s+3600*a):function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===a?0:function e(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",a=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,u=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var c="",f=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(f!==t)return-1*e(f,n,i,a,s,u,l);for(var h=0;h<r.length;h++){var d=r[h];if((c=t.replace(d.key,""))!==t)return e(c,n,i,a,s,u,l)*d.factor}if((c=t.replace("%",""))!==t)return e(c,n,i,a,s,u,l)/100;var p=parseFloat(t);if(!isNaN(p)){var m=a(p);if(m&&"."!==m&&(c=t.replace(new RegExp("".concat(o(m),"$")),""))!==t)return e(c,n,i,a,s,u,l);var y={};Object.keys(u).forEach((function(e){y[u[e]]=e}));for(var v=Object.keys(y).sort().reverse(),g=v.length,b=0;b<g;b++){var w=v[b],_=y[w];if((c=t.replace(w,""))!==t){var S=void 0;switch(_){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return e(c,n,i,a,s,u,l)*S}}}}(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=e.replace(n,"");return(r=r.replace(new RegExp("([0-9])".concat(o(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,n),t,n,i,a,s,u)}(t,l,c,f,h,d,n);else{if("number"!=typeof t)return;p=t}if(void 0!==p)return p}}},{"./globalState":4}],10:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function l(e){return!!i.unformat(e)}function c(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=Object.keys(e).map((function(r){if(!t[r])return console.error("".concat(n," Invalid key: ").concat(r)),!1;var i=e[r],a=t[r];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!c(i,s,"[Validate ".concat(r,"]"),!0))return!1}else if(o(i)!==a.type)return console.error("".concat(n," ").concat(r,' type mismatched: "').concat(a.type,'" expected, "').concat(o(i),'" provided')),!1;if(a.restrictions&&a.restrictions.length)for(var u=a.restrictions.length,l=0;l<u;l++){var f=a.restrictions[l],h=f.restriction,d=f.message;if(!h(i,e))return console.error("".concat(n," ").concat(r," invalid value: ").concat(d)),!1}return a.restriction&&!a.restriction(i,e)?(console.error("".concat(n," ").concat(r," invalid value: ").concat(a.message)),!1):a.validValues&&-1===a.validValues.indexOf(i)?(console.error("".concat(n," ").concat(r," invalid value: must be among ").concat(JSON.stringify(a.validValues),', "').concat(i,'" provided')),!1):!(a.children&&!c(i,a.children,"[Validate ".concat(r,"]")))}));return i||a.push.apply(a,r(Object.keys(t).map((function(r){var o=t[r];if("string"==typeof o&&(o={type:o}),o.mandatory){var i=o.mandatory;if("function"==typeof i&&(i=i(e)),i&&void 0===e[r])return console.error("".concat(n,' Missing mandatory key "').concat(r,'"')),!1}return!0})))),a.reduce((function(e,t){return e&&t}),!0)}function f(e){return c(e,s,"[Validate format]")}t.exports={validate:function(e,t){var n=l(e),r=f(t);return n&&r},validateFormat:f,validateInput:l,validateLanguage:function(e){return c(e,u,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},37347:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,i){for(var a,s,u=o(e),l=1;l<arguments.length;l++){for(var c in a=Object(arguments[l]))n.call(a,c)&&(u[c]=a[c]);if(t){s=t(a);for(var f=0;f<s.length;f++)r.call(a,s[f])&&(u[s[f]]=a[s[f]])}}return u}},704:function(e,t,n){!function(t,r){"use strict";var o;try{o=n(90421)}catch(e){}e.exports=function(e){var t="function"==typeof e,n=!!window.addEventListener,r=window.document,o=window.setTimeout,i=function(e,t,r,o){n?e.addEventListener(t,r,!!o):e.attachEvent("on"+t,r)},a=function(e,t,r,o){n?e.removeEventListener(t,r,!!o):e.detachEvent("on"+t,r)},s=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},u=function(e,t){s(e,t)||(e.className=""===e.className?t:e.className+" "+t)},l=function(e,t){var n;e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},c=function(e){return/Array/.test(Object.prototype.toString.call(e))},f=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},h=function(e){var t=e.getDay();return 0===t||6===t},d=function(e){return e%4==0&&e%100!=0||e%400==0},p=function(e,t){return[31,d(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},m=function(e){f(e)&&e.setHours(0,0,0,0)},y=function(e,t){return e.getTime()===t.getTime()},v=function(e,t,n){var r,o;for(r in t)(o=void 0!==e[r])&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?f(t[r])?n&&(e[r]=new Date(t[r].getTime())):c(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=v({},t[r],n):!n&&o||(e[r]=t[r]);return e},g=function(e,t,n){var o;r.createEvent?((o=r.createEvent("HTMLEvents")).initEvent(t,!0,!1),o=v(o,n),e.dispatchEvent(o)):r.createEventObject&&(o=r.createEventObject(),o=v(o,n),e.fireEvent("on"+t,o))},b=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},w={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},_=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},S=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},E=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},k=function(e,t,n,r,o,i){var a,s,u,l,f,h=e._o,d=n===h.minYear,p=n===h.maxYear,m='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',y=!0,v=!0;for(u=[],a=0;a<12;a++)u.push('<option value="'+(n===o?a-t:12+a-t)+'"'+(a===r?' selected="selected"':"")+(d&&a<h.minMonth||p&&a>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(l='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+u.join("")+"</select></div>",c(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=n-h.yearRange,s=1+n+h.yearRange),u=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&u.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return f='<div class="pika-label">'+n+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+u.join("")+"</select></div>",h.showMonthAfterYear?m+=f+l:m+=l+f,d&&(0===r||h.minMonth>=r)&&(y=!1),p&&(11===r||h.maxMonth<=r)&&(v=!1),0===t&&(m+='<button class="pika-prev'+(y?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),m+"</div>"},R=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+_(e,t)+'">'+_(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")},T=function(a){var u=this,l=u.config(a);u._onMouseDown=function(e){if(u._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(s(t,"is-disabled")||(!s(t,"pika-button")||s(t,"is-empty")||s(t.parentNode,"is-disabled")?s(t,"pika-prev")?u.prevMonth():s(t,"pika-next")&&u.nextMonth():(u.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),l.bound&&o((function(){u.hide(),l.blurFieldOnSelect&&l.field&&l.field.blur()}),100))),s(t,"pika-select"))u._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},u._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(s(t,"pika-select-month")?u.gotoMonth(t.value):s(t,"pika-select-year")&&u.gotoYear(t.value))},u._onKeyChange=function(e){if(e=e||window.event,u.isVisible())switch(e.keyCode){case 13:case 27:l.field&&l.field.blur();break;case 37:e.preventDefault(),u.adjustDate("subtract",1);break;case 38:u.adjustDate("subtract",7);break;case 39:u.adjustDate("add",1);break;case 40:u.adjustDate("add",7)}},u._onInputChange=function(n){var r;n.firedBy!==u&&(r=l.parse?l.parse(l.field.value,l.format):t?(r=e(l.field.value,l.format,l.formatStrict))&&r.isValid()?r.toDate():null:new Date(Date.parse(l.field.value)),f(r)&&u.setDate(r),u._v||u.show())},u._onInputFocus=function(){u.show()},u._onInputClick=function(){u.show()},u._onInputBlur=function(){var e=r.activeElement;do{if(s(e,"pika-single"))return}while(e=e.parentNode);u._c||(u._b=o((function(){u.hide()}),50)),u._c=!1},u._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,r=t;if(t){!n&&s(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",u._onChange)));do{if(s(r,"pika-single")||r===l.trigger)return}while(r=r.parentNode);u._v&&t!==l.trigger&&r!==l.trigger&&u.hide()}},u.el=r.createElement("div"),u.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:""),i(u.el,"mousedown",u._onMouseDown,!0),i(u.el,"touchend",u._onMouseDown,!0),i(u.el,"change",u._onChange),l.keyboardInput&&i(r,"keydown",u._onKeyChange),l.field&&(l.container?l.container.appendChild(u.el):l.bound?r.body.appendChild(u.el):l.field.parentNode.insertBefore(u.el,l.field.nextSibling),i(l.field,"change",u._onInputChange),l.defaultDate||(t&&l.field.value?l.defaultDate=e(l.field.value,l.format).toDate():l.defaultDate=new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var c=l.defaultDate;f(c)?l.setDefaultDate?u.setDate(c,!0):u.gotoDate(c):u.gotoDate(new Date),l.bound?(this.hide(),u.el.className+=" is-bound",i(l.trigger,"click",u._onInputClick),i(l.trigger,"focus",u._onInputFocus),i(l.trigger,"blur",u._onInputBlur)):this.show()};return T.prototype={config:function(e){this._o||(this._o=v({},w,!0));var t=v(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,f(t.minDate)||(t.minDate=!1),f(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),c(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||w.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,f(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,r){t&&e.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return f(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",g(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),f(e)){var n=this._o.minDate,r=this._o.maxDate;f(n)&&e<n?e=n:f(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),g(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(f(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=o<n.getTime()||r.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,r=this.getDate()||new Date,o=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+o):"subtract"===e&&(n=new Date(r.valueOf()-o)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=b({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(m(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=w.minDate,this._o.minYear=w.minYear,this._o.minMonth=w.minMonth,this._o.startRange=w.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(m(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=w.maxDate,this._o.maxYear=w.maxYear,this._o.maxMonth=w.maxMonth,this._o.endRange=w.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,r=n.minYear,i=n.maxYear,a=n.minMonth,s=n.maxMonth,u="";this._y<=r&&(this._y=r,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var l=0;l<n.numberOfMonths;l++)u+='<div class="pika-lendar">'+k(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=u,n.bound&&"hidden"!==n.field.type&&o((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,o,i,a,s,c,f,h,d,p;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||r.documentElement.clientWidth,a=window.innerHeight||r.documentElement.clientHeight,s=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,d=!0,p=!0,"function"==typeof e.getBoundingClientRect)c=(h=e.getBoundingClientRect()).left+window.pageXOffset,f=h.bottom+window.pageYOffset;else for(c=t.offsetLeft,f=t.offsetTop+t.offsetHeight;t=t.offsetParent;)c+=t.offsetLeft,f+=t.offsetTop;(this._o.reposition&&c+n>i||this._o.position.indexOf("right")>-1&&c-n+e.offsetWidth>0)&&(c=c-n+e.offsetWidth,d=!1),(this._o.reposition&&f+o>a+s||this._o.position.indexOf("top")>-1&&f-o-e.offsetHeight>0)&&(f=f-o-e.offsetHeight,p=!1),this.el.style.left=c+"px",this.el.style.top=f+"px",u(this.el,d?"left-aligned":"right-aligned"),u(this.el,p?"bottom-aligned":"top-aligned"),l(this.el,d?"right-aligned":"left-aligned"),l(this.el,p?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var r,o,i,a,s=this._o,u=new Date,l=p(e,t),c=new Date(e,t,1).getDay(),d=[],v=[];m(u),s.firstDay>0&&(c-=s.firstDay)<0&&(c+=7);for(var g=0===t?11:t-1,b=11===t?0:t+1,w=0===t?e-1:e,_=11===t?e+1:e,k=p(w,g),T=l+c,C=T;C>7;)C-=7;T+=7-C;for(var M=!1,O=0,A=0;O<T;O++){var L=new Date(e,t,O-c+1),x=!!f(this._d)&&y(L,this._d),N=y(L,u),I=-1!==s.events.indexOf(L.toDateString()),D=O<c||O>=l+c,P=O-c+1,H=t,j=e,F=s.startRange&&y(s.startRange,L),Y=s.endRange&&y(s.endRange,L),U=s.startRange&&s.endRange&&s.startRange<L&&L<s.endRange;D&&(O<c?(P=k+P,H=g,j=w):(P-=l,H=b,j=_));var B={day:P,month:H,year:j,hasEvent:I,isSelected:x,isToday:N,isDisabled:s.minDate&&L<s.minDate||s.maxDate&&L>s.maxDate||s.disableWeekends&&h(L)||s.disableDayFn&&s.disableDayFn(L),isEmpty:D,isStartRange:F,isEndRange:Y,isInRange:U,showDaysInNextAndPreviousMonths:s.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:s.enableSelectionDaysInNextAndPreviousMonths};s.pickWholeWeek&&x&&(M=!0),v.push(S(B)),7==++A&&(s.showWeekNumber&&v.unshift((r=O-c,o=t,i=e,a=void 0,a=new Date(i,0,1),'<td class="pika-week">'+Math.ceil(((new Date(i,o,r)-a)/864e5+a.getDay()+1)/7)+"</td>")),d.push(E(v,s.isRTL,s.pickWholeWeek,M)),v=[],A=0,M=!1)}return R(s,d,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),l(this.el,"is-hidden"),this._o.bound&&(i(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&a(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",u(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),e.keyboardInput&&a(r,"keydown",this._onKeyChange),e.field&&(a(e.field,"change",this._onInputChange),e.bound&&(a(e.trigger,"click",this._onInputClick),a(e.trigger,"focus",this._onInputFocus),a(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},T}(o)}()},93748:(e,t,n)=>{"use strict";var r=n(35466),o=n(37347),i=n(27767);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=new Set,u={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)s.add(t[e])}var f=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d=Object.prototype.hasOwnProperty,p={},m={};function y(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new y(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new y(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new y(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new y(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new y(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new y(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new y(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new y(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new y(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,r){var o=v.hasOwnProperty(t)?v[t]:null;(null!==o?0===o.type:!r&&2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(m,e)||!d.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,b);v[t]=new y(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,b);v[t]=new y(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,b);v[t]=new y(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new y(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new y(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=60103,E=60106,k=60107,R=60108,T=60114,C=60109,M=60110,O=60112,A=60113,L=60120,x=60115,N=60116,I=60121,D=60128,P=60129,H=60130,j=60131;if("function"==typeof Symbol&&Symbol.for){var F=Symbol.for;S=F("react.element"),E=F("react.portal"),k=F("react.fragment"),R=F("react.strict_mode"),T=F("react.profiler"),C=F("react.provider"),M=F("react.context"),O=F("react.forward_ref"),A=F("react.suspense"),L=F("react.suspense_list"),x=F("react.memo"),N=F("react.lazy"),I=F("react.block"),F("react.scope"),D=F("react.opaque.id"),P=F("react.debug_trace_mode"),H=F("react.offscreen"),j=F("react.legacy_hidden")}var Y,U="function"==typeof Symbol&&Symbol.iterator;function B(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=U&&e[U]||e["@@iterator"])?e:null}function V(e){if(void 0===Y)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);Y=t&&t[1]||""}return"\n"+Y+e}var W=!1;function z(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var o=e.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s])return"\n"+o[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?V(e):""}function G(e){switch(e.tag){case 5:return V(e.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return z(e.type,!1);case 11:return z(e.type.render,!1);case 22:return z(e.type._render,!1);case 1:return z(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case k:return"Fragment";case E:return"Portal";case T:return"Profiler";case R:return"StrictMode";case A:return"Suspense";case L:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case M:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case O:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case x:return K(e.type);case I:return K(e._render);case N:t=e._payload,e=e._init;try{return K(e(t))}catch(e){}}return null}function X(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function $(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=$(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return o({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=X(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=X(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?oe(e,t.type,n):t.hasOwnProperty("defaultValue")&&oe(e,t.type,X(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function oe(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ie(e,t){return e=o({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ae(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+X(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return o({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ue(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:X(n)}}function le(e,t){var n=X(t.value),r=X(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ce(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var fe="http://www.w3.org/1999/xhtml";function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function de(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var pe,me,ye=(me=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((pe=pe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return me(e,t)}))}:me);function ve(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ge={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];function we(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||ge.hasOwnProperty(e)&&ge[e]?(""+t).trim():t+"px"}function _e(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=we(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(ge).forEach((function(e){be.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ge[t]=ge[e]}))}));var Se=o({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(Se[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Ce=null,Me=null;function Oe(e){if(e=no(e)){if("function"!=typeof Te)throw Error(a(280));var t=e.stateNode;t&&(t=oo(t),Te(e.stateNode,e.type,t))}}function Ae(e){Ce?Me?Me.push(e):Me=[e]:Ce=e}function Le(){if(Ce){var e=Ce,t=Me;if(Me=Ce=null,Oe(e),t)for(e=0;e<t.length;e++)Oe(t[e])}}function xe(e,t){return e(t)}function Ne(e,t,n,r,o){return e(t,n,r,o)}function Ie(){}var De=xe,Pe=!1,He=!1;function je(){null===Ce&&null===Me||(Ie(),Le())}function Fe(e,t){var n=e.stateNode;if(null===n)return null;var r=oo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Ye=!1;if(f)try{var Ue={};Object.defineProperty(Ue,"passive",{get:function(){Ye=!0}}),window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,Ue)}catch(me){Ye=!1}function Be(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}var Ve=!1,We=null,ze=!1,Ge=null,Ke={onError:function(e){Ve=!0,We=e}};function Xe(e,t,n,r,o,i,a,s,u){Ve=!1,We=null,Be.apply(Ke,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Je(e){if($e(e)!==e)throw Error(a(188))}function Qe(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Je(o),e;if(i===r)return Je(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s){for(u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Ze(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var et,tt,nt,rt,ot=!1,it=[],at=null,st=null,ut=null,lt=new Map,ct=new Map,ft=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dt(e,t,n,r,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:o,targetContainers:[r]}}function pt(e,t){switch(e){case"focusin":case"focusout":at=null;break;case"dragenter":case"dragleave":st=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ct.delete(t.pointerId)}}function mt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e=dt(t,n,r,o,i),null!==t&&null!==(t=no(t))&&tt(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function yt(e){var t=to(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void rt(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){nt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function vt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=no(n))&&tt(t),e.blockedOn=n,!1;t.shift()}return!0}function gt(e,t,n){vt(e)&&n.delete(t)}function bt(){for(ot=!1;0<it.length;){var e=it[0];if(null!==e.blockedOn){null!==(e=no(e.blockedOn))&&et(e);break}for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&it.shift()}null!==at&&vt(at)&&(at=null),null!==st&&vt(st)&&(st=null),null!==ut&&vt(ut)&&(ut=null),lt.forEach(gt),ct.forEach(gt)}function wt(e,t){e.blockedOn===t&&(e.blockedOn=null,ot||(ot=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,bt)))}function _t(e){function t(t){return wt(t,e)}if(0<it.length){wt(it[0],e);for(var n=1;n<it.length;n++){var r=it[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==at&&wt(at,e),null!==st&&wt(st,e),null!==ut&&wt(ut,e),lt.forEach(t),ct.forEach(t),n=0;n<ft.length;n++)(r=ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ft.length&&null===(n=ft[0]).blockedOn;)yt(n),null===n.blockedOn&&ft.shift()}function St(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Et={animationend:St("Animation","AnimationEnd"),animationiteration:St("Animation","AnimationIteration"),animationstart:St("Animation","AnimationStart"),transitionend:St("Transition","TransitionEnd")},kt={},Rt={};function Tt(e){if(kt[e])return kt[e];if(!Et[e])return e;var t,n=Et[e];for(t in n)if(n.hasOwnProperty(t)&&t in Rt)return kt[e]=n[t];return e}f&&(Rt=document.createElement("div").style,"AnimationEvent"in window||(delete Et.animationend.animation,delete Et.animationiteration.animation,delete Et.animationstart.animation),"TransitionEvent"in window||delete Et.transitionend.transition);var Ct=Tt("animationend"),Mt=Tt("animationiteration"),Ot=Tt("animationstart"),At=Tt("transitionend"),Lt=new Map,xt=new Map,Nt=["abort","abort",Ct,"animationEnd",Mt,"animationIteration",Ot,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",At,"transitionEnd","waiting","waiting"];function It(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],o=e[n+1];o="on"+(o[0].toUpperCase()+o.slice(1)),xt.set(r,t),Lt.set(r,o),l(o,[r])}}(0,i.unstable_now)();var Dt=8;function Pt(e){if(0!=(1&e))return Dt=15,1;if(0!=(2&e))return Dt=14,2;if(0!=(4&e))return Dt=13,4;var t=24&e;return 0!==t?(Dt=12,t):0!=(32&e)?(Dt=11,32):0!=(t=192&e)?(Dt=10,t):0!=(256&e)?(Dt=9,256):0!=(t=3584&e)?(Dt=8,t):0!=(4096&e)?(Dt=7,4096):0!=(t=4186112&e)?(Dt=6,t):0!=(t=62914560&e)?(Dt=5,t):67108864&e?(Dt=4,67108864):0!=(134217728&e)?(Dt=3,134217728):0!=(t=805306368&e)?(Dt=2,t):0!=(1073741824&e)?(Dt=1,1073741824):(Dt=8,e)}function Ht(e,t){var n=e.pendingLanes;if(0===n)return Dt=0;var r=0,o=0,i=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,o=Dt=15;else if(0!=(i=134217727&n)){var u=i&~a;0!==u?(r=Pt(u),o=Dt):0!=(s&=i)&&(r=Pt(s),o=Dt)}else 0!=(i=n&~a)?(r=Pt(i),o=Dt):0!==s&&(r=Pt(s),o=Dt);if(0===r)return 0;if(r=n&((0>(r=31-Vt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&a)){if(Pt(t),o<=Dt)return t;Dt=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-Vt(t)),r|=e[n],t&=~o;return r}function jt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ft(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Yt(24&~t))?Ft(10,t):e;case 10:return 0===(e=Yt(192&~t))?Ft(8,t):e;case 8:return 0===(e=Yt(3584&~t))&&0===(e=Yt(4186112&~t))&&(e=512),e;case 2:return 0===(t=Yt(805306368&~t))&&(t=268435456),t}throw Error(a(358,e))}function Yt(e){return e&-e}function Ut(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Bt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Vt(t)]=n}var Vt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Wt(e)/zt|0)|0},Wt=Math.log,zt=Math.LN2,Gt=i.unstable_UserBlockingPriority,Kt=i.unstable_runWithPriority,Xt=!0;function $t(e,t,n,r){Pe||Ie();var o=Jt,i=Pe;Pe=!0;try{Ne(o,e,t,n,r)}finally{(Pe=i)||je()}}function qt(e,t,n,r){Kt(Gt,Jt.bind(null,e,t,n,r))}function Jt(e,t,n,r){var o;if(Xt)if((o=0==(4&t))&&0<it.length&&-1<ht.indexOf(e))e=dt(null,e,t,n,r),it.push(e);else{var i=Qt(e,t,n,r);if(null===i)o&&pt(e,r);else{if(o){if(-1<ht.indexOf(e))return e=dt(i,e,t,n,r),void it.push(e);if(function(e,t,n,r,o){switch(t){case"focusin":return at=mt(at,e,t,n,r,o),!0;case"dragenter":return st=mt(st,e,t,n,r,o),!0;case"mouseover":return ut=mt(ut,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return lt.set(i,mt(lt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,ct.set(i,mt(ct.get(i)||null,e,t,n,r,o)),!0}return!1}(i,e,t,n,r))return;pt(e,r)}Ir(e,t,r,null,n)}}}function Qt(e,t,n,r){var o=Re(r);if(null!==(o=to(o))){var i=$e(o);if(null===i)o=null;else{var a=i.tag;if(13===a){if(null!==(o=qe(i)))return o;o=null}else if(3===a){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;o=null}else i!==o&&(o=null)}}return Ir(e,t,r,o,n),null}var Zt=null,en=null,tn=null;function nn(){if(tn)return tn;var e,t,n=en,r=n.length,o="value"in Zt?Zt.value:Zt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return tn=o.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function an(){return!1}function sn(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?on:an,this.isPropagationStopped=an,this}return o(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var un,ln,cn,fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=sn(fn),dn=o({},fn,{view:0,detail:0}),pn=sn(dn),mn=o({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(un=e.screenX-cn.screenX,ln=e.screenY-cn.screenY):ln=un=0,cn=e),un)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),yn=sn(mn),vn=sn(o({},mn,{dataTransfer:0})),gn=sn(o({},dn,{relatedTarget:0})),bn=sn(o({},fn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=o({},fn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(wn),Sn=sn(o({},fn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Rn[e])&&!!t[e]}function Cn(){return Tn}var Mn=o({},dn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),On=sn(Mn),An=sn(o({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ln=sn(o({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),xn=sn(o({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=o({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=sn(Nn),Dn=[9,13,27,32],Pn=f&&"CompositionEvent"in window,Hn=null;f&&"documentMode"in document&&(Hn=document.documentMode);var jn=f&&"TextEvent"in window&&!Hn,Fn=f&&(!Pn||Hn&&8<Hn&&11>=Hn),Yn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1,zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ae(r),0<(t=Pr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Xn=null,$n=null;function qn(e){Mr(e,0)}function Jn(e){if(J(ro(e)))return e}function Qn(e,t){if("change"===e)return t}var Zn=!1;if(f){var er;if(f){var tr="oninput"in document;if(!tr){var nr=document.createElement("div");nr.setAttribute("oninput","return;"),tr="function"==typeof nr.oninput}er=tr}else er=!1;Zn=er&&(!document.documentMode||9<document.documentMode)}function rr(){Xn&&(Xn.detachEvent("onpropertychange",or),$n=Xn=null)}function or(e){if("value"===e.propertyName&&Jn($n)){var t=[];if(Kn(t,$n,e,Re(e)),e=qn,Pe)e(t);else{Pe=!0;try{xe(e,t)}finally{Pe=!1,je()}}}}function ir(e,t,n){"focusin"===e?(rr(),$n=n,(Xn=t).attachEvent("onpropertychange",or)):"focusout"===e&&rr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn($n)}function sr(e,t){if("click"===e)return Jn(t)}function ur(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},cr=Object.prototype.hasOwnProperty;function fr(e,t){if(lr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(t,n[r])||!lr(e[n[r]],t[n[r]]))return!1;return!0}function hr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=hr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function mr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function yr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var vr=f&&"documentMode"in document&&11>=document.documentMode,gr=null,br=null,wr=null,_r=!1;function Sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==Q(r)||(r="selectionStart"in(r=gr)&&yr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},wr&&fr(wr,r)||(wr=r,0<(r=Pr(br,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}It("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),It("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),It(Nt,2);for(var Er="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),kr=0;kr<Er.length;kr++)xt.set(Er[kr],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Cr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,u,l){if(Xe.apply(this,arguments),Ve){if(!Ve)throw Error(a(198));var c=We;Ve=!1,We=null,ze||(ze=!0,Ge=c)}}(r,t,void 0,e),e.currentTarget=null}function Mr(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;Cr(o,s,l),i=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;Cr(o,s,l),i=u}}}if(ze)throw e=Ge,ze=!1,Ge=null,e}function Or(e,t){var n=io(t),r=e+"__bubble";n.has(r)||(Nr(t,e,2,!1),n.add(r))}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Lr(e){e[Ar]||(e[Ar]=!0,s.forEach((function(t){Tr.has(t)||xr(t,!1,e,null),xr(t,!0,e,null)})))}function xr(e,t,n,r){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===e&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!t&&Tr.has(e)){if("scroll"!==e)return;o|=2,i=r}var a=io(i),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(o|=4),Nr(i,e,o,t),a.add(s))}function Nr(e,t,n,r){var o=xt.get(t);switch(void 0===o?2:o){case 0:o=$t;break;case 1:o=qt;break;default:o=Jt}n=o.bind(null,t,n,e),o=void 0,!Ye||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ir(e,t,n,r,o){var i=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===o||8===u.nodeType&&u.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=to(s)))return;if(5===(u=a.tag)||6===u){r=i=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(He)return e();He=!0;try{De(e,t,n)}finally{He=!1,je()}}((function(){var r=i,o=Re(n),a=[];e:{var s=Lt.get(e);if(void 0!==s){var u=hn,l=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":u=On;break;case"focusin":l="focus",u=gn;break;case"focusout":l="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=yn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Ln;break;case Ct:case Mt:case Ot:u=bn;break;case At:u=xn;break;case"scroll":u=pn;break;case"wheel":u=In;break;case"copy":case"cut":case"paste":u=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=An}var c=0!=(4&t),f=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var d,p=r;null!==p;){var m=(d=p).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==h&&null!=(m=Fe(p,h))&&c.push(Dr(p,m,d))),f)break;p=p.return}0<c.length&&(s=new u(s,l,null,n,o),a.push({event:s,listeners:c}))}}if(0==(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(l=n.relatedTarget||n.fromElement)||!to(l)&&!l[Zr])&&(u||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?to(l):null)&&(l!==(f=$e(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=yn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=An,m="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==u?s:ro(u),d=null==l?s:ro(l),(s=new c(m,p+"leave",u,n,o)).target=f,s.relatedTarget=d,m=null,to(o)===r&&((c=new c(h,p+"enter",l,n,o)).target=d,c.relatedTarget=f,m=c),f=m,u&&l)e:{for(h=l,p=0,d=c=u;d;d=Hr(d))p++;for(d=0,m=h;m;m=Hr(m))d++;for(;0<p-d;)c=Hr(c),p--;for(;0<d-p;)h=Hr(h),d--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Hr(c),h=Hr(h)}c=null}else c=null;null!==u&&jr(a,s,u,c,!1),null!==l&&null!==f&&jr(a,f,l,c,!0)}if("select"===(u=(s=r?ro(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var y=Qn;else if(Gn(s))if(Zn)y=ur;else{y=ar;var v=ir}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(y=sr);switch(y&&(y=y(e,r))?Kn(a,y,n,o):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&oe(s,"number",s.value)),v=r?ro(r):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gr=v,br=r,wr=null);break;case"focusout":wr=br=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,Sr(a,n,o);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":Sr(a,n,o)}var g;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(g=nn()):(en="value"in(Zt=o)?Zt.value:Zt.textContent,Wn=!0)),0<(v=Pr(r,b)).length&&(b=new Sn(b,e,null,n,o),a.push({event:b,listeners:v}),(g||null!==(g=Vn(n)))&&(b.data=g))),(g=jn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,Yn);case"textInput":return(e=t.data)===Yn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Pn&&Bn(e,t)?(e=nn(),tn=en=Zt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=Pr(r,"onBeforeInput")).length&&(o=new Sn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=g)}Mr(a,t)}))}function Dr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Pr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Fe(e,n))&&r.unshift(Dr(e,i,o)),null!=(i=Fe(e,t))&&r.push(Dr(e,i,o))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function jr(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,o?null!=(u=Fe(n,i))&&a.unshift(Dr(n,u,s)):o||null!=(u=Fe(n,i))&&a.push(Dr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function Fr(){}var Yr=null,Ur=null;function Br(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Vr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Wr="function"==typeof setTimeout?setTimeout:void 0,zr="function"==typeof clearTimeout?clearTimeout:void 0;function Gr(e){(1===e.nodeType||9===e.nodeType&&null!=(e=e.body))&&(e.textContent="")}function Kr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Xr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var $r=0,qr=Math.random().toString(36).slice(2),Jr="__reactFiber$"+qr,Qr="__reactProps$"+qr,Zr="__reactContainer$"+qr,eo="__reactEvents$"+qr;function to(e){var t=e[Jr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Zr]||n[Jr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Xr(e);null!==e;){if(n=e[Jr])return n;e=Xr(e)}return t}n=(e=n).parentNode}return null}function no(e){return!(e=e[Jr]||e[Zr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ro(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function oo(e){return e[Qr]||null}function io(e){var t=e[eo];return void 0===t&&(t=e[eo]=new Set),t}var ao=[],so=-1;function uo(e){return{current:e}}function lo(e){0>so||(e.current=ao[so],ao[so]=null,so--)}function co(e,t){so++,ao[so]=e.current,e.current=t}var fo={},ho=uo(fo),po=uo(!1),mo=fo;function yo(e,t){var n=e.type.contextTypes;if(!n)return fo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function vo(e){return null!=e.childContextTypes}function go(){lo(po),lo(ho)}function bo(e,t,n){if(ho.current!==fo)throw Error(a(168));co(ho,t),co(po,n)}function wo(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(a(108,K(t)||"Unknown",i));return o({},n,r)}function _o(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,mo=ho.current,co(ho,e),co(po,po.current),!0}function So(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=wo(e,t,mo),r.__reactInternalMemoizedMergedChildContext=e,lo(po),lo(ho),co(ho,e)):lo(po),co(po,n)}var Eo=null,ko=null,Ro=i.unstable_runWithPriority,To=i.unstable_scheduleCallback,Co=i.unstable_cancelCallback,Mo=i.unstable_shouldYield,Oo=i.unstable_requestPaint,Ao=i.unstable_now,Lo=i.unstable_getCurrentPriorityLevel,xo=i.unstable_ImmediatePriority,No=i.unstable_UserBlockingPriority,Io=i.unstable_NormalPriority,Do=i.unstable_LowPriority,Po=i.unstable_IdlePriority,Ho={},jo=void 0!==Oo?Oo:function(){},Fo=null,Yo=null,Uo=!1,Bo=Ao(),Vo=1e4>Bo?Ao:function(){return Ao()-Bo};function Wo(){switch(Lo()){case xo:return 99;case No:return 98;case Io:return 97;case Do:return 96;case Po:return 95;default:throw Error(a(332))}}function zo(e){switch(e){case 99:return xo;case 98:return No;case 97:return Io;case 96:return Do;case 95:return Po;default:throw Error(a(332))}}function Go(e,t){return e=zo(e),Ro(e,t)}function Ko(e,t,n){return e=zo(e),To(e,t,n)}function Xo(){if(null!==Yo){var e=Yo;Yo=null,Co(e)}$o()}function $o(){if(!Uo&&null!==Fo){Uo=!0;var e=0;try{var t=Fo;Go(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Fo=null}catch(t){throw null!==Fo&&(Fo=Fo.slice(e+1)),To(xo,Xo),t}finally{Uo=!1}}}var qo=_.ReactCurrentBatchConfig;function Jo(e,t){if(e&&e.defaultProps){for(var n in t=o({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Qo=uo(null),Zo=null,ei=null,ti=null;function ni(){ti=ei=Zo=null}function ri(e){var t=Qo.current;lo(Qo),e.type._context._currentValue=t}function oi(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ii(e,t){Zo=e,ti=ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Pa=!0),e.firstContext=null)}function ai(e,t){if(ti!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(ti=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ei){if(null===Zo)throw Error(a(308));ei=t,Zo.dependencies={lanes:0,firstContext:t,responders:null}}else ei=ei.next=t;return e._currentValue}var si=!1;function ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function li(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ci(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fi(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function hi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function di(e,t,n,r){var i=e.updateQueue;si=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var l=u,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var f=e.alternate;if(null!==f){var h=(f=f.updateQueue).lastBaseUpdate;h!==s&&(null===h?f.firstBaseUpdate=c:h.next=c,f.lastBaseUpdate=l)}}if(null!==a){for(h=i.baseState,s=0,f=c=l=null;;){u=a.lane;var d=a.eventTime;if((r&u)===u){null!==f&&(f=f.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(u=t,d=n,m.tag){case 1:if("function"==typeof(p=m.payload)){h=p.call(d,h,u);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(u="function"==typeof(p=m.payload)?p.call(d,h,u):p))break e;h=o({},h,u);break e;case 2:si=!0}}null!==a.callback&&(e.flags|=32,null===(u=i.effects)?i.effects=[a]:u.push(a))}else d={eventTime:d,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===f?(c=f=d,l=h):f=f.next=d,s|=u;if(null===(a=a.next)){if(null===(u=i.shared.pending))break;a=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}null===f&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,js|=s,e.lanes=s,e.memoizedState=h}}function pi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(a(191,o));o.call(r)}}}var mi=(new r.Component).refs;function yi(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:o({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var vi={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=lu(),o=cu(e),i=ci(r,o);i.payload=t,null!=n&&(i.callback=n),fi(e,i),fu(e,o,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=lu(),o=cu(e),i=ci(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),fi(e,i),fu(e,o,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=lu(),r=cu(e),o=ci(n,r);o.tag=2,null!=t&&(o.callback=t),fi(e,o),fu(e,r,n)}};function gi(e,t,n,r,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!(t.prototype&&t.prototype.isPureReactComponent&&fr(n,r)&&fr(o,i))}function bi(e,t,n){var r=!1,o=fo,i=t.contextType;return"object"==typeof i&&null!==i?i=ai(i):(o=vo(t)?mo:ho.current,i=(r=null!=(r=t.contextTypes))?yo(e,o):fo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=vi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function wi(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vi.enqueueReplaceState(t,t.state,null)}function _i(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=mi,ui(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=ai(i):(i=vo(t)?mo:ho.current,o.context=yo(e,i)),di(e,n,o,r),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(yi(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&vi.enqueueReplaceState(o,o.state,null),di(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var Si=Array.isArray;function Ei(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===mi&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ki(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Ri(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Vu(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Ku(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=o(t,n.props)).ref=Ei(e,t,n),r.return=e,r):((r=Wu(n.type,n.key,n.props,null,e.mode,r)).ref=Ei(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Xu(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=zu(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Ku(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Wu(t.type,t.key,t.props,null,e.mode,n)).ref=Ei(e,null,t),n.return=e,n;case E:return(t=Xu(t,e.mode,n)).return=e,t}if(Si(t)||B(t))return(t=zu(t,e.mode,n,null)).return=e,t;ki(e,t)}return null}function d(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==o?null:u(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===o?n.type===k?f(e,t,n.props.children,r,o):l(e,t,n,r):null;case E:return n.key===o?c(e,t,n,r):null}if(Si(n)||B(n))return null!==o?null:f(e,t,n,r,null);ki(e,n)}return null}function p(e,t,n,r,o){if("string"==typeof r||"number"==typeof r)return u(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case S:return e=e.get(null===r.key?n:r.key)||null,r.type===k?f(t,e,r.props.children,o,r.key):l(t,e,r,o);case E:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o)}if(Si(r)||B(r))return f(t,e=e.get(n)||null,r,o,null);ki(t,r)}return null}function m(o,a,s,u){for(var l=null,c=null,f=a,m=a=0,y=null;null!==f&&m<s.length;m++){f.index>m?(y=f,f=null):y=f.sibling;var v=d(o,f,s[m],u);if(null===v){null===f&&(f=y);break}e&&f&&null===v.alternate&&t(o,f),a=i(v,a,m),null===c?l=v:c.sibling=v,c=v,f=y}if(m===s.length)return n(o,f),l;if(null===f){for(;m<s.length;m++)null!==(f=h(o,s[m],u))&&(a=i(f,a,m),null===c?l=f:c.sibling=f,c=f);return l}for(f=r(o,f);m<s.length;m++)null!==(y=p(f,o,m,s[m],u))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),a=i(y,a,m),null===c?l=y:c.sibling=y,c=y);return e&&f.forEach((function(e){return t(o,e)})),l}function y(o,s,u,l){var c=B(u);if("function"!=typeof c)throw Error(a(150));if(null==(u=c.call(u)))throw Error(a(151));for(var f=c=null,m=s,y=s=0,v=null,g=u.next();null!==m&&!g.done;y++,g=u.next()){m.index>y?(v=m,m=null):v=m.sibling;var b=d(o,m,g.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(o,m),s=i(b,s,y),null===f?c=b:f.sibling=b,f=b,m=v}if(g.done)return n(o,m),c;if(null===m){for(;!g.done;y++,g=u.next())null!==(g=h(o,g.value,l))&&(s=i(g,s,y),null===f?c=g:f.sibling=g,f=g);return c}for(m=r(o,m);!g.done;y++,g=u.next())null!==(g=p(m,o,y,g.value,l))&&(e&&null!==g.alternate&&m.delete(null===g.key?y:g.key),s=i(g,s,y),null===f?c=g:f.sibling=g,f=g);return e&&m.forEach((function(e){return t(o,e)})),c}return function(e,r,i,u){var l="object"==typeof i&&null!==i&&i.type===k&&null===i.key;l&&(i=i.props.children);var c="object"==typeof i&&null!==i;if(c)switch(i.$$typeof){case S:e:{for(c=i.key,l=r;null!==l;){if(l.key===c){if(7===l.tag){if(i.type===k){n(e,l.sibling),(r=o(l,i.props.children)).return=e,e=r;break e}}else if(l.elementType===i.type){n(e,l.sibling),(r=o(l,i.props)).ref=Ei(e,l,i),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}i.type===k?((r=zu(i.props.children,e.mode,u,i.key)).return=e,e=r):((u=Wu(i.type,i.key,i.props,null,e.mode,u)).ref=Ei(e,r,i),u.return=e,e=u)}return s(e);case E:e:{for(l=i.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=o(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Xu(i,e.mode,u)).return=e,e=r}return s(e)}if("string"==typeof i||"number"==typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=o(r,i)).return=e,e=r):(n(e,r),(r=Ku(i,e.mode,u)).return=e,e=r),s(e);if(Si(i))return m(e,r,i,u);if(B(i))return y(e,r,i,u);if(c&&ki(e,i),void 0===i&&!l)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,K(e.type)||"Component"))}return n(e,r)}}var Ti=Ri(!0),Ci=Ri(!1),Mi={},Oi=uo(Mi),Ai=uo(Mi),Li=uo(Mi);function xi(e){if(e===Mi)throw Error(a(174));return e}function Ni(e,t){switch(co(Li,t),co(Ai,e),co(Oi,Mi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:de(null,"");break;default:t=de(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}lo(Oi),co(Oi,t)}function Ii(){lo(Oi),lo(Ai),lo(Li)}function Di(e){xi(Li.current);var t=xi(Oi.current),n=de(t,e.type);t!==n&&(co(Ai,e),co(Oi,n))}function Pi(e){Ai.current===e&&(lo(Oi),lo(Ai))}var Hi=uo(0);function ji(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fi=null,Yi=null,Ui=!1;function Bi(e,t){var n=Uu(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Vi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Wi(e){if(Ui){var t=Yi;if(t){var n=t;if(!Vi(e,t)){if(!(t=Kr(n.nextSibling))||!Vi(e,t))return e.flags=-1025&e.flags|2,Ui=!1,void(Fi=e);Bi(Fi,n)}Fi=e,Yi=Kr(t.firstChild)}else e.flags=-1025&e.flags|2,Ui=!1,Fi=e}}function zi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fi=e}function Gi(e){if(e!==Fi)return!1;if(!Ui)return zi(e),Ui=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Vr(t,e.memoizedProps))for(t=Yi;t;)Bi(e,t),t=Kr(t.nextSibling);if(zi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Yi=Kr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Yi=null}}else Yi=Fi?Kr(e.stateNode.nextSibling):null;return!0}function Ki(){Yi=Fi=null,Ui=!1}var Xi=[];function $i(){for(var e=0;e<Xi.length;e++)Xi[e]._workInProgressVersionPrimary=null;Xi.length=0}var qi=_.ReactCurrentDispatcher,Ji=_.ReactCurrentBatchConfig,Qi=0,Zi=null,ea=null,ta=null,na=!1,ra=!1;function oa(){throw Error(a(321))}function ia(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function aa(e,t,n,r,o,i){if(Qi=i,Zi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qi.current=null===e||null===e.memoizedState?xa:Na,e=n(r,o),ra){i=0;do{if(ra=!1,!(25>i))throw Error(a(301));i+=1,ta=ea=null,t.updateQueue=null,qi.current=Ia,e=n(r,o)}while(ra)}if(qi.current=La,t=null!==ea&&null!==ea.next,Qi=0,ta=ea=Zi=null,na=!1,t)throw Error(a(300));return e}function sa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ta?Zi.memoizedState=ta=e:ta=ta.next=e,ta}function ua(){if(null===ea){var e=Zi.alternate;e=null!==e?e.memoizedState:null}else e=ea.next;var t=null===ta?Zi.memoizedState:ta.next;if(null!==t)ta=t,ea=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ea=e).memoizedState,baseState:ea.baseState,baseQueue:ea.baseQueue,queue:ea.queue,next:null},null===ta?Zi.memoizedState=ta=e:ta=ta.next=e}return ta}function la(e,t){return"function"==typeof t?t(e):t}function ca(e){var t=ua(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ea,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){o=o.next,r=r.baseState;var u=s=i=null,l=o;do{var c=l.lane;if((Qi&c)===c)null!==u&&(u=u.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),r=l.eagerReducer===e?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===u?(s=u=f,i=r):u=u.next=f,Zi.lanes|=c,js|=c}l=l.next}while(null!==l&&l!==o);null===u?i=r:u.next=s,lr(r,t.memoizedState)||(Pa=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function fa(e){var t=ua(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);lr(i,t.memoizedState)||(Pa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ha(e,t,n){var r=t._getVersion;r=r(t._source);var o=t._workInProgressVersionPrimary;if(null!==o?e=o===r:(e=e.mutableReadLanes,(e=(Qi&e)===e)&&(t._workInProgressVersionPrimary=r,Xi.push(t))),e)return n(t._source);throw Xi.push(t),Error(a(350))}function da(e,t,n,r){var o=As;if(null===o)throw Error(a(349));var i=t._getVersion,s=i(t._source),u=qi.current,l=u.useState((function(){return ha(o,t,n)})),c=l[1],f=l[0];l=ta;var h=e.memoizedState,d=h.refs,p=d.getSnapshot,m=h.source;h=h.subscribe;var y=Zi;return e.memoizedState={refs:d,source:t,subscribe:r},u.useEffect((function(){d.getSnapshot=n,d.setSnapshot=c;var e=i(t._source);if(!lr(s,e)){e=n(t._source),lr(f,e)||(c(e),e=cu(y),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var r=o.entanglements,a=e;0<a;){var u=31-Vt(a),l=1<<u;r[u]|=e,a&=~l}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=cu(y);o.mutableReadLanes|=r&o.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),lr(p,n)&&lr(m,t)&&lr(h,r)||((e={pending:null,dispatch:null,lastRenderedReducer:la,lastRenderedState:f}).dispatch=c=Aa.bind(null,Zi,e),l.queue=e,l.baseQueue=null,f=ha(o,t,n),l.memoizedState=l.baseState=f),f}function pa(e,t,n){return da(ua(),e,t,n)}function ma(e){var t=sa();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:la,lastRenderedState:e}).dispatch=Aa.bind(null,Zi,e),[t.memoizedState,e]}function ya(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Zi.updateQueue)?(t={lastEffect:null},Zi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function va(e){return e={current:e},sa().memoizedState=e}function ga(){return ua().memoizedState}function ba(e,t,n,r){var o=sa();Zi.flags|=e,o.memoizedState=ya(1|t,n,void 0,void 0===r?null:r)}function wa(e,t,n,r){var o=ua();r=void 0===r?null:r;var i=void 0;if(null!==ea){var a=ea.memoizedState;if(i=a.destroy,null!==r&&ia(r,a.deps))return void ya(t,n,i,r)}Zi.flags|=e,o.memoizedState=ya(1|t,n,i,r)}function _a(e,t){return ba(516,4,e,t)}function Sa(e,t){return wa(516,4,e,t)}function Ea(e,t){return wa(4,2,e,t)}function ka(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ra(e,t,n){return n=null!=n?n.concat([e]):null,wa(4,2,ka.bind(null,t,e),n)}function Ta(){}function Ca(e,t){var n=ua();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ma(e,t){var n=ua();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Oa(e,t){var n=Wo();Go(98>n?98:n,(function(){e(!0)})),Go(97<n?97:n,(function(){var n=Ji.transition;Ji.transition=1;try{e(!1),t()}finally{Ji.transition=n}}))}function Aa(e,t,n){var r=lu(),o=cu(e),i={lane:o,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),t.pending=i,a=e.alternate,e===Zi||null!==a&&a===Zi)ra=na=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=a(s,n);if(i.eagerReducer=a,i.eagerState=u,lr(u,s))return}catch(e){}fu(e,o,r)}}var La={readContext:ai,useCallback:oa,useContext:oa,useEffect:oa,useImperativeHandle:oa,useLayoutEffect:oa,useMemo:oa,useReducer:oa,useRef:oa,useState:oa,useDebugValue:oa,useDeferredValue:oa,useTransition:oa,useMutableSource:oa,useOpaqueIdentifier:oa,unstable_isNewReconciler:!1},xa={readContext:ai,useCallback:function(e,t){return sa().memoizedState=[e,void 0===t?null:t],e},useContext:ai,useEffect:_a,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,ba(4,2,ka.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ba(4,2,e,t)},useMemo:function(e,t){var n=sa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=sa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Aa.bind(null,Zi,e),[r.memoizedState,e]},useRef:va,useState:ma,useDebugValue:Ta,useDeferredValue:function(e){var t=ma(e),n=t[0],r=t[1];return _a((function(){var t=Ji.transition;Ji.transition=1;try{r(e)}finally{Ji.transition=t}}),[e]),n},useTransition:function(){var e=ma(!1),t=e[0];return va(e=Oa.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=sa();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},da(r,e,t,n)},useOpaqueIdentifier:function(){if(Ui){var e=!1,t=function(e){return{$$typeof:D,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+($r++).toString(36))),Error(a(355))})),n=ma(t)[1];return 0==(2&Zi.mode)&&(Zi.flags|=516,ya(5,(function(){n("r:"+($r++).toString(36))}),void 0,null)),t}return ma(t="r:"+($r++).toString(36)),t},unstable_isNewReconciler:!1},Na={readContext:ai,useCallback:Ca,useContext:ai,useEffect:Sa,useImperativeHandle:Ra,useLayoutEffect:Ea,useMemo:Ma,useReducer:ca,useRef:ga,useState:function(){return ca(la)},useDebugValue:Ta,useDeferredValue:function(e){var t=ca(la),n=t[0],r=t[1];return Sa((function(){var t=Ji.transition;Ji.transition=1;try{r(e)}finally{Ji.transition=t}}),[e]),n},useTransition:function(){var e=ca(la)[0];return[ga().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return ca(la)[0]},unstable_isNewReconciler:!1},Ia={readContext:ai,useCallback:Ca,useContext:ai,useEffect:Sa,useImperativeHandle:Ra,useLayoutEffect:Ea,useMemo:Ma,useReducer:fa,useRef:ga,useState:function(){return fa(la)},useDebugValue:Ta,useDeferredValue:function(e){var t=fa(la),n=t[0],r=t[1];return Sa((function(){var t=Ji.transition;Ji.transition=1;try{r(e)}finally{Ji.transition=t}}),[e]),n},useTransition:function(){var e=fa(la)[0];return[ga().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return fa(la)[0]},unstable_isNewReconciler:!1},Da=_.ReactCurrentOwner,Pa=!1;function Ha(e,t,n,r){t.child=null===e?Ci(t,null,n,r):Ti(t,e.child,n,r)}function ja(e,t,n,r,o){n=n.render;var i=t.ref;return ii(t,o),r=aa(e,t,n,r,i,o),null===e||Pa?(t.flags|=1,Ha(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ns(e,t,o))}function Fa(e,t,n,r,o,i){if(null===e){var a=n.type;return"function"!=typeof a||Bu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Wu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ya(e,t,a,r,o,i))}return a=e.child,0==(o&i)&&(o=a.memoizedProps,(n=null!==(n=n.compare)?n:fr)(o,r)&&e.ref===t.ref)?ns(e,t,i):(t.flags|=1,(e=Vu(a,r)).ref=t.ref,e.return=t,t.child=e)}function Ya(e,t,n,r,o,i){if(null!==e&&fr(e.memoizedProps,r)&&e.ref===t.ref){if(Pa=!1,0==(i&o))return t.lanes=e.lanes,ns(e,t,i);0!=(16384&e.flags)&&(Pa=!0)}return Va(e,t,n,r,i)}function Ua(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},bu(0,n);else{if(0==(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},bu(0,e),null;t.memoizedState={baseLanes:0},bu(0,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,bu(0,r);return Ha(e,t,o,n),t.child}function Ba(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Va(e,t,n,r,o){var i=vo(n)?mo:ho.current;return i=yo(t,i),ii(t,o),n=aa(e,t,n,r,i,o),null===e||Pa?(t.flags|=1,Ha(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ns(e,t,o))}function Wa(e,t,n,r,o){if(vo(n)){var i=!0;_o(t)}else i=!1;if(ii(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),bi(t,n,r),_i(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;l="object"==typeof l&&null!==l?ai(l):yo(t,l=vo(n)?mo:ho.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;f||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==l)&&wi(t,a,r,l),si=!1;var h=t.memoizedState;a.state=h,di(t,r,a,o),u=t.memoizedState,s!==r||h!==u||po.current||si?("function"==typeof c&&(yi(t,n,c,r),u=t.memoizedState),(s=si||gi(t,n,s,r,h,u,l))?(f||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,li(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Jo(t.type,s),a.props=l,f=t.pendingProps,h=a.context,u="object"==typeof(u=n.contextType)&&null!==u?ai(u):yo(t,u=vo(n)?mo:ho.current);var d=n.getDerivedStateFromProps;(c="function"==typeof d||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==f||h!==u)&&wi(t,a,r,u),si=!1,h=t.memoizedState,a.state=h,di(t,r,a,o);var p=t.memoizedState;s!==f||h!==p||po.current||si?("function"==typeof d&&(yi(t,n,d,r),p=t.memoizedState),(l=si||gi(t,n,l,r,h,p,u))?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,u),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,u)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=l):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),r=!1)}return za(e,t,n,r,i,o)}function za(e,t,n,r,o,i){Ba(e,t);var a=0!=(64&t.flags);if(!r&&!a)return o&&So(t,n,!1),ns(e,t,i);r=t.stateNode,Da.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Ti(t,e.child,null,i),t.child=Ti(t,null,s,i)):Ha(e,t,s,i),t.memoizedState=r.state,o&&So(t,n,!0),t.child}function Ga(e){var t=e.stateNode;t.pendingContext?bo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&bo(0,t.context,!1),Ni(e,t.containerInfo)}var Ka,Xa,$a,qa={dehydrated:null,retryLane:0};function Ja(e,t,n){var r,o=t.pendingProps,i=Hi.current,a=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&i)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(i|=1),co(Hi,1&i),null===e?(void 0!==o.fallback&&Wi(t),e=o.children,i=o.fallback,a?(e=Qa(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=qa,e):"number"==typeof o.unstable_expectedLoadTime?(e=Qa(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=qa,t.lanes=33554432,e):((n=Gu({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(o=function(e,t,n,r,o){var i=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 0==(2&i)&&t.child!==a?((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Vu(a,s),null!==e?r=Vu(e,r):(r=zu(r,i,o,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}(e,t,o.children,o.fallback,n),a=t.child,i=e.child.memoizedState,a.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=qa,o):(n=function(e,t,n,r){var o=e.child;return e=o.sibling,n=Vu(o,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}(e,t,o.children,n),t.memoizedState=null,n))}function Qa(e,t,n,r){var o=e.mode,i=e.child;return t={mode:"hidden",children:t},0==(2&o)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=Gu(t,o,0,null),n=zu(n,o,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function Za(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),oi(e.return,t)}function es(e,t,n,r,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,lastEffect:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o,a.lastEffect=i)}function ts(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Ha(e,t,r.children,n),0!=(2&(r=Hi.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Za(e,n);else if(19===e.tag)Za(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(co(Hi,r),0==(2&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ji(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),es(t,!1,o,n,i,t.lastEffect);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ji(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}es(t,!0,n,null,i,t.lastEffect);break;case"together":es(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ns(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),js|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Vu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Vu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function rs(e,t){if(!Ui)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function os(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return vo(t.type)&&go(),null;case 3:return Ii(),lo(po),lo(ho),$i(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Gi(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Pi(t);var i=xi(Li.current);if(n=t.type,null!==e&&null!=t.stateNode)Xa(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=xi(Oi.current),Gi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Jr]=t,r[Qr]=s,n){case"dialog":Or("cancel",r),Or("close",r);break;case"iframe":case"object":case"embed":Or("load",r);break;case"video":case"audio":for(e=0;e<Rr.length;e++)Or(Rr[e],r);break;case"source":Or("error",r);break;case"img":case"image":case"link":Or("error",r),Or("load",r);break;case"details":Or("toggle",r);break;case"input":ee(r,s),Or("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Or("invalid",r);break;case"textarea":ue(r,s),Or("invalid",r)}for(var l in Ee(n,s),e=null,s)s.hasOwnProperty(l)&&(i=s[l],"children"===l?"string"==typeof i?r.textContent!==i&&(e=["children",i]):"number"==typeof i&&r.textContent!==""+i&&(e=["children",""+i]):u.hasOwnProperty(l)&&null!=i&&"onScroll"===l&&Or("scroll",r));switch(n){case"input":q(r),re(r,s,!0);break;case"textarea":q(r),ce(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=Fr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(l=9===i.nodeType?i:i.ownerDocument,e===fe&&(e=he(n)),e===fe?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Jr]=t,e[Qr]=r,Ka(e,t),t.stateNode=e,l=ke(n,r),n){case"dialog":Or("cancel",e),Or("close",e),i=r;break;case"iframe":case"object":case"embed":Or("load",e),i=r;break;case"video":case"audio":for(i=0;i<Rr.length;i++)Or(Rr[i],e);i=r;break;case"source":Or("error",e),i=r;break;case"img":case"image":case"link":Or("error",e),Or("load",e),i=r;break;case"details":Or("toggle",e),i=r;break;case"input":ee(e,r),i=Z(e,r),Or("invalid",e);break;case"option":i=ie(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=o({},r,{value:void 0}),Or("invalid",e);break;case"textarea":ue(e,r),i=se(e,r),Or("invalid",e);break;default:i=r}Ee(n,i);var c=i;for(s in c)if(c.hasOwnProperty(s)){var f=c[s];"style"===s?_e(e,f):"dangerouslySetInnerHTML"===s?null!=(f=f?f.__html:void 0)&&ye(e,f):"children"===s?"string"==typeof f?("textarea"!==n||""!==f)&&ve(e,f):"number"==typeof f&&ve(e,""+f):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(u.hasOwnProperty(s)?null!=f&&"onScroll"===s&&Or("scroll",e):null!=f&&w(e,s,f,l))}switch(n){case"input":q(e),re(e,r,!1);break;case"textarea":q(e),ce(e);break;case"option":null!=r.value&&e.setAttribute("value",""+X(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ae(e,!!r.multiple,s,!1):null!=r.defaultValue&&ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Fr)}Br(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)$a(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));n=xi(Li.current),xi(Oi.current),Gi(t)?(r=t.stateNode,n=t.memoizedProps,r[Jr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Jr]=t,t.stateNode=r)}return null;case 13:return lo(Hi),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Gi(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&Hi.current)?0===Ds&&(Ds=3):(0!==Ds&&3!==Ds||(Ds=4),null===As||0==(134217727&js)&&0==(134217727&Fs)||mu(As,xs))),(r||n)&&(t.flags|=4),null);case 4:return Ii(),null===e&&Lr(t.stateNode.containerInfo),null;case 10:return ri(t),null;case 19:if(lo(Hi),null===(r=t.memoizedState))return null;if(s=0!=(64&t.flags),null===(l=r.rendering))if(s)rs(r,!1);else{if(0!==Ds||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(l=ji(e))){for(t.flags|=64,rs(r,!1),null!==(s=l.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return co(Hi,1&Hi.current|2),t.child}e=e.sibling}null!==r.tail&&Vo()>Vs&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=ji(l))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),rs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!Ui)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Vo()-r.renderingStartTime>Vs&&1073741824!==n&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Vo(),n.sibling=null,t=Hi.current,co(Hi,s?1&t|2:1&t),n):null;case 23:case 24:return wu(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(a(156,t.tag))}function is(e){switch(e.tag){case 1:vo(e.type)&&go();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ii(),lo(po),lo(ho),$i(),0!=(64&(t=e.flags)))throw Error(a(285));return e.flags=-4097&t|64,e;case 5:return Pi(e),null;case 13:return lo(Hi),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return lo(Hi),null;case 4:return Ii(),null;case 10:return ri(e),null;case 23:case 24:return wu(),null;default:return null}}function as(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o}}function ss(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Ka=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Xa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,xi(Oi.current);var a,s=null;switch(n){case"input":i=Z(e,i),r=Z(e,r),s=[];break;case"option":i=ie(e,i),r=ie(e,r),s=[];break;case"select":i=o({},i,{value:void 0}),r=o({},r,{value:void 0}),s=[];break;case"textarea":i=se(e,i),r=se(e,r),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Fr)}for(f in Ee(n,r),n=null,i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&null!=i[f])if("style"===f){var l=i[f];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==f&&"children"!==f&&"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(u.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in r){var c=r[f];if(l=null!=i?i[f]:void 0,r.hasOwnProperty(f)&&c!==l&&(null!=c||null!=l))if("style"===f)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(f,n)),n=c;else"dangerouslySetInnerHTML"===f?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(f,c)):"children"===f?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(f,""+c):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&(u.hasOwnProperty(f)?(null!=c&&"onScroll"===f&&Or("scroll",e),s||l===c||(s=[])):"object"==typeof c&&null!==c&&c.$$typeof===D?c.toString():(s=s||[]).push(f,c))}n&&(s=s||[]).push("style",n);var f=s;(t.updateQueue=f)&&(t.flags|=4)}},$a=function(e,t,n,r){n!==r&&(t.flags|=4)};var us="function"==typeof WeakMap?WeakMap:Map;function ls(e,t,n){(n=ci(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ks||(Ks=!0,Xs=r),ss(0,t)},n}function cs(e,t,n){(n=ci(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return ss(0,t),r(o)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===$s?$s=new Set([this]):$s.add(this),ss(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var fs="function"==typeof WeakSet?WeakSet:Set;function hs(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Hu(e,t)}else t.current=null}function ds(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Jo(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Gr(t.stateNode.containerInfo))}throw Error(a(163))}function ps(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;r=o.next,0!=(4&(o=o.tag))&&0!=(1&o)&&(Iu(n,e),Nu(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Jo(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&pi(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}pi(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Br(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&_t(n)))))}throw Error(a(163))}function ms(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var o=n.memoizedProps.style;o=null!=o&&o.hasOwnProperty("display")?o.display:null,r.style.display=we("display",o)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ys(e,t){if(ko&&"function"==typeof ko.onCommitFiberUnmount)try{ko.onCommitFiberUnmount(Eo,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,o=r.destroy;if(r=r.tag,void 0!==o)if(0!=(4&r))Iu(t,n);else{r=t;try{o()}catch(e){Hu(r,e)}}n=n.next}while(n!==e)}break;case 1:if(hs(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Hu(t,e)}break;case 5:hs(t);break;case 4:Ss(e,t)}}function vs(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function gs(e){return 5===e.tag||3===e.tag||4===e.tag}function bs(e){e:{for(var t=e.return;null!==t;){if(gs(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.flags&&(ve(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||gs(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?ws(e,n,t):_s(e,n,t)}function ws(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Fr));else if(4!==r&&null!==(e=e.child))for(ws(e,t,n),e=e.sibling;null!==e;)ws(e,t,n),e=e.sibling}function _s(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(_s(e,t,n),e=e.sibling;null!==e;)_s(e,t,n),e=e.sibling}function Ss(e,t){for(var n,r,o=t,i=!1;;){if(!i){i=o.return;e:for(;;){if(null===i)throw Error(a(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===o.tag||6===o.tag){e:for(var s=e,u=o,l=u;;)if(ys(s,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===u)break e;for(;null===l.sibling;){if(null===l.return||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}r?(s=n,u=o.stateNode,8===s.nodeType?s.parentNode.removeChild(u):s.removeChild(u)):n.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){n=o.stateNode.containerInfo,r=!0,o.child.return=o,o=o.child;continue}}else if(ys(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(i=!1)}o.sibling.return=o.return,o=o.sibling}}function Es(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var o=null!==e?e.memoizedProps:r;e=t.type;var i=t.updateQueue;if(t.updateQueue=null,null!==i){for(n[Qr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),ke(e,o),t=ke(e,r),o=0;o<i.length;o+=2){var s=i[o],u=i[o+1];"style"===s?_e(n,u):"dangerouslySetInnerHTML"===s?ye(n,u):"children"===s?ve(n,u):w(n,s,u,t)}switch(e){case"input":ne(n,r);break;case"textarea":le(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?ae(n,!!r.multiple,i,!1):e!==!!r.multiple&&(null!=r.defaultValue?ae(n,!!r.multiple,r.defaultValue,!0):ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,_t(n.containerInfo)));case 13:return null!==t.memoizedState&&(Bs=Vo(),ms(t.child,!0)),void ks(t);case 19:return void ks(t);case 23:case 24:return void ms(t,null!==t.memoizedState)}throw Error(a(163))}function ks(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new fs),t.forEach((function(t){var r=Fu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Rs(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&null!==(t=t.memoizedState)&&null===t.dehydrated}var Ts=Math.ceil,Cs=_.ReactCurrentDispatcher,Ms=_.ReactCurrentOwner,Os=0,As=null,Ls=null,xs=0,Ns=0,Is=uo(0),Ds=0,Ps=null,Hs=0,js=0,Fs=0,Ys=0,Us=null,Bs=0,Vs=1/0;function Ws(){Vs=Vo()+500}var zs,Gs=null,Ks=!1,Xs=null,$s=null,qs=!1,Js=null,Qs=90,Zs=[],eu=[],tu=null,nu=0,ru=null,ou=-1,iu=0,au=0,su=null,uu=!1;function lu(){return 0!=(48&Os)?Vo():-1!==ou?ou:ou=Vo()}function cu(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===Wo()?1:2;if(0===iu&&(iu=Hs),0!==qo.transition){0!==au&&(au=null!==Us?Us.pendingLanes:0),e=iu;var t=4186112&~au;return 0==(t&=-t)&&0==(t=(e=4186112&~e)&-e)&&(t=8192),t}return e=Wo(),e=Ft(0!=(4&Os)&&98===e?12:e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),iu)}function fu(e,t,n){if(50<nu)throw nu=0,ru=null,Error(a(185));if(null===(e=hu(e,t)))return null;Bt(e,t,n),e===As&&(Fs|=t,4===Ds&&mu(e,xs));var r=Wo();1===t?0!=(8&Os)&&0==(48&Os)?yu(e):(du(e,n),0===Os&&(Ws(),Xo())):(0==(4&Os)||98!==r&&99!==r||(null===tu?tu=new Set([e]):tu.add(e)),du(e,n)),Us=e}function hu(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function du(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,o=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var u=31-Vt(s),l=1<<u,c=i[u];if(-1===c){if(0==(l&r)||0!=(l&o)){c=t,Pt(l);var f=Dt;i[u]=10<=f?c+250:6<=f?c+5e3:-1}}else c<=t&&(e.expiredLanes|=l);s&=~l}if(r=Ht(e,e===As?xs:0),t=Dt,0===r)null!==n&&(n!==Ho&&Co(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Ho&&Co(n)}15===t?(n=yu.bind(null,e),null===Fo?(Fo=[n],Yo=To(xo,$o)):Fo.push(n),n=Ho):14===t?n=Ko(99,yu.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,e))}}(t),n=Ko(n,pu.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function pu(e){if(ou=-1,au=iu=0,0!=(48&Os))throw Error(a(327));var t=e.callbackNode;if(xu()&&e.callbackNode!==t)return null;var n=Ht(e,e===As?xs:0);if(0===n)return null;var r=n,o=Os;Os|=16;var i=Eu();for(As===e&&xs===r||(Ws(),_u(e,r));;)try{Tu();break}catch(t){Su(e,t)}if(ni(),Cs.current=i,Os=o,null!==Ls?r=0:(As=null,xs=0,r=Ds),0!=(Hs&Fs))_u(e,0);else if(0!==r){if(2===r&&(Os|=64,e.hydrate&&(e.hydrate=!1,Gr(e.containerInfo)),0!==(n=jt(e))&&(r=ku(e,n))),1===r)throw t=Ps,_u(e,0),mu(e,n),du(e,Vo()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(a(345));case 2:case 5:Ou(e);break;case 3:if(mu(e,n),(62914560&n)===n&&10<(r=Bs+500-Vo())){if(0!==Ht(e,0))break;if(((o=e.suspendedLanes)&n)!==n){lu(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Wr(Ou.bind(null,e),r);break}Ou(e);break;case 4:if(mu(e,n),(4186112&n)===n)break;for(r=e.eventTimes,o=-1;0<n;){var s=31-Vt(n);i=1<<s,(s=r[s])>o&&(o=s),n&=~i}if(n=o,10<(n=(120>(n=Vo()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ts(n/1960))-n)){e.timeoutHandle=Wr(Ou.bind(null,e),n);break}Ou(e);break;default:throw Error(a(329))}}return du(e,Vo()),e.callbackNode===t?pu.bind(null,e):null}function mu(e,t){for(t&=~Ys,t&=~Fs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Vt(t),r=1<<n;e[n]=-1,t&=~r}}function yu(e){if(0!=(48&Os))throw Error(a(327));if(xu(),e===As&&0!=(e.expiredLanes&xs)){var t=xs,n=ku(e,t);0!=(Hs&Fs)&&(n=ku(e,t=Ht(e,t)))}else n=ku(e,t=Ht(e,0));if(0!==e.tag&&2===n&&(Os|=64,e.hydrate&&(e.hydrate=!1,Gr(e.containerInfo)),0!==(t=jt(e))&&(n=ku(e,t))),1===n)throw n=Ps,_u(e,0),mu(e,t),du(e,Vo()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ou(e),du(e,Vo()),null}function vu(e,t){var n=Os;Os|=1;try{return e(t)}finally{0===(Os=n)&&(Ws(),Xo())}}function gu(e,t){var n=Os;Os&=-2,Os|=8;try{return e(t)}finally{0===(Os=n)&&(Ws(),Xo())}}function bu(e,t){co(Is,Ns),Ns|=t,Hs|=t}function wu(){Ns=Is.current,lo(Is)}function _u(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,zr(n)),null!==Ls)for(n=Ls.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&go();break;case 3:Ii(),lo(po),lo(ho),$i();break;case 5:Pi(r);break;case 4:Ii();break;case 13:case 19:lo(Hi);break;case 10:ri(r);break;case 23:case 24:wu()}n=n.return}As=e,Ls=Vu(e.current,null),xs=Ns=Hs=t,Ds=0,Ps=null,Ys=Fs=js=0}function Su(e,t){for(;;){var n=Ls;try{if(ni(),qi.current=La,na){for(var r=Zi.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}na=!1}if(Qi=0,ta=ea=Zi=null,ra=!1,Ms.current=null,null===n||null===n.return){Ds=1,Ps=t,Ls=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=xs,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var l=u;if(0==(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var f=0!=(1&Hi.current),h=a;do{var d;if(d=13===h.tag){var p=h.memoizedState;if(null!==p)d=null!==p.dehydrated;else{var m=h.memoizedProps;d=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!f)}}if(d){var y=h.updateQueue;if(null===y){var v=new Set;v.add(l),h.updateQueue=v}else y.add(l);if(0==(2&h.mode)){if(h.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var g=ci(-1,1);g.tag=2,fi(s,g)}s.lanes|=1;break e}u=void 0,s=t;var b=i.pingCache;if(null===b?(b=i.pingCache=new us,u=new Set,b.set(l,u)):void 0===(u=b.get(l))&&(u=new Set,b.set(l,u)),!u.has(s)){u.add(s);var w=ju.bind(null,i,l,s);l.then(w,w)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);u=Error((K(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ds&&(Ds=2),u=as(u,s),h=a;do{switch(h.tag){case 3:i=u,h.flags|=4096,t&=-t,h.lanes|=t,hi(h,ls(0,i,t));break e;case 1:i=u;var _=h.type,S=h.stateNode;if(0==(64&h.flags)&&("function"==typeof _.getDerivedStateFromError||null!==S&&"function"==typeof S.componentDidCatch&&(null===$s||!$s.has(S)))){h.flags|=4096,t&=-t,h.lanes|=t,hi(h,cs(h,i,t));break e}}h=h.return}while(null!==h)}Mu(n)}catch(e){t=e,Ls===n&&null!==n&&(Ls=n=n.return);continue}break}}function Eu(){var e=Cs.current;return Cs.current=La,null===e?La:e}function ku(e,t){var n=Os;Os|=16;var r=Eu();for(As===e&&xs===t||_u(e,t);;)try{Ru();break}catch(t){Su(e,t)}if(ni(),Os=n,Cs.current=r,null!==Ls)throw Error(a(261));return As=null,xs=0,Ds}function Ru(){for(;null!==Ls;)Cu(Ls)}function Tu(){for(;null!==Ls&&!Mo();)Cu(Ls)}function Cu(e){var t=zs(e.alternate,e,Ns);e.memoizedProps=e.pendingProps,null===t?Mu(e):Ls=t,Ms.current=null}function Mu(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=os(n,t,Ns)))return void(Ls=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&Ns)||0==(4&n.mode)){for(var r=0,o=n.child;null!==o;)r|=o.lanes|o.childLanes,o=o.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=is(t)))return n.flags&=2047,void(Ls=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ls=t);Ls=t=e}while(null!==t);0===Ds&&(Ds=5)}function Ou(e){var t=Wo();return Go(99,Au.bind(null,e,t)),null}function Au(e,t){do{xu()}while(null!==Js);if(0!=(48&Os))throw Error(a(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null;var r=n.lanes|n.childLanes,o=r,i=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var s=e.eventTimes,u=e.expirationTimes;0<i;){var l=31-Vt(i),c=1<<l;o[l]=0,s[l]=-1,u[l]=-1,i&=~c}if(null!==tu&&0==(24&r)&&tu.has(e)&&tu.delete(e),e===As&&(Ls=As=null,xs=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(o=Os,Os|=32,Ms.current=null,Yr=Xt,yr(s=mr())){if("selectionStart"in s)u={start:s.selectionStart,end:s.selectionEnd};else e:if(u=(u=s.ownerDocument)&&u.defaultView||window,(c=u.getSelection&&u.getSelection())&&0!==c.rangeCount){u=c.anchorNode,i=c.anchorOffset,l=c.focusNode,c=c.focusOffset;try{u.nodeType,l.nodeType}catch(e){u=null;break e}var f=0,h=-1,d=-1,p=0,m=0,y=s,v=null;t:for(;;){for(var g;y!==u||0!==i&&3!==y.nodeType||(h=f+i),y!==l||0!==c&&3!==y.nodeType||(d=f+c),3===y.nodeType&&(f+=y.nodeValue.length),null!==(g=y.firstChild);)v=y,y=g;for(;;){if(y===s)break t;if(v===u&&++p===i&&(h=f),v===l&&++m===c&&(d=f),null!==(g=y.nextSibling))break;v=(y=v).parentNode}y=g}u=-1===h||-1===d?null:{start:h,end:d}}else u=null;u=u||{start:0,end:0}}else u=null;Ur={focusedElem:s,selectionRange:u},Xt=!1,su=null,uu=!1,Gs=r;do{try{Lu()}catch(e){if(null===Gs)throw Error(a(330));Hu(Gs,e),Gs=Gs.nextEffect}}while(null!==Gs);su=null,Gs=r;do{try{for(s=e;null!==Gs;){var b=Gs.flags;if(16&b&&ve(Gs.stateNode,""),128&b){var w=Gs.alternate;if(null!==w){var _=w.ref;null!==_&&("function"==typeof _?_(null):_.current=null)}}switch(1038&b){case 2:bs(Gs),Gs.flags&=-3;break;case 6:bs(Gs),Gs.flags&=-3,Es(Gs.alternate,Gs);break;case 1024:Gs.flags&=-1025;break;case 1028:Gs.flags&=-1025,Es(Gs.alternate,Gs);break;case 4:Es(Gs.alternate,Gs);break;case 8:Ss(s,u=Gs);var S=u.alternate;vs(u),null!==S&&vs(S)}Gs=Gs.nextEffect}}catch(e){if(null===Gs)throw Error(a(330));Hu(Gs,e),Gs=Gs.nextEffect}}while(null!==Gs);if(_=Ur,w=mr(),b=_.focusedElem,s=_.selectionRange,w!==b&&b&&b.ownerDocument&&pr(b.ownerDocument.documentElement,b)){null!==s&&yr(b)&&(w=s.start,void 0===(_=s.end)&&(_=w),"selectionStart"in b?(b.selectionStart=w,b.selectionEnd=Math.min(_,b.value.length)):(_=(w=b.ownerDocument||document)&&w.defaultView||window).getSelection&&(_=_.getSelection(),u=b.textContent.length,S=Math.min(s.start,u),s=void 0===s.end?S:Math.min(s.end,u),!_.extend&&S>s&&(u=s,s=S,S=u),u=dr(b,S),i=dr(b,s),u&&i&&(1!==_.rangeCount||_.anchorNode!==u.node||_.anchorOffset!==u.offset||_.focusNode!==i.node||_.focusOffset!==i.offset)&&((w=w.createRange()).setStart(u.node,u.offset),_.removeAllRanges(),S>s?(_.addRange(w),_.extend(i.node,i.offset)):(w.setEnd(i.node,i.offset),_.addRange(w))))),w=[];for(_=b;_=_.parentNode;)1===_.nodeType&&w.push({element:_,left:_.scrollLeft,top:_.scrollTop});for("function"==typeof b.focus&&b.focus(),b=0;b<w.length;b++)(_=w[b]).element.scrollLeft=_.left,_.element.scrollTop=_.top}Xt=!!Yr,Ur=Yr=null,e.current=n,Gs=r;do{try{for(b=e;null!==Gs;){var E=Gs.flags;if(36&E&&ps(b,Gs.alternate,Gs),128&E){w=void 0;var k=Gs.ref;if(null!==k){var R=Gs.stateNode;Gs.tag,w=R,"function"==typeof k?k(w):k.current=w}}Gs=Gs.nextEffect}}catch(e){if(null===Gs)throw Error(a(330));Hu(Gs,e),Gs=Gs.nextEffect}}while(null!==Gs);Gs=null,jo(),Os=o}else e.current=n;if(qs)qs=!1,Js=e,Qs=t;else for(Gs=r;null!==Gs;)t=Gs.nextEffect,Gs.nextEffect=null,8&Gs.flags&&((E=Gs).sibling=null,E.stateNode=null),Gs=t;if(0===(r=e.pendingLanes)&&($s=null),1===r?e===ru?nu++:(nu=0,ru=e):nu=0,n=n.stateNode,ko&&"function"==typeof ko.onCommitFiberRoot)try{ko.onCommitFiberRoot(Eo,n,void 0,64==(64&n.current.flags))}catch(e){}if(du(e,Vo()),Ks)throw Ks=!1,e=Xs,Xs=null,e;return 0!=(8&Os)||Xo(),null}function Lu(){for(;null!==Gs;){var e=Gs.alternate;uu||null===su||(0!=(8&Gs.flags)?Ze(Gs,su)&&(uu=!0):13===Gs.tag&&Rs(e,Gs)&&Ze(Gs,su)&&(uu=!0));var t=Gs.flags;0!=(256&t)&&ds(e,Gs),0==(512&t)||qs||(qs=!0,Ko(97,(function(){return xu(),null}))),Gs=Gs.nextEffect}}function xu(){if(90!==Qs){var e=97<Qs?97:Qs;return Qs=90,Go(e,Du)}return!1}function Nu(e,t){Zs.push(t,e),qs||(qs=!0,Ko(97,(function(){return xu(),null})))}function Iu(e,t){eu.push(t,e),qs||(qs=!0,Ko(97,(function(){return xu(),null})))}function Du(){if(null===Js)return!1;var e=Js;if(Js=null,0!=(48&Os))throw Error(a(331));var t=Os;Os|=32;var n=eu;eu=[];for(var r=0;r<n.length;r+=2){var o=n[r],i=n[r+1],s=o.destroy;if(o.destroy=void 0,"function"==typeof s)try{s()}catch(e){if(null===i)throw Error(a(330));Hu(i,e)}}for(n=Zs,Zs=[],r=0;r<n.length;r+=2){o=n[r],i=n[r+1];try{var u=o.create;o.destroy=u()}catch(e){if(null===i)throw Error(a(330));Hu(i,e)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return Os=t,Xo(),!0}function Pu(e,t,n){fi(e,t=ls(0,t=as(n,t),1)),t=lu(),null!==(e=hu(e,1))&&(Bt(e,1,t),du(e,t))}function Hu(e,t){if(3===e.tag)Pu(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Pu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===$s||!$s.has(r))){var o=cs(n,e=as(t,e),1);if(fi(n,o),o=lu(),null!==(n=hu(n,1)))Bt(n,1,o),du(n,o);else if("function"==typeof r.componentDidCatch&&(null===$s||!$s.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function ju(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=lu(),e.pingedLanes|=e.suspendedLanes&n,As===e&&(xs&n)===n&&(4===Ds||3===Ds&&(62914560&xs)===xs&&500>Vo()-Bs?_u(e,0):Ys|=n),du(e,t)}function Fu(e,t){var n=e.stateNode;null!==n&&n.delete(t),0==(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===Wo()?1:2:(0===iu&&(iu=Hs),0===(t=Yt(62914560&~iu))&&(t=4194304))),n=lu(),null!==(e=hu(e,t))&&(Bt(e,t,n),du(e,n))}function Yu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Uu(e,t,n,r){return new Yu(e,t,n,r)}function Bu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vu(e,t){var n=e.alternate;return null===n?((n=Uu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Wu(e,t,n,r,o,i){var s=2;if(r=e,"function"==typeof e)Bu(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case k:return zu(n.children,o,i,t);case P:s=8,o|=16;break;case R:s=8,o|=1;break;case T:return(e=Uu(12,n,t,8|o)).elementType=T,e.type=T,e.lanes=i,e;case A:return(e=Uu(13,n,t,o)).type=A,e.elementType=A,e.lanes=i,e;case L:return(e=Uu(19,n,t,o)).elementType=L,e.lanes=i,e;case H:return Gu(n,o,i,t);case j:return(e=Uu(24,n,t,o)).elementType=j,e.lanes=i,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case M:s=9;break e;case O:s=11;break e;case x:s=14;break e;case N:s=16,r=null;break e;case I:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Uu(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function zu(e,t,n,r){return(e=Uu(7,e,r,t)).lanes=n,e}function Gu(e,t,n,r){return(e=Uu(23,e,r,t)).elementType=H,e.lanes=n,e}function Ku(e,t,n){return(e=Uu(6,e,null,t)).lanes=n,e}function Xu(e,t,n){return(t=Uu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $u(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ut(0),this.expirationTimes=Ut(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ut(0),this.mutableSourceEagerHydrationData=null}function qu(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Ju(e,t,n,r){var o=t.current,i=lu(),s=cu(o);e:if(n){t:{if($e(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(vo(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var l=n.type;if(vo(l)){n=wo(n,l,u);break e}}n=u}else n=fo;return null===t.context?t.context=n:t.pendingContext=n,(t=ci(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),fi(o,t),fu(o,s,i),s}function Qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Zu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function el(e,t){Zu(e,t),(e=e.alternate)&&Zu(e,t)}function tl(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new $u(e,t,null!=n&&!0===n.hydrate),t=Uu(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ui(t),e[Zr]=n.current,Lr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var o=(t=r[e])._getVersion;o=o(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,o]:n.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=n}function nl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function rl(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i._internalRoot;if("function"==typeof o){var s=o;o=function(){var e=Qu(a);s.call(e)}}Ju(t,a,e,o)}else{if(i=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new tl(e,0,t?{hydrate:!0}:void 0)}(n,r),a=i._internalRoot,"function"==typeof o){var u=o;o=function(){var e=Qu(a);u.call(e)}}gu((function(){Ju(t,a,e,o)}))}return Qu(a)}function ol(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(t))throw Error(a(200));return qu(e,t,null,n)}zs=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||po.current)Pa=!0;else{if(0==(n&r)){switch(Pa=!1,t.tag){case 3:Ga(t),Ki();break;case 5:Di(t);break;case 1:vo(t.type)&&_o(t);break;case 4:Ni(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var o=t.type._context;co(Qo,o._currentValue),o._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?Ja(e,t,n):(co(Hi,1&Hi.current),null!==(t=ns(e,t,n))?t.sibling:null);co(Hi,1&Hi.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return ts(e,t,n);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),co(Hi,Hi.current),r)break;return null;case 23:case 24:return t.lanes=0,Ua(e,t,n)}return ns(e,t,n)}Pa=0!=(16384&e.flags)}else Pa=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=yo(t,ho.current),ii(t,n),o=aa(null,t,r,e,o,n),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,vo(r)){var i=!0;_o(t)}else i=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,ui(t);var s=r.getDerivedStateFromProps;"function"==typeof s&&yi(t,r,s,e),o.updater=vi,t.stateNode=o,o._reactInternals=t,_i(t,r,e,n),t=za(null,t,r,!0,i,n)}else t.tag=0,Ha(null,t,o,n),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(i=o._init)(o._payload),t.type=o,i=t.tag=function(e){if("function"==typeof e)return Bu(e)?1:0;if(null!=e){if((e=e.$$typeof)===O)return 11;if(e===x)return 14}return 2}(o),e=Jo(o,e),i){case 0:t=Va(null,t,o,e,n);break e;case 1:t=Wa(null,t,o,e,n);break e;case 11:t=ja(null,t,o,e,n);break e;case 14:t=Fa(null,t,o,Jo(o.type,e),r,n);break e}throw Error(a(306,o,""))}return t;case 0:return r=t.type,o=t.pendingProps,Va(e,t,r,o=t.elementType===r?o:Jo(r,o),n);case 1:return r=t.type,o=t.pendingProps,Wa(e,t,r,o=t.elementType===r?o:Jo(r,o),n);case 3:if(Ga(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,li(e,t),di(t,r,null,n),(r=t.memoizedState.element)===o)Ki(),t=ns(e,t,n);else{if((i=(o=t.stateNode).hydrate)&&(Yi=Kr(t.stateNode.containerInfo.firstChild),Fi=t,i=Ui=!0),i){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(i=e[o])._workInProgressVersionPrimary=e[o+1],Xi.push(i);for(n=Ci(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Ha(e,t,r,n),Ki();t=t.child}return t;case 5:return Di(t),null===e&&Wi(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,Vr(r,o)?s=null:null!==i&&Vr(r,i)&&(t.flags|=16),Ba(e,t),Ha(e,t,s,n),t.child;case 6:return null===e&&Wi(t),null;case 13:return Ja(e,t,n);case 4:return Ni(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ti(t,null,r,n):Ha(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,ja(e,t,r,o=t.elementType===r?o:Jo(r,o),n);case 7:return Ha(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ha(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,o=t.pendingProps,s=t.memoizedProps,i=o.value;var u=t.type._context;if(co(Qo,u._currentValue),u._currentValue=i,null!==s)if(u=s.value,0==(i=lr(u,i)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(u,i):1073741823))){if(s.children===o.children&&!po.current){t=ns(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var l=u.dependencies;if(null!==l){s=u.child;for(var c=l.firstContext;null!==c;){if(c.context===r&&0!=(c.observedBits&i)){1===u.tag&&((c=ci(-1,n&-n)).tag=2,fi(u,c)),u.lanes|=n,null!==(c=u.alternate)&&(c.lanes|=n),oi(u.return,n),l.lanes|=n;break}c=c.next}}else s=10===u.tag&&u.type===t.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===t){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Ha(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=(i=t.pendingProps).children,ii(t,n),r=r(o=ai(o,i.unstable_observedBits)),t.flags|=1,Ha(e,t,r,n),t.child;case 14:return i=Jo(o=t.type,t.pendingProps),Fa(e,t,o,i=Jo(o.type,i),r,n);case 15:return Ya(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Jo(r,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,vo(r)?(e=!0,_o(t)):e=!1,ii(t,n),bi(t,r,o),_i(t,r,o,n),za(null,t,r,!0,e,n);case 19:return ts(e,t,n);case 23:case 24:return Ua(e,t,n)}throw Error(a(156,t.tag))},tl.prototype.render=function(e){Ju(e,this._internalRoot,null,null)},tl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Ju(null,e,null,(function(){t[Zr]=null}))},et=function(e){13===e.tag&&(fu(e,4,lu()),el(e,4))},tt=function(e){13===e.tag&&(fu(e,67108864,lu()),el(e,67108864))},nt=function(e){if(13===e.tag){var t=lu(),n=cu(e);fu(e,n,t),el(e,n)}},rt=function(e,t){return t()},Te=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=oo(r);if(!o)throw Error(a(90));J(r),ne(r,o)}}}break;case"textarea":le(e,n);break;case"select":null!=(t=n.value)&&ae(e,!!n.multiple,t,!1)}},xe=vu,Ne=function(e,t,n,r,o){var i=Os;Os|=4;try{return Go(98,e.bind(null,t,n,r,o))}finally{0===(Os=i)&&(Ws(),Xo())}},Ie=function(){0==(49&Os)&&(function(){if(null!==tu){var e=tu;tu=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,du(e,Vo())}))}Xo()}(),xu())},De=function(e,t){var n=Os;Os|=2;try{return e(t)}finally{0===(Os=n)&&(Ws(),Xo())}};var il={Events:[no,ro,oo,Ae,Le,xu,{current:!1}]},al={findFiberByHostInstance:to,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},sl={bundleType:al.bundleType,version:al.version,rendererPackageName:al.rendererPackageName,rendererConfig:al.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Qe(e))?null:e.stateNode},findFiberByHostInstance:al.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ul.isDisabled&&ul.supportsFiber)try{Eo=ul.inject(sl),ko=ul}catch(me){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=il,t.createPortal=ol,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return null===(e=Qe(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Os;if(0!=(48&n))return e(t);Os|=1;try{if(e)return Go(99,e.bind(null,t))}finally{Os=n,Xo()}},t.hydrate=function(e,t,n){if(!nl(t))throw Error(a(200));return rl(null,e,t,!0,n)},t.render=function(e,t,n){if(!nl(t))throw Error(a(200));return rl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!nl(e))throw Error(a(40));return!!e._reactRootContainer&&(gu((function(){rl(null,null,e,!1,(function(){e._reactRootContainer=null,e[Zr]=null}))})),!0)},t.unstable_batchedUpdates=vu,t.unstable_createPortal=function(e,t){return ol(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nl(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return rl(e,t,n,!1,r)},t.version="17.0.2"},46116:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(93748)},46751:(e,t,n)=>{"use strict";var r=n(37347),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,u=60112;t.Suspense=60113;var l=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var f=Symbol.for;o=f("react.element"),i=f("react.portal"),t.Fragment=f("react.fragment"),t.StrictMode=f("react.strict_mode"),t.Profiler=f("react.profiler"),a=f("react.provider"),s=f("react.context"),u=f("react.forward_ref"),t.Suspense=f("react.suspense"),l=f("react.memo"),c=f("react.lazy")}var h="function"==typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=g.prototype=new v;b.constructor=g,r(b,y.prototype),b.isPureReactComponent=!0;var w={current:null},_=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,r)&&!S.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:w.current}}function k(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var R=/\/+/g;function T(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,n,r,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case i:u=!0}}if(u)return a=a(u=e),e=""===r?"."+T(u,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(R,"$&/")+"/"),C(a,t,n,"",(function(e){return e}))):null!=a&&(k(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(R,"$&/")+"/")+e)),t.push(a)),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=r+T(s=e[l],l);u+=C(s,t,n,c,a)}else if(c=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=C(s=s.value,t,n,c=r+T(s,l++),a);else if("object"===s)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return u}function M(e,t,n){if(null==e)return e;var r=[],o=0;return C(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function O(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var A={current:null};function L(){var e=A.current;if(null===e)throw Error(d(321));return e}var x={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error(d(143));return e}},t.Component=y,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,t.cloneElement=function(e,t,n){if(null==e)throw Error(d(267,e));var i=r({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=w.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var f=0;f<c;f++)l[f]=arguments[f+2];i.children=l}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:c,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:l,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return L().useCallback(e,t)},t.useContext=function(e,t){return L().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return L().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return L().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return L().useLayoutEffect(e,t)},t.useMemo=function(e,t){return L().useMemo(e,t)},t.useReducer=function(e,t,n){return L().useReducer(e,t,n)},t.useRef=function(e){return L().useRef(e)},t.useState=function(e){return L().useState(e)},t.version="17.0.2"},35466:(e,t,n)=>{"use strict";e.exports=n(46751)},77588:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),a=new M(r||[]);return i._invoke=function(e,t,n){var r=f;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=R(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?p:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",m={};function y(){}function v(){}function g(){}var b={};u(b,i,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(O([])));_&&_!==n&&r.call(_,i)&&(b=_);var S=g.prototype=y.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,s){var u=c(e[o],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function R(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,R(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=c(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function O(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=g,u(S,"constructor",g),u(g,"constructor",v),v.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},E(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(S),u(S,s,"Generator"),u(S,i,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},60905:function(e,t){var n,r;"undefined"!=typeof self&&self,void 0===(r="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var n={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(n,"global");break;case"i":s(n,"ignoreCase");break;case"m":s(n,"multiLine");break;case"u":s(n,"unicode");break;case"y":s(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":t=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i("\n"),i("\r"),i("\u2028"),i("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=l;break;case"D":e=l,t=!0;break;case"s":e=f;break;case"S":e=f,t=!0;break;case"w":e=c;break;case"W":e=c,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=i("\f");break;case"n":e=i("\n");break;case"r":e=i("\r");break;case"t":e=i("\t");break;case"v":e=i("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:i(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:i(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var n=this.classAtom();if("Character"===n.type&&this.isRangeDash()){this.consumeChar("-");var r=this.classAtom();if("Character"===r.type){if(r.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:r.value})}else a(n.value,e),e.push(i("-")),a(r.value,e)}else a(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:e,value:t};return e&&(n.idx=this.groupIdx),n},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===r.test(e))throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",r=0;r<e;r++){var o=this.popChar();if(!1===n.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,n=/[0-9a-fA-F]/,r=/[0-9]/,o=/[1-9]/;function i(e){return e.charCodeAt(0)}function a(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function s(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var l=[];for(t=i("0");t<=i("9");t++)l.push(t);var c=[i("_")].concat(l);for(t=i("a");t<=i("z");t++)c.push(t);for(t=i("A");t<=i("Z");t++)c.push(t);var f=[i(" "),i("\f"),i("\n"),i("\r"),i("\t"),i("\v"),i("\t"),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i("\u2028"),i("\u2029"),i(""),i(""),i(""),i("\ufeff")];function h(){}return h.prototype.visitChildren=function(e){for(var t in e){var n=e[t];e.hasOwnProperty(t)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(e){this.visit(e)}),this))}},h.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},h.prototype.visitPattern=function(e){},h.prototype.visitFlags=function(e){},h.prototype.visitDisjunction=function(e){},h.prototype.visitAlternative=function(e){},h.prototype.visitStartAnchor=function(e){},h.prototype.visitEndAnchor=function(e){},h.prototype.visitWordBoundary=function(e){},h.prototype.visitNonWordBoundary=function(e){},h.prototype.visitLookahead=function(e){},h.prototype.visitNegativeLookahead=function(e){},h.prototype.visitCharacter=function(e){},h.prototype.visitSet=function(e){},h.prototype.visitGroup=function(e){},h.prototype.visitGroupBackReference=function(e){},h.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:h,VERSION:"0.4.0"}})?n.apply(t,[]):n)||(e.exports=r)},18794:(e,t)=>{"use strict";var n,r,o,i;if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,f=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(e){throw setTimeout(f,0),e}};n=function(e){null!==l?setTimeout(n,0,e):(l=e,setTimeout(f,0))},r=function(e,t){c=setTimeout(e,t)},o=function(){clearTimeout(c)},t.unstable_shouldYield=function(){return!1},i=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,d=window.clearTimeout;if("undefined"!=typeof console){var p=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,y=null,v=-1,g=5,b=0;t.unstable_shouldYield=function(){return t.unstable_now()>=b},i=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var w=new MessageChannel,_=w.port2;w.port1.onmessage=function(){if(null!==y){var e=t.unstable_now();b=e+g;try{y(!0,e)?_.postMessage(null):(m=!1,y=null)}catch(e){throw _.postMessage(null),e}}else m=!1},n=function(e){y=e,m||(m=!0,_.postMessage(null))},r=function(e,n){v=h((function(){e(t.unstable_now())}),n)},o=function(){d(v),v=-1}}function S(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,o=e[r];if(!(void 0!==o&&0<R(o,t)))break e;e[r]=t,e[n]=o,n=r}}function E(e){return void 0===(e=e[0])?null:e}function k(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length;r<o;){var i=2*(r+1)-1,a=e[i],s=i+1,u=e[s];if(void 0!==a&&0>R(a,n))void 0!==u&&0>R(u,a)?(e[r]=u,e[s]=n,r=s):(e[r]=a,e[i]=n,r=i);else{if(!(void 0!==u&&0>R(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function R(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var T=[],C=[],M=1,O=null,A=3,L=!1,x=!1,N=!1;function I(e){for(var t=E(C);null!==t;){if(null===t.callback)k(C);else{if(!(t.startTime<=e))break;k(C),t.sortIndex=t.expirationTime,S(T,t)}t=E(C)}}function D(e){if(N=!1,I(e),!x)if(null!==E(T))x=!0,n(P);else{var t=E(C);null!==t&&r(D,t.startTime-e)}}function P(e,n){x=!1,N&&(N=!1,o()),L=!0;var i=A;try{for(I(n),O=E(T);null!==O&&(!(O.expirationTime>n)||e&&!t.unstable_shouldYield());){var a=O.callback;if("function"==typeof a){O.callback=null,A=O.priorityLevel;var s=a(O.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?O.callback=s:O===E(T)&&k(T),I(n)}else k(T);O=E(T)}if(null!==O)var u=!0;else{var l=E(C);null!==l&&r(D,l.startTime-n),u=!1}return u}finally{O=null,A=i,L=!1}}var H=i;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){x||L||(x=!0,n(P))},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return E(T)},t.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var n=A;A=t;try{return e()}finally{A=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=A;A=e;try{return t()}finally{A=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:M++,callback:i,priorityLevel:e,startTime:a,expirationTime:u=a+u,sortIndex:-1},a>s?(e.sortIndex=a,S(C,e),null===E(T)&&e===E(C)&&(N?o():N=!0,r(D,a-s))):(e.sortIndex=u,S(T,e),x||L||(x=!0,n(P))),e},t.unstable_wrapCallback=function(e){var t=A;return function(){var n=A;A=t;try{return e.apply(this,arguments)}finally{A=n}}}},27767:(e,t,n)=>{"use strict";e.exports=n(18794)},70438:e=>{function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t},70268:function(e){!function(t){"use strict";for(var n=[null,0,{}],r=44032,o=4352,i=function(e,t){this.codepoint=e,this.feature=t},a={},s=[],u=0;u<=255;++u)s[u]=0;var l=[function(e,t,r){return t<60||13311<t&&t<42607?new i(t,n):e(t,r)},function(e,t,n){var r=a[t];return r||(r=e(t,n)).feature&&++s[t>>8&255]>10&&(a[t]=r),r},function(e,t,n){return n?e(t,n):new i(t,null)},function(e,t,n){var a;if(t<o||4371<=t&&t<r||55204<t)return e(t,n);if(o<=t&&t<4371){var s={},u=21*(t-o);for(a=0;a<21;++a)s[4449+a]=r+28*(a+u);return new i(t,[,,s])}var l=t-r,c=l%28,f=[];if(0!==c)f[0]=[r+l-c,4519+c];else for(f[0]=[o+Math.floor(l/588),4449+Math.floor(l%588/28)],f[2]={},a=1;a<28;++a)f[2][4519+a]=t+a;return new i(t,f)},function(e,t,r){var o=(i.udata[65280&t]||{})[t];return new i(t,o||n)}];i.fromCharCode=l.reduceRight((function(e,t){return function(n,r){return t(e,n,r)}}),null),i.isHighSurrogate=function(e){return e>=55296&&e<=56319},i.isLowSurrogate=function(e){return e>=56320&&e<=57343},i.prototype.prepFeature=function(){this.feature||(this.feature=i.fromCharCode(this.codepoint,!0).feature)},i.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var e=this.codepoint-65536;return String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320)},i.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},i.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},i.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},i.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},i.prototype.getComposite=function(e){if(this.prepFeature(),!this.feature[2])return null;var t=this.feature[2][e.codepoint];return t?i.fromCharCode(t):null};var c=function(e){this.str=e,this.cursor=0};c.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var e,t=this.str.charCodeAt(this.cursor++);return i.isHighSurrogate(t)&&this.cursor<this.str.length&&i.isLowSurrogate(e=this.str.charCodeAt(this.cursor))&&(t=1024*(t-55296)+(e-56320)+65536,++this.cursor),i.fromCharCode(t)}return this.str=null,null};var f=function(e,t){this.it=e,this.canonical=t,this.resBuf=[]};f.prototype.next=function(){if(0===this.resBuf.length){var e=this.it.next();if(!e)return null;this.resBuf=function e(t,n){var r=n.getDecomp();if(!r||t&&n.isCompatibility())return[n];for(var o=[],a=0;a<r.length;++a){var s=e(t,i.fromCharCode(r[a]));o=o.concat(s)}return o}(this.canonical,e)}return this.resBuf.shift()};var h=function(e){this.it=e,this.resBuf=[]};h.prototype.next=function(){var e;if(0===this.resBuf.length)do{var t=this.it.next();if(!t)break;e=t.getCanonicalClass();var n=this.resBuf.length;if(0!==e)for(;n>0&&!(this.resBuf[n-1].getCanonicalClass()<=e);--n);this.resBuf.splice(n,0,t)}while(0!==e);return this.resBuf.shift()};var d=function(e){this.it=e,this.procBuf=[],this.resBuf=[],this.lastClass=null};d.prototype.next=function(){for(;0===this.resBuf.length;){var e=this.it.next();if(!e){this.resBuf=this.procBuf,this.procBuf=[];break}if(0===this.procBuf.length)this.lastClass=e.getCanonicalClass(),this.procBuf.push(e);else{var t=this.procBuf[0].getComposite(e),n=e.getCanonicalClass();t&&(this.lastClass<n||0===this.lastClass)?this.procBuf[0]=t:(0===n&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=n,this.procBuf.push(e))}}return this.resBuf.shift()};var p=function(e,t){for(var n,r=function(e,t){switch(e){case"NFD":return new h(new f(new c(t),!0));case"NFKD":return new h(new f(new c(t),!1));case"NFC":return new d(new h(new f(new c(t),!0)));case"NFKC":return new d(new h(new f(new c(t),!1)))}throw e+" is invalid"}(e,t),o="";n=r.next();)o+=n.toString();return o};i.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var m={nfc:function(e){return p("NFC",e)},nfd:function(e){return p("NFD",e)},nfkc:function(e){return p("NFKC",e)},nfkd:function(e){return p("NFKD",e)}};e.exports=m,m.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=""+this,t=void 0===arguments[0]?"NFC":arguments[0];if(null==this)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if("NFC"===t)return m.nfc(e);if("NFD"===t)return m.nfd(e);if("NFKC"===t)return m.nfkc(e);if("NFKD"===t)return m.nfkd(e);throw new RangeError("Invalid normalization form: "+t)}}),m.shimApplied=!0)}()},26065:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(6738),o=n.n(r),i=n(77705),a=n.n(i),s=n(86742),u=n.n(s),l=new URL(n(13525),n.b),c=new URL(n(21276),n.b),f=a()(o()),h=u()(l),d=u()(c);f.push([e.id,'/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o.,\n * a Polish corporation, based in Gdynia, Poland, at 96/98 Aleja Zwyciestwa,\n * registered with the National Court Register under number 538651,\n * EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including\n * international treaties, and dual-licensed  depending on whether\n * your use is intended for or may result in commercial advantage\n * or monetary compensation (commercial purposes), or not.\n * \n * If your use involves only such purposes as research, private study,\n * evaluation and the like, you agree to be bound by the terms included\n * in the "handsontable-non-commercial-license.pdf" file, available\n * in the main directory of this software repository.\n * \n * By installing, copying, or otherwise using this software for\n * commercial purposes, you agree to be bound by the terms included\n * in the "handsontable-general-terms.pdf" file, available in the main\n * directory of this software repository.\n * \n * HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND. IN NO EVENT\n * AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE\n * TO YOU FOR DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL,\n * INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING\n * FROM USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 10.0.0\n * Release date: 29/09/2021 (built at 29/09/2021 10:36:27)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;cursor:default;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-wrap}.handsontable td,.handsontable th,.handsontable th:last-child{border-right:1px solid #ccc;border-bottom:1px solid #ccc}.handsontable.htRowHeaders thead tr th:nth-child(2),.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.ht_clone_master{z-index:100}.ht_clone_right{z-index:110}.ht_clone_left{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_right_corner{z-index:140}.ht_clone_bottom_left_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_right_corner{z-index:170}.ht_clone_top_left_corner{z-index:180}.handsontable tbody tr th:nth-last-child(2),.ht_clone_top_left_corner thead tr th:nth-last-child(2){border-right:1px solid #ccc}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_left,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_left thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_left .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{touch-action:manipulation;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:13px;font-weight:400;color:#373737}.handsontable a{color:#104acc}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}#hot-display-license-info{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:10px;font-weight:400;color:#373737;padding:5px 0 3px;text-align:left}#hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{position:absolute;top:0;cursor:col-resize;z-index:210;width:5px;height:25px}.handsontable .manualRowResizer{position:absolute;left:0;cursor:row-resize;z-index:210;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{position:absolute;right:0;top:0;background-color:#34a9db;display:none;width:0;border-right:1px dashed #777;margin-left:5px}.handsontable .manualRowResizerGuide{position:absolute;left:0;bottom:0;background-color:#34a9db;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{text-decoration:underline;cursor:pointer}.handsontable span.colHeader.columnSorting:before{top:50%;margin-top:-6px;padding-left:8px;position:absolute;right:-9px;content:"";height:10px;width:5px;background-size:contain;background-repeat:no-repeat;background-position-x:right}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url('+h+")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("+d+')}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;position:relative;padding-right:20px}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;bottom:-100%\\9;background:#005eff}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInput:focus{outline:none}.handsontableInputHolder{position:absolute;top:0;left:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"\\25B6";color:#777;position:absolute;right:5px;font-size:9px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);right:5px;border:1px solid #a6a6a6;line-height:8px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;-webkit-box-shadow:0 0 0 6px #eee;-moz-box-shadow:0 0 0 6px #eee;box-shadow:0 0 0 6px #eee;background:#eee;text-align:center}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{-webkit-box-shadow:0 0 0 2px #5292f7 inset;-moz-box-shadow:0 0 0 2px #5292f7 inset;box-shadow:inset 0 0 0 2px #5292f7;-webkit-appearance:none}.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea),.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle){z-index:9999}.bottomRightSelectionHandle,.bottomRightSelectionHandle-HitArea,.topLeftSelectionHandle,.topLeftSelectionHandle-HitArea{left:-10000px;top:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{font-size:inherit;vertical-align:middle;cursor:pointer;display:inline-block}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.htCommentCell{position:relative}.htCommentCell:after{content:"";position:absolute;top:0;right:0;border-left:6px solid transparent;border-top:6px solid #000}.htComments{display:none;z-index:1059;position:absolute}.htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}.htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7}\n\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_corner,.htContextMenu .ht_clone_left,.htContextMenu .ht_clone_top{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_left td:first-of-type,.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_top_left_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;margin-left:-1px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{top:50%;margin-top:-2px;position:absolute;right:-15px;padding-left:5px;font-size:8px;height:8px;line-height:1.1;text-decoration:underline;text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}\n\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border-radius:2px;border:1px solid #bbb;color:#bbb;font-size:9px;line-height:9px;padding:2px;margin:3px 1px 0 5px;float:right}.handsontable .changeType:before{content:"\\25BC\\ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_corner,.htDropdownMenu .ht_clone_left,.htDropdownMenu .ht_clone_top{display:none}.htDropdownMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htDropdownMenu table tbody tr td:first-child{border:0}.htDropdownMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_corner,.htFiltersConditionsMenu .ht_clone_left,.htFiltersConditionsMenu .ht_clone_top{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htFiltersConditionsMenu table tbody tr td:first-child{border:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{text-align:center;padding-top:10px;padding-bottom:3px}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{font-family:inherit;font-size:.75em;padding:4px;box-sizing:border-box;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{border:1px solid #509272;color:#18804e;background-color:#d2e0d9}.handsontable .htUISelectAll{margin-right:10px}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}.handsontable .htCheckboxRendererInput{margin:0 5px 0 0;vertical-align:middle;height:1em}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border-radius:2px;border:1px solid #d2d1d1}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-right:10px}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border-radius:2px;border:1px solid #d2d1d1;font-family:inherit;font-size:.75em;font-weight:700;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"\\25B2";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"\\25BC";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border-radius:2px;border:1px solid #d2d1d1;padding:3px}.handsontable .htUIRadio{display:inline-block;margin-right:5px;height:100%}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-right:.5ex}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{text-align:left;padding-left:7px}.handsontable th div.ht_nestingLevels{display:inline-block;position:absolute;left:11px}.handsontable.innerBorderLeft th div.ht_nestingLevels,.handsontable.innerBorderLeft~.handsontable th div.ht_nestingLevels{right:10px}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;width:10px;height:1px;float:left}.handsontable th span.ht_nestingLevel:after{content:"\\2510";font-size:9px;display:inline-block;position:relative;bottom:3px}.handsontable th div.ht_nestingButton{display:inline-block;position:absolute;right:-2px;cursor:pointer}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"\\002B"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"\\002D"}.handsontable.innerBorderLeft th div.ht_nestingButton,.handsontable.innerBorderLeft~.handsontable th div.ht_nestingButton{right:0}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;position:absolute;top:50%;font-size:5pt;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{right:1px;content:"\\25C0"}.handsontable th.afterHiddenColumn:before{left:1px;content:"\\25B6"}\n\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;line-height:6pt;position:absolute;left:2px}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{content:"\\25B2";bottom:2px}.handsontable th.afterHiddenRow:after{content:"\\25BC";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}',""]);const p=f},20028:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(6738),o=n.n(r),i=n(77705),a=n.n(i)()(o());a.push([e.id,'\r\n/*\r\n  A stylesheet customizing app (custom renderers)\r\n*/\r\n\r\ntable.htCore .star {\r\n  color: #fcb515;\r\n}\r\n\r\ntable.htCore tr.odd td {\r\n  background: #fafbff;\r\n}\r\n\r\ntable.htCore td .progressBar {\r\n  background: #37bc6c;\r\n  height: 10px;\r\n}\r\n\r\ntable.htCore tr.selected td {\r\n  background: #edf3fd;\r\n}\r\n\r\n/*\r\n  A stylesheet customizing Handsontable style\r\n*/\r\ntable {\r\n  font-size: 14px;\r\n}\r\n\r\n  .handsontable {\r\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",\r\n      "Ubuntu", "Helvetica Neue", Arial, sans-serif;\r\n    font-weight: 400;\r\n  }\r\n  \r\n  .collapsibleIndicator {\r\n    text-align: center;\r\n  }\r\n  \r\n  .handsontable .htRight .changeType {\r\n    margin: 3px 1px 0 13px;\r\n  }\r\n  \r\n  .grand_total {\r\n    font-weight: bold;\r\n    font-style: italic;\r\n  }\r\n\r\n  .row_total {\r\n    font-style: italic;\r\n    border-right: 1px solid #000000 !important; \r\n    border-left: 1px solid #000000 !important; \r\n  }\r\n  .sub_total {\r\n    font-style: italic;\r\n    border-top: 1px solid #000000 !important; \r\n    border-bottom: 1px solid #000000 !important; \r\n}\r\n.htDimmed {\r\n    color: black !important;\r\n}\r\n.changed_cell {\r\n  position: relative;\r\n}\r\n.changed_cell::before,\r\n.changed_cell::after {\r\n    content: \'\';\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    border-color: transparent;\r\n    border-style: solid;\r\n}\r\n\r\n.changed_cell::after {\r\n    border-width: 6px;\r\n    border-right-color: #0c0;\r\n    border-top-color: #0c0;\r\n}',""]);const s=a},46700:(e,t,n)=>{var r={"./af":89127,"./af.js":89127,"./ar":67006,"./ar-dz":72633,"./ar-dz.js":72633,"./ar-kw":63215,"./ar-kw.js":63215,"./ar-ly":96968,"./ar-ly.js":96968,"./ar-ma":52572,"./ar-ma.js":52572,"./ar-sa":68319,"./ar-sa.js":68319,"./ar-tn":75629,"./ar-tn.js":75629,"./ar.js":67006,"./az":76722,"./az.js":76722,"./be":15958,"./be.js":15958,"./bg":74921,"./bg.js":74921,"./bm":17293,"./bm.js":17293,"./bn":52288,"./bn.js":52288,"./bo":82127,"./bo.js":82127,"./br":43922,"./br.js":43922,"./bs":78932,"./bs.js":78932,"./ca":13246,"./ca.js":13246,"./cs":18208,"./cs.js":18208,"./cv":26492,"./cv.js":26492,"./cy":71883,"./cy.js":71883,"./da":12285,"./da.js":12285,"./de":6454,"./de-at":3082,"./de-at.js":3082,"./de-ch":9076,"./de-ch.js":9076,"./de.js":6454,"./dv":9016,"./dv.js":9016,"./el":83093,"./el.js":83093,"./en-SG":90820,"./en-SG.js":90820,"./en-au":85535,"./en-au.js":85535,"./en-ca":12610,"./en-ca.js":12610,"./en-gb":78386,"./en-gb.js":78386,"./en-ie":35272,"./en-ie.js":35272,"./en-il":73563,"./en-il.js":73563,"./en-nz":82140,"./en-nz.js":82140,"./eo":59823,"./eo.js":59823,"./es":30312,"./es-do":69546,"./es-do.js":69546,"./es-us":37781,"./es-us.js":37781,"./es.js":30312,"./et":58563,"./et.js":58563,"./eu":64003,"./eu.js":64003,"./fa":40463,"./fa.js":40463,"./fi":68941,"./fi.js":68941,"./fo":40006,"./fo.js":40006,"./fr":32346,"./fr-ca":60761,"./fr-ca.js":60761,"./fr-ch":10982,"./fr-ch.js":10982,"./fr.js":32346,"./fy":24934,"./fy.js":24934,"./ga":34804,"./ga.js":34804,"./gd":41733,"./gd.js":41733,"./gl":72271,"./gl.js":72271,"./gom-latn":70763,"./gom-latn.js":70763,"./gu":84125,"./gu.js":84125,"./he":81651,"./he.js":81651,"./hi":18602,"./hi.js":18602,"./hr":8641,"./hr.js":8641,"./hu":3079,"./hu.js":3079,"./hy-am":60443,"./hy-am.js":60443,"./id":8963,"./id.js":8963,"./is":11343,"./is.js":11343,"./it":28072,"./it-ch":33115,"./it-ch.js":33115,"./it.js":28072,"./ja":58183,"./ja.js":58183,"./jv":71064,"./jv.js":71064,"./ka":81999,"./ka.js":81999,"./kk":29360,"./kk.js":29360,"./km":43667,"./km.js":43667,"./kn":41882,"./kn.js":41882,"./ko":42401,"./ko.js":42401,"./ku":42583,"./ku.js":42583,"./ky":66751,"./ky.js":66751,"./lb":81193,"./lb.js":81193,"./lo":80769,"./lo.js":80769,"./lt":44409,"./lt.js":44409,"./lv":9262,"./lv.js":9262,"./me":97514,"./me.js":97514,"./mi":83434,"./mi.js":83434,"./mk":70610,"./mk.js":70610,"./ml":71654,"./ml.js":71654,"./mn":86730,"./mn.js":86730,"./mr":47196,"./mr.js":47196,"./ms":20487,"./ms-my":14750,"./ms-my.js":14750,"./ms.js":20487,"./mt":58856,"./mt.js":58856,"./my":21240,"./my.js":21240,"./nb":12121,"./nb.js":12121,"./ne":89802,"./ne.js":89802,"./nl":80737,"./nl-be":93497,"./nl-be.js":93497,"./nl.js":80737,"./nn":18153,"./nn.js":18153,"./pa-in":10499,"./pa-in.js":10499,"./pl":53629,"./pl.js":53629,"./pt":95702,"./pt-br":23312,"./pt-br.js":23312,"./pt.js":95702,"./ro":10719,"./ro.js":10719,"./ru":33778,"./ru.js":33778,"./sd":25545,"./sd.js":25545,"./se":35811,"./se.js":35811,"./si":12015,"./si.js":12015,"./sk":21587,"./sk.js":21587,"./sl":20147,"./sl.js":20147,"./sq":36821,"./sq.js":36821,"./sr":63019,"./sr-cyrl":37792,"./sr-cyrl.js":37792,"./sr.js":63019,"./ss":15078,"./ss.js":15078,"./sv":13593,"./sv.js":13593,"./sw":57655,"./sw.js":57655,"./ta":51553,"./ta.js":51553,"./te":65967,"./te.js":65967,"./tet":39236,"./tet.js":39236,"./tg":82091,"./tg.js":82091,"./th":44141,"./th.js":44141,"./tl-ph":98941,"./tl-ph.js":98941,"./tlh":99565,"./tlh.js":99565,"./tr":6075,"./tr.js":6075,"./tzl":91637,"./tzl.js":91637,"./tzm":48231,"./tzm-latn":84943,"./tzm-latn.js":84943,"./tzm.js":48231,"./ug-cn":27822,"./ug-cn.js":27822,"./uk":17263,"./uk.js":17263,"./ur":71769,"./ur.js":71769,"./uz":29736,"./uz-latn":24725,"./uz-latn.js":24725,"./uz.js":29736,"./vi":9562,"./vi.js":9562,"./x-pseudo":7219,"./x-pseudo.js":7219,"./yo":76195,"./yo.js":76195,"./zh-cn":37289,"./zh-cn.js":37289,"./zh-hk":51589,"./zh-hk.js":51589,"./zh-tw":23384,"./zh-tw.js":23384};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=46700},93379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var u=e[s],l=r.base?u[0]+r.base:u[0],c=i[l]||0,f="".concat(l," ").concat(c);i[l]=c+1;var h=n(f),d={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==h)t[h].references++,t[h].updater(d);else{var p=o(d,r);r.byIndex=s,t.splice(s,0,{identifier:f,updater:p,references:1})}a.push(f)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var u=r(e,o),l=0;l<i.length;l++){var c=n(i[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=u}}},90569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},19216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},44589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},21276:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII="},13525:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.b=document.baseURI||self.location.href,(()=>{"use strict";var e={};n.r(e),n.d(e,{cancelAnimationFrame:()=>G,getComparisonFunction:()=>$,hasCaptionProblem:()=>X,isClassListSupported:()=>V,isGetComputedStyleSupported:()=>z,isPassiveEventSupported:()=>q,isTextContentSupported:()=>W,isTouchSupported:()=>K,requestAnimationFrame:()=>B});var t={};n.r(t),n.d(t,{arrayAvg:()=>se,arrayEach:()=>re,arrayFilter:()=>te,arrayFlatten:()=>ue,arrayMap:()=>ne,arrayMax:()=>ie,arrayMin:()=>ae,arrayReduce:()=>ee,arraySum:()=>oe,arrayUnique:()=>le,extendArray:()=>Q,getDifferenceOfArrays:()=>ce,getIntersectionOfArrays:()=>fe,getUnionOfArrays:()=>he,pivot:()=>Z,stringToArray:()=>de,to2dArray:()=>J});var r={};n.r(r),n.d(r,{clone:()=>_e,createObjectPropListener:()=>Ae,deepClone:()=>we,deepExtend:()=>be,deepObjectSize:()=>Oe,defineGetter:()=>Re,duckSchema:()=>ye,extend:()=>ge,getProperty:()=>Ce,hasOwnProperty:()=>Le,inherit:()=>ve,isObject:()=>ke,isObjectEqual:()=>Ee,mixin:()=>Se,objectEach:()=>Te,setProperty:()=>Me});var o={};n.r(o),n.d(o,{isChrome:()=>He,isChromeWebKit:()=>je,isEdge:()=>Be,isEdgeWebKit:()=>Ve,isFirefox:()=>Fe,isFirefoxWebKit:()=>Ye,isIE:()=>We,isIE9:()=>ze,isIOS:()=>Xe,isIpadOS:()=>$e,isLinuxOS:()=>Qe,isMSBrowser:()=>Ge,isMacOS:()=>Je,isMobileBrowser:()=>Ke,isSafari:()=>Ue,isWindowsOS:()=>qe,setBrowserMeta:()=>De,setPlatformMeta:()=>Pe});var i={};n.r(i),n.d(i,{_injectProductInfo:()=>Ct,isDefined:()=>ft,isEmpty:()=>dt,isRegExp:()=>pt,isUndefined:()=>ht,stringify:()=>ct});var a={};n.r(a),n.d(a,{equalsIgnoreCase:()=>Ot,isPercentValue:()=>Lt,randomString:()=>At,sanitize:()=>It,stripTags:()=>Nt,substitute:()=>xt,toUpperCaseFirst:()=>Mt});var s={};n.r(s),n.d(s,{HTML_CHARACTERS:()=>tn,addClass:()=>qt,addEvent:()=>wn,clearTextSelection:()=>Rn,closest:()=>Ut,closestDown:()=>Bt,empty:()=>Zt,fastInnerHTML:()=>nn,fastInnerText:()=>rn,getCaretPosition:()=>Sn,getComputedStyle:()=>mn,getCssTransform:()=>xn,getFrameElement:()=>jt,getParent:()=>Ht,getParentWindow:()=>Ft,getScrollLeft:()=>cn,getScrollTop:()=>ln,getScrollableElement:()=>fn,getScrollbarWidth:()=>Mn,getSelectionEndPosition:()=>En,getSelectionText:()=>kn,getStyle:()=>dn,getTrimmingContainer:()=>hn,getWindowScrollLeft:()=>un,getWindowScrollTop:()=>sn,hasAccessToParentWindow:()=>Yt,hasClass:()=>$t,hasHorizontalScrollbar:()=>An,hasVerticalScrollbar:()=>On,index:()=>Wt,innerHeight:()=>gn,innerWidth:()=>bn,isChildOf:()=>Vt,isDetached:()=>Hn,isInput:()=>In,isOutsideInput:()=>Dn,isVisible:()=>on,matchesCSSRules:()=>pn,offset:()=>an,outerHeight:()=>vn,outerWidth:()=>yn,overlayContainsElement:()=>zt,removeClass:()=>Jt,removeEvent:()=>_n,removeTextNodes:()=>Qt,resetCssTransform:()=>Nn,selectElementIfAllowed:()=>Pn,setCaretPosition:()=>Tn,setOverlayPosition:()=>Ln});var u={};n.r(u),n.d(u,{curry:()=>Wn,curryRight:()=>zn,debounce:()=>Un,fastCall:()=>Gn,isFunction:()=>jn,partial:()=>Vn,pipe:()=>Bn,throttle:()=>Fn,throttleAfterHits:()=>Yn});var l={};n.r(l),n.d(l,{KEY_CODES:()=>Jn,isCtrlKey:()=>tr,isCtrlMetaKey:()=>nr,isFunctionKey:()=>er,isKey:()=>rr,isPrintableChar:()=>Zn});var c={};n.r(c),n.d(c,{isImmediatePropagationStopped:()=>ir,isLeftClick:()=>sr,isRightClick:()=>ar,stopImmediatePropagation:()=>or});var f={};n.r(f),n.d(f,{_dataToHTML:()=>uo,htmlToGridSettings:()=>lo,instanceToHTML:()=>so});var h={};n.r(h),n.d(h,{isNumeric:()=>po,isNumericLike:()=>mo,rangeEach:()=>yo,rangeEachReverse:()=>vo,valueAccordingPercent:()=>go});var d={};n.r(d),n.d(d,{cellMethodLookupFactory:()=>xl,countFirstRowKeys:()=>Il,createEmptySpreadsheetData:()=>Al,createSpreadsheetData:()=>Ml,createSpreadsheetObjectData:()=>Ol,dataRowToChangesArray:()=>Nl,isArrayOfArrays:()=>Dl,isArrayOfObjects:()=>Pl,spreadsheetColumnIndex:()=>Cl,spreadsheetColumnLabel:()=>Tl,translateRowsToColumns:()=>Ll});var p={};n.r(p),n.d(p,{CONTEXTMENU_ITEMS_ADD_COMMENT:()=>zf,CONTEXTMENU_ITEMS_ALIGNMENT:()=>$f,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>nh,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>Jf,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Zf,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>qf,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>th,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>Qf,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>eh,CONTEXTMENU_ITEMS_BORDERS:()=>rh,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>ah,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>sh,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>ih,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>oh,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>jf,CONTEXTMENU_ITEMS_COPY:()=>Ff,CONTEXTMENU_ITEMS_CUT:()=>Yf,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>Gf,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>Uf,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>fh,CONTEXTMENU_ITEMS_HIDE_ROW:()=>dh,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>Lf,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>xf,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>Vf,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>ch,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>lh,CONTEXTMENU_ITEMS_NO_ITEMS:()=>Mf,CONTEXTMENU_ITEMS_READ_ONLY:()=>Hf,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>Xf,CONTEXTMENU_ITEMS_REDO:()=>Pf,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>uh,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>If,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>Kf,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>Nf,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>Of,CONTEXTMENU_ITEMS_ROW_BELOW:()=>Af,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>hh,CONTEXTMENU_ITEMS_SHOW_ROW:()=>ph,CONTEXTMENU_ITEMS_UNDO:()=>Df,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>Bf,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>Wf,CONTEXT_MENU_ITEMS_NAMESPACE:()=>Cf,FILTERS_BUTTONS_CANCEL:()=>Gh,FILTERS_BUTTONS_CLEAR:()=>Wh,FILTERS_BUTTONS_OK:()=>zh,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>Kh,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>$h,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>Xh,FILTERS_BUTTONS_SELECT_ALL:()=>Vh,FILTERS_CONDITIONS_AFTER:()=>Nh,FILTERS_CONDITIONS_BEFORE:()=>Ih,FILTERS_CONDITIONS_BEGINS_WITH:()=>Sh,FILTERS_CONDITIONS_BETWEEN:()=>Lh,FILTERS_CONDITIONS_BY_VALUE:()=>Th,FILTERS_CONDITIONS_CONTAINS:()=>kh,FILTERS_CONDITIONS_EMPTY:()=>gh,FILTERS_CONDITIONS_ENDS_WITH:()=>Eh,FILTERS_CONDITIONS_EQUAL:()=>wh,FILTERS_CONDITIONS_GREATER_THAN:()=>Ch,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>Mh,FILTERS_CONDITIONS_LESS_THAN:()=>Oh,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>Ah,FILTERS_CONDITIONS_NAMESPACE:()=>yh,FILTERS_CONDITIONS_NONE:()=>vh,FILTERS_CONDITIONS_NOT_BETWEEN:()=>xh,FILTERS_CONDITIONS_NOT_CONTAIN:()=>Rh,FILTERS_CONDITIONS_NOT_EMPTY:()=>bh,FILTERS_CONDITIONS_NOT_EQUAL:()=>_h,FILTERS_CONDITIONS_TODAY:()=>Dh,FILTERS_CONDITIONS_TOMORROW:()=>Ph,FILTERS_CONDITIONS_YESTERDAY:()=>Hh,FILTERS_DIVS_FILTER_BY_CONDITION:()=>jh,FILTERS_DIVS_FILTER_BY_VALUE:()=>Fh,FILTERS_LABELS_CONJUNCTION:()=>Yh,FILTERS_LABELS_DISJUNCTION:()=>Uh,FILTERS_NAMESPACE:()=>mh,FILTERS_VALUES_BLANK_CELLS:()=>Bh});var m={};n.r(m),n.d(m,{getNormalizedDate:()=>Zm});var y={};n.r(y),n.d(y,{AbsPlugin:()=>oX,ArrayPlugin:()=>JK,BitShiftPlugin:()=>fX,BitwiseLogicOperationsPlugin:()=>_X,BooleanPlugin:()=>MX,CharPlugin:()=>DX,CodePlugin:()=>BX,ComplexPlugin:()=>A0,CountBlankPlugin:()=>$X,CountUniquePlugin:()=>n$,DateTimePlugin:()=>d$,DegreesPlugin:()=>k$,DeltaPlugin:()=>L$,ExpPlugin:()=>j$,FinancialPlugin:()=>K$,FormulaTextPlugin:()=>iq,InformationPlugin:()=>hq,IsEvenPlugin:()=>bq,IsOddPlugin:()=>Tq,LogarithmPlugin:()=>Nq,LookupPlugin:()=>xZ,MathConstantsPlugin:()=>Uq,MathPlugin:()=>y0,MatrixPlugin:()=>Jq,MedianPlugin:()=>oJ,ModuloPlugin:()=>fJ,NumericAggregationPlugin:()=>EJ,PowerPlugin:()=>xJ,RadiansPlugin:()=>FJ,RadixConversionPlugin:()=>KJ,RandomPlugin:()=>aQ,RomanPlugin:()=>FZ,RoundingPlugin:()=>mQ,SimpleArithmerticPlugin:()=>XZ,SqrtPlugin:()=>SQ,StatisticalAggregationPlugin:()=>q0,StatisticalPlugin:()=>s0,SumifPlugin:()=>QQ,SumprodPlugin:()=>iZ,TextPlugin:()=>hZ,TrigonometryPlugin:()=>bZ});var v=n(35466),g=n(46116),b=n(93379),w=n.n(b),_=n(7795),S=n.n(_),E=n(90569),k=n.n(E),R=n(3565),T=n.n(R),C=n(19216),M=n.n(C),O=n(44589),A=n.n(O),L=n(20028),x={};function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}x.styleTagTransform=A(),x.setAttributes=T(),x.insert=k().bind(null,"head"),x.domAPI=S(),x.insertStyleElement=M(),w()(L.Z,x),L.Z&&L.Z.locals&&L.Z.locals,n(7120),n(85066),n(29045),n(5536),n(74486),n(6429),n(12406),n(30717),n(62322),n(93296),n(11646),n(23675),n(92129),n(27228),n(57021),n(55090),n(60151),n(68192),n(52004),n(28407),n(56394),n(38288),n(55677),n(24655),n(20288),n(54458),n(25101),n(12076),n(97723),n(38833),n(49268),n(7390),n(64669),n(67441),n(13233);for(var I,D,P,H=0,j=["ms","moz","webkit","o"],F=window.requestAnimationFrame,Y=window.cancelAnimationFrame,U=0;U<j.length&&!F;++U)F=window["".concat(j[U],"RequestAnimationFrame")],Y=window["".concat(j[U],"CancelAnimationFrame")]||window["".concat(j[U],"CancelRequestAnimationFrame")];function B(e){return F.call(window,e)}function V(){return!!document.documentElement.classList}function W(){return!!document.createTextNode("test").textContent}function z(){return!!window.getComputedStyle}function G(e){Y.call(window,e)}function K(){return"ontouchstart"in window}function X(){return void 0===I&&function(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),I=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),I}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D||(D="object"===("undefined"==typeof Intl?"undefined":N(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1},D)}function q(){if(void 0!==P)return P;try{var e={get passive(){P=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){P=!1}return P}function J(e){for(var t=e.length,n=0;n<t;)e[n]=[e[n]],n+=1}function Q(e,t){for(var n=t.length,r=0;r<n;)e.push(t[r]),r+=1}function Z(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function ee(e,t,n,r){var o=-1,i=e,a=n;Array.isArray(e)||(i=Array.from(e));var s=i.length;for(r&&s&&(a=i[o+=1]),o+=1;o<s;)a=t(a,i[o],o,i),o+=1;return a}function te(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];t(s,n,r)&&(i[a+=1]=s),n+=1}return i}function ne(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];i[a+=1]=t(s,n,r),n+=1}return i}function re(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length;n<o&&!1!==t(r[n],n,r);)n+=1;return e}function oe(e){return ee(e,(function(e,t){return e+t}),0)}function ie(e){return ee(e,(function(e,t){return e>t?e:t}),Array.isArray(e)?e[0]:void 0)}function ae(e){return ee(e,(function(e,t){return e<t?e:t}),Array.isArray(e)?e[0]:void 0)}function se(e){return e.length?oe(e)/e.length:0}function ue(e){return ee(e,(function(e,t){return e.concat(Array.isArray(t)?ue(t):t)}),[])}function le(e){var t=[];return re(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return re(i,(function(e){a=a.filter((function(t){return!e.includes(t)}))})),a}function fe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return re(i,(function(e){a=a.filter((function(t){return e.includes(t)}))})),a}function he(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=new Set(o);return re(i,(function(e){re(e,(function(e){a.has(e)||a.add(e)}))})),Array.from(a)}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ye(e){var t;return Array.isArray(e)?t=[]:(t={},Te(e,(function(e,n){"__children"!==n&&(e&&"object"===me(e)&&!Array.isArray(e)?t[n]=ye(e):Array.isArray(e)?e.length&&"object"===me(e[0])&&!Array.isArray(e[0])?t[n]=[ye(e[0])]:t[n]=[]:t[n]=null)}))),t}function ve(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function ge(e,t,n){var r=Array.isArray(n);return Te(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function be(e,t){Te(t,(function(n,r){t[r]&&"object"===me(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),be(e[r],t[r])):e[r]=t[r]}))}function we(e){return"object"===me(e)?JSON.parse(JSON.stringify(e)):e}function _e(e){var t={};return Te(e,(function(e,n){t[n]=e})),t}function Se(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return re(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),Te(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));var r,o,i;"function"==typeof t?e.prototype[n]=t:Object.defineProperty(e.prototype,n,{get:(r=n,o=t,i="_".concat(r),function(){var e;return void 0===this[i]&&(this[i]=(e=o,(Array.isArray(e)||ke(e))&&(e=we(e)),e)),this[i]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}))})),e}function Ee(e,t){return JSON.stringify(e)===JSON.stringify(t)}function ke(e){return"[object Object]"===Object.prototype.toString.call(e)}function Re(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function Te(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function Ce(e,t){var n=t.split("."),r=e;return Te(n,(function(e){if(void 0===(r=r[e]))return r=void 0,!1})),r}function Me(e,t,n){var r=t.split("."),o=e;r.forEach((function(e,t){t!==r.length-1?(Le(o,e)||(o[e]={}),o=o[e]):o[e]=n}))}function Oe(e){return ke(e)?function e(t){var n=0;return ke(t)?Te(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n}(e):0}function Ae(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),o=(pe(t={_touched:!1},r,e),pe(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),o}function Le(e,t){return Object.prototype.hasOwnProperty.call(e,t)}F||(F=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-H)),r=window.setTimeout((function(){e(t+n)}),n);return H=t+n,r}),Y||(Y=function(e){clearTimeout(e)}),n(26922);var xe=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},Ne={chrome:xe((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:xe((function(e){return/CriOS/.test(e)})),edge:xe((function(e){return/Edge/.test(e)})),edgeWebKit:xe((function(e){return/EdgiOS/.test(e)})),firefox:xe((function(e){return/Firefox/.test(e)})),firefoxWebKit:xe((function(e){return/FxiOS/.test(e)})),ie:xe((function(e){return/Trident/.test(e)})),ie9:xe((function(){return!!document.documentMode})),mobile:xe((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:xe((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},Ie={mac:xe((function(e){return/^Mac/.test(e)})),win:xe((function(e){return/^Win/.test(e)})),linux:xe((function(e){return/^Linux/.test(e)})),ios:xe((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,r=e.vendor,o=void 0===r?navigator.vendor:r;Te(Ne,(function(e){(0,e.test)(n,o)}))}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;Te(Ie,(function(e){(0,e.test)(n)}))}function He(){return Ne.chrome.value}function je(){return Ne.chromeWebKit.value}function Fe(){return Ne.firefox.value}function Ye(){return Ne.firefoxWebKit.value}function Ue(){return Ne.safari.value}function Be(){return Ne.edge.value}function Ve(){return Ne.edgeWebKit.value}function We(){return Ne.ie.value}function ze(){return Ne.ie9.value}function Ge(){return Ne.ie.value||Ne.edge.value}function Ke(){return Ne.mobile.value}function Xe(){return Ie.ios.value}function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Ie.mac.value}function qe(){return Ie.win.value}function Je(){return Ie.mac.value}function Qe(){return Ie.linux.value}De(),Pe();var Ze,et,tt,nt,rt,ot,it=n(31199),at=(n(47561),n(619),n(11932),n(90421));function st(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=ee(e,(function(e,t,r){return e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"");return o.trim()}function ut(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e){var t;switch(lt(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function ft(e){return void 0!==e}function ht(e){return void 0===e}function dt(e){return null===e||""===e||ht(e)}function pt(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var mt,yt,vt,gt="length",bt=function(e){return parseInt(e,16)},wt=function(e){return parseInt(e,10)},_t=function(e,t,n){return e.substr(t,n)},St=function(e){return e.codePointAt(0)-65},Et=function(e){return"".concat(e).replace(/\-/g,"")},kt=!1,Rt={invalid:function(){return st(Ze||(Ze=ut(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return st(et||(et=ut(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return st(tt||(tt=ut(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},Tt={invalid:function(){return st(nt||(nt=ut(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return st(rt||(rt=ut(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return st(ot||(ot=ut(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function Ct(e,t){var n,r=!dt(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="10.0.0",a="invalid",s="invalid",u=function(e){var t=[][gt],n=t;if(e[gt]!==St("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=St(o.shift());i;i=St(o.shift()||"A"))--i<""[gt]?n|=(wt("".concat(wt(bt(r)+(bt(_t(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=_t(e,i,i?1===o[gt]?9:8:6);return n===t}(e=Et(e||""));if(r||o||u)if(u){var l=at("29/09/2021","DD/MM/YYYY"),c=Math.floor(l.toDate().getTime()/864e5),f=function(e){return bt(_t(Et(e),bt("12"),St("F")))/(bt(_t(Et(e),St("B"),~~![][gt]))||9)}(e);if(n=at(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f){var h=at().diff(l,"days");a=h<=1?"valid":"expired",s=h<=15?"valid":"expired"}else a="valid",s="valid"}else o?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(a="valid",s="valid"),kt||"valid"===a||(Rt[a]({keyValidityDate:n,hotVersion:i})&&console["non_commercial"===a?"info":"warn"](Rt[a]({keyValidityDate:n,hotVersion:i})),kt=!0),"valid"!==s&&t.parentNode&&Tt[s]({keyValidityDate:n,hotVersion:i})){var d=document.createElement("div");d.id="hot-display-license-info",d.innerHTML=Tt[s]({keyValidityDate:n,hotVersion:i}),t.parentNode.insertBefore(d,t.nextSibling)}}function Mt(e){return e[0].toUpperCase()+e.substr(1)}function Ot(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=n.length;o;){var i=ct(n[o-=1]).toLowerCase();-1===e.indexOf(i)&&e.push(i)}return 1===e.length}function At(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function Lt(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function xt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function Nt(e){return It("".concat(e),{ALLOWED_TAGS:[]})}function It(e,t){return it.sanitize(e,t)}function Dt(e){return function(e){if(Array.isArray(e))return Pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ht(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=e;null!==o;){if(n===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function jt(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Ft(e){return jt(e)&&e.parent}function Yt(e){return!!Object.getPrototypeOf(e.parent)}function Ut(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=e;null!=a&&a!==n;){var s=a,u=s.nodeType,l=s.nodeName;if(u===o&&(t.includes(l)||t.includes(a)))return a;var c=a,f=c.host;a=f&&u===i?f:a.parentNode}return null}function Bt(e,t,n){for(var r=[],o=e;o&&(o=Ut(o,t,n))&&(!n||n.contains(o));)r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=r.length;return i?r[i-1]:null}function Vt(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Wt(e){var t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function zt(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function Gt(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(V()){var Kt=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};mt=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},yt=function(e,t){var n,r=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=Gt(o)).length>0)if(Kt(r))(n=e.classList).add.apply(n,Dt(o));else for(var i=0;o[i];)e.classList.add(o[i]),i+=1},vt=function(e,t){var n,r=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=Gt(o)).length>0)if(Kt(r))(n=e.classList).remove.apply(n,Dt(o));else for(var i=0;o[i];)e.classList.remove(o[i]),i+=1}}else{var Xt=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};mt=function(e,t){return void 0!==e.className&&Xt(t).test(e.className)},yt=function(e,t){var n=e.className,r=t;if("string"==typeof r&&(r=r.split(" ")),r=Gt(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!Xt(r[o]).test(n)&&(n+=" ".concat(r[o]));e.className=n},vt=function(e,t){var n=0,r=e.className,o=t;for("string"==typeof o&&(o=o.split(" ")),o=Gt(o);o[n];)r=r.replace(Xt(o[n])," ").trim(),n+=1;e.className!==r&&(e.className=r)}}function $t(e,t){return mt(e,t)}function qt(e,t){yt(e,t)}function Jt(e,t){vt(e,t)}function Qt(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)Qt(t[n])}function Zt(e){for(var t;t=e.lastChild;)e.removeChild(t)}var en,tn=/(<(.*)>|&(.*);)/;function nn(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];tn.test(t)?e.innerHTML=n?It(t):t:rn(e,t)}function rn(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?W?n.textContent=t:n.data=t:(Zt(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function on(e){for(var t=e.ownerDocument.documentElement,n=e;n!==t;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return on(n.host.impl);if(n.host)return on(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function an(e){var t,n,r,o,i=e.ownerDocument,a=i.defaultView,s=i.documentElement,u=e;if(X()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return{top:(o=u.getBoundingClientRect()).top+(a.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(a.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};for(t=u.offsetLeft,n=u.offsetTop,r=u;(u=u.offsetParent)&&u!==i.body;)t+=u.offsetLeft,n+=u.offsetTop,r=u;return r&&"fixed"===r.style.position&&(t+=a.pageXOffset||s.scrollLeft,n+=a.pageYOffset||s.scrollTop),{left:t,top:n}}function sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function ln(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?sn(t):e.scrollTop}function cn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?un(t):e.scrollLeft}function fn(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(n=(t=e.document?e.document:e).defaultView);for(var r=["auto","scroll"],o=z(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,u=a.overflowX,l=a.overflowY;if([s,u,l].includes("scroll"))return i;if(o){var c=n.getComputedStyle(i);if(s=c.overflow,u=c.overflowX,l=c.overflowY,r.includes(s)||r.includes(u)||r.includes(l))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(l)||r.includes(s)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(u)||r.includes(s)))return i;i=i.parentNode}return n}function hn(e){for(var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=mn(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),u=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(u))return r;r=r.parentNode}return n}function dn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var o=mn(e,n);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}}function pn(e,t){var n=t.selectorText,r=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n))),r}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function yn(e){return Math.ceil(e.getBoundingClientRect().width)}function vn(e){return X()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function gn(e){return e.clientHeight||e.innerHeight}function bn(e){return e.clientWidth||e.innerWidth}function wn(e,t,n){e.addEventListener(t,n,!1)}function _n(e,t,n){e.removeEventListener(t,n,!1)}function Sn(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function En(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function Rn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Tn(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}}function Cn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}function Mn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===en&&(en=Cn(e)),en}function On(e){return e.offsetWidth!==e.clientWidth}function An(e){return e.offsetHeight!==e.clientHeight}function Ln(e,t,n){ze()?(e.style.top=n,e.style.left=t):Ue()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function xn(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function Nn(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function In(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function Dn(e){return In(e)&&!1===e.hasAttribute("data-hot-input")}function Pn(e){Dn(e.ownerDocument.activeElement)||e.select()}function Hn(e){return!e.parentNode}function jn(e){return"function"==typeof e}function Fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];var l=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=l,c=!0);var f=t-(l-n);return c?(r.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,e.apply(i,s),n=0,o=void 0}),f)),r}return i}function Yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=Fn(e,t),o=n;function i(){o=n}function a(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return o?(o-=1,e.apply(this,n)):r.apply(this,n)}return a.clearHits=i,a}function Un(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,a)}),n),t}return o}function Bn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ee(o,(function(e,t){return t(e)}),r.apply(this,t))}}function Vn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function Wn(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i);return s.length>=t?e.apply(this,s):n(s)}}([])}function zn(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i.reverse());return s.length>=t?e.apply(this,s):n(s)}}([])}function Gn(e,t,n,r,o,i,a,s){return ft(s)?e.call(t,n,r,o,i,a,s):ft(a)?e.call(t,n,r,o,i,a):ft(i)?e.call(t,n,r,o,i):ft(o)?e.call(t,n,r,o):ft(r)?e.call(t,n,r):ft(n)?e.call(t,n):e.call(t)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(31770);var Xn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=null,this.col=null,void 0!==t&&void 0!==n&&(this.row=t,this.col=n)}var t,n;return t=e,n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col)}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}],n&&Kn(t.prototype,n),e}();const $n=Xn;var qn,Jn={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Fe()?182:174,AUDIO_MUTE:Fe()?181:173,AUDIO_UP:Fe()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Qn=[Jn.ALT,Jn.ARROW_DOWN,Jn.ARROW_LEFT,Jn.ARROW_RIGHT,Jn.ARROW_UP,Jn.AUDIO_DOWN,Jn.AUDIO_MUTE,Jn.AUDIO_UP,Jn.BACKSPACE,Jn.CAPS_LOCK,Jn.DELETE,Jn.END,Jn.ENTER,Jn.ESCAPE,Jn.F1,Jn.F2,Jn.F3,Jn.F4,Jn.F5,Jn.F6,Jn.F7,Jn.F8,Jn.F9,Jn.F10,Jn.F11,Jn.F12,Jn.F13,Jn.F14,Jn.F15,Jn.F16,Jn.F17,Jn.F18,Jn.F19,Jn.HOME,Jn.INSERT,Jn.MEDIA_NEXT,Jn.MEDIA_PLAY_PAUSE,Jn.MEDIA_PREV,Jn.MEDIA_STOP,Jn.NULL,Jn.NUM_LOCK,Jn.PAGE_DOWN,Jn.PAGE_UP,Jn.PAUSE,Jn.SCROLL_LOCK,Jn.SHIFT,Jn.TAB];function Zn(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function er(e){return Qn.includes(e)}function tr(e){var t=[];return Je()?t.push(Jn.COMMAND_LEFT,Jn.COMMAND_RIGHT,Jn.COMMAND_FIREFOX):t.push(Jn.CONTROL),t.includes(e)}function nr(e){return[Jn.CONTROL,Jn.COMMAND_LEFT,Jn.COMMAND_RIGHT,Jn.COMMAND_FIREFOX].includes(e)}function rr(e,t){var n=t.split("|"),r=!1;return re(n,(function(t){if(e===Jn[t])return r=!0,!1})),r}function or(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function ir(e){return!1===e.isImmediatePropagationEnabled}function ar(e){return 2===e.button}function sr(e){return 0===e.button}function ur(){var e;ft(console)&&(e=console).warn.apply(e,arguments)}function lr(){var e;ft(console)&&(e=console).error.apply(e,arguments)}function cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(14327);var fr,hr,dr=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],pr=st(qn||(fr=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(hr=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(hr=fr.slice(0)),qn=Object.freeze(Object.defineProperties(fr,{raw:{value:Object.freeze(hr)}})))),mr=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yr=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),vr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalBucket=this.createEmptyBucket()}var t,n,r;return t=e,n=[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return re(dr,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))re(t,(function(t){return n.add(e,t,r)}));else{mr.has(e)&&ur(xt(pr,{hookName:e,removedInVersion:mr.get(e)})),yr.has(e)&&ur(yr.get(e));var o=this.getBucket(r);if(void 0===o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){var i=!1;t.initialHook&&re(o[e],(function(n,r){if(n.initialHook)return o[e][r]=t,i=!0,!1})),i||o[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?re(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,s){var u=this.globalBucket[t],l=u?u.length:0,c=0;if(l)for(;c<l;)if(u[c]&&!u[c].skip){var f=Gn(u[c],e,n,r,o,i,a,s);void 0!==f&&(n=f),u[c]&&u[c].runOnce&&this.remove(t,u[c]),c+=1}else c+=1;var h=this.getBucket(e)[t],d=h?h.length:0,p=0;if(d)for(;p<d;)if(h[p]&&!h[p].skip){var m=Gn(h[p],e,n,r,o,i,a,s);void 0!==m&&(n=m),h[p]&&h[p].runOnce&&this.remove(t,h[p],e),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Te(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||dr.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&dr.splice(dr.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return yr.has(e)||mr.has(e)}},{key:"isRegistered",value:function(e){return dr.indexOf(e)>=0}},{key:"getRegistered",value:function(){return dr}}],r=[{key:"getSingleton",value:function(){return gr}}],n&&cr(t.prototype,n),r&&cr(t,r),e}(),gr=new vr;const br=vr;function wr(e){return function(e){if(Array.isArray(e))return _r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return _r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Sr=new Map;function Er(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Sr.has(e)||Sr.set(e,new Map);var t=Sr.get(e);function n(e,n){t.set(e,n)}function r(e){return t.get(e)}function o(e){return t.has(e)}function i(){return wr(t.keys())}function a(){return wr(t.values())}return{register:n,getItem:r,hasItem:o,getNames:i,getValues:a}}var kr=new WeakMap,Rr=Er("editors"),Tr=Rr.register,Cr=Rr.getItem,Mr=Rr.hasItem,Or=Rr.getNames;function Ar(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},br.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Lr(e,t){var n;if("function"==typeof e)kr.get(e)||Nr(null,e),n=kr.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=Cr(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function xr(e){if(!Mr(e))throw Error('No registered editor found under "'.concat(e,'" name'));return Cr(e).getConstructor()}function Nr(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new Ar(t);"string"==typeof e&&Tr(e,n),kr.set(t,n)}function Ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Rr.getValues;var Pr=0,Hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Ir(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}var t,n;return t=e,n=[{key:"addEventListener",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,jr(e))}return"boolean"==typeof o||q()||(o=!1),this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),Pr+=1,function(){r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(r=this.context.eventListeners[i]).event===t&&r.element===e){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Pr-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];n&&this.removeEventListener(n.element,n.event,n.callback,e)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n=e.document,r=e;n||(r=(n=e.ownerDocument?e.ownerDocument:e).defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}}],n&&Dr(t.prototype,n),e}();function jr(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),or(this)},e}const Fr=Hr;n(27867),n(13080);var Yr={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;re(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;Te(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};Re(Yr,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const Ur=Yr;function Br(e){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Br(e)}function Vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wr(e,t){return Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wr(e,t)}function zr(e,t){if(t&&("object"===Br(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gr(e){return Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gr(e)}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $r=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),qr=function(){function e(t){Kr(this,e),this.hot=t,this.instance=t,this.state=$r.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var t,n,r;return t=e,n=[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=$r.VIRGIN}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Gr(t);if(n){var o=Gr(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return zr(this,e)});function o(){return Kr(this,o),r.apply(this,arguments)}return o}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,r,o,i;if(t){var a=this.hot.getSelectedLast();n=Math.max(Math.min(a[0],a[2]),0),r=Math.max(Math.min(a[1],a[3]),0),o=Math.max(a[0],a[2]),i=Math.max(a[1],a[3])}else{var s=[this.row,this.col,null,null];n=s[0],r=s[1],o=s[2],i=s[3]}var u,l,c=this.hot.runHooks("modifyGetCellCoords",n,r);if(Array.isArray(c)){var f=(l=2,function(e){if(Array.isArray(e))return e}(u=c)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(u,l)||function(e,t){if(e){if("string"==typeof e)return Vr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vr(e,t):void 0}}(u,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());n=f[0],r=f[1]}this.hot.populateFromArray(n,r,e,o,i,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===$r.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(new $n(r,o)),this.state=$r.EDITING,this.isInFullEditMode()){var i="string"==typeof e?e:ct(this.originalValue);this.setValue(i)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e),o.hot.view.render()}}if(!this.isWaiting())if(this.state!==$r.VIRGIN){if(this.state===$r.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=$r.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=$r.FINISHED,o.discardEditor(e)})):(this.state=$r.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=$r.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===$r.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=$r.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=$r.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===$r.WAITING}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(t="left"),t}}],r=[{key:"EDITOR_TYPE",get:function(){return"base"}}],n&&Xr(t.prototype,n),r&&Xr(t,r),e}();function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Se(qr,Ur);var Zr=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new Fr(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)}));for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",(function(e){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",e)})),i=Ft(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view.wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}var t,n;return t=e,n=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e,t,n=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&n.prepareEditor()}));else{var r=this.instance.selection.selectedRange.current().highlight,o=r.row,i=r.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),s=o,u=i;if(Array.isArray(a)){var l=(t=2,function(e){if(Array.isArray(e))return e}(e=a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());s=l[0],u=l[1]}this.cellProperties=this.instance.getCellMeta(s,u);var c=this.instance.rootDocument.activeElement;if(c&&c.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var f=this.instance.getCellEditor(this.cellProperties),h=this.instance.getCell(o,i,!0);if(f&&h){var d=this.instance.colToProp(u),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),u);this.activeEditor=Lr(f,this.instance),this.activeEditor.prepare(o,i,d,h,p,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"moveSelectionUp",value:function(e){e?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(e){e?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(e){e?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(e){e?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(e){if(this.instance.isListening()){this.instance.runHooks("beforeKeyDown",e);var t=e.keyCode;if(!this.destroyed&&229!==t&&!ir(e)&&(this.lastKeyCode=t,this.selection.isSelected())){var n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||er(t)||nr(t)||n||this.isEditorOpened()){var r,o=e.shiftKey,i=o?this.selection.setRangeEnd:this.selection.setRangeStart;switch(t){case Jn.A:!this.isEditorOpened()&&n&&(this.instance.selectAll(),e.preventDefault(),e.stopPropagation());break;case Jn.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionUp(o),e.preventDefault(),e.stopPropagation();break;case Jn.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionDown(o),e.preventDefault(),e.stopPropagation();break;case Jn.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionRight(o),e.preventDefault(),e.stopPropagation();break;case Jn.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionLeft(o),e.preventDefault(),e.stopPropagation();break;case Jn.TAB:r="function"==typeof this.tableMeta.tabMoves?this.tableMeta.tabMoves(e):this.tableMeta.tabMoves,o?this.selection.transformStart(-r.row,-r.col):this.selection.transformStart(r.row,r.col,!0),e.preventDefault(),e.stopPropagation();break;case Jn.BACKSPACE:case Jn.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),e.preventDefault();break;case Jn.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e),e.preventDefault();break;case Jn.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==$r.WAITING&&this.closeEditorAndSaveChanges(n),this.moveSelectionAfterEnter(o)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,e)):this.moveSelectionAfterEnter(o),e.preventDefault(),or(e);break;case Jn.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(n),this.activeEditor.focus()),e.preventDefault();break;case Jn.HOME:e.ctrlKey||e.metaKey?i.call(this.selection,new $n(this.instance.rowIndexMapper.getFirstNotHiddenIndex(0,1),this.selection.selectedRange.current().from.col)):i.call(this.selection,new $n(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(0,1))),e.preventDefault(),e.stopPropagation();break;case Jn.END:e.ctrlKey||e.metaKey?i.call(this.selection,new $n(this.instance.rowIndexMapper.getFirstNotHiddenIndex(this.instance.countRows()-1,-1),this.selection.selectedRange.current().from.col)):i.call(this.selection,new $n(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(this.instance.countCols()-1,-1))),e.preventDefault(),e.stopPropagation();break;case Jn.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break;case Jn.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation()}}else this.openEditor("",e)}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}],n&&Qr(t.prototype,n),e}(),eo=new WeakMap;Zr.getInstance=function(e,t,n){var r=eo.get(e);return r||(r=new Zr(e,t,n),eo.set(e,r)),r};const to=Zr;function no(e){return function(e){if(Array.isArray(e))return ro(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ro(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ro(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(92070),n(99751),n(55017),n(46825),n(4363),n(85375);var oo={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},io=new RegExp(Object.keys(oo).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function ao(e){return"TABLE"===(e&&e.nodeName||"")}function so(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,r),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],u=t?["<thead>","</thead>"]:[],l=["<tbody>","</tbody>"],c=n?1:0,f=t?1:0,h=0;h<i;h+=1){for(var d=t&&0===h,p=[],m=0;m<a;m+=1){var y=!d&&n&&0===m,v="";if(d)v="<th>".concat(e.getColHeader(m-c),"</th>");else if(y)v="<th>".concat(e.getRowHeader(h-f),"</th>");else{var g=o[h][m],b=e.getCellMeta(h-f,m-c),w=b.hidden,_=b.rowspan,S=b.colspan;if(!w){var E=[];if(_&&E.push('rowspan="'.concat(_,'"')),S&&E.push('colspan="'.concat(S,'"')),dt(g))v="<td ".concat(E.join(" "),"></td>");else{var k=g.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v="<td ".concat(E.join(" "),">").concat(k,"</td>")}}}p.push(v)}var R=["<tr>"].concat(p,["</tr>"]).join("");d?u.splice(1,0,R):l.splice(-1,0,R)}return s.splice(1,0,u.join(""),l.join("")),s.join("")}function uo(e){for(var t=e.length,n=["<table>"],r=0;r<t;r+=1){var o=e[r],i=o.length,a=[];0===r&&n.push("<tbody>");for(var s=0;s<i;s+=1){var u=o[s],l=dt(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(l,"</td>"))}n.push.apply(n,["<tr>"].concat(a,["</tr>"])),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function lo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},r=t.createDocumentFragment(),o=t.createElement("div");r.appendChild(o);var i=e;if("string"==typeof i){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(i&&ao(i)){var s=o.querySelector('meta[name$="enerator"]'),u=null!==i.querySelector("tbody th"),l=i.querySelector("tr"),c=l?Array.from(l.cells).reduce((function(e,t){return e+t.colSpan}),0)-(u?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,p=0,m=0;if(i.tHead){var y=Array.from(i.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&h.push(e),!t}));d=(p=y.length)>0,p>1?n.nestedHeaders=Array.from(y).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,t,n){if(u&&0===n)return e;var r=t.colSpan,o=t.innerHTML,i=r>1?{label:o,colspan:r}:o;return e.push(i),e}),[]);return e.push(n),e}),[]):d&&(n.colHeaders=Array.from(y[0].children).reduce((function(e,t,n){return u&&0===n||e.push(t.innerHTML),e}),[]))}h.length&&(n.fixedRowsTop=h.length),f.length&&(n.fixedRowsBottom=f.length);var v=[].concat(h,no(Array.from(i.tBodies).reduce((function(e,t){return e.push.apply(e,no(Array.from(t.rows))),e}),[])),no(f));m=v.length;for(var g=new Array(m),b=0;b<m;b++)g[b]=new Array(c);for(var w=[],_=[],S=0;S<m;S++)for(var E=v[S],k=Array.from(E.cells),R=k.length,T=0;T<R;T++){var C=k[T],M=C.nodeName,O=C.innerHTML,A=C.rowSpan,L=C.colSpan,x=g[S].findIndex((function(e){return void 0===e}));if("TD"===M){if(A>1||L>1){for(var N=S;N<S+A;N++)if(N<m)for(var I=x;I<x+L;I++)g[N][I]=null;var D=C.getAttribute("style"),P=D&&D.includes("mso-ignore:colspan");P||w.push({col:x,row:S,rowspan:A,colspan:L})}var H="";H=s&&/excel/gi.test(s.content)?O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):O.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),g[S][x]=H.replace(io,(function(e){return oo[e]}))}else _.push(O)}return w.length&&(n.mergeCells=w),_.length&&(n.rowHeaders=_),g.length&&(n.data=g),n}}function co(e){return function(e){if(Array.isArray(e))return fo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return fo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fo(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ho(e){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ho(e)}function po(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=ho(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var r=Array.from(new Set(["."].concat(co(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(r,")?\\d+((").concat(r,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function mo(e){return po(e,[","])}function yo(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function vo(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function go(e,t){return t=parseInt(t.tostring().replace("%",""),10),parseInt(e*t/100,10)}function bo(e){return function(e){if(Array.isArray(e))return So(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||_o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){if(e){if("string"==typeof e)return So(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?So(e,t):void 0}}function So(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Eo="asc",ko=new Map([[Eo,[-1,1]],["desc",[1,-1]]]),Ro=function(e){return"The priority '".concat(e,"' is already declared in a map.")},To=function(e){return"The priority '".concat(e,"' is not a number.")};function Co(e){return function(e){if(Array.isArray(e))return Ao(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Oo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Oo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oo(e,t){if(e){if("string"==typeof e)return Ao(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(e,t):void 0}}function Ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(47715);var Lo=function(e){return"The id '".concat(e,"' is already declared in a map.")};function xo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function r(e,r){if(u(e))throw new Error(t(e));n.set(e,r)}function o(){n.clear()}function i(e){var t=s().find((function(t){var n=Mo(t,2),r=n[0],o=n[1];return e===o&&r}))||[null];return Mo(t,1)[0]}function a(e){return n.get(e)}function s(){return Co(n)}function u(e){return n.has(e)}return t=jn(t)?t:Lo,{addItem:r,clear:o,getId:i,getItem:a,getItems:s,hasItem:u}}function No(e){return function(e){if(Array.isArray(e))return Io(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Io(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Do=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function Po(e){return function(e){if(Array.isArray(e))return jo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ho(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ho(e,t){if(e){if("string"==typeof e)return jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jo(e,t):void 0}}function jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fo=function(e){return'There is already registered "'.concat(e,'" plugin.')},Yo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;function o(e,o){if(!po(e))throw new Error(n(e));if(r.has(e))throw new Error(t(e));r.set(e,o)}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Eo,t=ko.get(e)||ko.get(Eo),n=wo(t,2),o=n[0],i=n[1];return bo(r).sort((function(e,t){return e[0]<t[0]?o:i})).map((function(e){return e[1]}))}return t=jn(t)?t:Ro,n=jn(n)?n:To,{addItem:o,getItems:i}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),Uo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function r(e){if(n.has(e))throw new Error(t(e));n.add(e)}function o(){return No(n)}return t=jn(t)?t:Do,{addItem:r,getItems:o}}({errorItemExists:Fo}),Bo=xo({errorIdExists:Fo});function Vo(){return[].concat(Po(Yo.getItems()),Po(Uo.getItems()))}function Wo(e){var t=Mt(e);return Bo.getItem(t)}function zo(e,t,n){var r,o,i=function(e,t,n){return"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY),[e,t,n]}(e,t,n),a=(o=3,function(e){if(Array.isArray(e))return e}(r=i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||Ho(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());e=a[0],t=a[1],n=a[2],void 0===Wo(e)&&function(e,t,n){var r=Mt(e);if(Bo.hasItem(r))throw new Error(Fo(r));void 0===n?Uo.addItem(r):Yo.addItem(n,r),Bo.addItem(r,t)}(e,t,n)}var Go=Er("renderers"),Ko=Go.register,Xo=Go.getItem,$o=Go.hasItem,qo=Go.getNames;function Jo(e){if("function"==typeof e)return e;if(!$o(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Xo(e)}function Qo(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),Ko(e,t)}Go.getValues;var Zo=Er("validators"),ei=Zo.register,ti=Zo.getItem,ni=Zo.hasItem,ri=Zo.getNames;function oi(e){if("function"==typeof e)return e;if(!ni(e))throw Error('No registered validator found under "'.concat(e,'" name'));return ti(e)}function ii(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),ei(e,t)}function ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Zo.getValues;var si=new WeakMap,ui=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Fr(t),si.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n;return t=e,n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",(function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout((function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))}),200)}))};Ke()?t():(K()&&t(),e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=si.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],o=r[0],i=r[1],a=[n.col,t.selectedCellBeforeTouchEnd.from.col];return o===i&&a[0]===a[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=Bt(e,["TD","TH"],this.instance.wtTable.TABLE);return n?(t.coords=this.instance.wtTable.getCoords(n),t.TD=n):$t(e,"wtBorder")&&$t(e,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):$t(e,"wtBorder")&&$t(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=si.get(this),n=this.instance.rootDocument.activeElement,r=Vn(Ht,e.target),o=e.target;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);$t(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,o):i.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,i.coords,i.TD,this.instance),(0===e.button||this.instance.touchApplied)&&i.TD&&(t.dblClickOrigin[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.instance.getSetting("onCellContextMenu",e,t.coords,t.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(this.instance.hasSetting("onCellMouseOver")){var t=this.instance.wtTable.TABLE,n=Bt(e.target,["TD","TH"],t),r=this.instance.cloneSource||this.instance;n&&n!==r.lastMouseOver&&Vt(n,t)&&(r.lastMouseOver=n,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(n),n,this.instance))}}},{key:"onMouseOut",value:function(e){if(this.instance.hasSetting("onCellMouseOut")){var t=this.instance.wtTable.TABLE,n=Bt(e.target,["TD","TH"],t),r=Bt(e.relatedTarget,["TD","TH"],t);n&&n!==r&&Vt(n,t)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseUp",value:function(e){var t=si.get(this),n=this.parentCell(e.target);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,this.instance),(0===e.button||this.instance.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?($t(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",e,n.coords,n.TD,this.instance),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){si.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=ft(r)&&r.row>=0&&r.col>=0;e.cancelable&&o&&this.instance.getSetting("isDataViewInstance")&&(Xe()&&(je()||Ye())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()),this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=si.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}],n&&ai(t.prototype,n),e}();const li=ui;var ci="top",fi="bottom",hi="left",di="top_left_corner",pi="bottom_left_corner",mi=[ci,fi,hi,di,pi],yi={};function vi(e){var t=e.OVERLAY_NAME;if(-1===mi.indexOf(t))throw new Error("Unsupported overlay (".concat(t,")."));bi(t)||(yi[t]=e)}function gi(e,t){return new yi[e](t)}function bi(e){return void 0!==yi[e]}function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n;return t=e,n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}],n&&wi(t.prototype,n),e}();const Si=_i;function Ei(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ki=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n;return t=e,n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}],n&&Ei(t.prototype,n),e}();const Ri=ki;function Ti(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ci=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n;return t=e,n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}],n&&Ti(t.prototype,n),e}();function Mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=new Ci,this.workingSpace=0,this.sharedSize=null}var t,n;return t=e,n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof Ci}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}],n&&Mi(t.prototype,n),e}();function Ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Li=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new Oi,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n;return t=e,n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var r=e.firstElementChild;r;){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;r=r.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var i=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(i):e.insertBefore(i,e.firstChild),o+=1}for(var a=n&&t.isPlaceOn(1);o>r;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}],n&&Ai(t.prototype,n),e}();function xi(e){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}function Ni(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Di(e,t){return Di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Di(e,t)}function Pi(e,t){if(t&&("object"===xi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hi(e){return Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hi(e)}var ji=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Di(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Hi(r);if(o){var n=Hi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Pi(this,e)});function a(){return Ni(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}])&&Ii(t.prototype,n),a}(Li);function Fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}var t,n;return t=e,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&Fi(t.prototype,n),e}();function Ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new Yi(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}var t,n;return t=e,n=[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}],n&&Ui(t.prototype,n),e}();function Vi(e){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vi(e)}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zi(e,t){return zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},zi(e,t)}function Gi(e,t){if(t&&("object"===Vi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ki(e){return Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ki(e)}var Xi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zi(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ki(r);if(o){var n=Ki(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Gi(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=a,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new ji(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var s=this.table.renderedRowToSource(a),u=o.getRenderedNode(a);this.sourceRowIndex=s;var l=this.obtainOrderView(u),c=i.obtainOrderView(u);l.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){l.render();var h=l.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](s,h,f)}l.end()}}}])&&Wi(t.prototype,n),a}(Bi);function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ji(e,t){return Ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ji(e,t)}function Qi(e,t){if(t&&("object"===$i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zi(e){return Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zi(e)}var ea=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ji(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zi(r);if(o){var n=Zi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qi(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,e)}return t=a,(n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild;if(t){for(var o=this.table.columnsToRender+n,i=0,a=t;i<a;i++){for((r=this.rootNode.childNodes[i])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>t)for(var u=t;u<s;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Zt(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[t],s=-1*i;s<o;s+=1){var u=this.table.renderedColumnToSource(s),l=a.childNodes[s+i];l.className="",l.removeAttribute("style"),r[t](u,l,t)}}}])&&qi(t.prototype,n),a}(Bi);function ta(e){return ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ta(e)}function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ra(e,t){return ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ra(e,t)}function oa(e,t){if(t&&("object"===ta(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ia(e){return ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ia(e)}var aa,sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ia(r);if(o){var n=ia(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return oa(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,e)}return t=a,(n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<t;a++){var s=this.table.renderedColumnToSource(a),u=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[a+n].style.width="".concat(u,"px")}var l=this.rootNode.firstChild;l&&qt(l,"rowHeader")}}])&&na(t.prototype,n),a}(Bi);function ua(e){return ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ua(e)}function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ca(e,t){return ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ca(e,t)}function fa(e,t){if(t&&("object"===ua(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ha(e){return ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ha(e)}var da=!1,pa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ca(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ha(r);if(o){var n=ha(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fa(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,"TR",e)).orderView=new Li(e,(function(e){return t.nodesPool.obtain(e)}),t.nodeType),t}return t=a,n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!da&&e>1e3&&(da=!0,ur(st(aa||(aa=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}],n&&la(t.prototype,n),a}(Bi);function ma(e){return ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ma(e)}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function va(e,t){return va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},va(e,t)}function ga(e,t){if(t&&("object"===ma(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ba(e){return ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ba(e)}var wa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&va(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ba(r);if(o){var n=ba(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ga(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=a,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new ji(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,o=e.rowHeaders,i=0;i<t;i++){var a=this.table.renderedRowToSource(i),s=r.getRenderedNode(i);this.sourceRowIndex=a;var u=this.obtainOrderView(s),l=o.obtainOrderView(s);u.prependView(l).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){u.render();var f=u.getCurrentNode(),h=this.table.renderedColumnToSource(c);$t(f,"hide")||(f.className=""),f.removeAttribute("style"),this.table.cellRenderer(a,h,f)}u.end()}}}])&&ya(t.prototype,n),a}(Bi);function _a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ea=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;_a(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}var t,n;return t=e,n=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}],n&&Sa(t.prototype,n),e}();function ka(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ra(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ta=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,s=t.columnUtils,u=t.cellRenderer;ka(this,e),this.renderer=new Ea(n,{cellRenderer:u}),this.renderer.setRenderers({rowHeaders:new Xi,columnHeaders:new ea(r),colGroup:new sa(o),rows:new pa(i),cells:new wa}),this.renderer.setAxisUtils(a,s)}var t,n;return t=e,(n=[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&Ra(t.prototype,n),e}();function Ca(e){return Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ca(e)}function Ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oa=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.headerWidths=new Map}var t,n;return t=e,(n=[{key:"getWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===Ca(t)&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getWidth(e),n=this.wot.wtViewport.columnsRenderCalculator,r=null!=t?t:this.wot.wtSettings.settings.defaultColumnWidth;if(n){var o=n.getStretchedColumnWidth(e,r);o&&(r=o)}return r}},{key:"getHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=e.cloneSource,o=r?r.wtTable.holder:t.holder,i=o.offsetHeight<o.scrollHeight?Mn():0,a=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-i),null!=(a=e.getSetting("onModifyRowHeaderWidth",a)))for(var s=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth"),l=0;l<s;l++){var c=Array.isArray(a)?a[l]:a;c=null==c?u:c,this.headerWidths.set(l,c)}}}])&&Ma(t.prototype,n),e}();function Aa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var La=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n;return t=e,(n=[{key:"getHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}])&&Aa(t.prototype,n),e}();function xa(e,t){if(e){if("string"==typeof e)return Na(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Na(e,t):void 0}}function Na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Da=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isMaster=!t.cloneOverlay,this.wot=t,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,Qt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(o)},this.rowUtils=new La(this.wot),this.columnUtils=new Oa(this.wot),this.tableRenderer=new Ta({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}var t,n;return t=e,n=[{key:"is",value:function(e){return n=e,!(!(t=this.wot.cloneOverlay)||!yi[n])&&t instanceof yi[n];var t,n}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(e.createElement("TR"))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&$t(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&$t(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&$t(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable"),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtOverlays,r=t.wtViewport,o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),s=a.length,u=t.getSetting("columnHeaders"),l=u.length,c=!1,f=e;if(this.isMaster&&(this.holderOffset=an(this.holder),f=r.createRenderCalculators(f),s&&!t.getSetting("fixedColumnsLeft"))){var h=n.leftOverlay.getScrollPosition(),d=this.correctHeaderWidth;this.correctHeaderWidth=h>0,d!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(c=n.prepareOverlays()),f)this.isMaster&&r.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=an(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var p=o>0?this.getFirstRenderedRow():0,m=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ri(p,o,l),this.columnFilter=new Si(m,i,s);var y,v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var g={};this.wot.getSetting("beforeDraw",!0,g),v=!0!==g.skipRender}if(v)if(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(fi)||this.is(pi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(y=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(fi))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var b=yn(this.hider),w=yn(this.TABLE);0!==b&&w!==b&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is(fi)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var _=n.topOverlay.resetFixedPosition();n.bottomOverlay.clone&&(_=n.bottomOverlay.resetFixedPosition()||_),_=n.leftOverlay.resetFixedPosition()||_,n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition(),_&&(n.refreshAll(),n.adjustElementsSize())}return this.refreshSelections(f),c&&n.syncScrollWithMaster(),t.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t,n,r,o=this.wot.wtTable.columnFilter.renderedToSource(e),i=this.wot.getSetting("columnHeaders").length,a=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,t=this.wot.wtTable.getColumnHeaderHeight(i),(n=this.wot.wtTable.getColumnHeader(o,i))&&(r=gn(n),(!t&&a<r||t<r)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(s)?null!==s[i]&&void 0!==s[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]):isNaN(s)||(this.wot.wtViewport.oversizedColumnHeaders[i]=s),this.wot.wtViewport.oversizedColumnHeaders[i]<(s[i]||s)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,t=e.wtTable.THEAD.childNodes,n=e.wtViewport.oversizedColumnHeaders,r=0,o=e.getSetting("columnHeaders").length;r<o;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height="".concat(n[r],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if((this.isMaster||this.is(fi))&&!e.getSetting("externalRowCalculator"))for(var t=this.getRenderedRowsCount(),n=0;n<t;n++){var r=this.rowFilter.renderedToSource(n);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[r]&&(e.wtViewport.oversizedRows[r]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,r=t.length;n<r;n++)Jt(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wot;if(t.selections){var n=Array.from(t.selections),r=n.length;if(e){for(var o=[],i=0;i<r;i++){for(var a=n[i].settings,s=a.highlightHeaderClassName,u=a.highlightRowClassName,l=a.highlightColumnClassName,c=n[i].classNames,f=c.length,h=0;h<f;h++)o.includes(c[h])||o.push(c[h]);s&&!o.includes(s)&&o.push(s),u&&!o.includes(u)&&o.push(u),l&&!o.includes(l)&&o.push(l)}var d=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(var p=0;p<d.length;p++)o.push(d[p]);for(var m=o.length,y=0;y<m;y++)this.removeClassFromCells(o[y])}for(var v=0;v<r;v++)n[v].draw(t,e)}}},{key:"getCell",value:function(e){var t,n,r,o=e.row,i=e.col,a=this.wot.getSetting("onModifyGetCellCoords",o,i);if(a&&Array.isArray(a)){var s=(r=2,function(e){if(Array.isArray(e))return e}(n=a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||xa(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o=s[0],i=s[1]}if(this.isRowBeforeRenderedRows(o))return-1;if(this.isRowAfterRenderedRows(o))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;if(!(t=o<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(o)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(o)])&&o>=0)throw new Error("TR was expected to be rendered but is not");var u=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!u&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return u}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wot.getSetting("rowHeaders").length;if(!(t>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==r?void 0:r.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wot.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null==o?void 0:o.childNodes[r];i&&t.push(i)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Ut(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,o=Wt(n),i=t.cellIndex;return zt(di,t,this.wtRootElement)||zt(ci,t,this.wtRootElement)?"THEAD"===r.nodeName&&(o-=r.childNodes.length):o=zt(pi,t,this.wtRootElement)||zt(fi,t,this.wtRootElement)?this.wot.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),i=zt(di,t,this.wtRootElement)||zt(hi,t,this.wtRootElement)||zt(pi,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new $n(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,t,n,r,o,i=this.TBODY.childNodes.length;if(i*this.wot.wtSettings.settings.defaultRowHeight!=gn(this.TBODY)-1||this.wot.getSetting("fixedRowsBottom"))for(;i;)i-=1,n=this.rowFilter.renderedToSource(i),e=this.getRowHeight(n),t=(o=(r=this.getTrForRow(n)).querySelector("th"))?gn(o):gn(r)-1,(!e&&this.wot.wtSettings.settings.defaultRowHeight<t||e<t)&&(t+=1,this.wot.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return on(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t,n=jn(e)?e():null;return Array.isArray(n)?(t=n,n=function(e){if(Array.isArray(e))return Na(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||xa(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[n.length-1]=this._correctRowHeaderWidth(n[n.length-1]):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}],n&&Ia(t.prototype,n),e}();const Pa=Da;var Ha={getFirstRenderedRow:function(){var e=this.wot.getSetting("totalRows"),t=this.wot.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Re(Ha,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const ja=Ha;var Fa={getFirstRenderedColumn:function(){return 0===this.wot.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Re(Fa,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});const Ya=Fa;function Ua(e){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ua(e)}function Ba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Va(e,t){return Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Va(e,t)}function Wa(e,t){if(t&&("object"===Ua(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function za(e){return za=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},za(e)}var Ga=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=za(t);if(n){var o=za(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Wa(this,e)});function o(){return Ba(this,o),r.apply(this,arguments)}return o}(Pa);Se(Ga,ja),Se(Ga,Ya);const Ka=Ga;function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Re(this,"wot",t,{writable:!1});var n=this.wot.wtTable,r=n.TABLE,o=n.hider,i=n.spreader,a=n.holder,s=n.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=r,this.hider=o,this.spreader=i,this.holder=a,this.wtRootElement=s,this.trimmingContainer=hn(this.hider.parentNode.parentNode),this.updateStateOfRendering()}var t,n;return t=e,n=[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=hn(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot,t=e.wtTable;"hidden"===e.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=fn(t.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1!==this.clone.wtTable.holder.contains(e)){var r=this.mainTableScrollableElement===this.wot.rootWindow,o=n<this.wot.getSetting("fixedColumnsLeft"),i=t<this.wot.getSetting("fixedRowsTop"),a=t>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),s={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},u={left:e.offsetLeft,top:e.offsetTop};return r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s)}ur("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var o,i,a=this.wot.wtTable.wtRootElement.getBoundingClientRect();return o=t?a.left<=0?-1*a.left:0:r.left,i=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-a.top:r.top,{left:n.left+o,top:n.top+i}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var i=this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),a=this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition(),s=0,u=0;if(n||(s=i-o.left),t){var l=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+l.top}else e||(u=a-o.top);return{left:r.left-s,top:r.top-u}}},{key:"makeClone",value:function(e){if(-1===mi.indexOf(e))throw new Error('Clone type "'.concat(e,'" is not supported.'));var t=this.wot,n=t.wtTable,r=t.rootDocument,o=t.rootWindow,i=r.createElement("DIV"),a=r.createElement("TABLE"),s=n.wtRootElement.parentNode;i.className="ht_clone_".concat(e," handsontable"),i.style.position="absolute",i.style.top=0,i.style.left=0,i.style.overflow="visible",a.className=n.TABLE.className,i.appendChild(a),this.type=e,s.appendChild(i);var u=this.wot.getSetting("preventOverflow");return!0===u||"horizontal"===u&&this.type===ci||"vertical"===u&&this.type===hi?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=n.holder:this.mainTableScrollableElement=fn(n.TABLE),new this.wot.constructor({cloneSource:this.wot,cloneOverlay:this,table:a})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;re([e.style,t.style,e.parentNode.style],(function(e){e.width="",e.height=""}))}}},{key:"destroy",value:function(){new Fr(this.clone).destroy()}}],n&&Xa(t.prototype,n),e}();function qa(e){return qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qa(e)}function Ja(e,t,n){return Ja=ts()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Za(o,n.prototype),o},Ja.apply(null,arguments)}function Qa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Za(e,t){return Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Za(e,t)}function es(e,t){if(t&&("object"===qa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ts(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ns(e){return ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ns(e)}var rs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}(s,e);var t,n,r,o,i,a=(t=s,n=ts(),function(){var e,r=ns(t);if(n){var o=ns(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return es(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).clone=t.makeClone(pi),t}return r=s,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ja(Ka,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderBottomOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),e.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===e.rootWindow){var n,r,o=this.wot,i=o.rootDocument,a=o.wtTable.hider.getBoundingClientRect(),s=Math.ceil(a.bottom),u=Math.ceil(a.left),l=i.documentElement.clientHeight;n=u<0?-u:0,r=s>l?s-l:0,r+="px",n+="px",t.style.left=n,t.style.bottom=r}else Nn(t),this.repositionOverlay();var c=vn(this.clone.wtTable.TABLE),f=yn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(c=0),t.style.height="".concat(c,"px"),t.style.width="".concat(f,"px"),!1}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Mn(n);t.holder.clientHeight===t.holder.offsetHeight&&(o=0),r.style.bottom="".concat(o,"px")}}],i=[{key:"OVERLAY_NAME",get:function(){return pi}}],o&&Qa(r.prototype,o),i&&Qa(r,i),s}($a),os={getFirstRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.startColumn;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.endColumn;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return null===e?-1:e},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Re(os,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const is=os;function as(e){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},as(e)}function ss(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function us(e,t){return us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},us(e,t)}function ls(e,t){if(t&&("object"===as(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cs(e){return cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cs(e)}var fs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=cs(t);if(n){var o=cs(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return ls(this,e)});function o(){return ss(this,o),r.apply(this,arguments)}return o}(Pa);Se(fs,ja),Se(fs,is);const hs=fs;function ds(e){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ds(e)}function ps(e,t,n){return ps=bs()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&ys(o,n.prototype),o},ps.apply(null,arguments)}function ms(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ys(e,t){return ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ys(e,t)}function vs(e,t){if(t&&("object"===ds(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gs(e)}function gs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ws(e){return ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ws(e)}var _s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(s,e);var t,n,r,o,i,a=(t=s,n=bs(),function(){var e,r=ws(t);if(n){var o=ws(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return vs(this,e)});function s(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=gs(t=a.call(this,e)),(r="cachedFixedRowsBottom")in n?Object.defineProperty(n,r,{value:-1,enumerable:!0,configurable:!0,writable:!0}):n[r]=-1,t.clone=t.makeClone(fi),t.cachedFixedRowsBottom=t.wot.getSetting("fixedRowsBottom"),t}return r=s,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ps(hs,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;e.style.top="";var t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"vertical"===n)t=this.getScrollPosition(),this.repositionOverlay();else{var r,o,i=this.wot,a=i.rootDocument,s=i.wtTable,u=s.hider.getBoundingClientRect(),l=Math.ceil(u.bottom),c=a.documentElement.clientHeight;r=""===(r=s.hider.style.left)?0:r,t=o=l>c?l-c:0,o+="px",e.style.left=r,e.style.bottom=o}var f=this.adjustHeaderBordersPosition(t);return this.adjustElementsSize(),f}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Mn(n);t.holder.clientHeight===t.holder.offsetHeight&&(o=0),r.style.bottom="".concat(o,"px")}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(un(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.settings.defaultRowHeight,i=e,a=0;i<t;){var s=r.getRowHeight(i);a+=void 0===s?o:s,i+=1}return a}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=e.rootWindow,o=Mn(this.wot.rootDocument),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var u=vn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),i.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;t&&r.offsetHeight!==r.clientHeight&&(o=Mn(this.wot.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return ln(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wot.getSetting("columnHeaders"),o=!1;if((n||0===t)&&r.length>0){var i=this.wot.wtTable.holder.parentNode,a=$t(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),e||0===this.wot.getSetting("totalRows")?(qt(i,"innerBorderBottom"),o=!a):(Jt(i,"innerBorderBottom"),o=a)}return o}}],i=[{key:"OVERLAY_NAME",get:function(){return fi}}],o&&ms(r.prototype,o),i&&ms(r,i),s}($a),Ss={getFirstRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.startRow;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.startRow;return null===e?-1:e},getLastRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.endRow;return null===e?-1:e},getLastVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.endRow;return null===e?-1:e},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Re(Ss,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const Es=Ss;function ks(e){return ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ks(e)}function Rs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ts(e,t){return Ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ts(e,t)}function Cs(e,t){if(t&&("object"===ks(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ms(e)}var Os=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ts(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Ms(t);if(n){var o=Ms(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Cs(this,e)});function o(){return Rs(this,o),r.apply(this,arguments)}return o}(Pa);Se(Os,Es),Se(Os,Ya);const As=Os;function Ls(e){return Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ls(e)}function xs(e,t,n){return xs=Ps()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Is(o,n.prototype),o},xs.apply(null,arguments)}function Ns(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Is(e,t){return Is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Is(e,t)}function Ds(e,t){if(t&&("object"===Ls(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ps(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Hs(e){return Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hs(e)}var js=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Is(e,t)}(s,e);var t,n,r,o,i,a=(t=s,n=Ps(),function(){var e,r=Hs(t);if(n){var o=Hs(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Ds(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).clone=t.makeClone(hi),t}return r=s,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xs(As,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(this.needFullRender&&e.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,n=0,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||r&&"horizontal"===r)n=this.getScrollPosition(),Nn(t);else{var o,i,a=e.hider.getBoundingClientRect(),s=Math.ceil(a.left),u=Math.ceil(a.right);i=""===(i=e.hider.style.top)?0:i,n=o=s<0&&u-t.offsetWidth>0?-s:0,Ln(t,o+="px",i)}var l=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),l}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,sn(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot.wtSettings.defaultColumnWidth,r=e,o=0;r<t;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,r=e.rootWindow,o=Mn(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===a){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,t.wtRootElement.scrollHeight),i.height="".concat(s,"px")}else i.height="";this.clone.wtTable.holder.style.height=i.height;var u=yn(this.clone.wtTable.TABLE);i.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+r,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalColumns");if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;return t&&r.offsetWidth!==r.clientWidth&&(o=Mn(this.wot.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==this.wot.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return cn(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft");this.wot.getSetting("totalRows")?Jt(t,"emptyRows"):qt(t,"emptyRows");var o=!1;if(r&&!n.length)qt(t,"innerBorderLeft");else if(!r&&n.length){var i=$t(t,"innerBorderLeft");e?(qt(t,"innerBorderLeft"),o=!i):(Jt(t,"innerBorderLeft"),o=i)}return o}}],i=[{key:"OVERLAY_NAME",get:function(){return hi}}],o&&Ns(r.prototype,o),i&&Ns(r,i),s}($a),Fs={getFirstRenderedRow:function(){return 0===this.wot.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Re(Fs,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const Ys=Fs;function Us(e){return Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(e)}function Bs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vs(e,t){return Vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vs(e,t)}function Ws(e,t){if(t&&("object"===Us(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zs(e)}var Gs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vs(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=zs(t);if(n){var o=zs(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Ws(this,e)});function o(){return Bs(this,o),r.apply(this,arguments)}return o}(Pa);Se(Gs,Ys),Se(Gs,Ya);const Ks=Gs;function Xs(e){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xs(e)}function $s(e,t,n){return $s=Zs()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Js(o,n.prototype),o},$s.apply(null,arguments)}function qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Js(e,t){return Js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Js(e,t)}function Qs(e,t){if(t&&("object"===Xs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function eu(e){return eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},eu(e)}var tu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Js(e,t)}(s,e);var t,n,r,o,i,a=(t=s,n=Zs(),function(){var e,r=eu(t);if(n){var o=eu(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Qs(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).clone=t.makeClone(di),t}return r=s,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $s(Ks,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderTopOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var n=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(n.top),o=Math.ceil(n.left),i=Math.ceil(n.bottom),a=Math.ceil(n.right),s="0",u="0";t&&"vertical"!==t||o<0&&a-e.offsetWidth>0&&(s="".concat(-o,"px")),t&&"horizontal"!==t||r<0&&i-e.offsetHeight>0&&(u="".concat(-r,"px")),Ln(e,s,u)}else Nn(e);var l=vn(this.clone.wtTable.TABLE),c=yn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),e.style.height="".concat(l,"px"),e.style.width="".concat(c,"px"),!1}}}],i=[{key:"OVERLAY_NAME",get:function(){return di}}],o&&qs(r.prototype,o),i&&qs(r,i),s}($a);function nu(e){return nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nu(e)}function ru(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ou(e,t){return ou=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ou(e,t)}function iu(e,t){if(t&&("object"===nu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function au(e){return au=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},au(e)}var su=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ou(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=au(t);if(n){var o=au(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return iu(this,e)});function o(){return ru(this,o),r.apply(this,arguments)}return o}(Pa);Se(su,Ys),Se(su,is);const uu=su;function lu(e){return lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lu(e)}function cu(e,t,n){return cu=mu()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&hu(o,n.prototype),o},cu.apply(null,arguments)}function fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hu(e,t){return hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hu(e,t)}function du(e,t){if(t&&("object"===lu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pu(e)}function pu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function yu(e){return yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yu(e)}var vu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hu(e,t)}(s,e);var t,n,r,o,i,a=(t=s,n=mu(),function(){var e,r=yu(t);if(n){var o=yu(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return du(this,e)});function s(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=pu(t=a.call(this,e)),(r="cachedFixedRowsTop")in n?Object.defineProperty(n,r,{value:-1,enumerable:!0,configurable:!0,writable:!0}):n[r]=-1,t.clone=t.makeClone(ci),t.cachedFixedRowsTop=t.wot.getSetting("fixedRowsTop"),t}return r=s,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cu(uu,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow"),n=0,r=!1;if(this.trimmingContainer!==this.wot.rootWindow||t&&"vertical"===t)n=this.getScrollPosition(),Nn(e);else{var o,i,a=this.wot.wtTable,s=a.hider.getBoundingClientRect(),u=Math.ceil(s.top),l=Math.ceil(s.bottom),c=e.offsetHeight;r=l===c,n=i=u<0&&l-c>0?-u:0,Ln(e,o=""===(o=a.hider.style.left)?0:o,i+="px")}var f=this.adjustHeaderBordersPosition(n,r);return this.adjustElementsSize(),f}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(un(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot.wtSettings.settings.defaultRowHeight,r=e,o=0;r<t;){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,r=e.rootWindow,o=Mn(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var u=vn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),i.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+r,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,r=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=this.getTableParentOffset(),i=0;if(t&&r.offsetHeight!==r.clientHeight&&(i=Mn(n.rootDocument)),t){var a=n.getSetting("fixedRowsBottom"),s=n.getSetting("totalRows");o+=this.sumCellSizes(0,e+1),o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(s-a,s),o+=1}else o+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return o+=i,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return ln(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,r=this.wot.getSetting("totalColumns");r?Jt(n,"emptyColumns"):qt(n,"emptyColumns");var o=!1;if(!t){var i=this.wot.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,s=this.wot.getSetting("columnHeaders");if((a||0===i)&&s.length>0){var u=$t(n,"innerBorderTop");this.cachedFixedRowsTop=this.wot.getSetting("fixedRowsTop"),e||0===this.wot.getSetting("totalRows")?(qt(n,"innerBorderTop"),o=!u):(Jt(n,"innerBorderTop"),o=u)}}if(0===this.wot.getSetting("rowHeaders").length){var l=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(l)for(var c=0;c<l.length;c++)l[c].style["border-left-width"]=0}return o}}],i=[{key:"OVERLAY_NAME",get:function(){return ci}}],o&&fu(r.prototype,o),i&&fu(r,i),s}($a);function gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}vi(rs),vi(_s),vi(js),vi(tu),vi(vu);var bu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t;var n=this.wot,r=n.rootDocument,o=n.rootWindow,i=n.wtTable,a=parseInt(o.getComputedStyle(r.body).lineHeight,10),s=1.2*parseInt(o.getComputedStyle(r.body).fontSize,10);this.instance=this.wot,this.eventManager=new Fr(this.wot),this.scrollbarSize=Mn(r),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var u="hidden"===o.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?i.holder:fn(i.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}var t,n;return t=e,n=[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=gi(ci,this.wot),bi(fi)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),bi(pi)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=gi(fi,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=gi(hi,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=gi(di,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=gi(pi,this.wot)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.wot,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var a,s=r.devicePixelRatio&&r.devicePixelRatio>1,u=this.scrollableElement===r,l=this.wot.wtSettings.getSetting("preventWheel"),c={passive:u};(l||s||!He())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,l)}),c),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,l)}),c)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(a),a=setTimeout((function(){e.wot.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.wot.rootWindow,r=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==n&&i!==n&&!i.contains(o),s=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!s){var u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&u)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=rr(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.browserLineHeight,n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*t,n+=n*t);var o=this.scrollVertically(n),i=this.scrollHorizontally(r);return o||i}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,t=e.rootWindow,n=e.wtTable;"hidden"===t.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=n.holder:this.scrollableElement=fn(n.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtTable.spreader,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtViewport,r=t.wtTable,o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=r.hider.style;if(u.width="".concat(a+this.leftOverlay.sumCellSizes(0,o),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var l=r.wtRootElement,c=l.scrollHeight,f=l.scrollWidth,h=r.holder,d=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=c<d,this.hasScrollbarBottom=f<p,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wot.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return re(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.instance.wtTable.TABLE;re([this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}],n&&gu(t.prototype,n),e}();const wu=bu;function _u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Su=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n;return t=e,n=[{key:"scrollViewport",value:function(e,t,n,r,o){if(e.col<0||e.row<0)return!1;var i=this.scrollViewportHorizontally(e.col,n,o),a=this.scrollViewportVertically(e.row,t,r);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedColumnsLeft,i=r.leftOverlay,a=r.totalColumns,s=!1;if(e>=0&&e<=Math.max(a-1,0)){var u=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();e>=o&&u>-1&&(e<u||n)?s=i.scrollTo(e):(-1===l||l>-1&&(e>l||t))&&(s=i.scrollTo(e,!0))}return s}},{key:"scrollViewportVertically",value:function(e,t,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedRowsBottom,i=r.fixedRowsTop,a=r.topOverlay,s=r.totalRows,u=!1;if(e>=0&&e<=Math.max(s-1,0)){var l=this.getFirstVisibleRow(),c=this.getLastVisibleRow();e>=i&&l>-1&&(e<l||t)?u=a.scrollTo(e):(-1===c||c>-1&&(e>c&&e<s-o||n))&&(u=a.scrollTo(e,!0))}return u}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop,a=this.wot.rootWindow,s=n.getFirstVisibleRow();if(t.mainTableScrollableElement===a){var u=an(n.wtRootElement),l=gn(n.hider),c=gn(a),f=ln(a,a);if(u.top+l-c<=f){var h=r.getColumnHeaderHeight();h+=t.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=t.sumCellSizes(d-1,d),u.top+l-h<=f){s=d;break}}}return s}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=this.wot.rootWindow,a=n.getLastVisibleRow();if(t.mainTableScrollableElement===i){var s=an(n.wtRootElement),u=ln(i,i);if(s.top>u)for(var l=gn(i),c=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),s.top+c-u>=l){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){var s=an(n.wtRootElement),u=bn(n.hider),l=bn(i),c=cn(i,i);if(s.left+u-l<=c)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=t.sumCellSizes(h-1,h),s.left+u-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===i){var s=an(n.wtRootElement),u=cn(i,i);if(s.left>u)for(var l=bn(i),c=r.getRowHeaderWidth(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),s.left+c-u>=l){a=f-2;break}}return a}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}],n&&_u(t.prototype,n),e}();const Eu=Su;function ku(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ru=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderLeftOverlay:function(){return r.getSetting("fixedColumnsLeft")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var o=r.getSetting("data",e,t);rn(n,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Te(this.defaults,(function(e,t){if(void 0!==n[t])r.settings[t]=n[t];else{if(void 0===e)throw new Error('A required setting "'.concat(t,'" was not provided'));r.settings[t]=e}}))}var t,n;return t=e,n=[{key:"update",value:function(e,t){var n=this;return void 0===t?Te(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this.wot}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}],n&&ku(t.prototype,n),e}();const Tu=Ru;function Cu(e){return Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cu(e)}function Mu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Au(e,t){return Au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Au(e,t)}function Lu(e,t){if(t&&("object"===Cu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xu(e)}var Nu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Au(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xu(r);if(o){var n=xu(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Lu(this,e)});function a(){return Mu(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=hn(this.wtRootElement),t=this.wot.rootWindow;if(e===t)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=e.parentElement,r=dn(e,"height",t),o=dn(e,"overflow",t),i=this.holder.style,a=e.scrollWidth,s=e.scrollHeight,u=e.getBoundingClientRect(),l=u.width,c=u.height;if(n&&["auto","hidden","scroll"].includes(o)){var f=e.cloneNode(!1);f.style.overflow="auto",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);var h=parseInt(mn(f,t).height,10);n.removeChild(f),0===h&&(c=0)}c=Math.min(c,s),i.height="auto"===r?"auto":"".concat(c,"px"),l=Math.min(l,a),i.width="".concat(l,"px"),i.overflow="",this.hasTableHeight="auto"===i.height||c>0,this.hasTableWidth=l>0}this.isTableVisible=on(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot,t=e.getOverlayName(),n=e.getSetting("columnHeaders").length;if(n&&!e.wtViewport.hasOversizedColumnHeadersMarked[t]){for(var r=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),i=0;i<n;i++)for(var a=-1*r;a<o;a++)this.markIfOversizedColumnHeader(a);e.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}}])&&Ou(t.prototype,n),a}(Pa);Se(Nu,Es),Se(Nu,is);const Iu=Nu;function Du(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hu=new WeakMap,ju=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,u=t.scrollbarHeight;Du(this,e),Hu.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var t,n,r;return t=e,n=[{key:"calculate",value:function(){for(var t,n=0,r=!0,o=[],i=Hu.get(this),a=i.calculationType,s=i.overrideFn,u=i.rowHeightFn,l=i.scrollOffset,c=i.totalRows,f=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d=0;d<c;d++)if(t=u(d),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=l&&2!==a&&(this.startRow=d),n>=l&&n+(2===a?t:0)<=l+f-h&&(null===this.startRow&&(this.startRow=d),this.endRow=d),o.push(n),n+=t,2!==a&&(this.endRow=d),n>=l+f-h){r=!1;break}if(this.endRow===c-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var p=o[this.endRow]+t-o[this.startRow-1];if((p<=f-h||2!==a)&&(this.startRow-=1),p>=f-h)break}1===a&&null!==this.startRow&&s&&s(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],r=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],n&&Pu(t.prototype,n),r&&Pu(t,r),e}();const Fu=ju;function Yu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bu=new WeakMap,Vu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,u=t.stretchMode,l=t.stretchingItemWidthFn,c=void 0===l?function(e){return e}:l;Yu(this,e),Bu.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var t,n,r;return t=e,n=[{key:"calculate",value:function(){for(var e,t=0,n=!0,r=[],o=Bu.get(this),i=o.calculationType,a=o.overrideFn,s=o.scrollOffset,u=o.totalColumns,l=o.viewportWidth,c=0;c<u;c++)if(e=this._getColumnWidth(c),t<=s&&2!==i&&(this.startColumn=c),t>=s&&t+(2===i?e:0)<=s+(s>0?l+1:l)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=c),this.endColumn=c),r.push(t),t+=e,2!==i&&(this.endColumn=c),t>=s+l){n=!1;break}if(this.endColumn===u-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var f=r[this.endColumn]+e-r[this.startColumn-1];if((f<=l||2!==i)&&(this.startColumn-=1),f>l)break}1===i&&null!==this.startColumn&&a&&a(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),u<this.endColumn&&(this.endColumn=u-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=Bu.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var a=this._getColumnWidth(i),s=n.stretchingColumnWidthFn(void 0,i);"number"==typeof s?t-=s:o+=a}var u=t-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var l=this._getColumnWidth(r-1),c=u+l;this.stretchLastWidth=c>=0?c:l}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=Bu.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var i=Math.round(t*this.stretchAllRatio),a=r.stretchingColumnWidthFn(i,e);this.stretchAllColumnsWidth[e]=void 0===a?i:isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===Bu.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=Bu.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],r=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],n&&Uu(t.prototype,n),r&&Uu(t,r),e}();const Wu=Vu;function zu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gu=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Fr(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",(function(){n.clientHeight=n.getWorkspaceHeight()}))}var t,n;return t=e,n=[{key:"getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,t=this.instance.wtOverlays.topOverlay.trimmingContainer;return t===this.wot.rootWindow?e.documentElement.clientHeight:vn(t)>0&&t.clientHeight>0?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wot,r=n.rootDocument,o=n.rootWindow,i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=r.documentElement.offsetWidth,s=n.getSetting("totalColumns");if(n.getSetting("preventOverflow"))return yn(this.instance.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>e)return r.documentElement.clientWidth;if(i!==o&&("scroll"===(t=dn(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",o))||"hidden"===t||"auto"===t))return Math.max(e,i.clientWidth);var u=n.getSetting("stretchH");return"none"!==u&&u?e:Math.max(e,yn(this.instance.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=this.wot.wtTable,r=0,o=e;o<t;)r+=n.getColumnWidth(o),o+=1;return r}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,t=this.wot.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return an(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return vn(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return yn(e.TABLE)||yn(e.TBODY)||yn(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.instance.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=vn(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=t.length;i<a;i++)o?(this.rowHeaderWidth+=yn(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=this.wot,i=o.wtSettings,a=o.wtOverlays,s=o.wtTable,u=o.rootDocument;this.rowHeaderWidth=NaN,e=i.settings.renderAllRows&&1===r?1/0:this.getViewportHeight();var l=a.topOverlay.getScrollPosition()-a.topOverlay.getTableParentOffset();l<0&&(l=0);var c=o.getSetting("fixedRowsTop"),f=o.getSetting("fixedRowsBottom"),h=o.getSetting("totalRows");return c&&(l+=n=a.topOverlay.sumCellSizes(0,c),e-=n),f&&a.bottomOverlay.clone&&(e-=n=a.bottomOverlay.sumCellSizes(h-f,h)),t=s.holder.clientHeight===s.holder.offsetHeight?0:Mn(u),new Fu({viewportSize:e,scrollOffset:l,totalItems:o.getSetting("totalRows"),itemSizeFn:function(e){return s.getRowHeight(e)},overrideFn:i.settings.viewportRowCalculatorOverride,calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.wot,n=t.wtSettings,r=t.wtOverlays,o=t.wtTable,i=t.rootDocument,a=this.getViewportWidth(),s=r.leftOverlay.getScrollPosition()-r.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,s<0&&(s=0);var u=t.getSetting("fixedColumnsLeft");if(u){var l=r.leftOverlay.sumCellSizes(0,u);s+=l,a-=l}return o.holder.clientWidth!==o.holder.offsetWidth&&(a-=Mn(i)),new Wu({viewportSize:a,scrollOffset:s,totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return t.wtTable.getColumnWidth(e)},overrideFn:n.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(2),r=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow,r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(t<o||t===o&&t>0||n>i||n===i&&n<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn,r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(t<o||t===o&&t>0||n>i||n===i&&n<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Te(this.hasOversizedColumnHeadersMarked,(function(e,t,n){n[t]=void 0}))}}],n&&zu(t.prototype,n),e}();const Ku=Gu;function Xu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=[];if(this.guid="wt_".concat(At()),this.rootDocument=t.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,t.table),this.wtScroll=new Eu(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new li(this),this.selections=this.cloneSource.selections):(this.wtSettings=new Tu(this,t),this.wtTable=new Iu(this,t.table),this.wtScroll=new Eu(this),this.wtViewport=new Ku(this),this.wtEvent=new li(this),this.selections=this.getSetting("selections"),this.wtOverlays=new wu(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;r<o;r++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){rn(t,n[e])}])}this.drawn=!1,this.drawInterrupted=!1}var t,n;return t=e,n=[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<r&&e.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];Te({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){e.getSetting(o).length&&n.push(r),t.push(r)})),Jt(this.wtTable.wtRootElement.parentNode,t),qt(this.wtTable.wtRootElement.parentNode,n)}},{key:"getSetting",value:function(e,t,n,r,o){return this.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}],n&&Xu(t.prototype,n),e}();const qu=$u;function Ju(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),l=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||l)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(new $n(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(new $n(s.to.row,o.col)):l&&o.col<0&&!a.row?i.setRangeEnd(new $n(o.row,s.to.col)):(!u&&!l&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!l&&o.row<0||l&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),f=n||r&&c;o.row<0&&o.col>=0&&!a.column?f&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?f&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?f&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}var Qu=new Map([["mousedown",Ju],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller;if(t){var i=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!o.column?r.setRangeEnd(new $n(u-1,n.col)):i&&!o.row?r.setRangeEnd(new $n(n.row,s-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",Ju]]);function Zu(e,t){var n=t.coords,r=t.selection,o=t.controller;Qu.get(e.type)({coords:n,selection:r,controller:o,isShiftKey:e.shiftKey,isLeftClick:sr(e)||"touchstart"===e.type,isRightClick:ar(e)})}var el=new WeakMap,tl=Symbol("rootInstance");function nl(e){el.set(e,!0)}function rl(e){return e===tl}function ol(e){return el.has(e)}function il(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||cl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function al(e,t,n){return al=sl()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&ul(o,n.prototype),o},al.apply(null,arguments)}function sl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ul(e,t){return ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ul(e,t)}function ll(e){return function(e){if(Array.isArray(e))return fl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cl(e,t){if(e){if("string"==typeof e)return fl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fl(e,t):void 0}}function fl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dl=new WeakMap,pl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Fr(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,dl.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var t,n;return t=e,n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this.wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,o){return this.wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this.wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this.wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=dl.get(this),t=this.instance,n=t.rootElement,r=t.rootDocument,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),qt(n,"handsontable"),e.table=r.createElement("TABLE"),qt(e.table,"htCore"),this.instance.getSettings().tableClassName&&qt(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=dl.get(this),n=this.instance,r=n.rootElement,o=n.rootDocument,i=n.selection,a=o.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var r=e.instance.rootWindow;Rn(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&Rn(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(a,"keyup",(function(e){i.isInProgress()&&!e.shiftKey&&i.finish()})),this.eventManager.addEventListener(a,"mouseup",(function(n){i.isInProgress()&&sr(n)&&i.finish(),t.mouseDown=!1,!Dn(o.activeElement)&&(i.isSelected()||i.isSelectedByAnyHeader()||r.contains(n.target)||ar(n))||e.instance.unlisten()})),this.eventManager.addEventListener(a,"contextmenu",(function(e){i.isInProgress()&&ar(e)&&(i.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(a,"touchend",(function(){i.isInProgress()&&i.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(a,"mousedown",(function(n){var i=n.target,s=n.x||n.clientX,u=n.y||n.clientY,l=n.target;if(!t.mouseDown&&r&&e.instance.view){var c=e.instance.view.wt.wtTable.holder;if(l===c){var f=Mn(o);if(o.elementFromPoint(s+f,u)!==c||o.elementFromPoint(s,u+f)!==c)return}else for(;l!==a;){if(null===l){if(n.isTargetWebComponent)break;return}if(l===r)return;l=l.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(i):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||In(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t=e.row,n=e.col;return al($n,ll(this.translateFromRenderableToVisualIndex(t,n)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getFirstNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getFirstNotHiddenIndex(e,t),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=r-i),a}},{key:"initializeWalkontable",value:function(){var e=this,t=dl.get(this),n={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return ol(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,ll(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsLeft:function(){var t=e.instance.countCols(),n=Math.min(parseInt(e.settings.fixedColumnsLeft,10),t)-1;return e.countNotHiddenColumnIndexes(n,-1)},fixedRowsTop:function(){var t=e.instance.countRows(),n=Math.min(parseInt(e.settings.fixedRowsTop,10),t)-1;return e.countNotHiddenRowIndexes(n,-1)},fixedRowsBottom:function(){var t=e.instance.countRows(),n=Math.max(t-parseInt(e.settings.fixedRowsBottom,10),0);return e.countNotHiddenRowIndexes(n,1)},shouldRenderLeftOverlay:function(){return e.settings.fixedColumnsLeft>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=il(e.translateFromRenderableToVisualIndex(t,n),2),i=o[0],a=o[1],s=e.instance.runHooks("modifyGetCellCoords",i,a),u=i,l=a;if(Array.isArray(s)){var c=il(s,2);u=c[0],l=c[1]}var f=e.instance.getCellMeta(u,l),h=e.instance.colToProp(l),d=e.instance.getDataAtRowProp(u,h);e.instance.hasHook("beforeValueRender")&&(d=e.instance.runHooks("beforeValueRender",d,f)),e.instance.runHooks("beforeRenderer",r,i,a,h,d,f),e.instance.getCellRenderer(f)(e.instance,r,i,a,h,d,f),e.instance.runHooks("afterRenderer",r,i,a,h,d,f)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),s={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=i,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,a,o,s),ir(n)||(Zu(n,{coords:a,selection:e.instance.selection,controller:s}),e.instance.runHooks("afterOnCellMouseDown",n,a,o),e.activeWt=e.wt)},onCellContextMenu:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r);e.activeWt=i,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,a,o),ir(n)||(e.instance.runHooks("afterOnCellContextMenu",n,a,o),e.activeWt=e.wt)},onCellMouseOut:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,i,r),ir(t)||(e.instance.runHooks("afterOnCellMouseOut",t,i,r),e.activeWt=e.wt)},onCellMouseOver:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),s={row:!1,column:!1,cell:!1};e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOver",n,a,o,s),ir(n)||(t.mouseDown&&Zu(n,{coords:a,selection:e.instance.selection,controller:s}),e.instance.runHooks("afterOnCellMouseOver",n,a,o),e.activeWt=e.wt)},onCellMouseUp:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,i,r),ir(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,i,r),e.activeWt=e.wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(a,1))},onAfterDrawSelection:function(t,n,r){var o,i=il(e.translateFromRenderableToVisualIndex(t,n),2),a=i[0],s=i[1],u=e.instance.selection.getSelectedRange(),l=u.size();if(l>0){var c=(null!=r?r:0)+1-l,f=u.peekByIndex(c);o=[f.from.row,f.from.col,f.to.row,f.to.col]}return e.instance.runHooks("afterDrawSelection",a,s,o,r)},onBeforeDrawBorders:function(t,n){var r=il(t,4),o=r[0],i=r[1],a=r[2],s=r[3],u=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(s)];return e.instance.runHooks("beforeDrawBorders",u,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,i=e.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,s=t>=0?o.getVisualFromRenderableIndex(t):t,u=e.instance.runHooks("modifyGetCellCoords",s,a,r);if(Array.isArray(u)){var l=il(u,4),c=l[0],f=l[1],h=l[2],d=l[3];return[c>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"==typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);t.startRow=Math.max(o-a,0),t.endRow=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsLeft&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"==typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);t.startColumn=Math.max(o-a,0),t.endColumn=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this.wt=new qu(n),this.activeWt=this.wt;var r=this.wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e.wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(In(e))return!0;var t=Vt(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return dl.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!$t(n,"relative"))return Zt(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=this.instance,o=r.rootDocument,i=r.getRowHeader,a=o.createElement("div"),s=o.createElement("span");a.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),a.appendChild(s),t.appendChild(a)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;$t(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(Zt(t),this.appendColHeader(e,t))}else{var r=this.instance.rootDocument,o=r.createElement("div"),i=r.createElement("span");o.className="relative",i.className="colHeader",this.updateCellHeader(i,e,this.instance.getColHeader),o.appendChild(i),t.appendChild(o)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(e,t,n){var r=t,o=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&($t(e,"colHeader")?r=o.wtTable.columnFilter.sourceToRendered(t):$t(e,"rowHeader")&&(r=o.wtTable.rowFilter.sourceToRendered(t))),r>-1?nn(e,n(t)):(rn(e,String.fromCharCode(160)),qt(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=dl.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=dl.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}],n&&hl(t.prototype,n),e}();const ml=pl;var yl=Er("cellTypes"),vl=yl.register,gl=yl.getItem,bl=yl.hasItem,wl=yl.getNames;function _l(e){if(!bl(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return gl(e)}function Sl(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var n=t,r=n.editor,o=n.renderer,i=n.validator;r&&Nr(e,r),o&&Qo(e,o),i&&ii(e,i),vl(e,t)}function El(e){return El="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},El(e)}yl.getValues;var kl="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Rl=kl.length;function Tl(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%Rl,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/Rl,10);return r}function Cl(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(Rl,r)*(kl.indexOf(e[n])+1);return t-1}function Ml(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i=[];for(t=0;t<r;t++)i.push(Tl(t)+(e+1));o.push(i)}return o}function Ol(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i={};for(t=0;t<r;t++)i["prop".concat(t)]=Tl(t)+(e+1);o.push(i)}return o}function Al(e,t){for(var n,r=[],o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function Ll(e){var t,n,r,o,i=[],a=0;for(t=0,n=e.length;t<n;t++)for(r=0,o=e[t].length;r<o;r++)r===a&&(i.push([]),a+=1),i[r].push(e[t][r]);return i}function xl(e,t){var n=void 0===t||t;return function(t,r){return function t(r){if(r){if(Le(r,e)&&void 0!==r[e])return r[e];if(Le(r,"type")&&r.type){if("string"!=typeof r.type)throw new Error('Cell "type" must be a string');var o=_l(r.type);if(Le(o,e))return o[e];if(n)return}return t(Object.getPrototypeOf(r))}}("number"==typeof t?this.getCellMeta(t,r):t)}}function Nl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function Il(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&ke(e[0])&&(t=Oe(e[0]))),t}function Dl(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return Array.isArray(e)})))}function Pl(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return"object"===El(e)&&!Array.isArray(e)&&null!==e})))}function Hl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Hl(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var t,n;return t=e,n=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return re(this.data,(function(r,o){var i=t.getAtCell(o,e);n.push(i)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0===t&&void 0===n,a=null,s=null;if(a=this.modifyRowData(e),Array.isArray(a))s=[],i?a.forEach((function(t,n){s[n]=r.getAtPhysicalCell(e,n,a)})):yo(t,n,(function(n){s[n-t]=r.getAtPhysicalCell(e,n,a)}));else if(ke(a)||jn(a))if(s=o?[]:{},!i||o){var u=0,l=this.countFirstRowKeys()-1;yo(u,l,(function(i){var c=r.colToProp(i);if(i>=(t||u)&&i<=(n||l)&&!Number.isInteger(c)){var f=r.getAtPhysicalCell(e,c,a);o?s.push(f):Me(s,c,f)}}))}else Te(a,(function(t,n){Me(s,n,r.getAtPhysicalCell(e,n,a))}));return s}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=Ae(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:Me(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"==typeof t?Ce(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var o=Ae(r);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,s=null,u=null;null===t||null===n?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,n.row),a=Math.min(t.col,n.col),s=Math.max(t.row,n.row),u=Math.max(t.col,n.col));var l=[];return yo(i,s,(function(t){l.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,a,u,r))})),l}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Il(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],n&&jl(t.prototype,n),e}();const Yl=Fl;n(51271),n(36582),n(10815);var Ul={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,o,i,a){if(this._localHooks[e])for(var s=this._localHooks[e].length,u=0;u<s;u++)Gn(this._localHooks[e][u],this,t,n,r,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};Re(Ul,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const Bl=Ul;function Vl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Vl(this,e),this.indexedValues=[],this.initValueOrFn=t}var t,n;return t=e,n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,jn(this.initValueOrFn)?yo(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):yo(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}],n&&Wl(t.prototype,n),e}();function Gl(e){return function(e){if(Array.isArray(e))return Kl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Kl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kl(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xl(e,t,n,r){var o=n.length?n[0]:void 0;return[].concat(Gl(e.slice(0,o)),Gl(n.map((function(e,t){return jn(r)?r(e,t):r}))),Gl(void 0===o?[]:e.slice(o)))}function $l(e,t){return te(e,(function(e,n){return!1===t.includes(n)}))}function ql(e){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ql(e)}function Jl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zl(e,t,n){return Zl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nc(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Zl(e,t,n||e)}function ec(e,t){return ec=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ec(e,t)}function tc(e,t){if(t&&("object"===ql(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nc(e)}Se(zl,Bl);var rc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ec(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nc(r);if(o){var n=nc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tc(this,e)});function a(){return Jl(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"insert",value:function(e,t){this.indexedValues=Xl(this.indexedValues,0,t,this.initValueOrFn),Zl(nc(a.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=$l(this.indexedValues,e),Zl(nc(a.prototype),"remove",this).call(this,e)}}])&&Ql(t.prototype,n),a}(zl);function oc(e){return oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oc(e)}function ic(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sc(e,t){return sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},sc(e,t)}function uc(e,t){if(t&&("object"===oc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function lc(e){return lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lc(e)}var cc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lc(r);if(o){var n=lc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return uc(this,e)});function a(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ic(this,a),i.call(this,e)}return t=a,(n=[{key:"getHiddenIndexes",value:function(){return ee(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&ac(t.prototype,n),a}(rc);function fc(e){return function(e){if(Array.isArray(e))return hc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return hc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hc(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dc(e,t,n){return[].concat(fc(e.slice(0,t)),fc(n),fc(e.slice(t)))}function pc(e,t){return te(e,(function(e){return!1===t.includes(e)}))}function mc(e,t){return ne(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function yc(e,t){var n=t[0],r=t.length;return ne(e,(function(e){return e>=n?e+r:e}))}function vc(e){return vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(e)}function gc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _c(e,t,n){return _c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rc(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},_c(e,t,n||e)}function Sc(e,t){return Sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sc(e,t)}function Ec(e,t){if(t&&("object"===vc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kc(e)}function kc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rc(e){return Rc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rc(e)}function Tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rc(r);if(o){var n=Rc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ec(this,e)});function a(){var e;bc(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tc(kc(e=i.call.apply(i,[this].concat(n))),"orderOfIndexes",[]),e}return t=a,n=[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){var t;this.orderOfIndexes=function(e){if(Array.isArray(e))return gc(e)}(t=Array(e.length).keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return gc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gc(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),_c(Rc(a.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=pc(this.orderOfIndexes,[e]),jn(this.initValueOrFn)?_c(Rc(a.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):_c(Rc(a.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,_c(Rc(a.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=Xl(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=yc(this.orderOfIndexes,t),_c(Rc(a.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=$l(this.indexedValues,e),this.orderOfIndexes=pc(this.orderOfIndexes,e),this.orderOfIndexes=mc(this.orderOfIndexes,e),_c(Rc(a.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}],n&&wc(t.prototype,n),a}(zl);function Mc(e){return Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mc(e)}function Oc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lc(e,t){return Lc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Lc(e,t)}function xc(e,t){if(t&&("object"===Mc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Nc(e){return Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Nc(e)}var Ic=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Nc(r);if(o){var n=Nc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xc(this,e)});function a(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Oc(this,a),i.call(this,e)}return t=a,(n=[{key:"getTrimmedIndexes",value:function(){return ee(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&Ac(t.prototype,n),a}(rc),Dc=new Map([["hiding",cc],["index",zl],["linkedPhysicalIndexToValue",Cc],["physicalIndexToValue",rc],["trimming",Ic]]);function Pc(e){return Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pc(e)}function Hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jc(e,t,n){return jc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uc(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},jc(e,t,n||e)}function Fc(e,t){return Fc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fc(e,t)}function Yc(e,t){if(t&&("object"===Pc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Uc(e){return Uc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Uc(e)}var Bc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Uc(r);if(o){var n=Uc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Yc(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,(function(e){return e}))}return t=a,(n=[{key:"insert",value:function(e,t){var n=yc(this.indexedValues,t);this.indexedValues=dc(n,e,t),jc(Uc(a.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=pc(this.indexedValues,e);this.indexedValues=mc(t,e),jc(Uc(a.prototype),"remove",this).call(this,e)}}])&&Hc(t.prototype,n),a}(zl);function Vc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wc=0,zc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collection=new Map}var t,n;return t=e,(n=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),Wc+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);ft(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Wc-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return ht(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}])&&Vc(t.prototype,n),e}();function Gc(e){return Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gc(e)}function Kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xc(e,t){return Xc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xc(e,t)}function $c(e,t){if(t&&("object"===Gc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qc(e){return qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qc(e)}Se(zc,Bl);var Jc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qc(r);if(o){var n=qc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $c(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return t=a,n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=ne(this.get(),(function(e){return e.getValues()})),n=[],r=ft(t[0])&&t[0].length||0,o=0;o<r;o+=1){for(var i=[],a=0;a<this.getLength();a+=1)i.push(t[a][o]);n.push(i)}return ne(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return ft(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],n&&Kc(t.prototype,n),a}(zc);function Qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ef=new WeakMap,tf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}(this,ef,{writable:!0,value:[]})}var t,n;return t=e,(n=[{key:"subscribe",value:function(e){return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(this,Zc(this,ef,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){!function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Zc(e,t,"set"),n)}(this,ef,e)}}])&&Qc(t.prototype,n),e}();function nf(e,t){for(var n=[],r=0,o=0;r<e.length&&o<t.length;r++,o++)e[r]!==t[o]&&n.push({op:"replace",index:o,oldValue:e[r],newValue:t[o]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;o<e.length;o++)n.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return n}function rf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function of(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function af(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function sf(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,lf(e,t,"get"))}function uf(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,lf(e,t,"set"),n),n}function lf(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}Se(tf,Bl);var cf=new WeakMap,ff=new WeakMap,hf=new WeakMap,df=new WeakMap,pf=new WeakMap,mf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;rf(this,e),af(this,cf,{writable:!0,value:new Set}),af(this,ff,{writable:!0,value:[]}),af(this,hf,{writable:!0,value:[]}),af(this,df,{writable:!0,value:!1}),af(this,pf,{writable:!0,value:!1}),uf(this,pf,null!=n&&n)}var t,n;return t=e,(n=[{key:"createObserver",value:function(){var e=this,t=new tf;return sf(this,cf).add(t),t.addLocalHook("unsubscribe",(function(){sf(e,cf).delete(t)})),t._writeInitialChanges(nf(sf(this,ff),sf(this,hf))),t}},{key:"emit",value:function(e){var t=sf(this,hf);sf(this,df)&&sf(this,ff).length===e.length||(0===e.length?e=new Array(t.length).fill(sf(this,pf)):uf(this,ff,new Array(e.length).fill(sf(this,pf))),sf(this,df)||(uf(this,df,!0),t=sf(this,ff)));var n=nf(t,e);sf(this,cf).forEach((function(e){return e._write(n)})),uf(this,hf,e)}}])&&of(t.prototype,n),e}();function yf(e){return function(e){if(Array.isArray(e))return vf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return vf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vf(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bf,wf=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexesSequence=new Bc,this.trimmingMapsCollection=new Jc((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new Jc((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new zc,this.hidingChangesObservable=new mf({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}var t,n;return t=e,n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Dc.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Dc.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof Ic?this.trimmingMapsCollection.register(e,t):t instanceof cc?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return ft(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return ft(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return ft(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return ft(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t,o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=yf(new Array(e).keys()),this.notHiddenIndexesCache=yf(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var r=ne(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),i=e.length,a=pc(this.getIndexesSequence(),r),s=o-i;if(t+i<o){var u=a.filter((function(e){return!1===n.isTrimmed(e)}))[t];s=a.indexOf(u)}this.setIndexesSequence(dc(a,s,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=ft(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),i=ne(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(o,i),this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}],n&&gf(t.prototype,n),e}();function _f(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function Sf(e){ft(e)&&lr(st(bf||(bf=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}Se(wf,Bl);var Ef=Er("phraseFormatters"),kf=Ef.register,Rf=Ef.getValues;kf("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var Tf,Cf="ContextMenu:items",Mf="".concat(Cf,".noItems"),Of="".concat(Cf,".insertRowAbove"),Af="".concat(Cf,".insertRowBelow"),Lf="".concat(Cf,".insertColumnOnTheLeft"),xf="".concat(Cf,".insertColumnOnTheRight"),Nf="".concat(Cf,".removeRow"),If="".concat(Cf,".removeColumn"),Df="".concat(Cf,".undo"),Pf="".concat(Cf,".redo"),Hf="".concat(Cf,".readOnly"),jf="".concat(Cf,".clearColumn"),Ff="".concat(Cf,".copy"),Yf="".concat(Cf,".cut"),Uf="".concat(Cf,".freezeColumn"),Bf="".concat(Cf,".unfreezeColumn"),Vf="".concat(Cf,".mergeCells"),Wf="".concat(Cf,".unmergeCells"),zf="".concat(Cf,".addComment"),Gf="".concat(Cf,".editComment"),Kf="".concat(Cf,".removeComment"),Xf="".concat(Cf,".readOnlyComment"),$f="".concat(Cf,".align"),qf="".concat(Cf,".align.left"),Jf="".concat(Cf,".align.center"),Qf="".concat(Cf,".align.right"),Zf="".concat(Cf,".align.justify"),eh="".concat(Cf,".align.top"),th="".concat(Cf,".align.middle"),nh="".concat(Cf,".align.bottom"),rh="".concat(Cf,".borders"),oh="".concat(Cf,".borders.top"),ih="".concat(Cf,".borders.right"),ah="".concat(Cf,".borders.bottom"),sh="".concat(Cf,".borders.left"),uh="".concat(Cf,".borders.remove"),lh="".concat(Cf,".nestedHeaders.insertChildRow"),ch="".concat(Cf,".nestedHeaders.detachFromParent"),fh="".concat(Cf,".hideColumn"),hh="".concat(Cf,".showColumn"),dh="".concat(Cf,".hideRow"),ph="".concat(Cf,".showRow"),mh="Filters:",yh="".concat(mh,"conditions"),vh="".concat(yh,".none"),gh="".concat(yh,".isEmpty"),bh="".concat(yh,".isNotEmpty"),wh="".concat(yh,".isEqualTo"),_h="".concat(yh,".isNotEqualTo"),Sh="".concat(yh,".beginsWith"),Eh="".concat(yh,".endsWith"),kh="".concat(yh,".contains"),Rh="".concat(yh,".doesNotContain"),Th="".concat(yh,".byValue"),Ch="".concat(yh,".greaterThan"),Mh="".concat(yh,".greaterThanOrEqualTo"),Oh="".concat(yh,".lessThan"),Ah="".concat(yh,".lessThanOrEqualTo"),Lh="".concat(yh,".isBetween"),xh="".concat(yh,".isNotBetween"),Nh="".concat(yh,".after"),Ih="".concat(yh,".before"),Dh="".concat(yh,".today"),Ph="".concat(yh,".tomorrow"),Hh="".concat(yh,".yesterday"),jh="".concat(mh,"labels.filterByCondition"),Fh="".concat(mh,"labels.filterByValue"),Yh="".concat(mh,"labels.conjunction"),Uh="".concat(mh,"labels.disjunction"),Bh="".concat(mh,"values.blankCells"),Vh="".concat(mh,"buttons.selectAll"),Wh="".concat(mh,"buttons.clear"),zh="".concat(mh,"buttons.ok"),Gh="".concat(mh,"buttons.cancel"),Kh="".concat(mh,"buttons.placeholder.search"),Xh="".concat(mh,"buttons.placeholder.value"),$h="".concat(mh,"buttons.placeholder.secondValue");function qh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Jh=(qh(Tf={languageCode:"en-US"},Mf,"No available options"),qh(Tf,Of,"Insert row above"),qh(Tf,Af,"Insert row below"),qh(Tf,Lf,"Insert column left"),qh(Tf,xf,"Insert column right"),qh(Tf,Nf,["Remove row","Remove rows"]),qh(Tf,If,["Remove column","Remove columns"]),qh(Tf,Df,"Undo"),qh(Tf,Pf,"Redo"),qh(Tf,Hf,"Read only"),qh(Tf,jf,"Clear column"),qh(Tf,$f,"Alignment"),qh(Tf,qf,"Left"),qh(Tf,Jf,"Center"),qh(Tf,Qf,"Right"),qh(Tf,Zf,"Justify"),qh(Tf,eh,"Top"),qh(Tf,th,"Middle"),qh(Tf,nh,"Bottom"),qh(Tf,Uf,"Freeze column"),qh(Tf,Bf,"Unfreeze column"),qh(Tf,rh,"Borders"),qh(Tf,oh,"Top"),qh(Tf,ih,"Right"),qh(Tf,ah,"Bottom"),qh(Tf,sh,"Left"),qh(Tf,uh,"Remove border(s)"),qh(Tf,zf,"Add comment"),qh(Tf,Gf,"Edit comment"),qh(Tf,Kf,"Delete comment"),qh(Tf,Xf,"Read-only comment"),qh(Tf,Vf,"Merge cells"),qh(Tf,Wf,"Unmerge cells"),qh(Tf,Ff,"Copy"),qh(Tf,Yf,"Cut"),qh(Tf,lh,"Insert child row"),qh(Tf,ch,"Detach from parent"),qh(Tf,fh,["Hide column","Hide columns"]),qh(Tf,hh,["Show column","Show columns"]),qh(Tf,dh,["Hide row","Hide rows"]),qh(Tf,ph,["Show row","Show rows"]),qh(Tf,vh,"None"),qh(Tf,gh,"Is empty"),qh(Tf,bh,"Is not empty"),qh(Tf,wh,"Is equal to"),qh(Tf,_h,"Is not equal to"),qh(Tf,Sh,"Begins with"),qh(Tf,Eh,"Ends with"),qh(Tf,kh,"Contains"),qh(Tf,Rh,"Does not contain"),qh(Tf,Ch,"Greater than"),qh(Tf,Mh,"Greater than or equal to"),qh(Tf,Oh,"Less than"),qh(Tf,Ah,"Less than or equal to"),qh(Tf,Lh,"Is between"),qh(Tf,xh,"Is not between"),qh(Tf,Nh,"After"),qh(Tf,Ih,"Before"),qh(Tf,Dh,"Today"),qh(Tf,Ph,"Tomorrow"),qh(Tf,Hh,"Yesterday"),qh(Tf,Bh,"Blank cells"),qh(Tf,jh,"Filter by condition"),qh(Tf,Fh,"Filter by value"),qh(Tf,Yh,"And"),qh(Tf,Uh,"Or"),qh(Tf,Vh,"Select all"),qh(Tf,Wh,"Clear"),qh(Tf,zh,"OK"),qh(Tf,Gh,"Cancel"),qh(Tf,Kh,"Search"),qh(Tf,Xh,"Value"),qh(Tf,$h,"Second value"),Tf);var Qh=Jh.languageCode,Zh=Er("languagesDictionaries"),ed=Zh.register,td=Zh.getItem,nd=Zh.hasItem,rd=Zh.getValues;function od(e,t){var n=e,r=t;return ke(e)&&(n=(r=e).languageCode),function(e,t){var n;e!==Qh&&(n=t,Te(td(Qh),(function(e,t){ht(n[t])&&(n[t]=e)})))}(n,r),ed(n,we(r)),we(r)}function id(e){return ad(e)?we(td(e)):null}function ad(e){return nd(e)}function sd(e,t,n){var r=id(e);if(null===r)return null;var o=r[t];if(ht(o))return null;var i=function(e,t){var n=e;return re(Rf(),(function(r){n=r(e,t)})),n}(o,n);return Array.isArray(i)?i[0]:i}function ud(e){var t=_f(e);return ad(t)||(t=Qh,Sf(e)),t}od(Jh);var ld=new Fr,cd=new Set,fd=0;function hd(e){0===fd&&(ld.addEventListener(e,"keydown",(function(e){cd.has(e.keyCode)||cd.add(e.keyCode)})),ld.addEventListener(e,"keyup",(function(e){cd.has(e.keyCode)&&cd.delete(e.keyCode)})),ld.addEventListener(e,"visibilitychange",(function(){e.hidden&&cd.clear()})),ld.addEventListener(e.defaultView,"blur",(function(){cd.clear()}))),fd+=1}function dd(){fd>0&&(fd-=1),0===fd&&(ld.clearEvents(),cd.clear(),fd=0)}function pd(){return Array.from(cd.values()).some((function(e){return nr(e)}))}n(79174);var md="active-header",yd="area",vd="cell",gd="fill",bd="header",wd="custom-selection";function _d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ed=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;_d(this,e),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone()}var t,n;return t=e,n=[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopLeftCorner())&&this.includes(e.getOuterBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new $n(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new $n(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),r=this.getDirection(),o=e.getOuterTopLeftCorner(),i=e.getOuterBottomRightCorner(),a=Math.min(t.row,o.row),s=Math.min(t.col,o.col),u=Math.max(n.row,i.row),l=Math.max(n.col,i.col),c=new $n(a,s),f=new $n(u,l);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new $n(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return new $n(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return new $n(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return new $n(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getOuterTopLeftCorner",value:function(){return new $n(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return new $n(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return new $n(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return new $n(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(new $n(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(new $n(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(new $n(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(new $n(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof $n))return!1;if(t&&t.includes(e)){if(this.getOuterTopLeftCorner().isEqual(new $n(t.from.row,t.from.col)))return this.getOuterBottomRightCorner();if(this.getOuterTopRightCorner().isEqual(new $n(t.from.row,t.to.col)))return this.getOuterBottomLeftCorner();if(this.getOuterBottomLeftCorner().isEqual(new $n(t.to.row,t.from.col)))return this.getOuterTopRightCorner();if(this.getOuterBottomRightCorner().isEqual(new $n(t.to.row,t.to.col)))return this.getOuterTopLeftCorner()}return e.isEqual(this.getOuterBottomRightCorner())?this.getOuterTopLeftCorner():e.isEqual(this.getOuterTopLeftCorner())?this.getOuterBottomRightCorner():e.isEqual(this.getOuterTopRightCorner())?this.getOuterBottomLeftCorner():e.isEqual(this.getOuterBottomLeftCorner())?this.getOuterTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),a=Math.max(e.from.row,e.to.row),s=Math.min(e.from.col,e.to.col),u=Math.max(e.from.col,e.to.col),l=[];return t===i&&l.push("top"),o===u&&l.push("right"),n===a&&l.push("bottom"),r===s&&l.push("left"),l}},{key:"getInner",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(new $n(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(new $n(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++)if(!1===e(r,o))return}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to)}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}],n&&Sd(t.prototype,n),e}();const kd=Ed;function Rd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Td(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Td(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Td(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(49628);var Md=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&(this.eventManager=new Fr(t),this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var t,n;return t=e,n=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var r=e.main.childNodes[t];e.eventManager.addEventListener(r,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),or(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(i){var a;((a=i).clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","left","bottom","right","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=t.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(r=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ke()&&this.createMultipleSelectorHandles(),this.disappear();var s=this.wot.wtTable,u=s.bordersHolder;u||((u=t.createElement("div")).className="htBorders",s.bordersHolder=u,s.spreader.appendChild(u)),u.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={topLeft:t.createElement("DIV"),topLeftHitArea:t.createElement("DIV"),bottomRight:t.createElement("DIV"),bottomRightHitArea:t.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style},Te({position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")},(function(t,n){e.selectionHandles.styles.bottomRightHitArea[n]=t,e.selectionHandles.styles.topLeftHitArea[n]=t})),Te({position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"},(function(t,n){e.selectionHandles.styles.bottomRight[n]=t,e.selectionHandles.styles.topLeft[n]=t})),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-a,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(r-a,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-s/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(r-s/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+i,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(r+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+i-s/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(r+o-s/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,o,i,a,s=this.wot,u=s.wtTable,l=s.rootDocument,c=s.rootWindow,f=u.getRenderedRowsCount(),h=0;h<f;h+=1){var d=u.rowFilter.renderedToSource(h);if(d>=e[0]&&d<=e[2]){t=d,i=e[0];break}}for(var p=f-1;p>=0;p-=1){var m=u.rowFilter.renderedToSource(p);if(m>=e[0]&&m<=e[2]){n=m;break}}for(var y=u.getRenderedColumnsCount(),v=0;v<y;v+=1){var g=u.columnFilter.renderedToSource(v);if(g>=e[1]&&g<=e[3]){r=g,a=e[1];break}}for(var b=y-1;b>=0;b-=1){var w=u.columnFilter.renderedToSource(b);if(w>=e[1]&&w<=e[3]){o=w;break}}if(void 0!==t&&void 0!==r){var _=u.getCell(new $n(t,r)),S=t!==n||r!==o,E=S?u.getCell(new $n(n,o)):_,k=an(_),R=S?an(E):k,T=an(u.TABLE),C=k.top,M=k.left,O=M-T.left-1,A=R.left+yn(E)-M;if(this.isEntireColumnSelected(t,n)){var L=this.getDimensionsFromHeader("columns",r,o,i,T),x=null;if(L){var N=Rd(L,3);x=N[0],O=N[1],A=N[2]}x&&(_=x)}var I=C-T.top-1,D=R.top+vn(E)-C;if(this.isEntireRowSelected(r,o)){var P=this.getDimensionsFromHeader("rows",t,n,a,T),H=null;if(P){var j=Rd(P,3);H=j[0],I=j[1],D=j[2]}H&&(_=H)}var F=mn(_,c);parseInt(F.borderTopWidth,10)>0&&(I+=1,D=D>0?D-1:0),parseInt(F.borderLeftWidth,10)>0&&(O+=1,A=A>0?A-1:0),this.topStyle.top="".concat(I,"px"),this.topStyle.left="".concat(O,"px"),this.topStyle.width="".concat(A,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(I,"px"),this.leftStyle.left="".concat(O,"px"),this.leftStyle.height="".concat(D,"px"),this.leftStyle.display="block";var Y=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+D-Y,"px"),this.bottomStyle.left="".concat(O,"px"),this.bottomStyle.width="".concat(A,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(I,"px"),this.rightStyle.left="".concat(O+A-Y,"px"),this.rightStyle.height="".concat(D+1,"px"),this.rightStyle.display="block";var U=this.settings.border.cornerVisible;U="function"==typeof U?U(this.settings.layerLevel):U;var B=this.wot.getSetting("onModifyGetCellCoords",n,o),V=n,W=o;if(B&&Array.isArray(B)){var z=Rd(B,4);V=z[2],W=z[3]}if(Ke()||!U||this.isPartRange(V,W))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+D+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.left="".concat(O+A+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var G=hn(u.TABLE),K=G===c;K&&(G=l.documentElement),o===this.wot.getSetting("totalColumns")-1&&(K?E.getBoundingClientRect().left:E.offsetLeft)+yn(E)+parseInt(this.cornerDefaultStyle.width,10)/2>=bn(G)&&(this.cornerStyle.left="".concat(Math.floor(O+A+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0),n===this.wot.getSetting("totalRows")-1&&(K?E.getBoundingClientRect().top:E.offsetTop)+vn(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=gn(G)&&(this.cornerStyle.top="".concat(Math.floor(I+D+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ke()&&this.updateMultipleSelectionHandlesPosition(n,o,I,O,A,D)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r,o){var i=this.wot.wtTable,a=i.wtRootElement.parentNode,s=null,u=null,l=null,c=null,f=null,h=null,d=null,p=null;switch(e){case"rows":s=function(){return i.getRowHeader.apply(i,arguments)},u=function(){return vn.apply(void 0,arguments)},l="ht__selection--rows",h="top";break;case"columns":s=function(){return i.getColumnHeader.apply(i,arguments)},u=function(){return yn.apply(void 0,arguments)},l="ht__selection--columns",h="left"}if(a.classList.contains(l)){var m=this.wot.getSetting("columnHeaders").length;if(d=s(t,m-r),p=s(n,m-r),!d||!p)return!1;var y=an(d),v=an(p);return d&&p&&(c=y[h]-o[h]-1,f=v[h]+u(p)-y[h]),[d,c,f]}return!1}},{key:"changeBorderStyle",value:function(e,t){var n=this[e].style,r=t[e];!r||r.hide?qt(this[e],"hidden"):($t(this[e],"hidden")&&Jt(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height="".concat(r.width,"px")),"right"!==e&&"left"!==e||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=this[e].style;t.backgroundColor="#000",t.width="".concat(1,"px"),t.height="".concat(1,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?qt(this[e],"hidden"):Jt(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Ke()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],n&&Cd(t.prototype,n),e}();const Od=Md;function Ad(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ld(e){return Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ld(e)}function xd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nd=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n;return t=e,n=[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Od(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new kd(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopLeftCorner(),t=this.cellRange.getOuterBottomRightCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.wtTable.getCell(new $n(t,n));if("object"===Ld(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),qt(i,a)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var i=o>=0?o:t,a=e,s=0==(i-=1)?e:"".concat(e,"-").concat(i);if($t(r,s)){var u=i+1;a="".concat(e,"-").concat(u)}else a=n(r,i);return a}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=(j=4,function(e){if(Array.isArray(e))return e}(H=r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(H,j)||function(e,t){if(e){if("string"==typeof e)return Ad(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ad(e,t):void 0}}(H,j)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],s=o[2],u=o[3],l=this.settings,c=l.highlightHeaderClassName,f=l.highlightColumnClassName,h=l.highlightRowClassName,d=l.highlightOnlyClosestHeader,p=l.selectionType,m=void 0===p||["active-header","header"].includes(p);if(m&&null!==a&&null!==u)for(var y=0,v=0;v<n;v+=1){var g=e.wtTable.columnFilter.renderedToSource(v);if(g>=a&&g<=u){var b=e.wtTable.getColumnHeaders(g),w=b.length-1;d&&b.length>1&&(b=[b[w]]);for(var _=0;_<b.length;_+=1){var S=[],E=b[_];c&&S.push(c),f&&S.push(f),_=d?w:_;var k=e.getSetting("onBeforeHighlightingColumnHeader",g,_,{selectionType:p,columnCursor:y,selectionWidth:u-a+1,classNames:S});k!==g&&(E=e.wtTable.getColumnHeader(k,_)),qt(E,S)}y+=1}}if(null!==i&&null!==s)for(var R=0,T=0;T<t;T+=1){var C=e.wtTable.rowFilter.renderedToSource(T);if(m&&C>=i&&C<=s){var M=e.wtTable.getRowHeaders(C),O=M.length-1;d&&M.length>1&&(M=[M[O]]);for(var A=0;A<M.length;A+=1){var L=[],x=M[A];c&&L.push(c),h&&L.push(h),A=d?O:A;var N=e.getSetting("onBeforeHighlightingRowHeader",C,A,{selectionType:p,rowCursor:R,selectionHeight:s-i+1,classNames:L});N!==C&&(x=e.wtTable.getRowHeader(N,A)),qt(x,L)}R+=1}if(null!==a&&null!==u)for(var I=0;I<n;I+=1){var D=e.wtTable.columnFilter.renderedToSource(I);C>=i&&C<=s&&D>=a&&D<=u?this.settings.className&&this.addClassAtCoords(e,C,D,this.settings.className,this.settings.markIntersections):C>=i&&C<=s?h&&this.addClassAtCoords(e,C,D,h):D>=a&&D<=u&&f&&this.addClassAtCoords(e,C,D,f);var P=e.getSetting("onAfterDrawSelection",C,D,this.settings.layerLevel);"string"==typeof P&&this.addClassAtCoords(e,C,D,P)}}e.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(e).appear(r)}var H,j}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}],n&&xd(t.prototype,n),e}();function Id(e){return Id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Id(e)}function Dd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hd(e,t,n){return Hd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yd(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Hd(e,t,n||e)}function jd(e,t){return jd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},jd(e,t)}function Fd(e,t){if(t&&("object"===Id(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Yd(e){return Yd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Yd(e)}var Ud=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jd(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Yd(r);if(o){var n=Yd(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fd(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,null)).visualCellRange=t||null,n.commit(),n}return t=a,n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=new kd(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,Hd(Yd(a.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,o=this.findVisibleCoordsInRowsRange(e.row,t.row,n);if(null===o)return null;var i=this.findVisibleCoordsInColumnsRange(e.col,t.col,r);return null===i?null:new $n(o,i)}},{key:"findVisibleCoordsInRowsRange",value:function(e,t,n){var r=this.settings.visualToRenderableCoords({row:e,col:-1}).row;return t===e&&null===r?null:null===r?this.findVisibleCoordsInRowsRange(e+n,t,n):e}},{key:"findVisibleCoordsInColumnsRange",value:function(e,t,n){var r=this.settings.visualToRenderableCoords({row:-1,col:e}).col;return t===e&&null===r?null:null===r?this.findVisibleCoordsInColumnsRange(e+n,t,n):e}},{key:"findVisibleHeaderRange",value:function(e,t,n,r){var o=this.findVisibleCoordsInRowsRange(e.row,t.row,n),i=this.findVisibleCoordsInRowsRange(t.row,e.row,-n),a=this.findVisibleCoordsInColumnsRange(e.col,t.col,r),s=this.findVisibleCoordsInColumnsRange(t.col,e.col,-r);return null===o&&null===i&&null===a&&null===s?null:[new $n(o,a),new $n(i,s)]}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e,t,n=this.visualCellRange,r=n.from,o=n.to,i=this.getRowSearchDirection(this.visualCellRange),a=this.getColumnSearchDirection(this.visualCellRange),s=this.findVisibleCoordsInRange(r,o,i,a),u=this.findVisibleCoordsInRange(o,r,-i,-a);if(null===s||null===u){var l=null;if("header"===this.settings.type){var c=(e=this.findVisibleHeaderRange(r,o,i,a),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=c[0],h=c[1];l=this.createRenderableCellRange(f,h)}this.cellRange=l}else this.cellRange=this.createRenderableCellRange(s,u);return this}},{key:"adjustCoordinates",value:function(e){var t=this.getRowSearchDirection(e),n=this.getColumnSearchDirection(e),r=e.from.clone().normalize(),o=e.to.clone().normalize(),i=this.findVisibleCoordsInRange(r,o,t,n);if(null!==i){if(null===this.cellRange){var a=this.settings.visualToRenderableCoords(i);this.cellRange=new kd(a)}return e.setHighlight(i),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,i=new $n(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),a=new $n(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return new kd(n,n,r)}},{key:"getRowSearchDirection",value:function(e){return e.from.row<e.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(e){return e.from.col<e.to.col?1:-1}}],n&&Pd(t.prototype,n),a}(Nd);const Bd=Ud;var Vd=["activeHeaderClassName"];function Wd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wd(Object(n),!0).forEach((function(t){Gd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kd=["layerLevel","areaCornerVisible"];function Xd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xd(Object(n),!0).forEach((function(t){qd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jd=["cellCornerVisible"];function Qd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qd(Object(n),!0).forEach((function(t){ep(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ep(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tp=["border","visualCellRange"];function np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?np(Object(n),!0).forEach((function(t){op(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):np(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function op(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ip(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ap(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ip(Object(n),!0).forEach((function(t){sp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ip(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(74517);var up=["headerClassName","rowClassName","columnClassName"];function lp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lp(Object(n),!0).forEach((function(t){fp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pp=Er("highlight/types"),mp=pp.register,yp=pp.getItem;function vp(e,t){return yp(e)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hp(Object(n),!0).forEach((function(t){dp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:e},t))}function gp(e){return function(e){if(Array.isArray(e))return bp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return bp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bp(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wp(Object(n),!0).forEach((function(t){Sp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}mp(md,(function(e){var t=e.activeHeaderClassName,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Vd);return new Bd(zd(zd({highlightHeaderClassName:t},n),{},{selectionType:md}))})),mp(yd,(function(e){var t=e.layerLevel,n=e.areaCornerVisible,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Kd);return new Bd($d($d({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:yd}))})),mp(vd,(function(e){var t=e.cellCornerVisible,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Jd);return new Bd(Zd(Zd({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:vd}))})),mp(wd,(function(e){var t=e.border,n=e.visualCellRange,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,tp);return new Bd(rp(rp(rp({},t),r),{},{selectionType:wd}),n)})),mp(gd,(function(e){var t=Object.assign({},e);return new Bd(ap(ap({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:gd}))})),mp(bd,(function(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,up);return new Bd(cp(cp({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:bd}))}));var kp=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.layerLevel=0,this.cell=vp(vd,e),this.fill=vp(gd,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var n,r;return n=t,r=[{key:"isEnabledFor",value:function(e,t){var n=e;e===vd&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=vp(yd,_p({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return gp(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=vp(bd,_p({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return gp(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=vp(md,_p({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return gp(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return gp(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(vp(wd,_p(_p({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),re(this.areas.values(),(function(e){e.clear()})),re(this.headers.values(),(function(e){e.clear()})),re(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(gp(this.areas.values()),gp(this.headers.values()),gp(this.activeHeaders.values()),gp(this.customSelections))[Symbol.iterator]()}}],r&&Ep(n.prototype,r),t}();const Rp=kp;function Tp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cp=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.ranges=[]}var n,r;return n=t,r=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(new kd(e)),this}},{key:"add",value:function(e){return this.ranges.push(new kd(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}],r&&Tp(n.prototype,r),t}();const Mp=Cp;function Op(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ap=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.options=n}var t,n;return t=e,(n=[{key:"transformStart",value:function(e,t,n){var r=new $n(e,t),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,s=i.col,u=o,l=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==s){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),m=this.options.minSpareCols(),y=this.options.autoWrapRow(),v=this.options.autoWrapCol();a+e>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):v&&(r.row=1-f,r.col=s+r.col===h-1?1-h:1):v&&a+r.row<0&&s+r.col>=0&&(r.row=f-1,r.col=s+r.col===0?h-1:-1),s+r.col>h-1?n&&m>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):y&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):y&&s+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var g=new $n(a+r.row,s+r.col);l=0,c=0,g.row<0?(l=-1,g.row=0):g.row>0&&g.row>=f&&(l=1,g.row=f-1),g.col<0?(c=-1,g.col=0):g.col>0&&g.col>=h&&(c=1,g.col=h-1),u=this.options.renderableToVisualCoords(g)}return this.runLocalHooks("afterTransformStart",u,l,c),u}},{key:"transformEnd",value:function(e,t){var n=new $n(e,t),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var s=this.options.visualToRenderableCoords(r.highlight),u=s.row,l=s.col;if(null!==u&&null!==l){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,m=new $n(d+n.row,p+n.col);i=0,a=0,m.row<0?(i=-1,m.row=0):m.row>0&&m.row>=c&&(i=1,m.row=c-1),m.col<0?(a=-1,m.col=0):m.col>0&&m.col>=f&&(a=1,m.col=f-1),o=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}])&&Op(t.prototype,n),e}();Se(Ap,Bl);const Lp=Ap;function xp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Np(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Np(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ip(e){return Ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ip(e)}var Dp,Pp=[3,2],Hp=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],jp=Symbol("root"),Fp=Symbol("child");function Yp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jp;if(t!==jp&&t!==Fp)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),r=t===jp,o=0;if(n){var i=e[0];if(0===e.length)o=1;else if(r&&i instanceof kd)o=3;else if(r&&Array.isArray(i))o=Yp(i,Fp);else if(e.length>=2&&e.length<=4){var a=!e.some((function(e,t){return!Hp[t].includes(Ip(e))}));a&&(o=2)}}return o}function Up(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!Pp.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,i=n?t.from.row:t[0],a=n?t.from.col:t[1],s=n?t.to.row:t[2],u=n?t.to.col:t[3];if("function"==typeof o&&("string"==typeof a&&(a=o(a)),"string"==typeof u&&(u=o(u))),ht(s)&&(s=i),ht(u)&&(u=a),!r){var l=i,c=a,f=s,h=u;i=Math.min(l,f),a=Math.min(c,h),s=Math.max(l,f),u=Math.max(c,h)}return[i,a,s,u]}}function Bp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}function Vp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wp(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gp=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Mp,this.highlight=new Rp({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)}}),this.transformation=new Lp(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}var t,n;return t=e,n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=ht(t)?pd():t,i=e.row<0,a=e.col<0,s=i&&a;this.selectedByCorner=s,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),e),(!r||r&&!o&&ht(t))&&this.selectedRange.clear(),this.selectedRange.add(e),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!s&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!s&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var t=this.selectedRange.current();"single"!==this.settings.selectionMode&&t.setTo(new $n(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(vd,t.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(t);var n=this.getLayerLevel();n<this.highlight.layerLevel&&(re(this.highlight.getAreas(),(function(e){e.clear()})),re(this.highlight.getHeaders(),(function(e){e.clear()})),re(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();if(r.clear(),o.clear(),i.clear(),this.highlight.isEnabledFor(yd,t.highlight)&&(this.isMultiple()||n>=1)&&(r.add(t.from).add(t.to).commit(),1===n)){var a=this.selectedRange.previous();this.highlight.useLayerLevel(n-1).createOrGetArea().add(a.from).commit().adjustCoordinates(a),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(bd,t.highlight)){var s=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),l=t;(s||u)&&(l=t.clone()),s&&(l.from.row=-1),u&&(l.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&l.from.normalize(),o.add(l.from).commit()):o.add(l.from).add(l.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===t.getWidth()&&i.add(new $n(t.from.row,-1)).add(new $n(t.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===t.getHeight()&&i.add(new $n(-1,t.from.col)).add(new $n(-1,t.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=Ae(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t,n){this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=new $n(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new $n(n-1,r-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=Yp(e);if(1===n)return!1;if(0===n)throw new Error(st(Dp||(Dp=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=Up(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!e.some((function(e){var t=Vp(r(e),4),n=t[0],a=t[1],s=t[2],u=t[3];return!(Bp(n,o)&&Bp(a,i)&&Bp(s,o)&&Bp(u,i))}));return a&&(this.clear(),re(e,(function(e){var n=Vp(r(e),4),o=n[0],i=n[1],a=n[2],s=n[3];t.setRangeStartOnly(new $n(o,i),!1),t.setRangeEnd(new $n(a,s)),t.finish()}))),a}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof e?this.tableProps.propToCol(e):e,o="string"==typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),a=this.tableProps.countRows(),s=Bp(r,i)&&Bp(o,i);return s&&(this.setRangeStartOnly(new $n(n,r)),this.setRangeEnd(new $n(a-1,o)),this.finish()),s}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=Bp(e,r)&&Bp(t,r);return i&&(this.setRangeStartOnly(new $n(e,n)),this.setRangeEnd(new $n(t,o-1)),this.finish()),i}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().adjustCoordinates(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),i.commit()}this.highlight.useLayerLevel(t)}}}],n&&zp(t.prototype,n),e}();Se(Gp,Bl);const Kp=Gp;function Xp(e,t){var n="string"==typeof e?_l(e):e;if(ke(n)){var r=ke(t),o={};return Te(n,(function(e,n){"CELL_TYPE"===n||r&&(!r||Le(t,n))||(o[n]=e)})),o}}function $p(e){return Number.isInteger(e)&&e>=0}function qp(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Jp(e){return null==e}function Qp(e){return Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(e)}const Zp=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,r,o;for(t=0,n=this.countCols();t<n;t++)if(!1===dt(r=this.getDataAtCell(e,t)))return"object"===Qp(r)&&(o=this.getCellMeta(e,t),Ee(this.getSchema()[o.prop],r));return!0},isEmptyCol:function(e){var t,n;for(t=0,n=this.countRows();t<n;t++)if(!1===dt(this.getDataAtCell(t,e)))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0}};function em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var nm=function(){function e(t){tm(this,e),this.metaCtor=function e(){tm(this,e)},this.meta=this.metaCtor.prototype,ge(this.meta,Zp()),this.meta.instance=t}var t,n;return t=e,(n=[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){ge(this.meta,e),ge(this.meta,Xp(e.type,e))}}])&&em(t.prototype,n),e}();function rm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var om=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.getMetaConstructor();this.meta=new n}var t,n;return t=e,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){ge(this.meta,e),ge(this.meta,Xp(e.type,e))}}])&&rm(t.prototype,n),e}();function im(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var am=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}var n,r;return n=t,r=[{key:"obtain",value:function(e){qp((function(){return $p(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;qp((function(){return $p(e)||Jp(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=[],o=this.data.length,i=0;i<n;i++)r.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[Jp(e)?this.index.length:e,0].concat(r))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;qp((function(){return $p(e)||Jp(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(Jp(e)?this.index.length-t:e,t),r=0;r<n.length;r++){var o=n[r];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return te(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:Symbol.iterator,value:function(){return this.entries()}}],r&&im(n.prototype,r),t}();function sm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var um=["data","width"],lm=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalMeta=t,this.metas=new am((function(){return n._createMeta()}))}var t,n;return t=e,n=[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);ge(n,t),ge(n,Xp(t.type,n))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}ve(n,e);for(var r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}(this.globalMeta.getMetaConstructor(),um).prototype}}],n&&sm(t.prototype,n),e}();function cm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hm=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columnMeta=t,this.metas=new am((function(){return n._createRow()}))}var t,n;return t=e,n=[{key:"updateMeta",value:function(e,t,n){var r=this.getMeta(e,t);ge(r,n),ge(r,Xp(n.type,r))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){this.metas.obtain(e).obtain(t)[n]=r}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,function(e){if(Array.isArray(e))return cm(e)}(r=t[n].values())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return cm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cm(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var r;return e}},{key:"getMetasAtRow",value:function(e){qp((function(){return $p(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new am((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}],n&&fm(t.prototype,n),e}();function dm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mm=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];dm(this,e),this.hot=t,this.globalMeta=new nm(t),this.globalMeta.updateMeta(r),this.tableMeta=new om(this.globalMeta),this.columnMeta=new lm(this.globalMeta),this.cellMeta=new hm(this.columnMeta),o.forEach((function(e){return new e(n)}))}var t,n;return t=e,n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(e,t);return i.visualRow=r,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],n&&pm(t.prototype,n),e}();function ym(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Se(mm,Bl);var vm=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),br.getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}var t,n;return t=e,(n=[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var o=e.visualRow,i=e.visualCol,a=this.metaManager.hot,s=a.colToProp(i);e.prop=s,a.runHooks("beforeGetCellMeta",o,i,e);var u,l=Le(e,"type")?e.type:null,c=jn(e.cells)?e.cells(n,r,s):null;l&&(c?c.type=null!==(u=c.type)&&void 0!==u?u:l:c={type:l}),c&&this.metaManager.updateCellMeta(n,r,c),a.runHooks("afterGetCellMeta",o,i,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}])&&ym(t.prototype,n),e}(),gm=(n(97754),/^(\r\n|\n\r|\r|\n)/),bm=/^[^\t\r\n]+/,wm=/^\t/;function _m(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="\t"),"string"==typeof(i=e[t][r])?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null==i?"":i;t!==n-1&&(a+="\n")}return a}function Sm(e){return Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sm(e)}function Em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var km=xl("copyable",!1),Rm=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=r,this.dataSource=n,this.duckSchema=this.dataSource&&this.dataSource[0]?ye(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var t,n,r;return t=e,n=[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"==typeof n){var a=Oe(e);r=a>0?a:this.countFirstRowKeys(),i=!0}else{var s=this.tableMeta.maxCols;r=Math.min(s,n.length)}for(t=0;t<r;t++){var u=i?n(t):n[t];if(ke(u)){if(void 0!==u.data){var l=i?o:t;this.colToPropCache[l]=u.data,this.propToColCache.set(u.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Il(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,i=t,a=n;return void 0===i&&(i=0,a=""),"object"!==Sm(e)||Array.isArray(e)||Te(e,(function(e,t){null===e?(r=a+t,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))})),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&ft(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(ft(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=this.instance.countSourceRows(),i=o,a=0,s=e;("number"!=typeof s||s>=o)&&(s=o),s<this.instance.countRows()&&(i=this.instance.toPhysicalRow(s));var u=this.instance.runHooks("beforeCreateRow",s,n,r);if(!1===u||null===i)return 0;for(var l=this.tableMeta.maxRows,c=this.instance.countCols(),f=[],h=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=we(t.getSchema()):(e=[],yo(c-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(s+a):be(e={},t.getSchema()),f.push(e),a+=1};a<n&&o+a<l;)h();return this.instance.rowIndexMapper.insertIndexes(s,a),this.spliceData.apply(this,[i,0].concat(f)),this.instance.runHooks("afterCreateRow",s,a,r),this.instance.forceFullRender=!0,a}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r=this.dataSource,o=this.tableMeta.maxCols,i=e;("number"!=typeof i||i>=this.instance.countSourceCols())&&(i=this.instance.countSourceCols());var a=this.instance.runHooks("beforeCreateCol",i,t,n);if(!1===a)return 0;var s=this.instance.countSourceCols();i<this.instance.countCols()&&(s=this.instance.toPhysicalColumn(i));for(var u=this.instance.countSourceRows(),l=this.instance.countCols(),c=0,f=s;c<t&&l<o;){if("number"!=typeof i||i>=l)if(u>0)for(var h=0;h<u;h+=1)void 0===r[h]&&(r[h]=[]),r[h].push(null);else r.push([null]);else for(var d=0;d<u;d++)r[d].splice(f,0,null);c+=1,f+=1,l+=1}return this.instance.columnIndexMapper.insertIndexes(i,c),this.instance.runHooks("afterCreateCol",i,c,n),this.instance.forceFullRender=!0,c}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t,o=this.visualRowsToPhysical(r,t),i=this.instance.countSourceRows();r=(i+r)%i;var a=this.instance.runHooks("beforeRemoveRow",r,o.length,o,n);if(!1===a)return!1;var s=o.length;if(this.filterData(r,s,o),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var u=ft(this.tableMeta.columns)||ft(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===u&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",r,s,o,n),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,t),i=o.slice(0).sort((function(e,t){return t-e})),a=this.instance.runHooks("beforeRemoveCol",r,t,o,n);if(!1===a)return!1;for(var s=!0,u=i.length,l=this.dataSource,c=0;c<u;c++)s&&o[0]!==o[c]-c&&(s=!1);if(s)for(var f=0,h=this.instance.countSourceRows();f<h;f++)l[f].splice(o[0],t);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var m=0;m<u;m++)l[d].splice(i[m],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,o,n),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Q(s,i);for(var l=0;l<n;)s.push(null),l+=1;return J(s),this.instance.populateFromArray(t,e,s,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Q(s,i);for(var l=0;l<n;)s.push(null),l+=1;return this.instance.populateFromArray(e,t,[s],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i,a=this.instance.runHooks("beforeDataSplice",e,t,r);!1!==a&&(i=this.dataSource).splice.apply(i,[e,t].concat(r))}},{key:"filterData",value:function(e,t,n){var r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),i=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Le(r,t))i=r[t];else if("string"==typeof t&&t.indexOf(".")>-1){var a=t.split("."),s=r;if(!s)return null;for(var u=0,l=a.length;u<l;u++)if(void 0===(s=s[a[u]]))return null;i=s}else"function"==typeof t&&(i=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var c=Ae(i);this.instance.runHooks("modifyData",n,this.propToCol(t),c,"get"),c.isTouched()&&(i=c.value)}return i}},{key:"getCopyable",value:function(e,t){return km.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var s=Ae(o);this.instance.runHooks("modifyData",r,this.propToCol(t),s,"set"),s.isTouched()&&(o=s.value)}if(i&&i.hasOwnProperty&&Le(i,t))i[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var u,l=t.split("."),c=i,f=0;for(f=0,u=l.length-1;f<u;f++)void 0===c[l[f]]&&(c[l[f]]={}),c=c[l[f]];c[l[f]]=o}else"function"==typeof t?t(this.dataSource.slice(r,r+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,r=this.instance.countSourceRows(),o=[],i=(r+e)%r,a=t;i<r&&a;)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],o=(n+e)%n,i=t;o<n&&i;){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!=0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,i,a,s=[],u=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===u||0===l)return[];var c=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(u-1,0),Math.max(t.row,n.row)),h=Math.min(Math.max(l-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,n.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&s.push(a)}return s}},{key:"getText",value:function(t,n){return _m(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return _m(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],r=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],n&&Em(t.prototype,n),r&&Em(t,r),e}();const Tm=Rm;function Cm(e){return Cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cm(e)}function Mm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Am(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Om(e){return function(e){if(Array.isArray(e))return Lm(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Am(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Am(e,t){if(e){if("string"==typeof e)return Lm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lm(e,t):void 0}}function Lm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xm=null;function Nm(e,t){var n,r,o,i,a=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=!1,l=this,c=new Fr(l),f=!0;t.language=ud(t.language);var h=new mm(l,t,[vm]),d=h.getTableMeta(),p=h.getGlobalMeta(),m=xo();rl(s)&&nl(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0,hd(this.rootDocument),this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),ol(this)&&Ct(t.licenseKey,e),this.guid="ht_".concat(At()),this.columnIndexMapper=new wf,this.rowIndexMapper=new wf,r=new Yl(l),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var y=function(e){var t=e.row,n=e.col;return new $n(t>=0?l.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?l.columnIndexMapper.getRenderableFromVisualIndex(n):n)},v=function(e){var t=e.row,n=e.col;return new $n(t>=0?l.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?l.columnIndexMapper.getVisualFromRenderableIndex(n):n)},g=new Kp(d,{countCols:function(){return l.countCols()},countRows:function(){return l.countRows()},propToCol:function(e){return n.propToCol(e)},isEditorOpened:function(){return!!l.getActiveEditor()&&l.getActiveEditor().isOpened()},countColsTranslated:function(){return a.view.countRenderableColumns()},countRowsTranslated:function(){return a.view.countRenderableRows()},visualToRenderableCoords:y,renderableToVisualCoords:v,isDisabledCellSelection:function(e,t){return l.getCellMeta(e,t).disableVisualSelection}});this.selection=g;var b=function(e){e.hiddenIndexesChanged&&a.selection.refresh()};function w(e){var t=_f(e);ad(t)?(l.runHooks("beforeLanguageChange",t),p.language=t,l.runHooks("afterLanguageChange",t)):Sf(e)}function _(e,t){var n="className"===e?l.rootElement:l.table;if(f)qt(n,t);else{var r=[],o=[];p[e]&&(r=Array.isArray(p[e])?p[e]:de(p[e])),t&&(o=Array.isArray(t)?t:de(t));var i=ce(r,o),a=ce(o,r);i.length&&Jt(n,i),a.length&&qt(n,a)}p[e]=t}function S(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function E(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function k(e,t,r){if(e.length){var o=l.getActiveEditor(),i=l.runHooks("beforeChange",e,t||"edit"),a=!0;if(!1!==i){var s=new S;s.onQueueEmpty=function(e){o&&a&&o.cancelChanges(),r(e)};for(var u=e.length-1;u>=0;u--)if(null===e[u])e.splice(u,1);else{var c=Mm(e[u],4),f=c[0],h=c[1],p=c[3],m=n.propToCol(h),y=l.getCellMeta(f,m);"numeric"===y.type&&"string"==typeof p&&mo(p)&&(e[u][3]=E(p)),l.getCellValidator(y)&&(s.addValidatorToQueue(),l.validateCell(e[u][3],y,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){a=!1,e.splice(t,1),n.valid=!0;var o=l.getCell(n.visualRow,n.visualCol);null!==o&&Jt(o,d.invalidCellClassName)}s.removeValidatorFormQueue()}}(u,y),t))}s.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function R(e,t){var r=e.length-1;if(!(r<0)){for(;r>=0;r--){var a=!1;if(null!==e[r]){if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(d.allowInsertRow)for(;e[r][0]>l.countRows()-1;){var s=n.createRow(void 0,void 0,t);if(!(s>=1)){a=!0;break}h.createRow(null,s)}if("array"===l.dataType&&(!d.columns||0===d.columns.length)&&d.allowInsertColumn)for(;n.propToCol(e[r][1])>l.countCols()-1;){var u=n.createCol(void 0,void 0,t);if(!(u>=1)){a=!0;break}h.createColumn(null,u)}a||n.set(e[r][0],e[r][1],e[r][3])}}else e.splice(r,1)}l.forceFullRender=!0,o.adjustRowsAndCols(),l.runHooks("beforeChangeRender",e,t),i.lockEditor(),l._refreshBorders(null),i.unlockEditor(),l.view.adjustElementsSize(),l.runHooks("afterChange",e,t||"edit");var c=l.getActiveEditor();c&&ft(c.refreshValue)&&c.refreshValue()}}function T(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("beforeSetRangeStart",(function(e){a.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){a.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){a.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=a.view.wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=a.view.wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=Ae(!1),n=a.selection.getSelectedRange(),r=n.current(),o=r.from,i=r.to,s=n.size()-1;a.runHooks("afterSelection",o.row,o.col,i.row,i.col,t,s),a.runHooks("afterSelectionByProp",o.row,l.colToProp(o.col),i.row,l.colToProp(i.col),t,s);var c=a.selection.isSelectedByAnyHeader(),f=a.selection.selectedRange.current(),h=!0;u&&(h=!1),t.isTouched()&&(h=!t.value);var d=a.selection.isSelectedByRowHeader(),p=a.selection.isSelectedByColumnHeader();!1!==h&&(c?d?a.view.scrollViewportVertically(l.rowIndexMapper.getRenderableFromVisualIndex(e.row)):p&&a.view.scrollViewportHorizontally(l.columnIndexMapper.getRenderableFromVisualIndex(e.col)):f&&!a.selection.isMultiple()?a.view.scrollViewport(y(f.from)):a.view.scrollViewport(y(e))),d&&p?qt(a.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(Jt(a.rootElement,"ht__selection--columns"),qt(a.rootElement,"ht__selection--rows")):p?(Jt(a.rootElement,"ht__selection--rows"),qt(a.rootElement,"ht__selection--columns")):Jt(a.rootElement,["ht__selection--rows","ht__selection--columns"]),a._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;a.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),a.runHooks("afterSelectionEndByProp",r.row,l.colToProp(r.col),o.row,l.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=a.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){a.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){a.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){a.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){a.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){i.destroyEditor(),a._refreshBorders(),Jt(a.rootElement,["ht__selection--rows","ht__selection--columns"]),a.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){a.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){a.alter("insert_col",e,1,"auto")})),o={alter:function(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=function(e){if(0===e.length)return[];var t=Om(e);return t.sort((function(e,t){var n=Mm(e,1)[0],r=Mm(t,1)[0];return n===r?0:n>r?1:-1})),ee(t,(function(e,t){var n=Mm(t,2),r=n[0],o=n[1],i=e[e.length-1],a=Mm(i,2),s=a[0]+a[1];if(r<=s){var u=Math.max(o-(s-r),0);i[1]+=u}else e.push([r,o]);return e}),[t[0]])};switch(e){case"insert_row":var c=l.countSourceRows();if(d.maxRows===c)return;if(t=ft(t)?t:c,r=n.createRow(t,i,a)){h.createRow(l.toPhysicalRow(t),i);var f=g.selectedRange.current(),p=null==f?void 0:f.from,m=null==p?void 0:p.row;if(ft(m)&&m>=t){var y=f.to,v=y.row,b=y.col,w=p.col;g.isSelectedByRowHeader()&&(w=-1),g.getSelectedRange().pop(),g.setRangeStartOnly(new $n(m+r,w),!0),g.setRangeEnd(new $n(v+r,b))}else l._refreshBorders()}break;case"insert_col":if(r=n.createCol(t,i,a)){if(h.createColumn(l.toPhysicalColumn(t),i),Array.isArray(d.colHeaders)){var _=[t,0];_.length+=r,Array.prototype.splice.apply(d.colHeaders,_)}var S=g.selectedRange.current(),E=null==S?void 0:S.from,k=null==E?void 0:E.col;if(ft(k)&&k>=t){var R=S.to,T=R.row,C=R.col,M=E.row;g.isSelectedByColumnHeader()&&(M=-1),g.getSelectedRange().pop(),g.setRangeStartOnly(new $n(M,k+r),!0),g.setRangeEnd(new $n(T,C+r))}else l._refreshBorders()}break;case"remove_row":var O=function(e){var t=0;re(e,(function(e){var r=Mm(e,2),o=r[0],i=r[1],s=dt(o)?l.countRows()-1:Math.max(o-t,0);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),n.removeRow(o,i,a)){h.removeRow(l.toPhysicalRow(s),i);var u=l.countRows(),c=d.fixedRowsTop;c>=s+1&&(d.fixedRowsTop-=Math.min(i,c-s));var f=d.fixedRowsBottom;f&&s>=u-f&&(d.fixedRowsBottom-=Math.min(i,f)),t+=i}}))};Array.isArray(t)?O(u(t)):O([[t,i]]),o.adjustRowsAndCols(),l._refreshBorders();break;case"remove_col":var A=function(e){var t=0;re(e,(function(e){var r=Mm(e,2),o=r[0],i=r[1],s=dt(o)?l.countCols()-1:Math.max(o-t,0),u=l.toPhysicalColumn(s);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),n.removeCol(o,i,a)){h.removeColumn(u,i);var c=d.fixedColumnsLeft;c>=s+1&&(d.fixedColumnsLeft-=Math.min(i,c-s)),Array.isArray(d.colHeaders)&&(void 0===u&&(u=-1),d.colHeaders.splice(u,i)),t+=i}}))};Array.isArray(t)?A(u(t)):A([[t,i]]),o.adjustRowsAndCols(),l._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}s||o.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=d.minRows,r=d.minSpareRows,o=d.minCols,i=d.minSpareCols;if(t){var a=l.countRows();a<t&&n.createRow(a,t-a,"auto")}if(r){var s=l.countEmptyRows(!0);if(s<r){var u=r-s,c=Math.min(u,d.maxRows-l.countSourceRows());n.createRow(l.countRows(),c,"auto")}}(o||i)&&(e=l.countEmptyCols(!0));var f=l.countCols();if(o&&!d.columns&&f<o){var h=o-f;e+=h,n.createCol(f,h,"auto")}if(i&&!d.columns&&"array"===l.dataType&&e<i){f=l.countCols();var p=i-e,m=Math.min(p,d.maxCols-f);n.createCol(f,m,"auto")}var y=l.countRows(),v=l.countCols();0!==y&&0!==v||g.deselect(),g.isSelected()&&re(g.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,i=e.to.col;n>y-1?(t=!0,o>(n=y-1)&&(o=n)):o>y-1&&(t=!0,n>(o=y-1)&&(n=o)),r>v-1?(t=!0,i>(r=v-1)&&(i=r)):i>v-1&&(t=!0,r>(i=v-1)&&(r=i)),t&&l.selectCell(n,r,o,i)})),l.view&&l.view.adjustElementsSize()},populateFromArray:function(e,t,n,r,o,i,a){var s,u,c,f,h,p,m,y,v=[],g={};if(0===(u=t.length))return!1;switch(o){case"shift_down":for(h=n?n.col-e.col+1:0,p=n?n.row-e.row+1:0,c=0,f=(t=Ll(t)).length,m=Math.max(f,h);c<m;c++)if(c<f){var b;for(s=0,u=t[c].length;s<p-u;s++)t[c].push(t[c][s%u]);t[c].unshift(e.col+c,e.row,0),(b=l).spliceCol.apply(b,Om(t[c]))}else{var w;t[c%f][0]=e.col+c,(w=l).spliceCol.apply(w,Om(t[c%f]))}break;case"shift_right":for(h=n?n.col-e.col+1:0,p=n?n.row-e.row+1:0,s=0,u=t.length,y=Math.max(u,p);s<y;s++)if(s<u){var _;for(c=0,f=t[s].length;c<h-f;c++)t[s].push(t[s][c%f]);t[s].unshift(e.row+s,e.col,0),(_=l).spliceRow.apply(_,Om(t[s]))}else{var S;t[s%u][0]=e.row+s,(S=l).spliceRow.apply(S,Om(t[s%u]))}break;default:g.row=e.row,g.col=e.col;var E,k={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},R=0,T=0,C=!0,M=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},O=t.length,A=n?n.row-e.row+1:0;for(u=n?A:Math.max(O,A),s=0;s<u&&!(n&&g.row>n.row&&A>O||!d.allowInsertRow&&g.row>l.countRows()-1||g.row>=d.maxRows);s++){var L=s-R,x=M(L).length,N=n?n.col-e.col+1:0;if(f=n?N:Math.max(x,N),g.col=e.col,E=l.getCellMeta(g.row,g.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!E.skipRowOnPaste){for(T=0,c=0;c<f&&!(n&&g.col>n.col&&N>x||!d.allowInsertColumn&&g.col>l.countCols()-1||g.col>=d.maxCols);c++)if(E=l.getCellMeta(g.row,g.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!E.skipColumnOnPaste)if(E.readOnly&&"UndoRedo.undo"!==r)g.col+=1;else{var I=c-T,D=M(L,I),P=l.getDataAtCell(g.row,g.col),H={row:L,col:I};if("Autofill.fill"===r){var j=l.runHooks("beforeAutofillInsidePopulate",H,i,t,a,{},k);j&&(D=ht(j.value)?D:j.value)}null!==D&&"object"===Cm(D)?(Array.isArray(D)&&null===P&&(P=[]),null===P||"object"!==Cm(P)?C=!1:Ee(ye(Array.isArray(P)?P:P[0]||P),ye(Array.isArray(D)?D:D[0]||D))?D=we(D):C=!1):null!==P&&"object"===Cm(P)&&(C=!1),C&&v.push([g.row,g.col,D]),C=!0,g.col+=1}else T+=1,g.col+=1,f+=1;g.row+=1}else R+=1,g.row+=1,u+=1}l.setDataAtCell(v,null,null,r||"populateFromArray")}}},this.init=function(){r.setData(d.data),l.runHooks("beforeInit"),(Ke()||$e())&&qt(l.rootElement,"mobile"),this.updateSettings(d,!0),this.view=new ml(this),i=to.getInstance(l,d,g),l.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===Cm(f)&&(l.runHooks("afterChange",f[0],f[1]),f=!1),l.runHooks("afterInit")},this.validateCell=function(e,t,n,r){var o,i=l.getCellValidator(t);function a(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var o=t.visualCol,i=t.visualRow,a=l.getCell(i,o,!0);if(a&&"TH"!==a.nodeName){var s=l.rowIndexMapper.getRenderableFromVisualIndex(i),u=l.columnIndexMapper.getRenderableFromVisualIndex(o);l.view.wt.wtSettings.settings.cellRenderer(s,u,a)}n(e)}else n(e)}pt(i)&&(o=i,i=function(e,t){t(o.test(e))}),jn(i)?(e=l.runHooks("beforeValidate",e,t.visualRow,t.prop,r),l._registerImmediate((function(){i.call(t,e,(function(n){l&&(n=l.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,a(n),l.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):l._registerImmediate((function(){t.valid=!0,a(t.valid,!1)}))},this.setDataAtCell=function(e,t,o,i){var a,s,u,c=T(e,t,o),f=[],h=i;for(a=0,s=c.length;a<s;a++){if("object"!==Cm(c[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof c[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=c[a][1]>=this.countCols()?c[a][1]:n.colToProp(c[a][1]),f.push([c[a][0],u,r.getAtCell(this.toPhysicalRow(c[a][0]),c[a][1]),c[a][2]])}h||"object"!==Cm(e)||(h=t),l.runHooks("afterSetDataAtCell",f,h),k(f,h,(function(){R(f,h)}))},this.setDataAtRowProp=function(e,t,n,o){var i,a,s=T(e,t,n),u=[],c=o;for(i=0,a=s.length;i<a;i++)u.push([s[i][0],s[i][1],r.getAtCell(this.toPhysicalRow(s[i][0]),s[i][1]),s[i][2]]);c||"object"!==Cm(e)||(c=t),l.runHooks("afterSetDataAtRowProp",u,c),k(u,c,(function(){R(u,c)}))},this.listen=function(){l&&!l.isListening()&&(xm=l.guid,l.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(xm=null,l.runHooks("afterUnlisten"))},this.isListening=function(){return xm===l.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,i,a,s,u,l){if("object"!==Cm(n)||"object"!==Cm(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var c="number"==typeof r?new $n(r,i):null;return o.populateFromArray(new $n(e,t),n,c,a,s,u,l)},this.spliceCol=function(e,t,r){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];return(o=n).spliceCol.apply(o,[e,t,r].concat(a))},this.spliceRow=function(e,t,r){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];return(o=n).spliceRow.apply(o,[e,t,r].concat(a))},this.getSelected=function(){if(g.isSelected())return ne(g.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(g.isSelected())return Array.from(g.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(g.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];re(g.getSelectedRange(),(function(e){var r=e.getTopLeftCorner(),o=e.getBottomRightCorner();yo(r.row,o.row,(function(e){yo(r.col,o.col,(function(r){t.getCellMeta(e,r).readOnly||n.push([e,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(i.lockEditor(),this._refreshBorders(null),i.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(l.view){var e=l.view.getLastSize(),t=e.width,n=e.height,r=l.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==t||i!==n;!1===l.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:o,height:i},a)||((a||l.view.wt.wtOverlays.scrollableElement===l.rootWindow)&&(l.view.setLastSize(o,i),l.render()),l.runHooks("afterRefreshDimensions",{width:t,height:n},{width:o,height:i},a))}},this.loadData=function(e,t){if(Array.isArray(d.dataSchema)?l.dataType="array":jn(d.dataSchema)?l.dataType="function":l.dataType="object",n&&n.destroy(),e=l.runHooks("beforeLoadData",e,f,t),n=new Tm(l,e,d),"object"===Cm(e)&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays (".concat(Cm(e)," given)"));var i,a=n.getSchema();e=[];var s,u=0;for(u=0,s=d.startRows;u<s;u++)if("object"!==l.dataType&&"function"!==l.dataType||!d.dataSchema)if("array"===l.dataType)i=we(a[0]),e.push(i);else{i=[];for(var c=0,p=d.startCols;c<p;c++)i.push(null);e.push(i)}else i=we(a),e.push(i)}Array.isArray(e[0])&&(l.dataType="array"),d.data=e,n.dataSource=e,r.data=e,r.dataType=l.dataType,r.colToProp=n.colToProp.bind(n),r.propToCol=n.propToCol.bind(n),r.countCachedColumns=n.countCachedColumns.bind(n),h.clearCellsCache(),l.initIndexMappers(),o.adjustRowsAndCols(),l.runHooks("afterLoadData",e,f,t),f?f=[null,"loadData"]:(l.runHooks("afterChange",null,"loadData"),l.render())},this.initIndexMappers=function(){var e=d.columns,t=0;if(Array.isArray(e))t=e.length;else if(jn(e))if("array"===l.dataType)for(var r=this.countSourceCols(),o=0;o<r;o+=1)e(o)&&(t+=1);else"object"!==l.dataType&&"function"!==l.dataType||(t=n.colToPropCache.length);else if(ft(d.dataSchema)){var i=n.getSchema();t=Array.isArray(i)?i.length:Oe(i)}else t=this.countSourceCols();this.columnIndexMapper.initToLength(t),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,o){return ht(e)?n.getAll():n.getRange(new $n(e,t),new $n(r,o),n.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,o){return n.getCopyableText(new $n(e,t),new $n(r,o))},this.getCopyableData=function(e,t){return n.getCopyable(e,n.colToProp(t))},this.getSchema=function(){return n.getSchema()},this.updateSettings=function(e){var t,r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!1;if(ft(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ft(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ft(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"!==t&&("language"!==t?"className"===t?_("className",e.className):"tableClassName"===t&&l.table?(_("tableClassName",e.tableClassName),l.view.wt.wtOverlays.syncOverlayTableClassNames()):br.getSingleton().isRegistered(t)||br.getSingleton().isDeprecated(t)?(jn(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,l.addHook(t,e[t])):!a&&Le(e,t)&&(p[t]=e[t]):w(e.language));void 0===e.data&&void 0===d.data?l.loadData(null,"updateSettings"):void 0!==e.data?l.loadData(e.data,"updateSettings"):void 0!==e.columns&&(n.createMap(),l.initIndexMappers());var u=l.countCols(),c=d.columns;if(c&&jn(c)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||h.clearCache(),u>0)for(t=0,r=0;t<u;t++){if(c){var m=s?c(t):c[r];m&&h.updateColumnMeta(r,m)}r+=1}ft(e.cell)&&Te(e.cell,(function(e){l.setCellMetaObject(e.row,e.col,e)})),l.runHooks("afterCellMetaReset");var y=l.rootElement.style.height;""!==y&&(y=parseInt(l.rootElement.style.height,10));var v=e.height;if(jn(v)&&(v=v()),a){var g=l.rootElement.getAttribute("style");g&&l.rootElement.setAttribute("data-initialstyle",l.rootElement.getAttribute("style"))}if(null===v){var b=l.rootElement.getAttribute("data-initialstyle");b&&(b.indexOf("height")>-1||b.indexOf("overflow")>-1)?l.rootElement.setAttribute("style",b):(l.rootElement.style.height="",l.rootElement.style.overflow="")}else void 0!==v&&(l.rootElement.style.height=isNaN(v)?"".concat(v):"".concat(v,"px"),l.rootElement.style.overflow="hidden");if(void 0!==e.width){var S=e.width;jn(S)&&(S=S()),l.rootElement.style.width=isNaN(S)?"".concat(S):"".concat(S,"px")}a||(l.view&&(l.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),l.view.wt.exportSettingsAsClassNames()),l.runHooks("afterUpdateSettings",e)),o.adjustRowsAndCols(),l.view&&!f&&(l.forceFullRender=!0,i.lockEditor(),l._refreshBorders(null),l.view.wt.wtOverlays.adjustElementsSize(),i.unlockEditor()),a||!l.view||""!==y&&""!==v&&void 0!==v||y===v||l.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=l.getSelectedLast();if(d.getValue){if(jn(d.getValue))return d.getValue.call(l);if(e)return l.getData()[e[0][0]][d.getValue]}else if(e)return l.getDataAtCell(e[0],e[1])},this.getSettings=function(){return d},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){o.alter(e,t,n,r,i)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:l.view.getCellAtCoords(new $n(o,r),n)},this.getCoords=function(e){var t=this.view.wt.wtTable.getCoords(e);if(null===t)return null;var n=t.row,r=t.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),new $n(o,i)},this.colToProp=function(e){return n.colToProp(e)},this.propToCol=function(e){return n.propToCol(e)},this.toVisualRow=function(e){return a.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return a.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return a.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return a.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return n.get(e,n.colToProp(t))},this.getDataAtRowProp=function(e,t){return n.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,Om(n.getRange(new $n(0,e),new $n(d.data.length-1,e),n.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,r=n.getRange(new $n(0,n.propToCol(e)),new $n(d.data.length-1,n.propToCol(e)),n.DESTINATION_RENDERER);return(t=[]).concat.apply(t,Om(r))},this.getSourceData=function(e,t,n,o){return void 0===e?r.getData():r.getByRange(new $n(e,t),new $n(n,o))},this.getSourceDataArray=function(e,t,n,o){return void 0===e?r.getData(!0):r.getByRange(new $n(e,t),new $n(n,o),!0)},this.getSourceDataAtCol=function(e){return r.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,o){var i=T(e,t,n),a=this.hasHook("afterSetSourceDataAtCell"),s=[];a&&re(i,(function(e){var t=Mm(e,3),n=t[0],o=t[1],i=t[2];s.push([n,o,r.getAtCell(n,o),i])})),re(i,(function(e){var t=Mm(e,3),n=t[0],o=t[1],i=t[2];r.setAtCell(n,o,i)})),a&&this.runHooks("afterSetSourceDataAtCell",s,o),this.render();var u=l.getActiveEditor();u&&ft(u.refreshValue)&&u.refreshValue()},this.getSourceDataAtRow=function(e){return r.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return r.getAtCell(e,t)},this.getDataAtRow=function(e){return n.getRange(new $n(e,0),new $n(e,this.countCols()-1),n.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var o=this,i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],a=i[0],s=i[1],u=i[2],l=i[3],c=null,f=null;void 0===u&&(u=a),void 0===l&&(l=s);var h="mixed";return yo(Math.max(Math.min(a,u),0),Math.max(a,u),(function(e){var t=!0;return yo(Math.max(Math.min(s,l),0),Math.max(s,l),(function(n){var r=o.getCellMeta(e,n);return f=r.type,c?t=c===f:c=f,t})),h=t?f:"mixed",t})),h},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],i=r[1],a=h.getCellMetaKeyValue(o,i,n);!1!==l.runHooks("beforeRemoveCellMeta",e,t,n,a)&&(h.removeCellMeta(o,i,n),l.runHooks("afterRemoveCellMeta",e,t,n,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&h.removeRow(this.toPhysicalRow(e),n),o.length>0&&re(o.reverse(),(function(n){h.createRow(t.toPhysicalRow(e)),re(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),l.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===Cm(n)&&Te(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){if(!1!==l.runHooks("beforeSetCellMeta",e,t,n,r)){var o=e,i=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),h.setCellMeta(o,i,n,r),l.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return h.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),h.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return h.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===l.dataType||d.columns)};var C=xl("renderer");this.getCellRenderer=function(e,t){return Jo(C.call(this,e,t))},this.getCellEditor=xl("editor");var M=xl("validator");this.getCellValidator=function(e,t){var n=M.call(this,e,t);return"string"==typeof n&&(n=oi(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new S;e&&(r.onQueueEmpty=e);for(var o=l.countRows()-1;o>=0;)if(void 0===t||-1!==t.indexOf(o)){for(var i=l.countCols()-1;i>=0;)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),l.validateCell(l.getDataAtCell(o,i),l.getCellMeta(o,i),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=d.rowHeaders,n=e;return void 0!==n&&(n=l.runHooks("modifyRowHeader",n)),void 0===n?(t=[],yo(l.countRows()-1,(function(e){t.push(l.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:jn(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!d.rowHeaders},this.hasColHeaders=function(){if(void 0!==d.colHeaders&&null!==d.colHeaders)return!!d.colHeaders;for(var e=0,t=l.countCols();e<t;e++)if(l.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=l.runHooks("modifyColHeader",e),n=d.colHeaders;if(void 0===t){for(var r=[],o=l.countCols(),i=0;i<o;i++)r.push(l.getColHeader(i));n=r}else{var a=l.toPhysicalColumn(t),s=function(e){for(var t=[],n=l.countCols(),r=0;r<n;r++)jn(d.columns)&&d.columns(r)&&t.push(r);return t[e]}(a);!1===d.colHeaders?n=null:d.columns&&jn(d.columns)&&d.columns(s)&&d.columns(s).title?n=d.columns(s).title:d.columns&&d.columns[a]&&d.columns[a].title?n=d.columns[a].title:Array.isArray(d.colHeaders)&&void 0!==d.colHeaders[a]?n=d.colHeaders[a]:jn(d.colHeaders)?n=d.colHeaders(a):d.colHeaders&&"string"!=typeof d.colHeaders&&"number"!=typeof d.colHeaders&&(n=Tl(t))}return n},this._getColWidthFromSettings=function(e){var t;if(e>=0&&(t=l.getCellMeta(0,e).width),void 0!==t&&t!==d.width||(t=d.colWidths),null!=t){switch(Cm(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=l._getColWidthFromSettings(e);return void 0===(t=l.runHooks("modifyColWidth",t,e))&&(t=Wu.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=d.rowHeights;if(null!=t){switch(Cm(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=l._getRowHeightFromSettings(e);return l.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return r.countRows()},this.countSourceCols=function(){return r.countFirstRowKeys()},this.countRows=function(){return n.getLength()},this.countCols=function(){var e=d.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return l.view.wt.drawn?l.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return l.view.wt.drawn?l.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return l.view.wt.drawn?l.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return l.view.wt.drawn?l.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return vo(l.countRows()-1,(function(n){if(l.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(l.countRows()<1)return 0;var t=0;return vo(l.countCols()-1,(function(n){if(l.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return d.isEmptyRow.call(l,e)},this.isEmptyCol=function(e){return d.isEmptyCol.call(l,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!ht(e)&&!ht(t)&&this.selectCells([[e,t,n,r]],o,i)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(u=!0);var r=g.selectCells(e);return r&&n&&l.listen(),u=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return g.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return g.selectRows(e,t)},this.deselectCell=function(){g.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();u=!0,g.selectAll(t,n),u=!1};var O=function(e,t){return e.getFirstNotHiddenIndex(t,1,!0)};function A(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,s=e,u=t;if(o){var c=Number.isInteger(e),f=Number.isInteger(t),h=c?O(this.rowIndexMapper,e):void 0,d=f?O(this.columnIndexMapper,t):void 0;if(null===h||null===d)return!1;s=c?l.rowIndexMapper.getRenderableFromVisualIndex(h):void 0,u=f?l.columnIndexMapper.getRenderableFromVisualIndex(d):void 0}var p=Number.isInteger(s),m=Number.isInteger(u);return p&&m?l.view.scrollViewport(new $n(s,u),i,r,n,a):p&&!1===m?l.view.scrollViewportVertically(s,i,n):!(!m||!1!==p)&&l.view.scrollViewportHorizontally(u,r,a)},this.destroy=function(){if(l._clearTimeouts(),l._clearImmediates(),l.view&&l.view.destroy(),r&&r.destroy(),r=null,h.clearCache(),dd(),ol(l)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}Zt(l.rootElement),c.destroy(),i&&i.destroy(),l.batchExecution((function(){l.rowIndexMapper.unregisterAll(),l.columnIndexMapper.unregisterAll(),m.getItems().forEach((function(e){Mm(e,2)[1].destroy()})),m.clear(),l.runHooks("afterDestroy")}),!0),br.getSingleton().destroy(l),Te(l,(function(e,t,n){jn(e)?n[t]=A(t):"guid"!==t&&(n[t]=null)})),l.isDestroyed=!0,n&&n.destroy(),l.rowIndexMapper=null,l.columnIndexMapper=null,n=null,o=null,g=null,i=null,l=null},this.getActiveEditor=function(){return i.getActiveEditor()},this.getPlugin=function(e){var t=Mt(e);return"UndoRedo"===t?this.undoRedo:m.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:m.getId(e)},this.getInstance=function(){return l},this.addHook=function(e,t){br.getSingleton().add(e,t,l)},this.hasHook=function(e){return br.getSingleton().has(e,l)},this.addHookOnce=function(e,t){br.getSingleton().once(e,t,l)},this.removeHook=function(e,t){br.getSingleton().remove(e,t,l)},this.runHooks=function(e,t,n,r,o,i,a){return br.getSingleton().run(l,e,t,n,r,o,i,a)},this.getTranslatedPhrase=function(e,t){return sd(d.language,e,t)},this.toHTML=function(){return so(a)},this.toTableElement=function(){var e=a.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",so(a)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"==typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){re(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){re(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i.destroyEditor(e),l.view.render(),t&&g.isSelected()&&i.prepareEditor()},Vo().forEach((function(e){var t=Wo(e);m.addItem(e,new t(a))})),br.getSingleton().run(l,"construct")}function Im(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(e,t,n){e.addEventListener(t,n,!1)},a=function(e,t,n){e.removeEventListener(t,n,!1)},s=function(i){var a,s;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=e.value+i:r.data=e.value+i,o.style.fontSize=l(e).fontSize,o.style.fontFamily=l(e).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>a?e.style.width=t.minWidth+"px":a>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=a+"px",s=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>s?e.style.height=t.minHeight+"px":t.maxHeight<s?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=s+"px"},u=function(){window.setTimeout(s,0)};function l(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(n,a,l){!function(n,a,l){e=n,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(t.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(t.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var s=parseInt(n.minWidth);isNaN(s)||(t.minWidth=s)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var u=parseInt(n.maxWidth);isNaN(u)||(t.maxWidth=u)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}(a),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),l&&(i(e,"change",s),i(e,"cut",u),i(e,"paste",u),i(e,"drop",u),i(e,"keydown",u),i(e,"focus",s),i(e,"compositionstart",u),i(e,"compositionupdate",u),i(e,"compositionend",u)),s()}(n,a,l)},unObserve:function(){a(e,"change",s),a(e,"cut",u),a(e,"paste",u),a(e,"drop",u),a(e,"keydown",u),a(e,"focus",s),a(e,"compositionstart",u),a(e,"compositionupdate",u),a(e,"compositionend",u)},resize:s}}function Dm(e){return Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dm(e)}function Pm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hm(e,t,n){return Hm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Um(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Hm(e,t,n||e)}function jm(e,t){return jm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},jm(e,t)}function Fm(e,t){if(t&&("object"===Dm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ym(e)}function Ym(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Um(e){return Um=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Um(e)}var Bm="ht_editor_hidden",Vm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jm(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Um(o);if(i){var n=Um(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fm(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(Ym(t)),t.autoResize=Im(),t.TEXTAREA=void 0,t.textareaStyle=void 0,t.TEXTAREA_PARENT=void 0,t.textareaParentStyle=void 0,t.layerClass=void 0,t.createElements(),t.bindEvents(),t.hot.addHookOnce("afterDestroy",(function(){return t.destroy()})),t}return t=s,n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)}))}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(e,t,n,r,o,i){var a=this.state;if(Hm(Um(s.prototype),"prepare",this).call(this,e,t,n,r,o,i),!i.readOnly){this.refreshDimensions(!0);var u=i.allowInvalid,l=i.fragmentSelection;u&&(this.TEXTAREA.value=""),a!==$r.FINISHED&&this.hideEditableElement(),!l&&!Ke()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===$r.VIRGIN&&(this.TEXTAREA.value="",Hm(Um(s.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),Tn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,qt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),qt(this.TEXTAREA_PARENT,"handsontableInputHolder"),$t(this.TEXTAREA_PARENT,this.layerClass)&&Jt(this.TEXTAREA_PARENT,this.layerClass),qt(this.TEXTAREA_PARENT,Bm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(We()||Be())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",$t(this.TEXTAREA_PARENT,this.layerClass)&&Jt(this.TEXTAREA_PARENT,this.layerClass),qt(this.TEXTAREA_PARENT,Bm)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;yo(e.length-1,(function(n){if($t(e[n],"handsontableEditor"))return t=!0,!1})),$t(this.TEXTAREA_PARENT,Bm)&&Jt(this.TEXTAREA_PARENT,Bm),t?(this.layerClass="ht_editor_visible",qt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),qt(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===$r.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t,n=this.hot.view.wt,r=n.wtOverlays,o=n.wtViewport,i=an(this.TD),a=an(this.hot.rootElement),s=r.topOverlay.holder,u=r.leftOverlay.holder,l=s!==this.hot.rootWindow?s.scrollTop:0,c=u!==this.hot.rootWindow?u.scrollLeft:0,f=this.checkEditorSection(),h=["","left"].includes(f)?l:0,d=["","top","bottom"].includes(f)?c:0,p=i.top===a.top?0:1,m=this.TD.style.backgroundColor,y=i.top-a.top-p-h,v=i.left-a.left-1-d;switch(f){case"top":t=xn(r.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=xn(r.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=xn(r.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=xn(r.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=xn(r.bottomOverlay.clone.wtTable.holder.parentNode)}var g=this.hot.hasColHeaders(),b=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),w=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),_=this.hot.rowIndexMapper.getRenderableIndexesLength(),S=_-this.hot.view.wt.getSetting("fixedRowsBottom");(g&&b<=0||b===S)&&(y+=1),w<=0&&(v+=1),t&&-1!==t?this.textareaParentStyle[t[0]]=t[1]:Nn(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(y,"px"),this.textareaParentStyle.left="".concat(v,"px"),this.showEditableElement();var E=o.rowsRenderCalculator.startPosition,k=o.columnsRenderCalculator.startPosition,R=r.leftOverlay.getScrollPosition(),T=r.topOverlay.getScrollPosition(),C=Mn(this.hot.rootDocument),M=this.TD.offsetTop+E-T,O=this.TD.offsetLeft+k-R,A=bn(this.TD)-8,L=On(s)?C:0,x=An(u)?C:0,N=this.hot.view.maximumVisibleElementWidth(O)-9-L,I=this.TD.scrollHeight+1,D=Math.max(this.hot.view.maximumVisibleElementHeight(M)-x,23),P=mn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=P.fontSize,this.TEXTAREA.style.fontFamily=P.fontFamily,this.TEXTAREA.style.backgroundColor=m,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,D),maxHeight:D,minWidth:Math.min(A,N),maxWidth:N},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),Xe()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(e){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===this.TEXTAREA&&!ir(e)){switch(e.keyCode){case Jn.ARROW_RIGHT:case Jn.ARROW_LEFT:case Jn.ARROW_UP:case Jn.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(e.keyCode)||or(e));break;case Jn.ENTER:var n=this.hot.selection.isMultiple();if(t&&!n||e.altKey){if(this.isOpened()){var r=Sn(this.TEXTAREA),o=this.getValue(),i="".concat(o.slice(0,r),"\n").concat(o.slice(r));this.setValue(i),Tn(this.TEXTAREA,r+1)}else this.beginEditing("".concat(this.originalValue,"\n"));or(e)}e.preventDefault();break;case Jn.BACKSPACE:case Jn.DELETE:case Jn.HOME:case Jn.END:or(e)}-1===[Jn.ARROW_UP,Jn.ARROW_RIGHT,Jn.ARROW_DOWN,Jn.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}}],r=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n&&Pm(t.prototype,n),r&&Pm(t,r),s}(qr);function Wm(e,t,n,r,o,i,a){var s=[],u=[];a.className&&qt(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?s.push(a.invalidCellClassName):u.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),Jt(t,u),qt(t,s)}function zm(e,t,n,r,o,i,a){Wm.apply(this,[e,t,n,r,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=ct(s),e.getSettings().trimWhitespace&&(s=s.trim()),a.rendererTemplate){Zt(t);var u=e.rootDocument.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=e.getSourceDataAtRow(n),t.appendChild(u)}else rn(t,s)}Wm.RENDERER_TYPE="base",zm.RENDERER_TYPE="text";var Gm={CELL_TYPE:"text",editor:Vm,renderer:zm};function Km(e,t){var n=new Nm(e,t||{},tl);return n.init(),n}Sl(Gm),Km.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Nm(e,t,tl)},Km.packageName="handsontable",Km.buildDate="29/09/2021 10:35:47",Km.version="10.0.0",Km.languages={dictionaryKeys:p,getLanguageDictionary:id,getLanguagesDictionaries:function(){return rd()},registerLanguageDictionary:od,getTranslatedPhrase:sd};const Xm=Km;function $m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var t,n;return t=e,n=[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){if(null!=this.hot.getColHeader(0)){var t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),re(this.rows,(function(t){e(t.row,vn(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),re(this.columns,(function(t){e(t.col,yn(t.table))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){re(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach((function(o){re(o.strings,(function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var s=t.hot.getCellRenderer(a),u=n.createElement("td");u.setAttribute("ghost-table",1),s(t.hot,u,e,i,t.hot.colToProp(i),o.value,a),r.appendChild(u)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var o=t.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach((function(e){re(e.strings,(function(e){var o=e.col,i=t.createElement("th");r.push([o,i]),n.appendChild(i)}))})),this.table.tHead.appendChild(n),re(r,(function(t){var n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return $m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$m(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];e.hot.view.appendColHeader(i,a)}))}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){re(o.strings,(function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var s=t.hot.getCellRenderer(a),u=n.createElement("td"),l=n.createElement("tr");u.setAttribute("ghost-table",1),s(t.hot,u,i,e,t.hot.colToProp(e),o.value,a),l.appendChild(u),r.appendChild(l)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=this.hot.rootDocument.createElement("col");return t.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(e),"px"),t}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),a=t.createElement("colgroup"),s=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(s.appendChild(u),o.appendChild(s),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(s),r.appendChild(i),qt(r,e),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:s,th:u}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("div"),o="htGhostTable htAutoSize ".concat(e.trim());return qt(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}],n&&qm(t.prototype,n),e}();const Qm=Jm;function Zm(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}function ey(e){return ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ey(e)}function ty(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ny(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ry(e,t,n){return ry="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ay(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},ry(e,t,n||e)}function oy(e,t){return oy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oy(e,t)}function iy(e,t){if(t&&("object"===ey(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ay(e)}var sy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oy(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ay(o);if(i){var n=ay(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return iy(this,e)});function s(){return ty(this,s),a.apply(this,arguments)}return t=s,n=[{key:"open",value:function(){ry(ay(s.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Tn(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ry(ay(s.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,t,n,r,o,i){ry(ay(s.prototype),"prepare",this).call(this,e,t,n,r,o,i);var a=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&a.setValue(n),a.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&ge(u,i.handsontable),this.htOptions=u}},{key:"beginEditing",value:function(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||ry(ay(s.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){ry(ay(s.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var r=this.htEditor.getInstance().getValue();void 0!==r&&this.setValue(r)}ry(ay(s.prototype),"finishEditing",this).call(this,e,t,n)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"onBeforeKeyDown",value:function(e){if(!ir(e)){var t,n,r=this.htEditor.getInstance();if(e.keyCode===Jn.ARROW_DOWN)if(r.getSelectedLast()||r.flipped){if(r.getSelectedLast())if(r.flipped)t=r.getSelectedLast()[0]+1;else if(!r.flipped){var o=r.countRows()-1;n=r.getSelectedLast()[0],t=Math.min(o,n+1)}}else t=0;else e.keyCode===Jn.ARROW_UP&&(!r.getSelectedLast()&&r.flipped?t=r.countRows()-1:r.getSelectedLast()&&(r.flipped?(n=r.getSelectedLast()[0],t=Math.max(0,n-1)):t=(n=r.getSelectedLast()[0])-1));void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length&&(e.preventDefault(),or(e),this.hot.listen(),this.TEXTAREA.focus())),ry(ay(s.prototype),"onBeforeKeyDown",this).call(this,e)}}}],r=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],n&&ny(t.prototype,n),r&&ny(t,r),s}(Vm);function uy(e){return uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uy(e)}function ly(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cy(e,t,n){return cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=py(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},cy(e,t,n||e)}function fy(e,t){return fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fy(e,t)}function hy(e,t){if(t&&("object"===uy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return dy(e)}function dy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function py(e){return py=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},py(e)}var my=new WeakMap,yy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=py(o);if(i){var n=py(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return hy(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).query=null,t.strippedChoices=[],t.rawChoices=[],my.set(dy(t),{skipOne:!1,isMacOS:t.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),t}return t=s,n=[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return ft(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){cy(py(s.prototype),"createElements",this).call(this),qt(this.htContainer,"autocompleteEditor"),qt(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=my.get(this);cy(py(s.prototype),"open",this).call(this);var n=this.htEditor.getInstance(),r=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var o=Mn();0===o&&t.isMacOS&&(o+=15),n.updateSettings({colWidths:r?[yn(this.TEXTAREA)-2]:void 0,width:r?yn(this.TEXTAREA)+o:void 0,renderer:function(t,n,r,o,i,a,s){zm(t,n,r,o,i,a,s);var u,l,c=e.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=e.query,p=ct(a);p&&!h&&-1!==(u=!0===f?p.indexOf(d):p.toLowerCase().indexOf(d.toLowerCase()))&&(l=p.substr(u,d.length),p=p.replace(l,"<strong>".concat(l,"</strong>"))),n.innerHTML=p},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),cy(py(s.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){cy(py(s.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,n=this.cellProperties.source;this.query=e,"function"==typeof n?n.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=Sn(this.TEXTAREA),n=En(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null,u=e;r&&(i=s.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(i)?i.length:0;if(!1===o)l&&(a=i[0]);else{for(var c=[],f=0,h=u.length;f<h&&!(r&&l<=f);f++)l?c.push(u[i[f]]):c.push(u[f]);a=0,u=c}this.strippedChoices=u,this.htEditor.loadData(Z([u])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.hot.listen(),Tn(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=an(this.TEXTAREA),t=vn(this.TEXTAREA),n=this.getDropdownHeight(),r=hn(this.hot.view.wt.wtTable.TABLE),o=r.scrollTop,i=vn(this.hot.view.wt.wtTable.THEAD),a={row:0,col:0};r!==this.hot.rootWindow&&(a=an(r));var s=e.top-a.top-i+o,u=r.scrollHeight-s-i-t,l=n>u&&s>u;return l?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(l?s:u,n),l}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n,r=0,o=0,i=0;do{r+=i=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,o+=1}while(r<e);n=r-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-n,"px")),this.setDropdownHeight(r-i)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+Mn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=ne(e,(function(e){return ct(e)})),r=ne(n,(function(e){return t?e:Nt(e)}));return r}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1,r=!1;return e===Jn.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===Jn.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=my.get(this);if(n.skipOne=!1,Zn(e.keyCode)||e.keyCode===Jn.BACKSPACE||e.keyCode===Jn.DELETE||e.keyCode===Jn.INSERT){var r=0;if(e.keyCode===Jn.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}cy(py(s.prototype),"onBeforeKeyDown",this).call(this,e)}}],r=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],n&&ly(t.prototype,n),r&&ly(t,r),s}(sy);function vy(e){return vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vy(e)}function gy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function by(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wy(e,t){return wy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wy(e,t)}function _y(e,t){if(t&&("object"===vy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sy(e){return Sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sy(e)}yy.sortByRelevance=function(e,t,n){var r,o,i,a,s=[],u=[],l=e.length,c=t.length;if(0===l){for(i=0;i<c;i++)u.push(i);return u}for(i=0;i<c;i++)o=Nt(ct(t[i])),-1!==(a=n?o.indexOf(e):o.toLowerCase().indexOf(e.toLowerCase()))&&(r=o.length-a-l,s.push({baseIndex:i,index:a,charsLeft:r,value:o}));for(s.sort((function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),i=0,c=s.length;i<c;i++)u.push(s[i].baseIndex);return u};var Ey=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wy(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sy(o);if(i){var n=Sy(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _y(this,e)});function s(){return gy(this,s),a.apply(this,arguments)}return t=s,r=[{key:"EDITOR_TYPE",get:function(){return"checkbox"}}],(n=[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var n=this.TD.querySelector('input[type="checkbox"]');$t(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&by(t.prototype,n),r&&by(t,r),s}(qr),ky=n(704);function Ry(e){return Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ry(e)}function Ty(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cy(e,t,n){return Cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ay(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Cy(e,t,n||e)}function My(e,t){return My=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},My(e,t)}function Oy(e,t){if(t&&("object"===Ry(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ay(e){return Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ay(e)}var Ly="date",xy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&My(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ay(o);if(i){var n=Ay(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Oy(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).defaultDateFormat="DD/MM/YYYY",t.isCellEdited=!1,t.parentDestroyed=!1,t.$datePicker=null,t}return t=s,n=[{key:"init",value:function(){var e=this;if("function"!=typeof at)throw new Error("You need to include moment.js to your project.");if("function"!=typeof ky)throw new Error("You need to include Pikaday to your project.");Cy(Ay(s.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){Cy(Ay(s.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,qt(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new Fr(this).addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()}))}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,t,n,r,o,i){Cy(Ay(s.prototype),"prepare",this).call(this,e,t,n,r,o,i)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Cy(Ay(s.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e=this;this._opened=!1,this.$datePicker.destroy(),this.instance._registerTimeout((function(){e.instance._refreshBorders()})),Cy(Ay(s.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}Cy(Ay(s.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!e&&er(e.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+vn(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+n.left,"px"),this.$datePicker=new ky(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.originalValue?(t=this.originalValue,at(t,r,!0).isValid()&&this.$datePicker.setMoment(at(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,at(t,r,!0).isValid()&&this.$datePicker.setMoment(at(t,r),!0),i||o||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block"}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&be(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=at(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}}],r=[{key:"EDITOR_TYPE",get:function(){return Ly}}],n&&Ty(t.prototype,n),r&&Ty(t,r),s}(Vm);function Ny(e){return Ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ny(e)}function Iy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Py(e,t,n){return Py="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fy(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Py(e,t,n||e)}function Hy(e,t){return Hy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hy(e,t)}function jy(e,t){if(t&&("object"===Ny(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fy(e){return Fy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fy(e)}var Yy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hy(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fy(o);if(i){var n=Fy(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jy(this,e)});function s(){return Iy(this,s),a.apply(this,arguments)}return t=s,n=[{key:"prepare",value:function(e,t,n,r,o,i){Py(Fy(s.prototype),"prepare",this).call(this,e,t,n,r,o,i),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],r=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],n&&Dy(t.prototype,n),r&&Dy(t,r),s}(yy);function Uy(e){return Uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uy(e)}function By(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wy(e,t){return Wy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wy(e,t)}function zy(e,t){if(t&&("object"===Uy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gy(e){return Gy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gy(e)}br.getSingleton().add("beforeValidate",(function(e,t,n){var r=this.getCellMeta(t,this.propToCol(n));r.editor===Yy&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var Ky=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wy(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Gy(r);if(o){var n=Gy(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return zy(this,e)});function a(){return By(this,a),i.apply(this,arguments)}return t=a,n=[{key:"EDITOR_TYPE",get:function(){return"numeric"}}],null&&Vy(t.prototype,null),n&&Vy(t,n),a}(Vm);function Xy(e){return Xy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xy(e)}function $y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jy(e,t,n){return Jy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ev(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Jy(e,t,n||e)}function Qy(e,t){return Qy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qy(e,t)}function Zy(e,t){if(t&&("object"===Xy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ev(e){return ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ev(e)}var tv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qy(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ev(o);if(i){var n=ev(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zy(this,e)});function s(){return $y(this,s),a.apply(this,arguments)}return t=s,r=[{key:"EDITOR_TYPE",get:function(){return"password"}}],(n=[{key:"createElements",value:function(){Jy(ev(s.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Zt(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&qy(t.prototype,n),r&&qy(t,r),s}(Vm);function nv(e){return nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(e)}function rv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ov(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iv(e,t,n){return iv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},iv(e,t,n||e)}function av(e,t){return av=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},av(e,t)}function sv(e,t){if(t&&("object"===nv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uv(e){return uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uv(e)}var lv="ht_editor_visible",cv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&av(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=uv(o);if(i){var n=uv(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sv(this,e)});function s(){return rv(this,s),a.apply(this,arguments)}return t=s,n=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),qt(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){var e=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()}))}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",$t(this.select,lv)&&Jt(this.select,lv),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,t,n,r,o,i){var a=this;iv(uv(s.prototype),"prepare",this).call(this,e,t,n,r,o,i);var u,l=this.cellProperties.selectOptions;u="function"==typeof l?this.prepareOptions(l(this.row,this.col,this.prop)):this.prepareOptions(l),Zt(this.select),Te(u,(function(e,t){var n=a.hot.rootDocument.createElement("OPTION");n.value=t,nn(n,e),a.select.appendChild(n)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"===nv(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===$r.EDITING)if(this.TD=this.getEditedCell(),this.TD){var e,t=this.hot.view.wt.wtOverlays,n=an(this.TD),r=an(this.hot.rootElement),o=t.scrollableElement,i=this.checkEditorSection(),a=yn(this.TD)+1,s=vn(this.TD)+1,u=n.top-r.top-1-(o.scrollTop||0),l=n.left-r.left-1-(o.scrollLeft||0);switch(i){case"top":e=xn(t.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=xn(t.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=xn(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=xn(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=xn(t.bottomOverlay.clone.wtTable.holder.parentNode)}var c=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),h=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view.wt.getSetting("fixedRowsBottom");(c<=0||c===h)&&(u+=1),f<=0&&(l+=1);var d=this.select.style;e&&-1!==e?d[e[0]]=e[1]:Nn(this.select);var p=mn(this.TD,this.hot.rootWindow);parseInt(p.borderTopWidth,10)>0&&(s-=1),parseInt(p.borderLeftWidth,10)>0&&(a-=1),d.height="".concat(s,"px"),d.minWidth="".concat(a,"px"),d.top="".concat(u,"px"),d.left="".concat(l,"px"),d.margin="0px",qt(this.select,lv)}else this.close()}},{key:"onBeforeKeyDown",value:function(){var e=this.select.selectedIndex-1,t=this.select.selectedIndex+1;switch(event.keyCode){case Jn.ARROW_UP:e>=0&&(this.select[e].selected=!0),or(event),event.preventDefault();break;case Jn.ARROW_DOWN:t<=this.select.length-1&&(this.select[t].selected=!0),or(event),event.preventDefault()}}}],r=[{key:"EDITOR_TYPE",get:function(){return"select"}}],n&&ov(t.prototype,n),r&&ov(t,r),s}(qr);function fv(e,t,n,r,o,i,a){Wm.apply(this,[e,t,n,r,o,i,a]),nn(t,null==i?"":i,!1)}function hv(e,t,n,r,o,i,a){var s=e.rootDocument,u=a.allowHtml?fv:zm,l=s.createElement("DIV");if(l.className="htAutocompleteArrow",l.appendChild(s.createTextNode(String.fromCharCode(9660))),u.apply(this,[e,t,n,r,o,i,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(l,t.firstChild),qt(t,"htAutocomplete"),!e.acArrowListener){var c=new Fr(e);e.acArrowListener=function(o){$t(o.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new $n(n,r),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){c.destroy()}))}}fv.RENDERER_TYPE="html",hv.RENDERER_TYPE="autocomplete";var dv=new WeakMap,pv=new WeakMap,mv="data-row",yv="data-col",vv="checkbox";function gv(e,t,n,r,o,i,a){var s=e.rootDocument;Wm.apply(this,[e,t,n,r,o,i,a]),function(e){var t=pv.get(e);if(!t){var n=e.rootElement;(t=new Fr(e)).addEventListener(n,"click",(function(t){return function(e,t){var n=e.target;if(bv(n)&&n.hasAttribute(mv)&&n.hasAttribute(yv)){var r=parseInt(n.getAttribute(mv),10),o=parseInt(n.getAttribute(yv),10);t.getCellMeta(r,o).readOnly&&e.preventDefault()}}(t,e)})),t.addEventListener(n,"mouseup",(function(t){return function(e,t){var n=e.target;bv(n)&&n.hasAttribute(mv)&&n.hasAttribute(yv)&&setTimeout(t.listen,10)}(t,e)})),t.addEventListener(n,"change",(function(t){return function(e,t){var n=e.target;if(bv(n)&&n.hasAttribute(mv)&&n.hasAttribute(yv)){var r=parseInt(n.getAttribute(mv),10),o=parseInt(n.getAttribute(yv),10),i=t.getCellMeta(r,o);if(!i.readOnly){var a;a=e.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,t.setDataAtCell(r,o,a)}}}(t,e)})),pv.set(e,t)}}(e);var u=function(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(s),l=a.label,c=!1;if(void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Zt(t),i===a.checkedTemplate||Ot(i,a.checkedTemplate)?u.checked=!0:i===a.uncheckedTemplate||Ot(i,a.uncheckedTemplate)?u.checked=!1:dt(i)?qt(u,"noValue"):(u.style.display="none",qt(u,"htBadValue"),c=!0),u.setAttribute(mv,n),u.setAttribute(yv,r),!c&&l){var f="";if(l.value)f="function"==typeof l.value?l.value.call(this,n,r,o,i):l.value;else if(l.property){var h=e.getDataAtRowProp(n,l.property);f=null!==h?h:""}var d=function(e,t,n){var r=e.createElement("label");return r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":""),r.appendChild(e.createTextNode(t)),r.cloneNode(!0)}(s,f,!0!==l.separated);"before"===l.position?l.separated?(t.appendChild(d),t.appendChild(u)):(d.appendChild(u),u=d):l.position&&"after"!==l.position||(l.separated?(t.appendChild(u),t.appendChild(d)):(d.insertBefore(u,d.firstChild),u=d))}function p(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopLeftCorner(),i=o.row,a=o.col,s=n[r].getBottomRightCorner(),u=s.row,l=s.col,c=[],f=i;f<=u;f+=1)for(var h=a;h<=l;h+=1){var d=e.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){void 0===d.checkedTemplate&&(d.checkedTemplate=!0),void 0===d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=e.getDataAtCell(f,h);!1===t?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&e.setDataAtCell(c)}}(!l||l&&!l.separated)&&t.appendChild(u),c&&t.appendChild(s.createTextNode("#bad-value#")),dv.has(e)||(dv.set(e,!0),e.addHook("beforeKeyDown",(function(t){var n="SPACE|ENTER",r="DELETE|BACKSPACE",o=Vn(rr,t.keyCode);!e.getSettings().enterBeginsEditing&&o("ENTER")||(o("".concat(n,"|").concat(r))&&!ir(t)&&function(t){var n=e.getSelectedRange();if(n)for(var r=0;r<n.length;r++)for(var o=n[r].getTopLeftCorner(),i=n[r].getBottomRightCorner(),a=o.row;a<=i.row;a++)for(var s=o.col;s<=i.col;s++){var u=e.getCellMeta(a,s);if("checkbox"!==u.type)return;var l=e.getCell(a,s);if(null==l)t();else{var c=l.querySelectorAll("input[type=checkbox]");c.length>0&&!u.readOnly&&t()}}}((function(){or(t),t.preventDefault()})),o(n)&&p(),o(r)&&p(!0))})))}function bv(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}br.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){var r=t.label,o=t.type,i=t.row,a=t.column,s=t.prop;if(o===vv){if(r){var u=r.value,l=r.property,c=n;if(u)c="function"==typeof u?u(i,a,s,n):u;else if(l){var f=this.getDataAtRowProp(i,l);c=null!==f?f:n}e=c}return e}})),gv.RENDERER_TYPE=vv;var wv=n(8551);function _v(e,t,n,r,o,i,a){var s=i;if(po(s)){var u=a.numericFormat,l=u&&u.culture||"-",c=u&&u.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(void 0!==l&&!wv.languages()[l]){var d=l.replace("-",""),p=wv.allLanguages?wv.allLanguages[l]:wv[d];p&&wv.registerLanguage(p)}wv.setLanguage(l),s=wv(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" ")}zm(e,t,n,r,o,s,a)}function Sv(e,t,n,r,o,i,a){zm.apply(this,[e,t,n,r,o,i,a]);var s=a.hashLength||t.innerHTML.length,u=a.hashSymbol||"*",l="";yo(s-1,(function(){l+=u})),nn(t,l)}function Ev(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,kv(n,t)):kv(n,t)(this.source):t(!0)}function kv(e,t){var n=e;return function(e){for(var r=!1,o=0,i=e.length;o<i;o++)if(n===e[o]){r=!0;break}t(r)}}function Rv(e,t){var n=Lr(Ly,this.instance),r=e,o=!0;null==r&&(r="");var i=at(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=at(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var s=function(e,t){var n=at(Zm(e)),r=at(e,t),o=e.search(/[A-z]/g)>-1;return(n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||o?n:r).format(t)}(r,this.dateFormat),u=this.instance.toVisualRow(this.row),l=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,l,s,"dateValidator"),o=!0}else o=!1;t(o)}function Tv(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&po(e))}_v.RENDERER_TYPE="numeric",Sv.RENDERER_TYPE="password",Ev.VALIDATOR_TYPE="autocomplete",n(79006),Rv.VALIDATOR_TYPE="date",Tv.VALIDATOR_TYPE="numeric";var Cv=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function Mv(e,t){var n=this.timeFormat||"h:mm:ss a",r=!0,o=e;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=at(o,Cv,!0).isValid()?at(o):at(o,n),s=a.isValid(),u=at(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(s=!0,u=!0),s||(r=!1),!s&&u&&(r=!0),s&&!u)if(!0===this.correctFormat){var l=a.format(n),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,l,"timeValidator"),r=!0}else r=!1;t(r)}Mv.VALIDATOR_TYPE="time";var Ov={CELL_TYPE:"autocomplete",editor:yy,renderer:hv,validator:Ev},Av={CELL_TYPE:"checkbox",editor:Ey,renderer:gv},Lv={CELL_TYPE:"date",editor:xy,renderer:hv,validator:Rv},xv={CELL_TYPE:"dropdown",editor:Yy,renderer:hv,validator:Ev},Nv={CELL_TYPE:"handsontable",editor:sy,renderer:hv},Iv={CELL_TYPE:"numeric",editor:Ky,renderer:_v,validator:Tv,dataType:"number"},Dv={CELL_TYPE:"password",editor:tv,renderer:Sv,copyable:!1},Pv={CELL_TYPE:"time",editor:Vm,renderer:zm,validator:Mv};function Hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fv=new Map([["plugin",function(e){return!!Wo(e)}],["cell-type",bl],["editor",Mr],["renderer",$o],["validator",ni]]),Yv=new WeakMap,Uv=[],Bv=null,Vv=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Re(this,"hot",t,{writable:!1}),Yv.set(this,{hooks:{}}),Bv=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var t,n,r;return t=e,n=[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var r=[];if(n.forEach((function(e){var t,n,o=(t=e.split(":"),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hv(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];if(!Fv.has(i))throw new Error('Unknown plugin dependency type "'.concat(i,'" was found.'));Fv.get(i)(a)||r.push(" - ".concat(a," (").concat(i,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");Uv.push(o)}}if(Bv||(Bv=Vo()),Bv.indexOf("UndoRedo")>=0&&Bv.splice(Bv.indexOf("UndoRedo"),1),Bv.indexOf(this.pluginName)>=0&&Bv.splice(Bv.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()})),0===Bv.length){if(Uv.length>0){var i=["".concat(Uv.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){Yv.get(this).hooks[e]=Yv.get(this).hooks[e]||[];var n=Yv.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),Yv.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;re(Yv.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=Yv.get(this).hooks;Te(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){re(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Te(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}],r=[{key:"PLUGIN_KEY",get:function(){return"base"}}],n&&jv(t.prototype,n),r&&jv(t,r),e}();function Wv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zv=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}var t,n,r;return t=e,n=[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map,i="number"==typeof n?{from:n,to:n}:n;return yo(i.from,i.to,(function(n){var i=r.generateSample(e,t,n);o.set(n,i)})),o}},{key:"generateSample",value:function(e,t,n){var r=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var o=new Map,i="row"===e?"col":"row",a=[];return yo(t.from,t.to,(function(t){var s,u="row"===e?r.dataFactory(n,t):r.dataFactory(t,n),l=u.value,c=u.bundleSeed,f="string"==typeof c&&c.length>0;s=f?c:ke(l)?"".concat(Object.keys(l).length):Array.isArray(l)?"".concat(l.length):"".concat(ct(l).length),o.has(s)||o.set(s,{needed:r.getSampleCount(),strings:[]});var h=o.get(s);h.needed&&(!(a.indexOf(l)>-1)||r.allowDuplicates||f)&&(h.strings.push(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({value:l},i,t)),a.push(l),h.needed-=1)})),o}}],r=[{key:"SAMPLE_COUNT",get:function(){return 3}}],n&&Wv(t.prototype,n),r&&Wv(t,r),e}();const Gv=zv;function Kv(e){return Kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kv(e)}function Xv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jv(e,t,n){return Jv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Jv(e,t,n||e)}function Qv(e,t){return Qv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qv(e,t)}function Zv(e,t){if(t&&("object"===Kv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eg(e)}function eg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tg(e){return tg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tg(e)}br.getSingleton().register("modifyAutoColumnSizeSeed");var ng=new WeakMap,rg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qv(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=tg(o);if(i){var n=tg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zv(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),ng.set(eg(t),{cachedColumnHeaders:[]}),t.ghostTable=new Qm(t.hot),t.samplesGenerator=new Gv((function(e,n){var r=t.hot.getCellMeta(e,n),o="";r.spanned||(o=t.hot.getDataAtCell(e,n));var i="";return t.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=t.hot.runHooks("modifyAutoColumnSizeSeed",i,r,o)),{value:o,bundleSeed:i}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredColumns=0,t.columnWidthsMap=new rc,t.hot.columnIndexMapper.registerMap("autoColumnSize",t.columnWidthsMap),t.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),t}return t=s,n=[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("afterFormulasValuesUpdate",(function(t){return e.onAfterFormulasValuesUpdate(t)})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyColWidth",(function(t,n){return e.getColumnWidth(n,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),Jv(tg(s.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),Jv(tg(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;Jv(tg(s.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var e=this.hot.renderCall,t=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==t&&-1!==n&&this.calculateColumnsWidth({from:t,to:n},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof n?{from:n,to:n}:n;yo(o.from,o.to,(function(t){var n=e.hot.toPhysicalColumn(t);null===n&&(n=t),(r||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n))&&re(e.samplesGenerator.generateColumnSamples(t,i),(function(t){var n=Xv(t,2),r=n[0],o=n[1];return e.ghostTable.addColumn(r,o)}))})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){e.ghostTable.getWidths((function(t,n){var r=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,r=this.hot.countCols()-1,o=null;this.inProgress=!0;var i=function i(){if(!e.hot)return G(o),void(e.inProgress=!1);e.calculateColumnsWidth({from:n,to:Math.min(n+s.CALCULATION_STEP,r)},t),(n=n+s.CALCULATION_STEP+1)<r?o=B(i):(G(o),e.inProgress=!1,e.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateColumnsWidth({from:0,to:a},t),this.firstCalculation=!1,n=a+1),n<r?i():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&Le(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Le(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoColumnSize,t=s.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return ke(e)&&(Lt(t=e.syncLimit)?t=go(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof r&&(r=Math.max(r,Wu.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=ng.get(this).cachedColumnHeaders;return ee(e,(function(e,n,r){var o=t.length;return(o-1<r||t[r]!==n)&&e.push(r),o-1<r?t.push(n):t[r]=n,e}),[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((function(){re(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!te(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=ne(e,(function(e){var n=Xv(e,2)[1];return t.hot.toPhysicalColumn(t.hot.propToCol(n))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){ng.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(e){var t=ne(te(e,(function(e){var t;return ft(null===(t=e.address)||void 0===t?void 0:t.col)})),(function(e){return e.address.col}));this.clearCache(Array.from(new Set(t)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Jv(tg(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"autoColumnSize"}},{key:"PLUGIN_PRIORITY",get:function(){return 10}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}],n&&qv(t.prototype,n),r&&qv(t,r),s}(Vv),og={horizontal:"horizontal",vertical:"vertical"};function ig(e){return ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ig(e)}function ag(e,t){if(e){if("string"==typeof e)return sg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sg(e,t):void 0}}function sg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ug(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lg(e,t,n){return lg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},lg(e,t,n||e)}function cg(e,t){return cg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},cg(e,t)}function fg(e,t){if(t&&("object"===ig(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hg(e)}function hg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dg(e){return dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dg(e)}br.getSingleton().register("modifyAutofillRange"),br.getSingleton().register("beforeAutofill"),br.getSingleton().register("afterAutofill");var pg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cg(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dg(o);if(i){var n=dg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fg(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(hg(t)),t.addingStarted=!1,t.mouseDownOnCellCorner=!1,t.mouseDragOutside=!1,t.handleDraggedCells=0,t.directions=[],t.autoInsertRow=!1,t}return t=s,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,n){return e.onBeforeCellMouseOver(n)})),lg(dg(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),lg(dg(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),lg(dg(s.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),n=t.getTopLeftCorner(),r=n.row,o=n.col,i=t.getBottomRightCorner(),a=i.row,s=i.col,u=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:a,endCol:s}]),l=[],c=[],f=[];return re(u,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===l.indexOf(t)&&l.push(t);for(var n=e.startCol;n<=e.endCol;n+=1)-1===c.indexOf(n)&&c.push(n)})),re(l,(function(t){var n=[];re(c,(function(r){n.push(e.hot.getCopyableData(t,r))})),f.push(n)})),f}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||ag(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.hot.selection.highlight.getFill().getVisualCorners(),4),t=e[0],n=e[1],r=e[2],o=e[3],i=this.hot.getSelectedRangeLast(),a=i.getTopLeftCorner(),s=i.getBottomRightCorner();this.resetSelectionOfDraggedArea();var u=[a.row,a.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,t),Math.min(a.col,n),Math.max(s.row,r),Math.max(s.col,o)],u),c=function(e,t){var n,r,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",n=new $n(t[0],t[1]),r=new $n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",n=new $n(t[0],e[3]+1),r=new $n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=new $n(t[0],t[1]),r=new $n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=new $n(e[2]+1,t[1]),r=new $n(t[2],t[3])),n&&n.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:r}}(u,l),f=c.directionOfDrag,h=c.startOfDragCoords,d=c.endOfDragCoords;if(h&&h.row>-1&&h.col>-1){var p=this.getSelectionData(),m=i.clone(),y=new kd(h,h,d),v=this.hot.runHooks("beforeAutofill",p,m,y,f);if(!1===v)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var g=function(e,t,n,r){var o=n.length,i=n?n[0].length:0,a=[],s=t.row-e.row,u=t.col-e.col;if(-1!==["down","up"].indexOf(r)){for(var l=[],c=0;c<u;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;l.push(d)}a.push(l)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<s;p++){var m=parseInt(n[p][0],10),y=parseInt(n[p][i-1],10),v=("right"===r?y-m:m-y)/(i-1)||0;a.push([v])}return a}(h,d,p,f),b=v,w=v;if(["up","left"].indexOf(f)>-1&&(1!==w.length||0!==w[0].length))if(b=[],"up"===f)for(var _=d.row-h.row+1,S=_%w.length,E=0;E<_;E++)b.push(w[(E+(w.length-S))%w.length]);else for(var k=d.col-h.col+1,R=k%w[0].length,T=0;T<w.length;T++){b.push([]);for(var C=0;C<k;C++)b[T].push(w[T][(C+(w[T].length-R))%w[T].length])}this.hot.populateFromArray(h.row,h.col,b,d.row,d.col,"".concat(this.pluginName,".fill"),null,f,g),this.setSelection(l),this.hot.runHooks("afterAutofill",b,m,y,f),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomRightCorner(),r=e;if(this.directions.includes(og.vertical)&&this.directions.includes(og.horizontal)){var o=t.getTopLeftCorner();(n.col<=e.col||o.col>=e.col)&&(r=new $n(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(r=new $n(e.row,n.col))}else if(this.directions.includes(og.vertical))r=new $n(e.row,n.col);else{if(!this.directions.includes(og.horizontal))return;r=new $n(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter("insert_row",void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),200)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,n=this.hot.getData(),r=this.hot.countRows(),o=e[2]+1;o<r;o++){for(var i=e[1];i<=e[3];i++)if(n[o][i])return-1;var a=n[o][e[1]-1],s=n[o][e[3]+1];(a||s)&&(t=o)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(new $n(e[0],e[1])).add(new $n(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t,n;(t=this.hot).selectCell.apply(t,(n=ne(e,(function(e){return Math.max(e,0)})),function(e){if(Array.isArray(e))return sg(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||ag(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,n=an(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+vn(this.hot.table),r=an(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+yn(this.hot.table);return e.clientY>n&&e.clientX<=r}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=function(e){var t={};return!0===e?(t.directions=Object.keys(og),t.autoInsertRow=!0):ke(e)?(ft(e.autoInsertRow)?e.direction===og.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ft(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(og)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){lg(dg(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"autofill"}},{key:"PLUGIN_PRIORITY",get:function(){return 20}}],n&&ug(t.prototype,n),r&&ug(t,r),s}(Vv);function mg(e){return mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mg(e)}function yg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vg(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bg(e,t,n){return bg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},bg(e,t,n||e)}function wg(e,t){return wg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wg(e,t)}function _g(e,t){if(t&&("object"===mg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sg(e){return Sg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sg(e)}var Eg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wg(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sg(o);if(i){var n=Sg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _g(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).rowHeightsMap=void 0,t.headerHeight=null,t.ghostTable=new Qm(t.hot),t.samplesGenerator=new Gv((function(e,n){var r;return e>=0?r=t.hot.getDataAtCell(e,n):-1===e&&(r=t.hot.getColHeader(n)),{value:r}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredRows=0,t.rowHeightsMap=new rc,t.hot.rowIndexMapper.registerMap("autoRowSize",t.rowHeightsMap),t.addHook("beforeRowResize",(function(e,n,r){return t.onBeforeRowResize(e,n,r)})),t}return t=s,n=[{key:"isEnabled",value:function(){var e=this.hot.getSettings().autoRowSize;return!0===e||ke(e)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),bg(Sg(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,bg(Sg(s.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,n,r){return e.onBeforeRowResize(t,n,r)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}yo(o.from,o.to,(function(t){(r||null===e.rowHeightsMap.getValueAtIndex(t))&&re(e.samplesGenerator.generateRowSamples(t,i),(function(t){var n=yg(t,2),r=n[0],o=n[1];return e.ghostTable.addRow(r,o)}))})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,r=this.hot.countRows()-1,o=null;this.inProgress=!0;var i=function i(){if(!e.hot)return G(o),void(e.inProgress=!1);e.calculateRowsHeight({from:n,to:Math.min(n+s.CALCULATION_STEP,r)},t),(n=n+s.CALCULATION_STEP+1)<r?o=B(i):(G(o),e.inProgress=!1,e.hot.view.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateRowsHeight({from:0,to:a},t),this.firstCalculation=!1,n=a+1),n<r?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&Le(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Le(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){on(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoRowSize,t=s.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return ke(e)&&(Lt(t=e.syncLimit)?t=go(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==n&&n>(t||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"==typeof e?{from:e,to:e}:e,r=n.from,o=n.to;this.hot.batchExecution((function(){yo(Math.min(r,o),Math.max(r,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!te(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),bg(Sg(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"autoRowSize"}},{key:"PLUGIN_PRIORITY",get:function(){return 40}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}],n&&gg(t.prototype,n),r&&gg(t,r),s}(Vv),kg=new Map([["indexesSequence",{getListWithInsertedItems:dc,getListWithRemovedItems:pc}],["physicallyIndexed",{getListWithInsertedItems:Xl,getListWithRemovedItems:$l}]]),Rg=function(e){if(!1===kg.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return kg.get(e)};function Tg(e){return Tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tg(e)}function Cg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mg(e,t,n){return Mg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Mg(e,t,n||e)}function Og(e,t){return Og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Og(e,t)}function Ag(e,t){if(t&&("object"===Tg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lg(e){return Lg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lg(e)}var xg=Rg("physicallyIndexed"),Ng=xg.getListWithInsertedItems,Ig=xg.getListWithRemovedItems,Dg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Og(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lg(r);if(o){var n=Lg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ag(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,(function(e){return e}))}return t=a,(n=[{key:"insert",value:function(e,t){var n=yc(this.indexedValues,t);this.indexedValues=Ng(n,e,t,this.initValueOrFn),Mg(Lg(a.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Ig(this.indexedValues,e);this.indexedValues=mc(t,e),Mg(Lg(a.prototype),"remove",this).call(this,e)}}])&&Cg(t.prototype,n),a}(zl);const Pg=Dg;function Hg(e){return Hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hg(e)}function jg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yg(e,t,n){return Yg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Yg(e,t,n||e)}function Ug(e,t){return Ug=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ug(e,t)}function Bg(e,t){if(t&&("object"===Hg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vg(e)}var Wg=Rg("physicallyIndexed"),zg=Wg.getListWithInsertedItems,Gg=Wg.getListWithRemovedItems,Kg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ug(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vg(r);if(o){var n=Vg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Bg(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,(function(e){return e}))}return t=a,(n=[{key:"insert",value:function(e,t){var n=this;this.indexedValues=zg(this.indexedValues,e,t,(function(e,t){return n.getNextValue(t)})),Yg(Vg(a.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Gg(this.indexedValues,e),Yg(Vg(a.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,function(e){if(Array.isArray(e))return jg(e)}(t=this.getValues())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return jg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jg(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())+1+e;var t}}])&&Fg(t.prototype,n),a}(zl);function Xg(e){return Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(e)}function $g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qg(e,t,n){return qg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},qg(e,t,n||e)}function Jg(e,t){return Jg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Jg(e,t)}function Qg(e,t){if(t&&("object"===Xg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zg(e)}var eb=new Map([["loose",Pg],["strict",Kg]]),tb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jg(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zg(o);if(i){var n=Zg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qg(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).headerIndexes=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t="loose");var n=eb.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),qg(Zg(s.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),qg(Zg(s.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){qg(Zg(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"bindRowsWithHeaders"}},{key:"PLUGIN_PRIORITY",get:function(){return 210}}],n&&$g(t.prototype,n),r&&$g(t,r),s}(Vv);function nb(e){return nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nb(e)}function rb(e){return function(e){if(Array.isArray(e))return ob(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ob(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ob(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ob(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ib(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ab(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sb(e,t,n){return sb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fb(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},sb(e,t,n||e)}function ub(e,t){return ub=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ub(e,t)}function lb(e,t){if(t&&("object"===nb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return cb(e)}function cb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fb(e){return fb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fb(e)}function hb(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function db(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pb(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,yb(e,t,"get"))}function mb(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,yb(e,t,"set"),n),n}function yb(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var vb=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),gb=new WeakMap,bb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ub(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fb(o);if(i){var n=fb(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return lb(this,e)});function s(){var e;ib(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return db(cb(e=a.call.apply(a,[this].concat(n))),"nestedHeadersPlugin",null),db(cb(e),"eventManager",new Fr(cb(e))),db(cb(e),"headerStateManager",null),hb(cb(e),gb,{writable:!0,value:null}),e}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.getSettings().nestedHeaders||ur("You need to configure the Nested Headers plugin in order to use collapsible headers."),mb(this,gb,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)})),sb(fb(s.prototype),"enablePlugin",this).call(this),this.updatePlugin())}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings().collapsibleColumns;"boolean"==typeof e?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(e)&&this.headerStateManager.mergeStateWith(e)}sb(fb(s.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),mb(this,gb,null),this.nestedHeadersPlugin=null,this.clearButtons(),sb(fb(s.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};yo(0,e-1,(function(e){var i=t.childNodes[e],a=n.childNodes[e],s=r?r.childNodes[e]:null;yo(0,i.childNodes.length-1,(function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".collapsibleIndicator"),o(t)),r&&s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(".collapsibleIndicator"),o(t))}))}))}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.headerStateManager.mapNodes((function(e){var n=e.collapsible,r=e.origColspan,o=e.headerLevel,i=e.columnIndex;if(!0===n&&r>1)return{row:t.headerStateManager.levelToRowCoords(o),col:i}}));this.toggleCollapsibleSection(n,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;if(!vb.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var r=te(e,(function(e){return e.row<0})),o=r.length>0;re(r,(function(e){var r,i=e.row,a=e.col,s=null!==(r=n.headerStateManager.getHeaderSettings(i,a))&&void 0!==r?r:{},u=s.collapsible,l=s.isCollapsed;if(!u||l&&"collapse"===t||!l&&"expand"===t)return o=!1,!1}));var i=[],a=[];o&&re(r,(function(e){var r=e.row,o=e.col,s=n.headerStateManager.triggerNodeModification(t,r,o),u=s.colspanCompensation,l=s.affectedColumns,c=s.rollbackModification;u>0&&(a.push.apply(a,rb(l)),i.push(c))}));var s=this.getCollapsedColumns(),u=[];"collapse"===t?u=le([].concat(rb(s),a)):"expand"===t&&(u=te(s,(function(e){return!a.includes(e)})));var l=vb.get(t);if(!1!==this.hot.runHooks(l.beforeHook,s,u,o)){this.hot.batchExecution((function(){re(a,(function(e){pb(n,gb).setValueAtIndex(n.hot.toPhysicalColumn(e),l.hideColumn)}))}),!0);var c=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(l.afterHook,s,u,o,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else re(i,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return pb(this,gb).getHiddenIndexes()}},{key:"generateIndicator",value:function(e,t){var n=this.hot.rootDocument.createElement("div"),r=this.headerStateManager.getHeaderSettings(e,t);return qt(n,"collapsibleIndicator"),r.isCollapsed?(qt(n,"collapsed"),rn(n,"+")):(qt(n,"expanded"),rn(n,"-")),n}},{key:"onAfterGetColHeader",value:function(e,t){var n,r=t.parentNode,o=r.parentNode,i=-1*o.childNodes.length+Array.prototype.indexOf.call(o.childNodes,r),a=null!==(n=this.headerStateManager.getHeaderSettings(i,e))&&void 0!==n?n:{},s=a.collapsible,u=a.origColspan;if(s&&u>1&&e>=this.hot.getSettings().fixedColumnsLeft){var l=this.generateIndicator(i,e);t.querySelector("div:first-child").appendChild(l)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){$t(e.target,"collapsibleIndicator")&&($t(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):$t(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),or(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){mb(this,gb,null),sb(fb(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"collapsibleColumns"}},{key:"PLUGIN_PRIORITY",get:function(){return 290}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}}],n&&ab(t.prototype,n),r&&ab(t,r),s}(Vv);function wb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Eb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eb(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rb=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Tb=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.sortingStates=new Cc,this.sortEmptyCells=!1,this.indicator=!0,this.headerAction=!0,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}var t,n;return t=e,n=[{key:"updateAllColumnsProperties",value:function(e){var t=this;ke(e)&&Te(e,(function(e,n){Rb.includes(n)&&(t[n]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((function(t){return Sb(t,1)[0]===e}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return ke(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;return null===this.sortingStates?[]:this.sortingStates.getEntries().map((function(t){var n=Sb(t,2),r=n[0],o=n[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wb(Object(n),!0).forEach((function(t){_b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({column:e.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(e){var t=this.getSortOrderOfColumn(e);if(ft(t))return{column:e,sortOrder:t}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}],n&&kb(t.prototype,n),e}(),Cb="asc",Mb="desc";function Ob(e){if(e!==Mb)return e===Cb?Mb:Cb}function Ab(e){return e.querySelector(".".concat("colHeader"))}function Lb(e,t){if(e<0||!t.parentNode)return!1;var n=t.parentNode.parentNode.childNodes;return-1==Array.from(n).indexOf(t.parentNode)-n.length}function xb(e,t,n){return-1===e&&t>=0&&!1===ar(n)}var Nb="indicatorDisabled",Ib="columnSorting",Db="sortAction",Pb=new Map([[Cb,"ascending"],[Mb,"descending"]]);function Hb(e,t,n,r){var o=[Ib];if(r&&o.push(Db),!1===n)return o.push(Nb),o;var i=e.getSortOrderOfColumn(t);return ft(i)&&o.push(Pb.get(i)),o}function jb(){return Array.from(Pb.values()).concat(Db,Nb,Ib)}function Fb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ub=function e(t){Yb(this,e),this.data=t,this.next=null,this.prev=null};const Bb=function(){function e(){Yb(this,e),this.first=null,this.last=null}var t,n;return t=e,(n=[{key:"push",value:function(e){var t=new Ub(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.last;this.last=t,t.prev=n,n.next=t}}},{key:"unshift",value:function(e){var t=new Ub(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.first;this.first=t,t.next=n,n.prev=t}}},{key:"inorder",value:function(e){for(var t=this.first;t;)e(t),t=t.next}},{key:"remove",value:function(e){if(null===this.first)return!1;for(var t,n,r=this.first;r;){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,t=this.first;;){if(null===e)return!1;if(null===(e=e.next))return!1;if((e=e.next)===(t=t.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){if(this.first){!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var e,t=this.first.next,n=this.first;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}}}])&&Fb(t.prototype,n),e}();var Vb=function(e,t){var n=e.toString(),r=t.toString();return n===r?0:n<r?-1:1};function Wb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vb,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(r-n)<=1)return[];var o=Math.ceil((n+r)/2);return Wb(e,t,n,o),Wb(e,t,o,r),zb(e,t,n,o,r)}function zb(e,t,n,r,o){for(var i=new Bb,a=new Bb,s=r-n,u=o-r,l=Math.max(s,u),c=o-n,f=0;f<l;f+=1)f<s&&i.push(e[n+f]),f<u&&a.push(e[r+f]);for(var h=0;h<c;)i.first&&a.first?t(i.first.data,a.first.data)>0?e[n+h]=a.shift().data:e[n+h]=i.shift().data:i.first?e[n+h]=i.shift().data:e[n+h]=a.shift().data,h+=1;return e}var Gb=-1;function Kb(e,t,n){return function(t,r){var o=n.sortEmptyCells;return"string"==typeof t&&(t=t.toLowerCase()),"string"==typeof r&&(r=r.toLowerCase()),t===r?0:dt(t)?dt(r)?0:o&&"asc"===e?Gb:1:dt(r)?o&&"asc"===e?1:Gb:isNaN(t)&&!isNaN(r)?"asc"===e?1:Gb:!isNaN(t)&&isNaN(r)?"asc"===e?Gb:1:(isNaN(t)||isNaN(r)||(t=parseFloat(t),r=parseFloat(r)),t<r?"asc"===e?Gb:1:t>r?"asc"===e?1:Gb:0)}}var Xb="default",$b=Er("sorting.compareFunctionFactory"),qb=$b.register,Jb=$b.getItem,Qb=$b.hasItem,Zb=Er("sorting.mainSortComparator"),ew=Zb.register,tw=Zb.getItem;function nw(e){return Qb(e)?Jb(e):Jb(Xb)}function rw(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ow(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ow(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ow(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iw(e){return iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iw(e)}qb("numeric",(function(e,t,n){return function(t,r){var o=parseFloat(t),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return 0;if(a){if(dt(t))return"asc"===e?Gb:1;if(dt(r))return"asc"===e?1:Gb}return isNaN(o)?1:isNaN(i)?Gb:o<i?"asc"===e?Gb:1:o>i?"asc"===e?1:Gb:0}})),qb("checkbox",(function(e,t,n){var r=t.checkedTemplate,o=t.uncheckedTemplate,i=n.sortEmptyCells;return function(t,a){var s=dt(t),u=dt(a),l=s?o:t,c=u?o:a,f=l===o||l===r,h=c===o||c===r;if(!1===i){if(s&&!1===u)return 1;if(!1===s&&u)return Gb}return!1===f&&h?"asc"===e?Gb:1:f&&!1===h?"asc"===e?1:Gb:!1===f&&!1===h?Kb(e,0,n)(t,a):l===o&&c===r?"asc"===e?Gb:1:l===r&&c===o?"asc"===e?1:Gb:0}})),qb("date",(function(e,t,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return 0;if(dt(r))return dt(o)?0:i&&"asc"===e?Gb:1;if(dt(o))return i&&"asc"===e?1:Gb;var a=t.dateFormat,s=at(r,a),u=at(o,a);return s.isValid()?u.isValid()?u.isAfter(s)?"asc"===e?Gb:1:u.isBefore(s)?"asc"===e?1:Gb:0:Gb:1}})),qb(Xb,Kb);var aw=["column"],sw=["column"];function uw(e){return function(e){if(Array.isArray(e))return lw(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return lw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lw(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cw(Object(n),!0).forEach((function(t){hw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dw(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function pw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mw(e,t,n){return mw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},mw(e,t,n||e)}function yw(e,t){return yw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yw(e,t)}function vw(e,t){if(t&&("object"===iw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gw(e){return gw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gw(e)}var bw="columnSorting",ww="append",_w="replace";ew(bw,(function(e,t){return function(n,r){var o=rw(n).slice(1),i=rw(r).slice(1);return function(n){var r=e[0],a=t[0],s=o[0],u=i[0],l=a.columnSorting;return(l.compareFunctionFactory?l.compareFunctionFactory:nw(a.type))(r,a,l)(s,u)}()}})),br.getSingleton().register("beforeColumnSort"),br.getSingleton().register("afterColumnSort");var Sw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yw(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gw(o);if(i){var n=gw(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vw(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).columnStatesManager=null,t.columnMetaCache=null,t.pluginKey=bw,t.indexesSequenceCache=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnStatesManager=new Tb(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new rc((function(t){var n=e.hot.toVisualColumn(t);return null===n&&(n=t),e.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(t,n){return e.onAfterOnCellMouseDown(t,n)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(t,n){return e.onAfterLoadData(n)})),this.hot.view&&this.loadOrSortBySettings(),mw(gw(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,n){var r=Ab(n);!1!==Lb(t,n)&&null!==r&&e.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,mw(gw(s.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Bc),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){return ft(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(e){var t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}},{key:"areValidSortConfigs",value:function(e){var t=this.hot.countCols();return function(e){if(e.some((function(e){return!1===function(e){if(!1===ke(e))return!1;var t=e.column,n=e.sortOrder;return Number.isInteger(t)&&[Cb,Mb].includes(n)}(e)})))return!1;var t=e.map((function(e){return e.column}));return new Set(t).size===t.length}(e)&&e.every((function(e){var n=e.column;return n<=t&&n>=0}))}},{key:"saveAllSortSettings",value:function(e){var t=this,n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=ne(e,(function(e){var n=e.column,r=dw(e,aw);return fw({column:t.hot.toPhysicalColumn(n)},r)})),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var n=t.value;return ft(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=ne(n.initialConfig,(function(t){var n=t.column,r=dw(t,sw);return fw({column:e.hot.toVisualColumn(n)},r)}))),n}},{key:"getColumnNextConfig",value:function(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);if(ft(t)){var n=Ob(t);return ft(n)?{column:e,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:Ob()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ww,n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,o=this.getSortConfig(),i=this.getColumnNextConfig(e);if(r){if(ht(i))return[].concat(uw(o.slice(0,n)),uw(o.slice(n+1)));if(t===ww)return[].concat(uw(o.slice(0,n)),uw(o.slice(n+1)),[i]);if(t===_w)return[].concat(uw(o.slice(0,n)),[i],uw(o.slice(n+1)))}return ft(i)?o.concat(i):o}},{key:"getPluginColumnConfig",value:function(e){if(ke(e)){var t=e[this.pluginKey];if(ke(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):jn(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(e){var t=this;if(0!==e.length){for(var n=[],r=this.hot.countRows(),o=function(n){return ne(e,(function(e){return t.hot.getDataAtCell(n,e.column)}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)n.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=ne(n,(function(e){return e[0]}));!function(e,t){for(var n=tw(t),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];Wb(e,n.apply(void 0,o))}(n,this.pluginKey,ne(e,(function(e){return e.sortOrder})),ne(e,(function(e){return t.getFirstCellSettings(e.column)})));for(var s=n.length;s<r;s+=1)n.push([s].concat(o(s)));var u=ne(n,(function(e){return e[0]})),l=new Map(ne(a,(function(e,t){return[e,u[t]]}))),c=ne(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return l.has(e)?l.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(c)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(ke(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(ke(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||ke(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var n=Ab(t);if(!1!==Lb(e,t)&&null!==n){var r=this.getFirstCellSettings(e)[this.pluginKey],o=r.indicator,i=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,o,i)}}},{key:"updateHeaderClasses",value:function(e){if(Jt(e,jb()),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];qt(e,Hb.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(e){mw(gw(s.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ft(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){!1!==xb(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&pd()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==xb(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(pd()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),mw(gw(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return bw}},{key:"PLUGIN_PRIORITY",get:function(){return 50}}],n&&pw(t.prototype,n),r&&pw(t,r),s}(Vv);function Ew(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(56660);var kw=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}var t,n;return t=e,n=[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[],r=e;if(r||"function"!=typeof this.settings)return r||(r=this.settings),re(r,(function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n){if("function"===this.settingsType){var r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();re(o,(function(o){"row"===r&&o.destinationRow>=t&&("insert_row"===e?o.alterRowOffset=n:"remove_row"===e&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=t&&("insert_col"===e?o.alterColumnOffset=n:"remove_col"===e&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var s=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),c=0===e.indexOf("move_row"),f=t;re(l,(function(e){"row"===s&&e.destinationRow>=f&&(e.alterRowOffset=u*n),"col"===s&&e.destinationColumn>=f&&(e.alterColumnOffset=u*n)})),this.resetAllEndpoints(l,!c),re(l,c?function(e){i.extendEndpointRanges(e,f,r[0],r.length),i.recreatePhysicalRanges(e),i.clearOffsetInformation(e)}:function(e){i.shiftEndpointCoordinates(e,f)}),a&&this.refreshAllEndpoints()}else{var h=function e(){return i.hot.removeHook("beforeViewRender",e),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",h)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,r){re(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,r=[],o=[];re(n,(function(e){var n=[];if(e[1])for(var r=e[0];r<=e[1];r++)n.push(t.hot.toPhysicalRow(r));else n.push(t.hot.toPhysicalRow(e[0]));o.push(n)})),re(o,(function(e){var t=[];re(e,(function(n,o){0===o?t.push(n):e[o]!==e[o-1]+1&&(t.push(e[o-1]),r.push(t),(t=[]).push(n)),o===e.length-1&&(t.push(n),r.push(t))}))})),e.ranges=r}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,re(e.ranges,(function(n){re(n,(function(r,o){r>=t&&(n[o]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.some((function(t){var n=t.alterRowOffset||0,r=t.alterColumnOffset||0;return t.destinationRow+n>=e.hot.countRows()||t.destinationColumn+r>=e.hot.countCols()}));r||(this.cellsToSetCache=[],re(t,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],re(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],re(e,(function(e,r,o){"".concat(e[2]||"")!=="".concat(e[3])&&re(t.getAllEndpoints(),(function(e,i){t.hot.propToCol(o[r][1])===e.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),re(n,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0,o=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],i=o[0],a=o[1];if(null!==a&&null!==i){var s=this.hot.getCellMeta(i,a);s.readOnly=!1,s.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}},{key:"setEndpointValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var a=this.hot.toVisualRow(e.destinationRow+r);if(null!==a){var s=this.hot.getCellMeta(a,e.destinationColumn+o);"init"!==t&&s.readOnly===e.readOnly||(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){ur("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}],n&&Ew(t.prototype,n),e}();const Rw=kw;function Tw(e){return Tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tw(e)}var Cw;function Mw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ow(e,t,n){return Ow="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Ow(e,t,n||e)}function Aw(e,t){return Aw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Aw(e,t)}function Lw(e,t){if(t&&("object"===Tw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xw(e){return xw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xw(e)}var Nw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aw(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xw(o);if(i){var n=xw(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Lw(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).endpoints=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new Rw(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,r)})),this.addHook("beforeCreateCol",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,r)})),this.addHook("afterCreateCol",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),Ow(xw(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}},{key:"calculateSum",value:function(e){var t=this,n=0;return Te(e.ranges,(function(r){n+=t.getPartialSum(r,e.sourceColumn)})),n}},{key:"getPartialSum",value:function(e,t){var n=0,r=e[1]||e[0],o=null,i=0;do{o=this.getCellValue(r,t)||0;var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a),n+=o||0,r-=1}while(r>=e[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(e,t){var n=this,r=null;return Te(e.ranges,(function(o){var i=n.getPartialMinMax(o,e.sourceColumn,t);if(null===r&&null!==i&&(r=i),null!==i)switch(t){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i)}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(e,t,n){var r,o=null,i=e[1]||e[0];do{if(r=this.getCellValue(i,t)||null,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}i-=1}while(i>=e[0]);return o}},{key:"countEmpty",value:function(e,t){var n=0,r=e[1]||e[0];do{this.getCellValue(r,t)||(n+=1),r-=1}while(r>=e[0]);return n}},{key:"countEntries",value:function(e){var t=this,n=0;return Te(e.ranges,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=t.countEmpty(r,e.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(e){return this.calculateSum(e)/this.countEntries(e)}},{key:"getCellValue",value:function(e,t){var n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t),o=this.hot.getSourceDataAtCell(e,t),i="";if(null!==n&&null!==r&&(i=this.hot.getCellMeta(n,r).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(st(Cw||(Cw=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,t));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}],r=[{key:"PLUGIN_KEY",get:function(){return"columnSummary"}},{key:"PLUGIN_PRIORITY",get:function(){return 220}}],n&&Mw(t.prototype,n),r&&Mw(t,r),s}(Vv);function Iw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dw=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=null,this.rootDocument=t,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}var t,n,r;return t=e,n=[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var n=this.getInputElement();n.style.width="".concat(e,"px"),n.style.height="".concat(t,"px")}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){this.getInputElement().readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.createElement("div"),qt(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),qt(t,e.CLASS_EDITOR),qt(n,e.CLASS_INPUT),t.appendChild(n),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],r=[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}],n&&Iw(t.prototype,n),r&&Iw(t,r),e}();const Pw=Dw;var Hw="---------";function jw(e){return $t(e,"htSeparator")}function Fw(e){return $t(e,"htDisabled")}function Yw(e){return $t(e,"htSelectionDisabled")}function Uw(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function Bw(e,t){var n={};return re(e,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))}))})),n}function Vw(e,t,n,r,o){re(e,(function(e){e.forAll((function(e,i){e>=0&&i>=0&&function(e,t,n,r,o,i){var a=o(e,t),s=r;a.className&&(s="vertical"===n?function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}(a.className,r):function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}(a.className,r)),i(e,t,"className",s)}(e,i,t,n,r,o)}))}))}function Ww(e,t){var n=!1;return Array.isArray(e)&&re(e,(function(e){return e.forAll((function(e,r){if(e>=0&&r>=0&&t(e,r))return n=!0,!1})),n})),n}function zw(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Gw(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}function Kw(e,t){var n=e.slice(0);return n.reverse(),(n=Gw(n,t)).reverse(),n}function Xw(e){var t=[];return re(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function $w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qw=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}var t,n;return t=e,n=[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),250)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Un((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}],n&&$w(t.prototype,n),e}();Se(qw,Bl);const Jw=qw;function Qw(e){return Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qw(e)}function Zw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t_(e,t,n){return t_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},t_(e,t,n||e)}function n_(e,t){return n_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n_(e,t)}function r_(e,t){if(t&&("object"===Qw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o_(e)}function o_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i_(e){return i_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i_(e)}var a_=new WeakMap,s_="comment",u_="value",l_="style",c_="readOnly",f_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n_(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=i_(o);if(i){var n=i_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return r_(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).editor=null,t.displaySwitch=null,t.eventManager=null,t.range={},t.mouseDown=!1,t.contextMenuEvent=!1,t.timer=null,a_.set(o_(t),{tempEditorDimensions:{},cellBelowCursor:null}),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new Pw(this.hot.rootDocument)),this.eventManager||(this.eventManager=new Fr(this)),this.displaySwitch||(this.displaySwitch=new Jw(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,n,r,o,i,a){return e.onAfterRenderer(t,a)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.onAfterBeginEditing()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,n){return e.showAtCell(t,n)})),this.registerListeners(),t_(i_(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),t_(i_(s.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){t_(i_(s.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=Ut(e.target,"TD","TBODY");return!!(t&&$t(t,"htCommentCell")&&Ut(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!=e?n=e:null!=t&&(n=t);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,Zw({},u_,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:new $n(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,s_),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new $n(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,u_)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,u_)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,n=e.col;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;var r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(r.comment?r.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:new $n(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,i=r.columnIndexMapper,a=this.range.from,s=a.row,u=a.col,l=o.getRenderableFromVisualIndex(s),c=i.getRenderableFromVisualIndex(u),f=null===l;null===l&&(l=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(s,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(u,-1)));var h=null===l,d=null===c;l=null!==(e=l)&&void 0!==e?e:0,c=null!==(t=c)&&void 0!==t?t:0;var p=this.hot,m=p.rootWindow,y=p.view.wt,v=y.wtTable,g=y.wtOverlays,b=y.wtViewport,w=g.scrollableElement,_=v.getCell({row:l,col:c}),S=an(_),E=d?0:v.getStretchedColumnWidth(c),k=f&&!h?vn(_):0,R=S.top,T=S.left;b.hasVerticalScroll()&&w!==m&&(R-=g.topOverlay.getScrollPosition()),b.hasHorizontalScroll()&&w!==m&&(T-=g.leftOverlay.getScrollPosition());var C=T+E,M=R+k,O=this.getCommentMeta(s,u,l_),A=this.getCommentMeta(s,u,c_);O?this.editor.setSize(O.width,O.height):this.editor.resetSize(),this.editor.setReadOnlyState(A),this.editor.setPosition(C,M)}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,n=e.getTopLeftCorner();return this.getCommentMeta(n.row,n.col,u_)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var r,o=this.hot.getCellMeta(e,t).comment;o?be(r=we(o),n):r=n,this.hot.setCellMeta(e,t,s_,r)}},{key:"getCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r.comment)return r.comment[n]}},{key:"onMouseDown",value:function(e){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=Ut(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.view.wt.wtTable.getCoords(t),n={row:this.hot.rowIndexMapper.getVisualFromRenderableIndex(n.row),col:this.hot.columnIndexMapper.getVisualFromRenderableIndex(n.col)}),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(e){var t=a_.get(this),n=this.hot.rootDocument;if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),!(this.mouseDown||this.editor.isFocused()||$t(e.target,"wtBorder")||t.cellBelowCursor!==e.target)&&this.editor)if(this.targetIsCellWithComment(e)){var r=this.hot.view.wt.wtTable.getCoords(e.target),o={from:new $n(this.hot.rowIndexMapper.getVisualFromRenderableIndex(r.row),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r.col))};this.displaySwitch.show(o)}else Vt(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(e,t){t.comment&&t.comment.value&&qt(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){a_.get(this).tempEditorDimensions={width:yn(e.target),height:vn(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=a_.get(this),n=yn(e.target),r=vn(e.target);n===t.tempEditorDimensions.width+1&&r===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,Zw({},l_,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var e=this;this.displaySwitch.cancelHiding();var t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:t.highlight}),this.show(),setTimeout((function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())}),10)}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,n){t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,n){if(t>=0&&n>=0){var r=!!e.getCommentMeta(t,n,c_);e.updateCommentMeta(t,n,Zw({},c_,!r))}}))}},{key:"addToContextMenu",value:function(e){var t=this,n=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(Gf):t.hot.getTranslatedPhrase(zf)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(Kf)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,t=this.getTranslatedPhrase(Xf),n=Ww(this.getSelectedRangeLast(),(function(t,n){var r=e.getCellMeta(t,n).comment;if(r&&(r=r.readOnly),r)return!0}));return n&&(t=zw(t)),t},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner()&&t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings().comments;if(ke(e))return e.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),t_(i_(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"comments"}},{key:"PLUGIN_PRIORITY",get:function(){return 60}}],n&&e_(t.prototype,n),r&&e_(t,r),s}(Vv);function h_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d_(e,t){var n;return re(t,(function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}const p_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.commands={},this.commonCallback=null}var t,n;return t=e,n=[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=e.split(":"),a=i[0],s=2===i.length?i[1]:null,u=this.commands[a];if(!u)throw new Error("Menu command '".concat(a,"' not exists."));if(s&&u.submenu&&(u=d_(s,u.submenu.items)),!0!==u.disabled&&("function"!=typeof u.disabled||!0!==u.disabled.call(this.hot))&&!Le(u,"submenu")){var l=[];"function"==typeof u.callback&&l.push(u.callback),"function"==typeof this.commonCallback&&l.push(this.commonCallback),r.unshift(i.join(":")),re(l,(function(e){return e.apply(t.hot,r)}))}}}],n&&h_(t.prototype,n),e}();var m_="alignment",y_="clear_column",v_="col_left",g_="col_right",b_="make_read_only",w_="redo";function __(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S_="remove_col";function E_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k_,R_="remove_row",T_="row_above",C_="row_below",M_="no_items",O_="undo";function A_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L_=[T_,C_,v_,g_,y_,R_,S_,O_,w_,b_,m_,Hw,M_],x_=(A_(k_={},Hw,(function(){return{name:Hw}})),A_(k_,M_,(function(){return{key:M_,name:function(){return this.getTranslatedPhrase(Mf)},disabled:!0,isCommand:!1}})),A_(k_,T_,(function(){return{key:T_,name:function(){return this.getTranslatedPhrase(Of)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;n||(r=t[Math.max(t.length-1,0)].start.row),this.alter("insert_row",r,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){return!Uw(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),A_(k_,C_,(function(){return{key:C_,name:function(){return this.getTranslatedPhrase(Af)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(n)r=this.countRows();else{var o,i=t[Math.max(t.length-1,0)],a=null==i||null===(o=i.end)||void 0===o?void 0:o.row;r=ft(a)?a+1:0}this.alter("insert_row",r,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){return!Uw(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),A_(k_,v_,(function(){return{key:v_,name:function(){return this.getTranslatedPhrase(Lf)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;n||(r=t[Math.max(t.length-1,0)].start.col),this.alter("insert_col",r,1,"ContextMenu.columnLeft"),n&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||!Uw(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}})),A_(k_,g_,(function(){return{key:g_,name:function(){return this.getTranslatedPhrase(xf)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(n)r=this.countCols();else{var o,i=t[Math.max(t.length-1,0)],a=null==i||null===(o=i.end)||void 0===o?void 0:o.col;r=ft(a)?a+1:0}this.alter("insert_col",r,1,"ContextMenu.columnRight"),n&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||!Uw(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}})),A_(k_,y_,(function(){return{key:y_,name:function(){return this.getTranslatedPhrase(jf)},callback:function(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){return!Uw(this)||!this.selection.isSelectedByColumnHeader()}}})),A_(k_,R_,(function(){return{key:R_,name:function(){var e,t,n=this.getSelected(),r=0;if(n)if(n.length>1)r=1;else{var o=(e=n[0],t=3,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return E_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o[0]-o[2]!=0&&(r=1)}return this.getTranslatedPhrase(Nf,r)},callback:function(){this.alter("remove_row",function(e){var t=Yp(e);if(0===t||1===t)return[];var n=Up(t),r=new Set;re(e,(function(e){var t=xp(n(e),3),o=t[0],i=t[2],a=Math.max(o,0),s=i-a+1;re(Array.from(new Array(s),(function(e,t){return a+t})),(function(e){r.has(e)||r.add(e)}))}));var o=Array.from(r).sort((function(e,t){return e-t})),i=ee(o,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return i}(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!Uw(this))return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}})),A_(k_,S_,(function(){return{key:S_,name:function(){var e,t,n=this.getSelected(),r=0;if(n)if(n.length>1)r=1;else{var o=(e=n[0],t=4,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return __(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?__(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o[1]-o[3]!=0&&(r=1)}return this.getTranslatedPhrase(If,r)},callback:function(){this.alter("remove_col",function(e){var t=Yp(e);if(0===t||1===t)return[];var n=Up(t),r=new Set;re(e,(function(e){var t=xp(n(e),4),o=t[1],i=t[3],a=Math.max(o,0),s=i-a+1;re(Array.from(new Array(s),(function(e,t){return a+t})),(function(e){r.has(e)||r.add(e)}))}));var o=Array.from(r).sort((function(e,t){return e-t})),i=ee(o,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return i}(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!Uw(this))return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}})),A_(k_,O_,(function(){return{key:O_,name:function(){return this.getTranslatedPhrase(Df)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}})),A_(k_,w_,(function(){return{key:w_,name:function(){return this.getTranslatedPhrase(Pf)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}})),A_(k_,b_,(function(){return{key:b_,name:function(){var e=this,t=this.getTranslatedPhrase(Hf),n=Ww(this.getSelectedRange(),(function(t,n){return e.getCellMeta(t,n).readOnly}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Ww(t,(function(t,n){return e.getCellMeta(t,n).readOnly}));re(t,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}})),A_(k_,m_,(function(){return{key:m_,name:function(){return this.getTranslatedPhrase($f)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(m_,":left"),name:function(){var e=this,t=this.getTranslatedPhrase(qf),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(m_,":center"),name:function(){var e=this,t=this.getTranslatedPhrase(Jf),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(m_,":right"),name:function(){var e=this,t=this.getTranslatedPhrase(Qf),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(m_,":justify"),name:function(){var e=this,t=this.getTranslatedPhrase(Zf),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{name:Hw},{key:"".concat(m_,":top"),name:function(){var e=this,t=this.getTranslatedPhrase(eh),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(m_,":middle"),name:function(){var e=this,t=this.getTranslatedPhrase(th),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(m_,":bottom"),name:function(){var e=this,t=this.getTranslatedPhrase(nh),n=Ww(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return n&&(t=zw(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=Bw(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,t,r,o),Vw(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1}]}}})),k_);function N_(){var e={};return Te(x_,(function(t,n){e[n]=t()})),e}function I_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;I_(this,e),this.hot=t,this.predefinedItems=N_(),this.defaultOrderPattern=n}var t,n;return t=e,n=[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,Te(e,(function(e,r){var o="";e.name===Hw?(n[Hw]=e,o=Hw):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return H_(e,this.defaultOrderPattern,this.predefinedItems)}}],n&&D_(t.prototype,n),e}();function H_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),ke(o)?Te(o,(function(e,t){var o=n["string"==typeof e?e:t];o||(o=e),ke(e)?ge(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)})):re(o,(function(e,t){var o=n[e];!o&&L_.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),ke(e)&&ge(o,e),void 0===o.key&&(o.key=t),r.push(o))})),r}const j_=P_;function F_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Y_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r,o,i,a,s,u,l=sn(n),c=un(n);this.rootWindow=n,this.type=this.getSourceType(t),"literal"===this.type?(r=parseInt(t.top,10),i=parseInt(t.left,10),s=t.height||0,u=t.width||0,o=r,a=i,r+=l,i+=c):"event"===this.type&&(r=parseInt(t.pageY,10),i=parseInt(t.pageX,10),s=t.target.clientHeight,u=t.target.clientWidth,o=r-l,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=l,this.scrollLeft=c,this.cellHeight=s,this.cellWidth=u}var t,n;return t=e,n=[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}},{key:"fitsOnRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}],n&&F_(t.prototype,n),e}();const U_=Y_;function B_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new Fr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var t,n;return t=e,n=[{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=Ft(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Un((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||215,r=!1,o=te(this.menuItems,(function(t){return t.key===M_&&(r=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(t,e.hot)}));if(o.length<1&&!r)o.push(N_().no_items);else if(0===o.length)return;o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hw,n=e.slice(0);return Xw(n=Kw(n=Gw(n,t),t))}(o,Hw);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return ft(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,r,o,i,a){return e.menuItemRenderer(t,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function(n,r){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return o[e].name===Hw?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),qe()&&i&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(i=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){qe()&&ar(t)||!i||!e.hasSelectedItem()||(Ke()||$e()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Nm(this.container,a),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!function(e){return $t(e,"htSubmenu")}(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;re(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),r=n?function(e){return ne(e,(function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,r=e.disabled,o=e.submenu,i=!0===r||"function"==typeof r&&!0===r.call(this.hot);return!1===t||n===Hw||!0===i||o}},{key:"setPosition",value:function(e){var t=new U_(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(t,"px")}},{key:"setPositionBelowCursor",value:function(e){var t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top="".concat(t,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var t;t=this.isSubMenu()?1+e.left+e.cellWidth:this.offset.right+1+e.left,this.container.style.left="".concat(t,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var t=Mn(this.hot.rootDocument),n=this.offset.left+e.left-this.container.offsetWidth+t+4;this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);jw(e)||Fw(e)||Yw(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);jw(t)||Fw(t)||Yw(t)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)}},{key:"selectNextCell",value:function(e,t){var n=e+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;r&&(jw(r)||Fw(r)||Yw(r)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"selectPrevCell",value:function(e,t){var n=e-1,r=n>=0?this.hotMenu.getCell(n,t):null;r&&(jw(r)||Fw(r)||Yw(r)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"menuItemRenderer",value:function(e,t,n,r,o,i){var a,s=this,u=e.getSourceDataAtRow(n),l=this.hot.rootDocument.createElement("div"),c=function(e){return e.disableSelection},f=i;"function"==typeof f&&(f=f.call(this.hot)),Zt(t),qt(l,"htItemWrapper"),t.appendChild(l),a=u,new RegExp(Hw,"i").test(a.name)?qt(t,"htSeparator"):"function"==typeof u.renderer?(qt(t,"htCustomMenuRenderer"),t.appendChild(u.renderer(e,l,n,r,o,f))):nn(l,f),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(s.hot)}(u)?(qt(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):c(u)?(qt(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):function(e){return Le(e,"submenu")}(u)?(qt(t,"htSubmenu"),c(u)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)}))):(Jt(t,["htSubmenu","htDisabled"]),c(u)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=t;return r&&(jn(r)&&(r=null===(r=r.call(this.hot))||ht(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),e=n.querySelector(".".concat(this.options.className,".").concat(r))),e||(qt(e=n.createElement("div"),"htMenu ".concat(this.options.className)),r&&qt(e,r),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(e){if(In(e.target)&&this.container.contains(e.target))or(e);else{var t=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,e.keyCode){case Jn.ESCAPE:this.close(),n=!0;break;case Jn.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?n=!0:(this.executeCommand(e),this.close(!0)));break;case Jn.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),n=!0;break;case Jn.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),n=!0;break;case Jn.ARROW_RIGHT:if(t){var r=this.openSubMenu(t[0]);r&&r.selectFirstCell()}n=!0;break;case Jn.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(e.preventDefault(),or(e)),this.keyEvent=!1}}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view.wt.wtTable,t=this.hotMenu.getSettings().data,n=e.hider.style,r=e.holder.style,o=parseInt(n.width,10),i=ee(t,(function(e,t){return e+(t.name===Hw?1:26)}),0);r.width="".concat(o+3,"px"),r.height="".concat(i+3,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Vt(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Vt(e.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&$t(e.target,"htCore")&&Vt(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}],n&&B_(t.prototype,n),e}();Se(V_,Bl);const W_=V_;function z_(e){return z_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z_(e)}function G_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K_(e,t,n){return K_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=J_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},K_(e,t,n||e)}function X_(e,t){return X_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},X_(e,t)}function $_(e,t){if(t&&("object"===z_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return q_(e)}function q_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J_(e){return J_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J_(e)}br.getSingleton().register("afterContextMenuDefaultOptions"),br.getSingleton().register("beforeContextMenuShow"),br.getSingleton().register("afterContextMenuShow"),br.getSingleton().register("afterContextMenuHide"),br.getSingleton().register("afterContextMenuExecute");var Q_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X_(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J_(o);if(i){var n=J_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $_(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(q_(t)),t.commandExecutor=new p_(t.hot),t.itemsFactory=null,t.menu=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().contextMenu;"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new W_(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),K_(J_(s.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),K_(J_(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),K_(J_(s.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect(),o=r.top,i=r.left;t=o-sn(e.view),n=i-un(e.view)}else t=-1*sn(this.menu.hotMenu.rootWindow),n=-1*un(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new j_(this.hot,s.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var r=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),re(r,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders,o=e.target;this.close(),$t(o,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||r||function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(o)||$t(o,"current")&&$t(o,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),K_(J_(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"contextMenu"}},{key:"PLUGIN_PRIORITY",get:function(){return 70}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[T_,C_,Hw,v_,g_,Hw,R_,S_,Hw,O_,w_,Hw,b_,Hw,m_]}}],n&&G_(t.prototype,n),r&&G_(t,r),s}(Vv);function Z_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Q_.SEPARATOR={name:Hw};var eS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var t,n;return t=e,n=[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}],n&&Z_(t.prototype,n),e}(),tS=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clipboardData=new eS};function nS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(70435);var rS=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Fr(this),this.listenersCount=new WeakSet,this.container=t}var t,n;return t=e,(n=[{key:"useSecondaryElement",value:function(){var e=function(e){var t=sS.get(e);if(t)return t.parentElement||e.appendChild(t),t;var n=(e.defaultView?e:e.ownerDocument).createElement("textarea");return sS.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),aS(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),aS(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ke()||Pn(this.mainElement)}}])&&nS(t.prototype,n),e}();Se(rS,Bl);var oS=new WeakMap,iS=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function aS(e,t,n){e.addEventListener(t,"copy",iS("copy",n)),e.addEventListener(t,"cut",iS("cut",n)),e.addEventListener(t,"paste",iS("paste",n))}var sS=new WeakMap;function uS(e){if(e instanceof rS){var t=oS.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=sS.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),sS.delete(e.container)),e.mainElement=null}oS.set(e.container,t)}}function lS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cS(e){return cS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cS(e)}function fS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hS(e,t,n){return hS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},hS(e,t,n||e)}function dS(e,t){return dS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dS(e,t)}function pS(e,t){if(t&&("object"===cS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return mS(e)}function mS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yS(e){return yS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yS(e)}br.getSingleton().register("afterCopyLimit"),br.getSingleton().register("modifyCopyableRange"),br.getSingleton().register("beforeCut"),br.getSingleton().register("afterCut"),br.getSingleton().register("beforePaste"),br.getSingleton().register("afterPaste"),br.getSingleton().register("beforeCopy"),br.getSingleton().register("afterCopy");var vS=new WeakMap,gS=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),bS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dS(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yS(o);if(i){var n=yS(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return pS(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).columnsLimit=1/0,t.copyableRanges=[],t.focusableElement=void 0,t.pasteMode="overwrite",t.rowsLimit=1/0,t.uiContainer=t.hot.rootDocument.body,vS.set(mS(t),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,n,r,o=this.hot.getSettings(),i=o.copyPaste,a=o.fragmentSelection;vS.get(this).isFragmentSelectionEnabled=!!a,"object"===cS(i)&&(this.pasteMode=i.pasteMode||this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,this.uiContainer=i.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=(t=this.uiContainer,n=new rS(t),r=oS.get(t),r=isNaN(r)?0:r,oS.set(t,r+1),n),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),hS(yS(s.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),hS(yS(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&uS(this.focusableElement),hS(yS(s.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){vS.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){vS.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],o=[];return re(e,(function(e){yo(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),yo(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),re(r,(function(e){var r=[];re(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),_m(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],o=[];return re(e,(function(e){yo(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),yo(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),re(r,(function(e){var r=[];re(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new tS;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),r=t.row,o=t.col,i=n.row,a=n.col,s=Math.min(i,r+this.rowsLimit-1),u=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:s,endCol:u}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===u||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var n=e.length,r=e[0].length,o=[],i=t.getTopLeftCorner(),a=i.row,s=i.col,u=t.getBottomRightCorner(),l=u.row,c=u.col,f=a,h=s,d=a,p=s;o.length<n||f<=l;){var m=this.hot.getCellMeta(f,s),y=m.skipRowOnPaste,v=m.visualRow;if(f=v+1,!0!==y){d=v,h=s;for(var g=[],b=o.length%n;g.length<r||h<=c;){var w=this.hot.getCellMeta(a,h),_=w.skipColumnOnPaste,S=w.visualCol;if(h=S+1,!0!==_){p=S;var E=g.length%r;g.push(e[b][E])}}o.push(g)}}return this.hot.populateFromArray(a,s,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,s,d,p]}}},{key:"onCopy",value:function(e){var t=vS.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=_m(n);if(e&&e.clipboardData){var o=uo(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[gS,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=vS.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=_m(n);if(e&&e.clipboardData){var o=uo(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[gS,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var n=It(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=n&&/(<table)|(<TABLE)/g.test(n)?lo(n,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=function(e){var t=[[""]];if(0===e.length)return t;for(var n,r=0,o=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(wm))e=e.replace(wm,""),r+=1,t[o][r]="";else if(e.match(gm))e=e.replace(gm,""),r=0,t[o+=1]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,s=!0;s;){var u=e.slice(0,1);'"'===u&&(a+=1),i+=u,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&a%2==0)&&(s=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var l=e.match(bm);i=l?l[0]:"",e=e.slice(i.length)}t[o][r]=i}return t}(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var r=(u=this.populateValues(t),l=4,function(e){if(Array.isArray(e))return e}(u)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(u,l)||function(e,t){if(e){if("string"==typeof e)return lS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lS(e,t):void 0}}(u,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=r[2],s=r[3];this.hot.selectCell(o,i,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}var u,l}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase(Ff)},callback:function(){t.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}),function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(Yf)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=vS.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&kn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(uS(this.focusableElement),this.focusableElement=null),hS(yS(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"copyPaste"}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}],n&&fS(t.prototype,n),r&&fS(t,r),s}(Vv);function wS(e,t){return"border_row".concat(e,"col").concat(t)}function _S(e,t){return{id:wS(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function SS(e,t){var n=!1;return re(e.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var i=e.getCellMeta(r,o).borders;if(i){if(!t)return n=!0,!1;if(!Le(i[t],"hide")||!1===i[t].hide)return n=!0,!1}}}))})),n}function ES(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function kS(e){return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(ih);return SS(this,"right")&&(e=ES(e)),e},callback:function(t,n){var r=SS(this,"right");e.prepareBorder(n,"right",r)}}}function RS(e){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(ah);return SS(this,"bottom")&&(e=ES(e)),e},callback:function(t,n){var r=SS(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function TS(e){return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(sh);return SS(this,"left")&&(e=ES(e)),e},callback:function(t,n){var r=SS(this,"left");e.prepareBorder(n,"left",r)}}}function CS(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(uh)},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!SS(this)}}}function MS(e){return MS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MS(e)}function OS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return AS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AS(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xS(e,t,n){return xS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},xS(e,t,n||e)}function NS(e,t){return NS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},NS(e,t)}function IS(e,t){if(t&&("object"===MS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function DS(e){return DS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},DS(e)}var PS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NS(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=DS(o);if(i){var n=DS(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return IS(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).savedBorders=[],t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),xS(DS(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),xS(DS(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),xS(DS(s.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,r=t?Object.keys(t):["top","right","bottom","left"],o=Up(Yp(e));re(e,(function(e){for(var i=OS(o(e),4),a=i[0],s=i[1],u=i[2],l=i[3],c=function(e){for(var o=function(o){re(r,(function(r){n.prepareBorderFromCustomAdded(e,o,t,r)}))},i=s;i<=l;i+=1)o(i)},f=a;f<=u;f+=1)c(f)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=Up(Yp(e)),r=[];return re(e,(function(e){for(var o=OS(n(e),4),i=o[0],a=o[1],s=o[2],u=o[3],l=function(e){for(var n=function(n){re(t.savedBorders,(function(t){t.row===e&&t.col===n&&r.push(t)}))},o=a;o<=u;o+=1)n(o)},c=i;c<=s;c+=1)l(c)})),r}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(re(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var n=new kd(new $n(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,r){var o=this.hot.countRows(),i=this.hot.countCols();if(!(e>=o||t>=i)){var a,s,u=_S(e,t);n&&(a=u,Le(s=n,"border")&&(a.border=s.border),Le(s,"top")&&(s.top?(ke(s.top)||(s.top={width:1,color:"#000"}),a.top=s.top):(s.top={hide:!0},a.top=s.top)),Le(s,"right")&&(s.right?(ke(s.right)||(s.right={width:1,color:"#000"}),a.right=s.right):(s.right={hide:!0},a.right=s.right)),Le(s,"bottom")&&(s.bottom?(ke(s.bottom)||(s.bottom={width:1,color:"#000"}),a.bottom=s.bottom):(s.bottom={hide:!0},a.bottom=s.bottom)),Le(s,"left")&&(s.left?(ke(s.left)||(s.left={width:1,color:"#000"}),a.left=s.left):(s.left={hide:!0},a.left=s.left)),u=a,re(this.hot.selection.highlight.customSelections,(function(e){if(u.id===e.settings.id)return Object.assign(e.settings,n),u.id=e.settings.id,u.left=e.settings.left,u.right=e.settings.right,u.top=e.settings.top,u.bottom=e.settings.bottom,!1}))),this.hot.setCellMeta(e,t,"borders",u),this.insertBorderIntoSettings(u,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e){var t=this,n=e.range,r=Math.min(n.to.row,this.hot.countRows()-1),o=Math.min(n.to.col,this.hot.countCols()-1);yo(n.from.row,r,(function(r){yo(n.from.col,o,(function(o){var i=_S(r,o),a=0;r===n.from.row&&Le(e,"top")&&(a+=1,i.top=e.top),r===n.to.row&&Le(e,"bottom")&&(a+=1,i.bottom=e.bottom),o===n.from.col&&Le(e,"left")&&(a+=1,i.left=e.left),o===n.to.col&&Le(e,"right")&&(a+=1,i.right=e.right),a>0&&(t.hot.setCellMeta(r,o,"borders",i),t.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=wS(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,r){var o=this.hot.getCellMeta(e,t).borders;o&&void 0!==o.border||(o=_S(e,t)),r?(o[n]={hide:!0},4===this.countHide(o)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))}},{key:"prepareBorder",value:function(e,t,n){var r=this;re(e,(function(e){var o=e.start,i=e.end;if(o.row===i.row&&o.col===i.col)"noBorders"===t?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":yo(o.col,i.col,(function(e){yo(o.row,i.row,(function(t){r.removeAllBorders(t,e)}))}));break;case"top":yo(o.col,i.col,(function(e){r.setBorder(o.row,e,t,n)}));break;case"right":yo(o.row,i.row,(function(e){r.setBorder(e,i.col,t,n)}));break;case"bottom":yo(o.col,i.col,(function(e){r.setBorder(i.row,e,t,n)}));break;case"left":yo(o.row,i.row,(function(e){r.setBorder(e,o.col,t,n)}))}}))}},{key:"createCustomBorders",value:function(e){var t=this;re(e,(function(e){e.range?t.prepareBorderFromCustomAddedRange(e):t.prepareBorderFromCustomAdded(e.row,e.col,e)}))}},{key:"countHide",value:function(e){return ee(Object.values(e),(function(e,t){var n=e;return t.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=ne(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;re(this.hot.selection.highlight.customSelections,(function(t,n){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[n].destroy(),e.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var e=this;re(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=ne(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,n=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),n=!0):re(this.savedBorders,(function(r,o){if(e.id===r.id)return t.savedBorders[o]=e,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,n){var r=!1;return re(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return Te(o.instanceBorders,(function(e){e.toggleHiddenClass(t,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(e,t,n){var r=this.countHide(e),o=!1;return 4===r?(this.removeAllBorders(e.row,e.col),o=!0):re(this.hot.selection.highlight.customSelections,(function(r){if(e.id===r.settings.id)return r.visualCellRange=t,r.commit(),n&&Te(r.instanceBorders,(function(t){t.changeBorderStyle(n,e)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings().customBorders;Array.isArray(e)?(e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;this.hot.getSettings().customBorders&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(rh)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(oh);return SS(this,"top")&&(e=ES(e)),e},callback:function(e,n){var r=SS(this,"top");t.prepareBorder(n,"top",r)}}),kS(this),RS(this),TS(this),CS(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){xS(DS(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"customBorders"}},{key:"PLUGIN_PRIORITY",get:function(){return 90}}],n&&LS(t.prototype,n),r&&LS(t,r),s}(Vv);function HS(e){return HS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HS(e)}function jS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FS(e,t,n){return FS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},FS(e,t,n||e)}function YS(e,t){return YS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},YS(e,t)}function US(e,t){if(t&&("object"===HS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return BS(e)}function BS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},VS(e)}var WS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YS(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=VS(o);if(i){var n=VS(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return US(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(BS(t)),t.boundaries=null,t.callback=null,t.listening=!1,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),FS(VS(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FS(VS(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),FS(VS(s.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mousemove",(function(t){return e.onMouseMove(t)})),t=Ft(t)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!ar(e)){var t=this.hot.view.wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){FS(VS(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"dragToScroll"}},{key:"PLUGIN_PRIORITY",get:function(){return 100}}],n&&jS(t.prototype,n),r&&jS(t,r),s}(Vv);function zS(e){return zS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zS(e)}function GS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KS(e,t,n){return KS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},KS(e,t,n||e)}function XS(e,t){return XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},XS(e,t)}function $S(e,t){if(t&&("object"===zS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qS(e)}function qS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JS(e){return JS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},JS(e)}br.getSingleton().register("afterDropdownMenuDefaultOptions"),br.getSingleton().register("beforeDropdownMenuShow"),br.getSingleton().register("afterDropdownMenuShow"),br.getSingleton().register("afterDropdownMenuHide"),br.getSingleton().register("afterDropdownMenuExecute");var QS="changeType",ZS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=JS(o);if(i){var n=JS(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $S(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(qS(t)),t.commandExecutor=new p_(t.hot),t.itemsFactory=null,t.menu=null,t.hot.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),t}return t=s,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new j_(this.hot,s.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),KS(JS(s.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",n),e.itemsFactory.setPredefinedItems(n.items);var r=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new W_(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",r),e.menu.setMenuItems(r),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),re(r,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),KS(JS(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),KS(JS(s.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),$t(e.target,QS)&&!this.menu.isOpened()){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect();t=r.top,n=r.left}var o=e.target.getBoundingClientRect();this.open({left:o.left+n,top:o.top+e.target.offsetHeight+3+t,width:o.width,height:o.height})}}},{key:"onAfterGetColHeader",value:function(e,t){var n=t.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(e<0||o!==r.length-1)){var i=t.querySelector(".".concat(QS));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=QS,a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),KS(JS(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"dropdownMenu"}},{key:"PLUGIN_PRIORITY",get:function(){return 230}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[v_,g_,Hw,S_,Hw,y_,Hw,b_,Hw,m_]}}],n&&GS(t.prototype,n),r&&GS(t,r),s}(Vv);function eE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ZS.SEPARATOR={name:Hw};var nE=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options={}}var t,n;return t=e,n=[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,i=t.endCol,a=this.options,s=[];return yo(n,o,(function(t){var n=[];!a.exportHiddenRows&&e._isHiddenRow(t)||(yo(r,i,(function(r){!a.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))})),s.push(n))})),s}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();yo(r,o,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(i[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();yo(r,o,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(i[n])}))}return t}},{key:"_getDataRange",value:function(){var e,t,n=this.hot.countCols()-1,r=this.hot.countRows()-1,o=(e=this.options.range,t=4,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eE(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=void 0===i?0:i,s=o[1],u=void 0===s?0:s,l=o[2],c=void 0===l?r:l,f=o[3],h=void 0===f?n:f;return{startRow:a=Math.max(a,0),startCol:u=Math.max(u,0),endRow:c=Math.min(c,r),endCol:h=Math.min(h,n)}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}],n&&tE(t.prototype,n),e}();const rE=nE;function oE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var iE=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}var t,n,r;return t=e,n=[{key:"_mergeOptions",value:function(t){var n=_e(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=ge(_e(e.DEFAULT_OPTIONS),n),(n=ge(n,t)).filename=xt(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}],n&&oE(t.prototype,n),r&&oE(t,r),e}();const aE=iE;function sE(e){return sE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sE(e)}function uE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cE(e,t){return cE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},cE(e,t)}function fE(e,t){if(t&&("object"===sE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hE(e){return hE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hE(e)}var dE=String.fromCharCode(13),pE=String.fromCharCode(34),mE=String.fromCharCode(10),yE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cE(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hE(o);if(i){var n=hE(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fE(this,e)});function s(){return uE(this,s),a.apply(this,arguments)}return t=s,n=[{key:"export",value:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,s=t.bom?String.fromCharCode(65279):"";return o&&(r=ne(r,(function(t){return e._escapeCell(t,!0)})),a&&(s+=t.columnDelimiter),s+=r.join(t.columnDelimiter),s+=t.rowDelimiter),re(n,(function(n,r){r>0&&(s+=t.rowDelimiter),a&&(s+=e._escapeCell(i[r])+t.columnDelimiter),s+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),s}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ct(e);return""!==n&&(t||n.indexOf(dE)>=0||n.indexOf(pE)>=0||n.indexOf(mE)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],n&&lE(t.prototype,n),r&&lE(t,r),s}(aE),vE=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e.csv=n,e}({},"csv",yE);function gE(e,t,n){return"function"==typeof vE[e]?new vE[e](t,n):null}function bE(e){return bE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bE(e)}function wE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SE(e,t){return SE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},SE(e,t)}function EE(e,t){if(t&&("object"===bE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kE(e){return kE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kE(e)}var RE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SE(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kE(o);if(i){var n=kE(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return EE(this,e)});function s(){return wE(this,s),a.apply(this,arguments)}return t=s,n=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(e,t),a=this._createBlob(i),s=o.URL||o.webkitURL,u=r.createElement("a"),l="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==u.download){var c=s.createObjectURL(a);u.style.display="none",u.setAttribute("href",c),u.setAttribute("download",l),r.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),r.body.removeChild(u),setTimeout((function(){s.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,l)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!vE[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return gE(e,new rE(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}],r=[{key:"PLUGIN_KEY",get:function(){return"exportFile"}},{key:"PLUGIN_PRIORITY",get:function(){return 240}}],n&&_E(t.prototype,n),r&&_E(t,r),s}(Vv);function TE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var CE=function(){function e(t,n){var r=n.id,o=n.stateless,i=void 0===o||o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Cc)}var t,n;return t=e,(n=[{key:"reset",value:function(){re(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),re(this.elements,(function(e){return e.destroy()})),this.state=null,this.elements=null,this.hot=null}}])&&TE(t.prototype,n),e}();Se(CE,Bl);const ME=CE;var OE={};function AE(e,t){if(!OE[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var n=OE[e],r=n.condition,o=n.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(e){return r.apply(e.meta.instance,[].concat([e],[i]))}}function LE(e){if(!OE[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return OE[e].descriptor}function xE(e,t,n){n.key=e,OE[e]={condition:t,descriptor:n}}var NE="none";xE(NE,(function(){return!0}),{name:vh,inputsCount:0,showOperators:!1});var IE="empty";xE(IE,(function(e){return dt(e.value)}),{name:gh,inputsCount:0,showOperators:!0});var DE="not_empty";function PE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(DE,(function(e,t){return!AE(IE,t)(e)}),{name:bh,inputsCount:0,showOperators:!0});var HE="eq";xE(HE,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return PE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return ct(e.value).toLowerCase()===ct(o)}),{name:wh,inputsCount:1,showOperators:!0});var jE="neq";function FE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function YE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function VE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(jE,(function(e,t){return!AE(HE,t)(e)}),{name:_h,inputsCount:1,showOperators:!0}),xE("gt",(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return FE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>o}),{name:Ch,inputsCount:1,showOperators:!0}),xE("gte",(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return YE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>=o}),{name:Mh,inputsCount:1,showOperators:!0}),xE("lt",(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return UE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<o}),{name:Oh,inputsCount:1,showOperators:!0}),xE("lte",(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return BE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<=o}),{name:Ah,inputsCount:1,showOperators:!0});var WE="date_after";function zE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(WE,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return VE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],i=at(e.value,e.meta.dateFormat),a=at(o,e.meta.dateFormat);return!(!i.isValid()||!a.isValid())&&i.diff(a)>=0}),{name:Nh,inputsCount:1,showOperators:!0});var GE="date_before";function KE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(GE,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return zE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],i=at(e.value,e.meta.dateFormat),a=at(o,e.meta.dateFormat);return!(!i.isValid()||!a.isValid())&&i.diff(a)<=0}),{name:Ih,inputsCount:1,showOperators:!0});var XE="between";xE(XE,(function(e,t){var n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return KE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];if("numeric"===e.meta.type){var s=parseFloat(i,10),u=parseFloat(a,10);i=Math.min(s,u),a=Math.max(s,u)}else if("date"===e.meta.type){var l=AE(GE,[a]),c=AE(WE,[i]);return l(e)&&c(e)}return e.value>=i&&e.value<=a}),{name:Lh,inputsCount:2,showOperators:!0});var $E="not_between";function qE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE($E,(function(e,t){return!AE(XE,t)(e)}),{name:xh,inputsCount:2,showOperators:!0});var JE="begins_with";function QE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(JE,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return qE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return ct(e.value).toLowerCase().startsWith(ct(o))}),{name:Sh,inputsCount:1,showOperators:!0}),n(23223);var ZE="ends_with";function ek(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}xE(ZE,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return QE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QE(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return ct(e.value).toLowerCase().endsWith(ct(o))}),{name:Eh,inputsCount:1,showOperators:!0});var tk="contains";xE(tk,(function(e,t){var n,r,o=(n=t,r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return ek(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ek(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return ct(e.value).toLowerCase().indexOf(ct(o))>=0}),{name:kh,inputsCount:1,showOperators:!0});var nk="not_contains";xE(nk,(function(e,t){return!AE(tk,t)(e)}),{name:Rh,inputsCount:1,showOperators:!0});var rk="date_tomorrow";xE(rk,(function(e){var t=at(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(at().subtract(-1,"days").startOf("day"),"d")}),{name:Ph,inputsCount:0});var ok="date_today";xE(ok,(function(e){var t=at(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(at().startOf("day"),"d")}),{name:Dh,inputsCount:0});var ik,ak="date_yesterday";function sk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}xE(ak,(function(e){var t=at(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(at().subtract(1,"days").startOf("day"),"d")}),{name:Hh,inputsCount:0});var uk="text",lk=(sk(ik={},"numeric",[NE,Hw,IE,DE,Hw,HE,jE,Hw,"gt","gte","lt","lte",XE,$E]),sk(ik,uk,[NE,Hw,IE,DE,Hw,HE,jE,Hw,JE,ZE,Hw,tk,nk]),sk(ik,"date",[NE,Hw,IE,DE,Hw,HE,jE,Hw,GE,WE,XE,Hw,rk,ok,ak]),ik);function ck(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fk="built",hk="building",dk=["click","input","keydown","keypress","keyup","focus","blur","change"],pk=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.eventManager=new Fr(this),this.options=ge(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}var t,n,r;return t=e,n=[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===hk?this._element:this.buildState===fk?(this.update(),this._element):(this.buildState=hk,this.build(),this.buildState=fk,this._element)}},{key:"isBuilt",value:function(){return this.buildState===fk}},{key:"translateIfPossible",value:function(e){return"string"==typeof e&&e.startsWith(mh)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(t,n){e.eventManager.addEventListener(t,n,(function(t){return e.runLocalHooks(n,t,e)}))};if(this.buildState||(this.buildState=hk),this.options.className&&qt(this._element,this.options.className),this.options.children.length)re(this.options.children,(function(t){return e._element.appendChild(t.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);Te(this.options,(function(t,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=e.translateIfPossible(t))})),this._element.appendChild(n),re(dk,(function(e){return t(n,e)}))}else re(dk,(function(n){return t(e._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],r=[{key:"DEFAULTS",get:function(){return _e({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}],n&&ck(t.prototype,n),r&&ck(t,r),e}();Se(pk,Bl);const mk=pk;function yk(e){return yk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yk(e)}function vk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gk(e,t,n){return gk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sk(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},gk(e,t,n||e)}function bk(e,t){return bk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},bk(e,t)}function wk(e,t){if(t&&("object"===yk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _k(e)}function _k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sk(e){return Sk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sk(e)}var Ek=new WeakMap,kk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bk(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sk(o);if(i){var n=Sk(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return wk(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=a.call(this,e,ge(s.DEFAULTS,t)),Ek.set(_k(n),{}),n.registerHooks(),n}return t=s,n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){gk(Sk(s.prototype),"build",this).call(this);var e=Ek.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,qt(this._element,"htUIInput"),qt(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=Ek.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Ek.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}],r=[{key:"DEFAULTS",get:function(){return _e({placeholder:"",type:"text",tagName:"input"})}}],n&&vk(t.prototype,n),r&&vk(t,r),s}(mk);const Rk=kk;function Tk(e){return Tk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tk(e)}function Ck(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mk(e,t,n){return Mk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xk(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Mk(e,t,n||e)}function Ok(e,t){return Ok=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ok(e,t)}function Ak(e,t){if(t&&("object"===Tk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Lk(e)}function Lk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xk(e){return xk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xk(e)}var Nk=new WeakMap,Ik=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ok(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xk(o);if(i){var n=xk(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ak(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=a.call(this,e,ge(s.DEFAULTS,t)),Nk.set(Lk(n),{}),n.menu=null,n.items=[],n.registerHooks(),n}return t=s,r=[{key:"DEFAULTS",get:function(){return _e({className:"htUISelect",wrapIt:!1})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return re(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;Mk(xk(s.prototype),"build",this).call(this),this.menu=new W_(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var t=new mk(this.hot,{className:"htUISelectCaption"}),n=new mk(this.hot,{className:"htUISelectDropdown"}),r=Nk.get(this);r.caption=t,r.captionElement=t.element,r.dropdown=n,re([t,n],(function(t){return e._element.appendChild(t.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(vh),Nk.get(this).captionElement.textContent=e,Mk(xk(s.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:e.left-5,top:e.top-1,width:e.width,height:e.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==Hw&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=Nk.get(this),t=e.caption,n=e.dropdown;t&&t.destroy(),n&&n.destroy(),Mk(xk(s.prototype),"destroy",this).call(this)}}])&&Ck(t.prototype,n),r&&Ck(t,r),s}(mk);const Dk=Ik;function Pk(e){return Pk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pk(e)}function Hk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fk(e,t,n){return Fk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bk(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Fk(e,t,n||e)}function Yk(e,t){return Yk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Yk(e,t)}function Uk(e,t){if(t&&("object"===Pk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Bk(e){return Bk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bk(e)}var Vk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yk(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bk(r);if(o){var n=Bk(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Uk(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.addSeparator=t.addSeparator,n.elements.push(new Dk(n.hot,{menuContainer:t.menuContainer})),n.elements.push(new Rk(n.hot,{placeholder:Xh})),n.elements.push(new Rk(n.hot,{placeholder:$h})),n.registerHooks(),n}return t=a,n=[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),re(this.getInputElements(),(function(t){t.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=_e(e.command);n.name.startsWith(yh)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),re(e.args,(function(e,r){if(r>n.inputsCount-1)return!1;var o=t.getInputElement(r);o.setValue(e),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||LE(NE),t=[];return re(this.getInputElements(),(function(n,r){e.inputsCount>r&&t.push(n.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var n=LE(e?e.name:NE);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||re(this.getInputElements(),(function(e){return e.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof Dk}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(e){return e instanceof Rk}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){qt(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&qt(n.parentNode,"border");var s=e.hot.rootDocument.createElement("div");return qt(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||re(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e,t,n=this.hot.getPlugin("filters").getSelectedColumn(),r=n&&n.visualIndex,o=function(e){var t=[],n=e;return lk[n]||(n=uk),re(lk[n],(function(e){var n;n=e===Hw?{name:Hw}:_e(LE(e)),t.push(n)})),t}((e=this.hot).getDataType.apply(e,function(e){if(Array.isArray(e))return Hk(e)}(t=this.hot.getSelectedLast()||[0,r])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Hk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hk(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));re(this.getInputElements(),(function(e){return e.hide()})),this.getSelectElement().setItems(o),Fk(Bk(a.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(e){re(this.getInputElements(),(function(t,n){t[e.inputsCount>n?"show":"hide"](),0===n&&setTimeout((function(){return t.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){rr(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),or(e)):rr(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),or(e))}}],n&&jk(t.prototype,n),a}(ME);const Wk=Vk;var zk={};function Gk(e){if(!zk[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=zk[e].func;return function(e,n){return t(e,n)}}function Kk(e,t,n){zk[e]={name:t,func:n}}var Xk="conjunction";Kk(Xk,Yh,(function(e,t){return e.every((function(e){return e.func(t)}))}));var $k="disjunction";Kk($k,Uh,(function(e,t){return e.some((function(e){return e.func(t)}))}));var qk="disjunctionWithExtraCondition";function Jk(e){return Jk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jk(e)}function Qk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zk(e,t,n){return Zk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Zk(e,t,n||e)}function eR(e,t){return eR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},eR(e,t)}function tR(e,t){if(t&&("object"===Jk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nR(e)}function nR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rR(e){return rR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rR(e)}Kk(qk,Uh,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}));var oR=new WeakMap,iR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eR(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rR(o);if(i){var n=rR(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tR(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=a.call(this,e,ge(s.DEFAULTS,t)),oR.set(nR(n),{}),n}return t=s,n=[{key:"build",value:function(){Zk(rR(s.prototype),"build",this).call(this);var e=oR.get(this);e.input=this._element.firstChild;var t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=oR.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&oR.get(this).input.focus()}}],r=[{key:"DEFAULTS",get:function(){return _e({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}],n&&Qk(t.prototype,n),r&&Qk(t,r),s}(mk);const aR=iR;function sR(e){return sR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sR(e)}var uR;function lR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cR(e,t){return cR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},cR(e,t)}function fR(e,t){if(t&&("object"===sR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hR(e){return hR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hR(e)}var dR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cR(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hR(r);if(o){var n=hR(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fR(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.buildOperatorsElement(),n}return t=a,n=[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return qt(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||re(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[Xk,$k];re(t,(function(n){var r,o=new aR(e.hot,{name:"operator",label:{htmlFor:n,textContent:(r=n,zk[r].name)},value:n,checked:n===t[0],id:n});o.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(o)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(st(uR||(uR=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Radio button with index "," doesn't exist."])),e));re(this.elements,(function(t,n){t.setChecked(n===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(e){return e instanceof aR&&e.isChecked()}));return e?e.getValue():Xk}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&re(this.elements,(function(t){t.setChecked(t.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xk,t=arguments.length>1?arguments[1]:void 0,n=e;n===qk&&(n=$k),this.state.setValueAtIndex(t,n)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}],n&&lR(t.prototype,n),a}(ME);const pR=dR;function mR(e,t){var n=e;return""===n&&(n="(".concat(t,")")),n}$();var yR=new Set([1]).has(1),vR=yR&&"function"==typeof Array.from;function gR(e){var t=e;return yR&&(t=new Set(t)),function(e){return yR?t.has(e):!!~t.indexOf(e)}}function bR(e){return null==e?"":e}function wR(e){var t=e;return t=(t=vR?Array.from(new Set(t)):le(t)).sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1})),t}function _R(e,t,n,r){var o,i=[],a=e===t;return a||(o=gR(t)),re(e,(function(e){var t=!1;(a||o(e))&&(t=!0);var s={checked:t,value:e,visualValue:mR(e,n)};r&&r(s),i.push(s)})),i}function SR(e){return SR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SR(e)}function ER(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kR(e,t,n){return kR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},kR(e,t,n||e)}function RR(e,t){return RR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},RR(e,t)}function TR(e,t){if(t&&("object"===SR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return CR(e)}function CR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MR(e){return MR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},MR(e)}n(59808);var OR=new WeakMap,AR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RR(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=MR(o);if(i){var n=MR(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return TR(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=a.call(this,e,ge(s.DEFAULTS,t)),OR.set(CR(n),{}),n}return t=s,r=[{key:"DEFAULTS",get:function(){return _e({href:"#",tagName:"a"})}}],(n=[{key:"build",value:function(){kR(MR(s.prototype),"build",this).call(this),OR.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(OR.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}])&&ER(t.prototype,n),r&&ER(t,r),s}(mk);const LR=AR;function xR(e){return xR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xR(e)}function NR(e){return function(e){if(Array.isArray(e))return IR(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return IR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IR(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function DR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PR(e,t,n){return PR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=YR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},PR(e,t,n||e)}function HR(e,t){return HR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},HR(e,t)}function jR(e,t){if(t&&("object"===xR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return FR(e)}function FR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YR(e){return YR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},YR(e)}var UR=new WeakMap,BR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HR(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=YR(o);if(i){var n=YR(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jR(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=a.call(this,e,ge(s.DEFAULTS,t)),UR.set(FR(n),{}),n.searchInput=new Rk(n.hot,{placeholder:Kh,className:"htUIMultipleSelectSearch"}),n.selectAllUI=new LR(n.hot,{textContent:Vh,className:"htUISelectAll"}),n.clearAllUI=new LR(n.hot,{textContent:Wh,className:"htUIClearAll"}),n.items=[],n.itemsBox=null,n.registerHooks(),n}return t=s,n=[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return NR(this.items)}},{key:"getValue",value:function(){return e=this.items,t=[],re(e,(function(e){e.checked&&t.push(e.value)})),t;var e,t}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;PR(YR(s.prototype),"build",this).call(this);var t=this.hot.rootDocument,n=t.createElement("div"),r=new mk(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(n);var o=function(n){e._element&&(e.itemsBox&&e.itemsBox.destroy(),qt(n,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(n,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,n,r,o,i){e.title=i.instance.getDataAtRowProp(t,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-Mn(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}),e.itemsBox.init())};o(n),setTimeout((function(){return o(n)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var e,t,n;this.isBuilt()&&(this.itemsBox.loadData((e=this.items,t=this.options.value,n=gR(t),ne(e,(function(e){return e.checked=n(e.value),e})))),PR(YR(s.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,PR(YR(s.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,n=e.target.value.toLowerCase();t=""===n?NR(this.items):te(this.items,(function(e){return"".concat(e.value).toLowerCase().indexOf(n)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this),Vn(rr,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(or(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(e){var t=Vn(rr,e.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",e,this),t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(or(e),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),re(this.itemsBox.getSourceData(),(function(e,n){e.checked=!0,t.push(Nl(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),re(this.itemsBox.getSourceData(),(function(e,n){e.checked=!1,t.push(Nl(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}],r=[{key:"DEFAULTS",get:function(){return _e({className:"htUIMultipleSelect",value:[]})}}],n&&DR(t.prototype,n),r&&DR(t,r),s}(mk);const VR=BR;function WR(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zR(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var GR="by_value";function KR(e){return KR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KR(e)}function XR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qR(e,t,n){return qR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},qR(e,t,n||e)}function JR(e,t){return JR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},JR(e,t)}function QR(e,t){if(t&&("object"===KR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ZR(e){return ZR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ZR(e)}xE(GR,(function(e,t){return(0,WR(t,1)[0])(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator:function(e){return[gR(WR(e,1)[0])]},showOperators:!1});var eT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JR(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ZR(r);if(o){var n=ZR(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return QR(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.elements.push(new VR(n.hot)),n.registerHooks(),n}return t=a,n=[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===GR){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0])}}},{key:"getState",value:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?NE:GR},args:[e.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(e){var t=this,n=function(e,n,r,o,i){var a,s,u=te(n,(function(e){return e.name===GR})),l=(a=u,s=1,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(a,s)||function(e,t){if(e){if("string"==typeof e)return XR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?XR(e,t):void 0}}(a,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c={},f=t.hot.getTranslatedPhrase(Bh);if(l){var h=wR(ne(o(e,i),(function(e){return e.value})));r&&(l.args[0]=r);var d=[],p=_R(h,l.args[0],f,(function(e){e.checked&&d.push(e.value)}));c.args=[d],c.command=LE(GR),c.itemsSnapshot=p}else c.args=[],c.command=LE(NE);t.state.setValueAtIndex(e,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof VR}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){qt(n.parentNode,"htFiltersMenuValue");var s=e.hot.rootDocument.createElement("div");return qt(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||re(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(Bh),t=wR(this._getColumnVisibleValues()),n=_R(t,t,e);this.getMultipleSelectElement().setItems(n),qR(ZR(a.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t)}},{key:"onInputKeyDown",value:function(e){rr(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),or(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=e&&e.visualIndex;return ne(this.hot.getDataAtCol(t),(function(e){return bR(e)}))}}],n&&$R(t.prototype,n),a}(ME);const tT=eT;function nT(e){return nT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nT(e)}function rT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oT(e,t){return oT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oT(e,t)}function iT(e,t){if(t&&("object"===nT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function aT(e){return aT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},aT(e)}var sT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oT(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=aT(o);if(i){var n=aT(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return iT(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,{id:t.id,stateless:!0})).name=t.name,n.elements.push(new Rk(n.hot,{type:"button",value:zh,className:"htUIButton htUIButtonOK",identifier:s.BUTTON_OK})),n.elements.push(new Rk(n.hot,{type:"button",value:Gh,className:"htUIButton htUIButtonCancel",identifier:s.BUTTON_CANCEL})),n.registerHooks(),n}return t=s,r=[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}],(n=[{key:"registerHooks",value:function(){var e=this;re(this.elements,(function(t){t.addLocalHook("click",(function(t,n){return e.onButtonClick(t,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return qt(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||re(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,t){t.options.identifier===s.BUTTON_OK?this.accept():this.cancel()}}])&&rT(t.prototype,n),r&&rT(t,r),s}(ME);const uT=sT;var lT,cT;function fT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return hT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hT(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dT(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function pT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yT="ConditionCollection.filteringStates",vT=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];pT(this,e),this.hot=t,this.isMapRegistrable=n,this.filteringStates=new Cc,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(yT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}var t,n;return t=e,n=[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(e,t){var n,r=this.filteringStates.getValueAtIndex(t),o=null!==(n=null==r?void 0:r.conditions)&&void 0!==n?n:[],i=null==r?void 0:r.operation;return this.isMatchInConditions(o,e,i)}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xk;return!e.length||Gk(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xk,r=arguments.length>3?arguments[3]:void 0,o=ne(t.args,(function(e){return"string"==typeof e?e.toLowerCase():e})),i=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);var a=this.getOperation(e);if(a){if(a!==n)throw Error(st(lT||(lT=dT(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,a))}else if(ht(zk[n]))throw new Error(st(cT||(cT=dT(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var s=this.getConditions(e);0===s.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:i,args:o,func:AE(i,o)}]},r):s.push({name:i,args:o,func:AE(i,o)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}},{key:"getOperation",value:function(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(e){return fT(e,1)[0]}))}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return ee(this.filteringStates.getEntries(),(function(e,t){var n=fT(t,2),r=n[0],o=n[1],i=o.operation,a=o.conditions;return e.push({column:r,operation:i,conditions:ne(a,(function(e){return{name:e.name,args:e.args}}))}),e}),[])}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),re(e,(function(e){re(e.conditions,(function(n){return t.addCondition(e.column,n)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,t){var n=this.getConditions(e);return t?n.some((function(e){return e.name===t})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(yT),this.filteringStates=null,this.clearLocalHooks()}}],n&&mT(t.prototype,n),e}();Se(vT,Bl);const gT=vT;function bT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};bT(this,e),this.conditionCollection=t,this.columnDataFactory=n}var t,n;return t=e,n=[{key:"filter",value:function(){var e=this,t=[];return re(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)})),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return re(n,(function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(e,t){var n=[];return re(t,(function(t){var r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])})),n}}],n&&wT(t.prototype,n),e}();const ST=_T;function ET(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var RT=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};ET(this,e),this.hot=t,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return r._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterRemove",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}var t,n;return t=e,n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,re(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();var s=Wn((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new gT(n.hot,!1),i=[].concat(e,r);o.importAllConditions(i);var a=n.columnDataFactory(t),s=gR(ne(o.isEmpty()?a:new ST(o,(function(e){return n.columnDataFactory(e)})).filter(),(function(e){return e.meta.visualRow})));return o.destroy(),te(a,(function(e){return s(e.meta.visualRow)}))}))(i),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;re(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),Te(this,(function(t,n){e[n]=null}))}}],n&&kT(t.prototype,n),e}();Se(RT,Bl);const TT=RT;function CT(e){return CT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CT(e)}var MT;function OT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function AT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LT(e,t,n){return LT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DT(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},LT(e,t,n||e)}function xT(e,t){return xT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xT(e,t)}function NT(e,t){if(t&&("object"===CT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return IT(e)}function IT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DT(e){return DT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},DT(e)}var PT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xT(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=DT(o);if(i){var n=DT(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return NT(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).eventManager=new Fr(IT(t)),t.dropdownMenuPlugin=null,t.conditionCollection=null,t.conditionUpdateObserver=null,t.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),t.lastSelectedColumn=null,t.filtersRowsMap=null,t.hot.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Ic),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,r=function(t){return t.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),t.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),t.addLocalHook("change",(function(n){return e.onComponentChange(t,n)})),t};if(!this.components.get("filter_by_condition")){var o=new Wk(this.hot,{id:"filter_by_condition",name:function(){return"".concat(e.hot.getTranslatedPhrase(jh),":")},addSeparator:!1,menuContainer:n});o.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new pR(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var i=new Wk(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});i.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",r(i))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new tT(this.hot,{id:"filter_by_value",name:function(){return"".concat(e.hot.getTranslatedPhrase(Fh),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new uT(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new gT(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new TT(this.hot,this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(e){return e.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),LT(DT(s.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"disablePlugin",value:function(){var e,t=this;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(e,n){e.destroy(),t.components.set(n,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),LT(DT(s.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xk,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},r)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(n){var i=[];this.hot.batchExecution((function(){e.filtersRowsMap.clear();var n=gR(r=ne(t.filter(),(function(e){return e.meta.visualRow})));yo(e.hot.countSourceRows()-1,(function(e){n(e)||i.push(e)})),re(i,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.getTopLeftCorner();void 0!==t&&this.hot.selectCell(t.row,t.col)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.hot.toVisualColumn(e),r=[];return re(this.hot.getSourceDataAtCol(n),(function(e,o){var i=t.hot.getCellMeta(o,n),a=i.row,s=i.col,u=i.visualCol,l=i.visualRow,c=i.type,f=i.instance,h=i.dateFormat;r.push({meta:{row:a,col:s,visualCol:u,visualRow:l,type:c,instance:f,dateFormat:h},value:bR(e)})})),r}},{key:"onAfterChange",value:function(e){var t=this;e&&re(e,(function(e){var n,r,o=(n=e,r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return OT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OT(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1],i=t.hot.propToCol(o);t.conditionCollection.hasConditions(i)&&t.updateValueComponentCondition(i)}))}},{key:"updateValueComponentCondition",value:function(e){var t=wR(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}},{key:"restoreComponents",value:function(e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((function(e){e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var e=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:Hw}),this.components.forEach((function(t){e.items.push(t.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,n,r){var o=e;return o===$k&&t.command.key!==NE&&n.command.key!==NE&&r.command.key!==NE?o=qk:r.command.key!==NE&&(t.command.key!==NE&&n.command.key!==NE||(o=Xk)),o}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,i);this.conditionUpdateObserver.groupChanges();var s=this.conditionCollection.getColumnStackPosition(n);-1===s&&(s=void 0),this.conditionCollection.removeConditions(n),r.command.key!==NE&&(this.conditionCollection.addCondition(n,r,a,s),o.command.key!==NE&&this.conditionCollection.addCondition(n,o,a,s)),i.command.key!==NE&&this.conditionCollection.addCondition(n,i,a,s),this.conditionUpdateObserver.flush(),this.components.forEach((function(e){return e.saveState(n)})),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(e,t){this.updateDependentComponentsVisibility(),e.constructor!==Wk||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var e=this.components.get("filter_by_condition").getState().command,t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents.apply(this,t):this.hideComponents.apply(this,t)}},{key:"onAfterGetColHeader",value:function(e,t){var n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?qt(t,"htFiltersActive"):Jt(t,"htFiltersActive")}},{key:"onTableClick",value:function(e){var t=Ut(e.target,"TH");if(t){var n=this.hot.getCoords(t).col,r=this.hot.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:r}}}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new ST(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){var t;if(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled){var n=e.editedConditionStack,r=n.conditions,o=n.column,i=r.filter((function(e){return e.name===GR})),a=r.filter((function(e){return e.name!==GR}));if(i.length>=2||a.length>=3)ur(st(MT||(MT=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The filter conditions have been applied properly, but couldnt be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldnt be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var s=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(s,o),this.components.get("filter_by_value").updateState(e)}}}},{key:"getIndexesOfComponents",value:function(){var e=[];if(!this.dropdownMenuPlugin)return e;for(var t=this.dropdownMenuPlugin.menu,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return re(r,(function(n){re(t.menuItems,(function(t,r){t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}},{key:"changeComponentsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var t=this.dropdownMenuPlugin.menu,n=t.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,i);e?r.showRows(s):r.hideRows(s),n.render()}}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){var e=this;this.enabled&&(this.components.forEach((function(t,n){null!==t&&(t.destroy(),e.components.set(n,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),LT(DT(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"filters"}},{key:"PLUGIN_PRIORITY",get:function(){return 250}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}],n&&AT(t.prototype,n),r&&AT(t,r),s}(Vv);function HT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HT(Object(n),!0).forEach((function(t){FT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function FT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YT="internal-use-in-handsontable",UT={licenseKey:YT,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function BT(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[mC])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function VT(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function WT(e){return WT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WT(e)}function zT(){var e="engine_relationship",t=Er(mC);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function GT(){var e="shared_engine_usage",t=Er(mC);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function KT(e){var t,n=zT(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function XT(e,t){if(e){var n=zT(),r=n.get(e),o=GT(),i=o.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),0===i.length&&(o.delete(e),e.destroy()))}}function $T(e,t){return!ht(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}function qT(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function JT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function QT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JT(Object(n),!0).forEach((function(t){cC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ZT(e){return ZT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZT(e)}function eC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||tC(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tC(e,t){if(e){if("string"==typeof e)return nC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nC(e,t):void 0}}function nC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iC(e,t,n){return iC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},iC(e,t,n||e)}function aC(e,t){return aC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},aC(e,t)}function sC(e,t){if(t&&("object"===ZT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return uC(e)}function uC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lC(e){return lC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lC(e)}function cC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fC(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function hC(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,pC(e,t,"set"),n),n}function dC(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,pC(e,t,"get"))}function pC(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var mC="formulas",yC="row_move";br.getSingleton().register("afterNamedExpressionAdded"),br.getSingleton().register("afterNamedExpressionRemoved"),br.getSingleton().register("afterSheetAdded"),br.getSingleton().register("afterSheetRemoved"),br.getSingleton().register("afterSheetRenamed"),br.getSingleton().register("afterFormulasValuesUpdate");var vC=function(e){return"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e},gC=new WeakMap,bC=new WeakMap,wC=new WeakMap,_C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aC(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lC(o);if(i){var n=lC(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sC(this,e)});function s(){var e;rC(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return fC(uC(e=a.call.apply(a,[this].concat(n))),gC,{writable:!0,value:!1}),fC(uC(e),bC,{writable:!0,value:!1}),fC(uC(e),wC,{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),cC(uC(e),"staticRegister",Er("formulas")),cC(uC(e),"engine",null),cC(uC(e),"sheetName",null),e}return t=s,n=[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[mC]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=function(e){var t,n=e.getSettings(),r=n[mC],o=null==r?void 0:r.engine;if(!0===r)return null;if(ht(o))return null;if("function"==typeof o.hyperformula||"function"==typeof o)return function(e,t,n){var r=t[mC],o=function(e){var t,n=e[mC],r=VT(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=BT(e);return jT(jT(jT({},UT),r),o)}(t),i=zT(),a=GT();(function(e,t){t&&t.forEach((function(t){var n=t.name,r=t.plugin,o=t.translations;try{e.registerFunction(n,r,o)}catch(e){ur(e.message)}}))})(e,r.functions),function(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(e){ur(e.message)}}}(e,r.language);var s=e.buildEmpty(o);return i.set(s,[n]),a.set(s,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,r=t.expression,o=t.scope,i=t.options;try{e.addNamedExpression(n,r,o,i)}catch(e){ur(e.message)}})),e.resumeEvaluation())}(s,r.namedExpressions),s.on("sheetAdded",(function(){s.rebuildAndRecalculate()})),s.on("sheetRemoved",(function(){s.rebuildAndRecalculate()})),s}(null!==(t=o.hyperformula)&&void 0!==t?t:o,n,e);if("object"===WT(o)&&ht(o.hyperformula)){var i=zT(),a=GT().get(o);return i.has(o)||i.set(o,[]),i.get(o).push(e),a&&a.push(e.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:YT}),o}return null}(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==n&&(this.sheetName=n)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("beforeUndo",(function(e){(null==e?void 0:e.actionType)!==yC&&t.engine.undo()})),this.addHook("beforeRedo",(function(e){(null==e?void 0:e.actionType)!==yC&&t.engine.redo()})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill.apply(t,arguments)})),dC(this,wC).forEach((function(e){var n=eC(e,2),r=n[0],o=n[1];return t.engine.on(r,o)})),iC(lC(s.prototype),"enablePlugin",this).call(this)}else ur("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;dC(this,wC).forEach((function(t){var n=eC(t,2),r=n[0],o=n[1];return e.engine.off(r,o)})),XT(this.engine,this.hot),this.engine=null,iC(lC(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(function(e){var t,n=e[mC],r=VT(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=BT(e);return jT(jT({},r),o)}(this.hot.getSettings()));var t=this.hot.getSettings()[mC];if(ft(t)&&ft(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var n=this.hot.getSettings()[mC].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=n?n:void 0,this.hot.getSourceDataArray())}iC(lC(s.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;dC(this,wC).forEach((function(t){var n,r=eC(t,2),o=r[0],i=r[1];return null===(n=e.engine)||void 0===n?void 0:n.off(o,i)})),hC(this,wC,null),XT(this.engine,this.hot),this.engine=null,iC(lC(s.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,r,o){return!o&&e>=n?r+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(ft(t)&&!Dl(t))return ur("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return ur("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(e){return ur(e.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(Mt(mC),".switchSheet"))}else lr("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:r,col:o}):"EMPTY"}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o&&this.engine.doesCellHaveFormula({sheet:n,row:r,col:o})}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;e.forEach((function(e){var t,n=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(r.has(n)||r.add(n))})),KT(this.engine).forEach((function(e,o){var i;(n||o!==t.sheetId)&&r.has(o)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(e){var t,n=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{},r=n.row,o=n.col,i=n.sheet;return ft(i)?"".concat(i,":").concat(r,"x").concat(o):""},o=new Set(n.map((function(e){return r(e)})));e.forEach((function(e){var n,i,a=null!==(n=e.address)&&void 0!==n?n:{},s=a.row,u=a.col,l=ft(s)?t.hot.toVisualRow(s):null,c=ft(u)?t.hot.toVisualColumn(u):null;if(null!==l&&null!==c){var f=null==e||null===(i=e.address)||void 0===i?void 0:i.sheet,h=r(e);if(void 0!==f&&!o.has(h)){var d=KT(t.engine).get(f);d.validateCell(d.getDataAtCell(l,c),d.getCellMeta(l,c),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var r={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r))return this.engine.setCellContents(r,n);ur("Not possible to set cell data at ".concat(JSON.stringify(r)))}},{key:"onBeforeValidate",value:function(e,t,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){var o={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(r),sheet:this.sheetId},i=this.engine.getCellValue(o);return"object"===ZT(i)&&null!==i?i.value:i}return e}},{key:"onBeforeAutofill",value:function(e,t,n){var r=this,o=function(e){return QT(QT({},e),{},{sheet:r.sheetId})},i={start:o(t.getTopLeftCorner()),end:o(t.getBottomRightCorner())},a={start:o(n.getTopLeftCorner()),end:o(n.getBottomRightCorner())};return!1!==this.engine.isItPossibleToSetCellContents(a)&&this.engine.getFillRangeData(i,a)}},{key:"onBeforeLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(Mt(mC))||hC(this,bC,ht(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(Mt(mC)))if(this.sheetName=$T(this.engine,this.hot.getSettings()[mC].sheetName),dC(this,bC))this.switchSheet(this.sheetName);else{var r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){hC(this,gC,!0);var o=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(o),hC(this,gC,!1)}}}},{key:"onModifyData",value:function(e,t,n,r){if("get"===r&&!dC(this,gC)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o,i=this.hot.toVisualRow(e);if(!this.isFormulaCellType(i,t)&&"ARRAY"!==this.getCellType(i,t))return void(qT(n.value)&&(n.value=qT(o=n.value)?o.substr(1):o));var a={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},s=this.engine.getCellValue(a),u="object"===ZT(s)&&null!==s?s.value:s;n.value=u}}},{key:"onModifySourceData",value:function(e,t,n,r){if("get"===r&&!dC(this,gC)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),i=this.hot.propToCol(t);if(!this.isFormulaCellType(o,i)&&"ARRAY"!==this.getCellType(o,i))return;var a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==a.width||0!==a.height){var s={row:e,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};n.value=this.engine.getCellSerialized(s)}}}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;if(!vC(t)){var r=[],o=[],i=this.engine.batch((function(){e.forEach((function(e){var t=eC(e,4),i=t[0],a=t[1],s=t[3],u=n.hot.propToCol(a),l=n.hot.toPhysicalRow(i),c=n.hot.toPhysicalColumn(u),f={row:l,col:c,sheet:n.sheetId};null!==l&&null!==c?n.syncChangeWithEngine(i,u,s):r.push([i,u,s]),o.push({address:f})}))}));r.length&&this.hot.addHookOnce("afterChange",(function(){var e=n.engine.batch((function(){r.forEach((function(e){var t=eC(e,3),r=t[0],o=t[1],i=t[2];n.syncChangeWithEngine(r,o,i)}))}));n.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}}},{key:"onAfterSetSourceDataAtCell",value:function(e,t){var n=this;if(!vC(t)){var r=[],o=[];e.forEach((function(e){var t,i=eC(e,4),a=i[0],s=i[1],u=i[3],l=n.hot.propToCol(s);if(po(l)){var c={row:a,col:n.toPhysicalColumnPosition(l),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(c)?(o.push({address:c}),r.push.apply(r,function(e){if(Array.isArray(e))return nC(e)}(t=n.engine.setCellContents(c,u))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||tC(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())):ur("Not possible to set source cell data at ".concat(JSON.stringify(c)))}})),this.renderDependentSheets(r),this.validateDependentCells(r,o)}}},{key:"onBeforeCreateRow",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this;return!1!==n.every((function(e){return r.engine.isItPossibleToRemoveRows(r.sheetId,[e,1])}))&&void 0}},{key:"onBeforeRemoveCol",value:function(e,t,n){var r=this;return!1!==n.every((function(e){return r.engine.isItPossibleToRemoveColumns(r.sheetId,[e,1])}))&&void 0}},{key:"onAfterCreateRow",value:function(e,t,n){if(!vC(n)){var r=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterCreateCol",value:function(e,t,n){if(!vC(n)){var r=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(!vC(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeRows(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(e,t,n,r){var o=this;if(!vC(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeColumns(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(e,t,n){var r,o=this;hC(this,gC,!0);var i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());hC(this,gC,!1),i.forEach((function(e,t){e.forEach((function(e,r){o.engine.setCellContents({col:r,row:n+t,sheet:o.sheetId},[[e]])}))}))}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}],r=[{key:"PLUGIN_KEY",get:function(){return mC}},{key:"PLUGIN_PRIORITY",get:function(){return 260}}],n&&oC(t.prototype,n),r&&oC(t,r),s}(Vv);function SC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function EC(e){return function(e){if(Array.isArray(e))return kC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return kC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kC(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RC(e){return RC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RC(e)}function TC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MC(e,t,n){return MC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},MC(e,t,n||e)}function OC(e,t){return OC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},OC(e,t)}function AC(e,t){if(t&&("object"===RC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return LC(e)}function LC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xC(e){return xC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xC(e)}function NC(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function IC(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,PC(e,t,"get"))}function DC(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,PC(e,t,"set"),n),n}function PC(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}br.getSingleton().register("beforeHideColumns"),br.getSingleton().register("afterHideColumns"),br.getSingleton().register("beforeUnhideColumns"),br.getSingleton().register("afterUnhideColumns");var HC=new WeakMap,jC=new WeakMap,FC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OC(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xC(o);if(i){var n=xC(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return AC(this,e)});function s(){var e;TC(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return NC(LC(e=a.call.apply(a,[this].concat(n))),HC,{writable:!0,value:{}}),NC(LC(e),jC,{writable:!0,value:null}),e}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenColumns;ke(t)&&(DC(this,HC,t),ht(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),DC(this,jC,new cc),IC(this,jC).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,IC(this,jC)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),MC(xC(s.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),MC(xC(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),DC(this,HC,{}),MC(xC(s.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n,i=IC(this,jC).getValues().slice(),a=e.length>0;r&&a&&(re(e.map((function(e){return t.hot.toPhysicalColumn(e)})),(function(e){i[e]=!1})),o=ee(i,(function(e,n,r){return n&&e.push(t.hot.toVisualColumn(r)),e}),[])),!1!==this.hot.runHooks("beforeUnhideColumns",n,o,r&&a)&&(r&&a&&IC(this,jC).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&a,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",n,o,r)&&(r&&this.hot.batchExecution((function(){re(e,(function(e){IC(t,jC).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return ne(IC(this,jC).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return IC(this,jC).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){re(this.hot.getCellsMeta(),(function(e){e&&(e.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:IC(this,HC).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===IC(this,HC).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(IC(this,HC).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return re(e,(function(e){var n=!0,o=0;yo(e.startCol,e.endCol,(function(i){t.isHidden(i)?(n||r(e.startRow,e.endRow,o,i-1),n=!0):(n&&(o=i),i===e.endCol&&r(e.startRow,e.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(IC(this,HC).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),qt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:Hw},(t=this,{key:"hidden_columns_hide",name:function(){var e,t,n=this.getSelectedLast(),r=0;if(Array.isArray(n)){var o=(t=4,function(e){if(Array.isArray(e))return e}(e=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return SC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SC(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o[1]-o[3]!=0&&(r=1)}return this.getTranslatedPhrase(fh,r)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.col,r.col),0),i=Math.max(n.col,r.col),a=[],s=o;s<=i;s+=1)a.push(s);var u=a[0],l=a[a.length-1],c=this.columnIndexMapper.getFirstNotHiddenIndex(l+1,1,!0,u-1);t.hideColumns(a),Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(hh,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.columnIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.columnIndexMapper.getFirstNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countCols()||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var n=this,r=ne(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopLeftCorner().col,a=o.getBottomRightCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){if(a-i+1>l-u+1){var h=c.slice(i,a+1);f.push.apply(f,EC(h.filter((function(e){return r.includes(e)}))))}}else if(0===u&&u<i)f.push.apply(f,EC(c.slice(0,i)));else if(null===u)f.push.apply(f,EC(c.slice(0,this.countCols())));else{var d=this.countCols()-1;l===s.getRenderableFromVisualIndex(s.getFirstNotHiddenIndex(d,-1))&&d>a&&f.push.apply(f,EC(c.slice(a+1)))}return re(f,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(IC(this,HC).columns)&&this.hideColumns(IC(this,HC).columns)}},{key:"destroy",value:function(){DC(this,HC,null),DC(this,jC,null),MC(xC(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"hiddenColumns"}},{key:"PLUGIN_PRIORITY",get:function(){return 310}}],n&&CC(t.prototype,n),r&&CC(t,r),s}(Vv);function YC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UC(e){return function(e){if(Array.isArray(e))return BC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return BC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BC(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function BC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function VC(e){return VC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VC(e)}function WC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GC(e,t,n){return GC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},GC(e,t,n||e)}function KC(e,t){return KC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},KC(e,t)}function XC(e,t){if(t&&("object"===VC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $C(e)}function $C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qC(e){return qC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qC(e)}function JC(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function QC(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,eM(e,t,"get"))}function ZC(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,eM(e,t,"set"),n),n}function eM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}br.getSingleton().register("beforeHideRows"),br.getSingleton().register("afterHideRows"),br.getSingleton().register("beforeUnhideRows"),br.getSingleton().register("afterUnhideRows");var tM=new WeakMap,nM=new WeakMap,rM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KC(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qC(o);if(i){var n=qC(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return XC(this,e)});function s(){var e;WC(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return JC($C(e=a.call.apply(a,[this].concat(n))),tM,{writable:!0,value:{}}),JC($C(e),nM,{writable:!0,value:null}),e}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenRows;ke(t)&&(ZC(this,tM,t),ht(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),ZC(this,nM,new cc),QC(this,nM).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,QC(this,nM)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),GC(qC(s.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),GC(qC(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ZC(this,tM,{}),GC(qC(s.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n,i=QC(this,nM).getValues().slice(),a=e.length>0;r&&a&&(re(e.map((function(e){return t.hot.toPhysicalRow(e)})),(function(e){i[e]=!1})),o=ee(i,(function(e,n,r){return n&&e.push(t.hot.toVisualRow(r)),e}),[])),!1!==this.hot.runHooks("beforeUnhideRows",n,o,r&&a)&&(r&&a&&QC(this,nM).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&a,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",n,o,r)&&(r&&this.hot.batchExecution((function(){re(e,(function(e){QC(t,nM).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return ne(QC(this,nM).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return QC(this,nM).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){re(this.hot.getCellsMeta(),(function(e){e&&(e.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===QC(this,tM).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(QC(this,tM).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return re(e,(function(e){var n=!0,o=0;yo(e.startRow,e.endRow,(function(i){t.isHidden(i)?(n||r(o,i-1,e.startCol,e.endCol),n=!0):(n&&(o=i),i===e.endRow&&r(o,i,e.startCol,e.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(e,t){if(QC(this,tM).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),qt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:Hw},(t=this,{key:"hidden_rows_hide",name:function(){var e,t,n=this.getSelectedLast(),r=0;if(Array.isArray(n)){var o=(t=3,function(e){if(Array.isArray(e))return e}(e=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return YC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YC(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o[0]-o[2]!=0&&(r=1)}return this.getTranslatedPhrase(dh,r)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.row,r.row),0),i=Math.max(n.row,r.row),a=[],s=o;s<=i;s+=1)a.push(s);var u=a[0],l=a[a.length-1],c=this.rowIndexMapper.getFirstNotHiddenIndex(l+1,1,!0,u-1);t.hideRows(a),Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(ph,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.rowIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.rowIndexMapper.getFirstNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countRows()||this.selectRows(o,i)}},disabled:!1,hidden:function(){var n=this,r=ne(e.getHiddenRows(),(function(e){return n.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopLeftCorner().row,a=o.getBottomRightCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){if(a-i+1>l-u+1){var h=c.slice(i,a+1);f.push.apply(f,UC(h.filter((function(e){return r.includes(e)}))))}}else if(0===u&&u<i)f.push.apply(f,UC(c.slice(0,i)));else if(null===u)f.push.apply(f,UC(c.slice(0,this.countRows())));else{var d=this.countRows()-1;l===s.getRenderableFromVisualIndex(s.getFirstNotHiddenIndex(d,-1))&&d>a&&f.push.apply(f,UC(c.slice(a+1)))}return re(f,(function(e){t.push(n.toVisualRow(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(QC(this,tM).rows)&&this.hideRows(QC(this,tM).rows)}},{key:"destroy",value:function(){ZC(this,tM,null),ZC(this,nM,null),GC(qC(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"hiddenRows"}},{key:"PLUGIN_PRIORITY",get:function(){return 320}}],n&&zC(t.prototype,n),r&&zC(t,r),s}(Vv);function oM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aM(e){return aM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aM(e)}function sM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uM(e,t,n){return uM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},uM(e,t,n||e)}function lM(e,t){return lM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lM(e,t)}function cM(e,t){if(t&&("object"===aM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fM(e)}function fM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hM(e){return hM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hM(e)}var dM=new WeakMap,pM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lM(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hM(o);if(i){var n=hM(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return cM(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),dM.set(fM(t),{afterFirstUse:!1}),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,n){return e.onBeforeColumnMove(t,n)})),uM(hM(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){dM.get(this).afterFirstUse=!1,uM(hM(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),uM(hM(s.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=dM.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||e<=n.fixedColumnsLeft-1||(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsLeft),n.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(e){var t=dM.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft<=0||e>n.fixedColumnsLeft-1||(n.fixedColumnsLeft-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsLeft))}},{key:"addContextMenuEntry",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(Uf)},callback:function(e,n){var r,o,i=(r=n,o=1,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||function(e,t){if(e){if("string"==typeof e)return oM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oM(e,t):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0].start.col;t.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(Bf)},callback:function(t,n){var r,o,i=(r=n,o=1,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||function(e,t){if(e){if("string"==typeof e)return iM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iM(e,t):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}(this))}},{key:"onBeforeColumnMove",value:function(e,t){if(dM.get(this).afterFirstUse){var n=this.hot.getSettings().fixedColumnsLeft;if(t<n)return!1;if(e.some((function(e){return e<n})))return!1}}}],r=[{key:"PLUGIN_KEY",get:function(){return"manualColumnFreeze"}},{key:"PLUGIN_PRIORITY",get:function(){return 110}}],n&&sM(t.prototype,n),r&&sM(t,r),s}(Vv);function mM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yM="px",vM=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0}var t,n;return t=e,n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){po(e)&&(this._element.style.top=e+yM),po(t)&&(this._element.style.left=t+yM)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){po(e)&&(this._element.style.width=e+yM),po(t)&&(this._element.style.height=t+yM)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){po(e)&&(this._element.style.marginTop=e+yM),po(t)&&(this._element.style.marginLeft=t+yM)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}],n&&mM(t.prototype,n),e}();const gM=vM;function bM(e){return bM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bM(e)}function wM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SM(e,t,n){return SM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=RM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},SM(e,t,n||e)}function EM(e,t){return EM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},EM(e,t)}function kM(e,t){if(t&&("object"===bM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function RM(e){return RM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},RM(e)}const TM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EM(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=RM(r);if(o){var n=RM(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kM(this,e)});function a(){return wM(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"build",value:function(){SM(RM(a.prototype),"build",this).call(this),qt(this._element,"ht__manualColumnMove--backlight")}}])&&_M(t.prototype,n),a}(gM);function CM(e){return CM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CM(e)}function MM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AM(e,t,n){return AM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},AM(e,t,n||e)}function LM(e,t){return LM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},LM(e,t)}function xM(e,t){if(t&&("object"===CM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function NM(e){return NM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},NM(e)}const IM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LM(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=NM(r);if(o){var n=NM(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xM(this,e)});function a(){return MM(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"build",value:function(){AM(NM(a.prototype),"build",this).call(this),qt(this._element,"ht__manualColumnMove--guideline")}}])&&OM(t.prototype,n),a}(gM);function DM(e){return DM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DM(e)}function PM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HM(e,t,n){return HM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},HM(e,t,n||e)}function jM(e,t){return jM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},jM(e,t)}function FM(e,t){if(t&&("object"===DM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return YM(e)}function YM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UM(e){return UM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},UM(e)}br.getSingleton().register("beforeColumnMove"),br.getSingleton().register("afterColumnMove");var BM=new WeakMap,VM="ht__manualColumnMove",WM="show-ui",zM="on-moving--columns",GM="after-selection--columns",KM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jM(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=UM(o);if(i){var n=UM(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return FM(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),BM.set(YM(t),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),t.eventManager=new Fr(YM(t)),t.backlight=new TM(e),t.guideline=new IM(e),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),qt(this.hot.rootElement,VM),HM(UM(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),HM(UM(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Jt(this.hot.rootElement,VM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),HM(UM(s.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=BM.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(e,t);var a=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,o,a),a}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var n=this.countFinalIndex(e,t);return BM.get(this).cachedDropIndex=t,this.moveColumns(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=ee(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getColumnsWidth",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=0,o=e;o<=t;o+=1){var i=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(r+=this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsLeft",value:function(e){return e<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return yo(e,t,(function(e){n.push(e)})),n}},{key:"refreshPositions",value:function(){var e=BM.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coords-1),s=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?i:0)),u=r.hider.offsetWidth,l=r.TBODY.offsetLeft,c=this.backlight.getOffset().left,f=this.backlight.getSize().width,h=0;if(e.rootElementOffset+r.holder.offsetWidth+i<e.target.eventPageX&&e.coords<e.countCols&&(e.coords+=1),e.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(e.coords)&&(a+=i),a+=h,e.coords<0)e.fixedColumns>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+a<=s){var d=e.coords>=e.countCols?e.countCols-1:e.coords;e.target.col=d+1,a+=e.target.TD.offsetWidth,e.target.col>n&&n<e.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else e.target.col=e.coords,e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);var p=s,m=a;s+f+c>=u?p=u-f-c:s+c<l+h&&(p=l+h+Math.abs(c)),a>=u-1?m=u-1:0===m?m=1:void 0!==o.scrollX&&e.coords<e.fixedColumns&&(m-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,m)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=BM.get(this),u=$t(e.target,"sortAction");if(!a||!i||s.pressed||0!==e.button||u)return s.pressed=!1,s.columnsToMove.length=0,void Jt(this.hot.rootElement,[zM,WM]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(t.row<0&&t.col>=d&&t.col<=p){r.column=!0,s.pressed=!0,s.target.eventPageX=e.pageX,s.coords=t.col,s.target.TD=n,s.target.col=t.col,s.columnsToMove=this.prepareColumnsToMoving(d,p),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=an(this.hot.rootElement).left;var m=s.hasRowHeaders?-1:0,y=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,v=t.col<s.fixedColumns,g=this.hot.view.wt.wtOverlays.scrollableElement,b=g.scrollX?g.scrollX-s.rootElementOffset:0,w=e.offsetX-(v?b:0),_=Math.abs(this.getColumnsWidth(d,t.col-1)+w);this.backlight.setPosition(y,this.getColumnsWidth(m,d-1)+_),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-y),this.backlight.setOffset(null,-1*_),qt(this.hot.rootElement,zM)}else Jt(this.hot.rootElement,GM),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=BM.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=BM.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?Jt(this.hot.rootElement,WM):qt(this.hot.rootElement,WM),r.row=!0,r.column=!0,r.cell=!0,i.coords=t.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=BM.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.coords=void 0,e.pressed=!1,e.backlightWidth=0,Jt(this.hot.rootElement,[zM,WM,GM]),this.hot.selection.isSelectedByColumnHeader()&&qt(this.hot.rootElement,GM),!(n<1||void 0===t)){var r=e.columnsToMove[0],o=this.hot.toPhysicalColumn(r),i=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),s=a+n-1;this.hot.selectColumns(a,s)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),HM(UM(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"manualColumnMove"}},{key:"PLUGIN_PRIORITY",get:function(){return 120}}],n&&PM(t.prototype,n),r&&PM(t,r),s}(Vv);function XM(e){return XM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XM(e)}function $M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qM(e,t,n){return qM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},qM(e,t,n||e)}function JM(e,t){return JM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},JM(e,t)}function QM(e,t){if(t&&("object"===XM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ZM(e)}function ZM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eO(e){return eO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},eO(e)}var tO="manualColumnWidths",nO=new WeakMap,rO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JM(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=eO(o);if(i){var n=eO(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return QM(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var n=(t=a.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentCol=null,t.selectedCols=[],t.currentWidth=null,t.newSize=null,t.startY=null,t.startWidth=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Fr(ZM(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.columnWidthsMap=void 0,nO.set(ZM(t),{config:void 0}),qt(t.handle,"manualColumnResizer"),qt(t.guide,"manualColumnResizerGuide"),t}return t=s,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new rc,this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("beforeStretchingColumnWidth",(function(t,n){return e.onBeforeStretchingColumnWidth(t,n)})),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)})),this.bindEvents(),qM(eO(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qM(eO(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){nO.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),qM(eO(s.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",tO,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",tO,e),e.value}},{key:"setManualSize",value:function(e,t){var n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=nO.get(this),n=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths();void 0!==r?this.hot.batchExecution((function(){r.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),t.config=n):!0===n&&Array.isArray(t.config)&&this.hot.batchExecution((function(){t.config.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var n=this.hot.view.wt,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(!(o<0)){var i,a=vn(this.currentTH),s=this.currentTH.getBoundingClientRect();o<n.getSetting("fixedColumnsLeft")&&(i=n.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),i||(i=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&u&&re(this.hot.getSelectedRange(),(function(e){yo(e.getTopLeftCorner().col,e.getBottomRightCorner().col,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))})),this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.left-6,this.startWidth=parseInt(s.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(vn(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);qt(this.handle,"active"),qt(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Jt(this.handle,"active"),Jt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(e){return!!Ut(e,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(!Hn(e.target)&&this.checkIfColumnHeader(e.target)){var t=this.getClosestTHParent(e.target);if(!t)return;var n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(t)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",e.newSize,n,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!0),r&&t()};this.dblclick>=2&&(this.selectedCols.length>1?(re(this.selectedCols,(function(e){n(e)})),t()):re(this.selectedCols,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;$t(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(e.pageX-this.startX),re(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeColumnResize",e.newSize,n,!1),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(re(this.selectedCols,(function(e){n(e)})),t()):re(this.selectedCols,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootWindow,r=t.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(r,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings().manualColumnResize&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){qM(eO(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"manualColumnResize"}},{key:"PLUGIN_PRIORITY",get:function(){return 130}}],n&&$M(t.prototype,n),r&&$M(t,r),s}(Vv);function oO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var iO="px",aO=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0}var t,n;return t=e,n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+iO),void 0!==t&&(this._element.style.left=t+iO)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+iO),t&&(this._element.style.height=t+iO)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+iO),t&&(this._element.style.marginLeft=t+iO)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}],n&&oO(t.prototype,n),e}();const sO=aO;function uO(e){return uO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uO(e)}function lO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fO(e,t,n){return fO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},fO(e,t,n||e)}function hO(e,t){return hO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hO(e,t)}function dO(e,t){if(t&&("object"===uO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pO(e){return pO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pO(e)}const mO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hO(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pO(r);if(o){var n=pO(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dO(this,e)});function a(){return lO(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"build",value:function(){fO(pO(a.prototype),"build",this).call(this),qt(this._element,"ht__manualRowMove--backlight")}}])&&cO(t.prototype,n),a}(sO);function yO(e){return yO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yO(e)}function vO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bO(e,t,n){return bO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},bO(e,t,n||e)}function wO(e,t){return wO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wO(e,t)}function _O(e,t){if(t&&("object"===yO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function SO(e){return SO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},SO(e)}const EO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wO(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=SO(r);if(o){var n=SO(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _O(this,e)});function a(){return vO(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"build",value:function(){bO(SO(a.prototype),"build",this).call(this),qt(this._element,"ht__manualRowMove--guideline")}}])&&gO(t.prototype,n),a}(sO);function kO(e){return kO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kO(e)}function RO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TO(e,t,n){return TO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},TO(e,t,n||e)}function CO(e,t){return CO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},CO(e,t)}function MO(e,t){if(t&&("object"===kO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return OO(e)}function OO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AO(e){return AO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},AO(e)}br.getSingleton().register("beforeRowMove"),br.getSingleton().register("afterRowMove");var LO=new WeakMap,xO="ht__manualRowMove",NO="show-ui",IO="on-moving--rows",DO="after-selection--rows",PO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CO(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=AO(o);if(i){var n=AO(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return MO(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),LO.set(OO(t),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),t.eventManager=new Fr(OO(t)),t.backlight=new mO(e),t.guideline=new EO(e),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),qt(this.hot.rootElement,xO),TO(AO(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),TO(AO(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Jt(this.hot.rootElement,xO),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),TO(AO(s.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=LO.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(e,t);var a=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,o,a),a}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var n=this.countFinalIndex(e,t);return LO.get(this).cachedDropIndex=t,this.moveRows(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=ee(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getRowsHeight",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=0,o=e;o<=t;o++){var i=n.getRenderableFromVisualIndex(o);null!==i&&(r+=this.hot.view.wt.wtTable.getRowHeight(i)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var n=e.from,r=e.to;return yo(Math.min(n.row,r.row),Math.max(n.row,r.row),(function(e){t.push(e)})),t}},{key:"refreshPositions",value:function(){var e=LO.get(this),t=e.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();t.row<o&&n>0&&this.hot.scrollViewportTo(n-1),t.row>=r&&r<i&&this.hot.scrollViewportTo(r+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=e.target.TD,u=an(this.hot.rootElement),l=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),c=e.target.eventPageY-u.top+a.holder.scrollTop,f=a.hider.offsetHeight,h=a.TBODY.offsetTop,d=this.backlight.getOffset().top,p=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(l+=a.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:s.offsetHeight/2+l<=c?(e.target.row=t.row+1,l+=0===t.row?s.offsetHeight-1:s.offsetHeight):e.target.row=t.row;var m=c,y=l;c+p+d>=f?m=f-p-d:c+d<h&&(m=h+Math.abs(d)),l>=f-1&&(y=f-1);var v=0;this.hot.view.wt.wtOverlays.topOverlay&&(v=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=o&&y-a.holder.scrollTop<v&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(m),this.guideline.setPosition(y)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view.wt,i=o.wtTable,a=o.wtViewport,s=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast(),l=LO.get(this);if(!u||!s||l.pressed||0!==e.button)return l.pressed=!1,l.rowsToMove.length=0,void Jt(this.hot.rootElement,[IO,NO]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=u.from,d=u.to,p=Math.min(h.row,d.row),m=Math.max(h.row,d.row);if(t.col<0&&t.row>=p&&t.row<=m){r.row=!0,l.pressed=!0,l.target.eventPageY=e.pageY,l.target.coords=t,l.target.TD=n,l.rowsToMove=this.prepareRowsToMoving();var y=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,y),this.backlight.setSize(i.hider.offsetWidth-y,this.getRowsHeight(p,m)),this.backlight.setOffset(-1*(this.getRowsHeight(p,t.row-1)+e.offsetY),null),qt(this.hot.rootElement,IO),this.refreshPositions()}else Jt(this.hot.rootElement,DO),l.pressed=!1,l.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=LO.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=LO.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?Jt(this.hot.rootElement,NO):qt(this.hot.rootElement,NO),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=t,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=LO.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,Jt(this.hot.rootElement,[IO,NO,DO]),this.hot.selection.isSelectedByRowHeader()&&qt(this.hot.rootElement,DO),!(n<1||void 0===t)){var r=e.rowsToMove[0],o=this.hot.toPhysicalRow(r),i=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),s=a+n-1;this.hot.selectRows(a,s)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view.wt.wtTable,t=this.hot.view.wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),TO(AO(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"manualRowMove"}},{key:"PLUGIN_PRIORITY",get:function(){return 140}}],n&&RO(t.prototype,n),r&&RO(t,r),s}(Vv);function HO(e){return HO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HO(e)}function jO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FO(e,t,n){return FO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},FO(e,t,n||e)}function YO(e,t){return YO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},YO(e,t)}function UO(e,t){if(t&&("object"===HO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return BO(e)}function BO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VO(e){return VO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},VO(e)}var WO,zO,GO,KO,XO="manualRowHeights",$O=new WeakMap,qO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YO(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=VO(o);if(i){var n=VO(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return UO(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var n=(t=a.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentRow=null,t.selectedRows=[],t.currentHeight=null,t.newSize=null,t.startY=null,t.startHeight=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Fr(BO(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.rowHeightsMap=void 0,$O.set(BO(t),{config:void 0}),qt(t.handle,"manualRowResizer"),qt(t.guide,"manualRowResizerGuide"),t}return t=s,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new rc,this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.bindEvents(),FO(VO(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FO(VO(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){$O.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),FO(VO(s.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",XO,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",XO,e),e.value}},{key:"setManualSize",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=Math.max(t,Fu.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var n=this.hot.view,r=n.wt,o=n.wt.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,s=yn(this.currentTH),u=this.currentTH.getBoundingClientRect(),l=i<r.getSetting("fixedRowsTop"),c=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");l?a=r.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=r.wtOverlays.bottomLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=r.wtOverlays.leftOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&f&&re(this.hot.getSelectedRange(),(function(e){yo(e.getTopLeftCorner().row,e.getBottomLeftCorner().row,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))})),this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(u.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(a.left,"px"),this.handle.style.width="".concat(s,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(yn(this.handle),10),t=parseInt(this.handle.style.left,10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);qt(this.handle,"active"),qt(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(t,"px"),this.guide.style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Jt(this.handle,"active"),Jt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(e){var t,n;return Ut(e,["TH"],this.hot.rootElement)&&"TBODY"===(null===(t=e.parentNode)||void 0===t||null===(n=t.parentNode)||void 0===n?void 0:n.tagName)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view.wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(!Hn(e.target)&&this.checkIfRowHeader(e.target)){var t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!0),r&&t()};this.dblclick>=2&&(this.selectedRows.length>1?(re(this.selectedRows,(function(e){n(e)})),t()):re(this.selectedRows,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;$t(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),re(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!1),r&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(re(this.selectedRows,(function(e){n(e)})),t()):re(this.selectedRows,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootElement,r=t.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(r,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(r,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings().manualRowResize&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var e=this,t=$O.get(this),n=this.hot.getSettings().manualRowResize,r=this.loadManualRowHeights();this.hot.batchExecution((function(){void 0!==r?r.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})):Array.isArray(n)?(n.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})),t.config=n):!0===n&&Array.isArray(t.config)&&t.config.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"destroy",value:function(){FO(VO(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"manualRowResize"}},{key:"PLUGIN_PRIORITY",get:function(){return 30}}],n&&jO(t.prototype,n),r&&jO(t,r),s}(Vv);function JO(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function QO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ZO=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1}var t,n,r;return t=e,n=[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",a=Math.min(t,r),s=Math.max(t,r),u=this[i],l=this[i]+this[o]-1;if(u>=t&&(this[i]+=n),n>0)t<=l&&t>u&&(this[o]+=n);else if(n<0){if(a<=u&&s>=l)return this.removed=!0,!1;if(u>=a&&u<=s){var c=s-u+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(u<=a&&l>=s)this[o]+=n;else if(u<=a&&l>=a&&l<s){var h=l-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new kd(new $n(this.row,this.col),new $n(this.row,this.col),new $n(this.getLastRow(),this.getLastColumn()))}}],r=[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return st(WO||(WO=JO(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return st(zO||(zO=JO(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return st(GO||(GO=JO(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return st(KO||(KO=JO(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}],n&&QO(t.prototype,n),r&&QO(t,r),e}();const eA=ZO;function tA(e,t,n,r){t?t.row===n&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}var nA;function rA(e){return function(e){if(Array.isArray(e))return oA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oA(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var aA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}var t,n,r;return t=e,n=[{key:"get",value:function(e,t){var n=this.mergedCells,r=!1;return re(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t&&(r=n,1))})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return re(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t)})),n}},{key:"getWithinRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,r=[],o=e;if(!o.includesRange){var i=new $n(o.from.row,o.from.col),a=new $n(o.to.row,o.to.col);o=new kd(i,i,a)}return re(n,(function(e){var n=new $n(e.row,e.col),i=new $n(e.row+e.rowspan-1,e.col+e.colspan-1),a=new kd(n,n,i);t?o.overlaps(a)&&r.push(e):o.includesRange(a)&&r.push(e)})),!!r.length&&r}},{key:"add",value:function(t){var n=this.mergedCells,r=t.row,o=t.col,i=t.rowspan,a=t.colspan,s=new eA(r,o,i,a),u=this.get(r,o),l=this.isOverlapping(s);return u||l?(ur(e.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),n.push(s),s)}},{key:"remove",value:function(e,t){var n=this.mergedCells,r=this.get(e,t),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],r=[];re(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&n.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,re(n,(function(t,o){yo(0,t.rowspan-1,(function(n){yo(0,t.colspan-1,(function(o){if(0!==o||0!==n){var i=e.hot.getCell(t.row+n,t.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),re(n,(function(e){tA.apply(void 0,rA(e))})),re(r,(function(e){tA.apply(void 0,rA(e))}))}},{key:"isOverlapping",value:function(e){var t=new kd(new $n(0,0),new $n(e.row,e.col),new $n(e.row+e.rowspan-1,e.col+e.colspan-1)),n=!1;return re(this.mergedCells,(function(e){return!new kd(new $n(0,0),new $n(e.row,e.col),new $n(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||(n=!0,!1)})),n}},{key:"isFirstRenderableMergedCell",value:function(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return new $n(e,t);var r=this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1);return new $n(r,o)}},{key:"shiftCollections",value:function(e,t,n){var r=this,o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}re(this.mergedCells,(function(e){e.shift(o,t)})),vo(this.mergedCells.length-1,0,(function(e){var t=r.mergedCells[e];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}],r=[{key:"IS_OVERLAPPING_WARNING",value:function(e){return st(nA||(nA=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),e.row,e.col)}}],n&&iA(t.prototype,n),r&&iA(t,r),e}();const sA=aA;function uA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lA(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var t,n;return t=e,n=[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,n,r){var o=t.slice(0),i=this.getAutofillSize(e,t,n),a=uA(e,4),s=a[0],u=a[1],l=a[2],c=a[3],f=["up","down"].indexOf(n)>-1?l-s+1:c-u+1,h=i-Math.floor(i/f)*f,d=this.getFarthestCollection(e,t,n,r);if(d)if("down"===n){var p=d.row+d.rowspan-s-h;o[2]+p>=this.plugin.hot.countRows()?o[2]-=h:o[2]+=h?p:0}else if("right"===n){var m=d.col+d.colspan-u-h;o[3]+m>=this.plugin.hot.countCols()?o[3]-=h:o[3]+=h?m:0}else if("up"===n){var y=l-h-d.row+1;o[0]+y<0?o[0]+=h:o[0]-=h?y:0}else if("left"===n){var v=c-h-d.col+1;o[1]+v<0?o[1]+=h:o[1]-=h?v:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:f}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),ge(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var r=uA(e,4),o=r[0],i=r[1],a=r[2],s=r[3],u=uA(t,4),l=u[0],c=u[1],f=u[2],h=u[3];switch(n){case"up":return o-l;case"down":return f-a;case"left":return i-c;case"right":return h-s;default:return null}}},{key:"getDragArea",value:function(e,t,n){var r=uA(e,4),o=r[0],i=r[1],a=r[2],s=r[3],u=uA(t,4),l=u[0],c=u[1],f=u[2],h=u[3];switch(n){case"up":return[l,c,o-1,s];case"down":return[a+1,i,f,s];case"left":return[l,c,a,i-1];case"right":return[o,s+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,r){var o=uA(e,4),i=o[0],a=o[1],s=o[2],u=o[3],l=["up","down"].indexOf(n)>-1,c=l?s:u,f=l?i:a,h=this.getAutofillSize(e,t,n),d=l?s-i+1:u-a+1,p=h-Math.floor(h/d)*d,m=null,y=null,v=null;switch(n){case"up":m="includesVertically",v=c-p+1;break;case"left":m="includesHorizontally",v=c-p+1;break;case"down":m="includesVertically",v=f+p-1;break;case"right":m="includesHorizontally",v=f+p-1}return re(r,(function(e){e[m](v)&&e.isFarther(y,n)&&(y=e)})),y}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(e,n){switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},i=0,a=null,s=1;do{for(var u=0;u<n.length;u+=1){if(o(a=n[u],i=s*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}u===n.length-1&&(s+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},r={min:null,max:null};return re(e,(function(e){var o=e[0],i=t.plugin.hot.propToCol(e[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var r=uA(this.getDragArea(e,t,n),4),o=r[0],i=r[1],a=r[2],s=r[3],u=new $n(o,i),l=new $n(a,s),c=new kd(u,u,l);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}],n&&cA(t.prototype,n),e}();const hA=fA;function dA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var t,n;return t=e,n=[{key:"snapDelta",value:function(e,t,n){var r=t.to,o=r.row+e.row,i=r.col+e.col;e.row?this.jumpOverMergedCell(e,n,o):e.col&&this.jumpOverMergedCell(e,n,i)}},{key:"jumpOverMergedCell",value:function(e,t,n){var r=e.row||e.col,o=null,i=null,a=null;e.row?(o=t.includesVertically(n),i=t.row,a=t.getLastRow()):e.col&&(o=t.includesHorizontally(n),i=t.col,a=t.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return new kd(e.highlight,e.from,new $n(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,r){var o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),s=Math.max(n[1],n[3]);if(void 0!==r&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var u=this.plugin.mergedCellsCollection.get(e,t);if(u){var l=u.getLastRow(),c=u.getLastColumn();return o<=u.row&&i<=u.col&&a>=l&&s>=c?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var o=0;o<e.colspan;o+=1)n.push(new $n(e.row+r,e.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],s=0;s<t.length;s+=1)a[s]=t[s].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}],n&&dA(t.prototype,n),e}();const mA=pA;function yA(e){return yA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yA(e)}function vA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||bA(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gA(e){return function(e){if(Array.isArray(e))return wA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||bA(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bA(e,t){if(e){if("string"==typeof e)return wA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wA(e,t):void 0}}function wA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SA(e,t,n){return SA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},SA(e,t,n||e)}function EA(e,t){return EA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},EA(e,t)}function kA(e,t){if(t&&("object"===yA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return RA(e)}function RA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TA(e){return TA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},TA(e)}br.getSingleton().register("beforeMergeCells"),br.getSingleton().register("afterMergeCells"),br.getSingleton().register("beforeUnmergeCells"),br.getSingleton().register("afterUnmergeCells");var CA,MA=new WeakMap,OA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EA(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=TA(o);if(i){var n=TA(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kA(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),MA.set(RA(t),{lastDesiredCoords:null}),t.mergedCellsCollection=null,t.autofillCalculations=null,t.selectionCalculations=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new sA(this),this.autofillCalculations=new hA(this),this.selectionCalculations=new mA(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,t){if("MergeCells"===t)return!1})),SA(TA(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),SA(TA(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),SA(TA(s.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(eA.containsNegativeValues(e)?(ur(eA.NEGATIVE_VALUES_WARNING(e)),t=!1):eA.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ur(eA.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):eA.isSingleCell(e)?(ur(eA.IS_SINGLE_CELL(e)),t=!1):eA.containsZeroSpan(e)&&(ur(eA.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n,r=[];re(e,(function(e){if(t.validateSetting(e)){var n=new $n(e.row,e.col),o=new $n(e.row+e.rowspan-1,e.col+e.colspan-1),i=new kd(n,n,o);r.push(t.mergeRange(i,!0,!0))}})),r=r.filter((function(e){return!0!==e}));var o=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,gA(o))}}},{key:"getBulkCollectionData",value:function(e){var t,n=this.getBulkCollectionDataRange(e),r=(t=this.hot).getData.apply(t,gA(n)).splice(0);return re(e,(function(e){var t=vA(e,3),o=t[0],i=t[1];re(t[2],(function(e,t){re(e,(function(e,a){r[o-n[0]+t][i-n[1]+a]=e}))}))})),[n[0],n[1],r]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],n=[0,0],r=null,o=null,i=null;return re(e,(function(e){r=e[0],o=e[1],i=e[2],t[0]=Math.min(r,t[0]),t[1]=Math.min(o,t[1]),n[0]=Math.max(r+i.length-1,n[0]),n[1]=Math.max(o+i[0].length-1,n[1])})),[].concat(t,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopLeftCorner(),i=e.getBottomRightCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[],u=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),yo(0,a.rowspan-1,(function(e){yo(0,a.colspan-1,(function(n){var r=null;s[e]||(s[e]=[]),0===e&&0===n?r=t.hot.getDataAtCell(a.row,a.col):t.hot.setCellMeta(a.row+e,a.col+n,"hidden",!0),s[e][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var l=this.mergedCellsCollection.add(a);return!l||(r?u=[a.row,a.col,s]:this.hot.populateFromArray(a.row,a.col,s,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,n),u)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),re(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),yo(0,e.rowspan-1,(function(n){yo(0,e.colspan-1,(function(r){t.hot.removeCellMeta(e.row+n,e.col+r,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,r){var o=new $n(e,t),i=new $n(n,r);this.mergeRange(new kd(o,o,i))}},{key:"unmerge",value:function(e,t,n,r){var o=new $n(e,t),i=new $n(n,r);this.unmergeRange(new kd(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),or(e))}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(n.from.row===t[r].row&&n.from.col===t[r].col&&n.to.row===t[r].row+t[r].rowspan-1&&n.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,n=MA.get(this),r=this.hot.getSelectedRangeLast(),o={row:e.row,col:e.col},i=new $n(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new $n(null,null)),a){var s=new $n(a.row,a.col),u=new $n(a.row+a.rowspan-1,a.col+a.colspan-1);new kd(s,s,u).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new $n(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-i.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-i.col:o.col,e.row>0?o.row=a.row+a.rowspan-1-i.row+e.row:e.row<0&&(o.row=i.row-a.row+e.row),e.col>0?o.col=a.col+a.colspan-1-i.col+e.col:e.col<0&&(o.col=i.col-a.col+e.col)}t=new $n(r.highlight.row+o.row,r.highlight.col+o.col);var l=this.mergedCellsCollection.get(t.row,t.col);if(l){var c=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);n.lastDesiredCoords=t,o={row:c.row-i.row,col:c.col-i.col}}0!==o.row&&(e.row=o.row),0!==o.col&&(e.col=o.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),r=_e(e),o=this.selectionCalculations.getUpdatedSelectionRange(n,e),i=_e(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=_e(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),re(a,(function(e){t.selectionCalculations.snapDelta(r,n,e)}))}while(r.row!==i.row||r.col!==i.col);e.row=r.row,e.col=r.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var r=n.row,o=n.col,i=n.colspan;return[r,o,r+n.rowspan-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Wf)}return this.getTranslatedPhrase(Vf)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||eA.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(e,t,n){var r=this.mergedCellsCollection.get(t,n),o=ke(r)?_e(r):void 0;if(ke(o)){var i=this.hot,a=i.rowIndexMapper,s=i.columnIndexMapper,u=o.row,l=o.col,c=o.colspan,f=o.rowspan,h=vA(this.translateMergedCellToRenderable(u,f,l,c),2),d=h[0],p=h[1],m=d-a.getRenderableFromVisualIndex(t)+1,y=p-s.getRenderableFromVisualIndex(n)+1;o.row=a.getFirstNotHiddenIndex(o.row,1),o.col=s.getFirstNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,m),o.colspan=Math.min(o.colspan,y)}tA(e,o,t,n)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),n=[t.row,t.col];e.row=n[0],e.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=new $n(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r].getRange();t.expandByRange(o)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,t,n){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ke(i)){var a=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(i.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ke(i)){var a=i.row+i.rowspan-1,s=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(a,-1));if(s>e.endRow)return e.endRow=s,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ke(i)){var a=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(i.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ke(i)){var a=i.col+i.colspan-1,s=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(a,-1));if(s>e.endColumn)return e.endColumn=s,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,r){var o,i,a=this.hot,s=a.rowIndexMapper,u=a.columnIndexMapper;return o=0===t?s.getFirstNotHiddenIndex(e,1):s.getFirstNotHiddenIndex(e+t-1,-1),i=0===r?u.getFirstNotHiddenIndex(n,1):u.getFirstNotHiddenIndex(n+r-1,-1),[e>=0?s.getRenderableFromVisualIndex(o):e,n>=0?u.getRenderableFromVisualIndex(i):n]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var n=this.autofillCalculations.getDirection(t,e),r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,n))return t;var o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o?r=this.autofillCalculations.snapDragArea(t,r,n,o):r}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast();re(this.mergedCellsCollection.getWithinRange(n),(function(t){n.getBottomRightCorner().row===t.getLastRow()&&n.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var o=t>0,i=t<0,a=n<0,s=n>0,u=r.row+r.rowspan-1==this.hot.countRows()-1,l=0===r.row,c=r.col+r.colspan-1==this.hot.countCols()-1,f=0===r.col;(o&&u||i&&l||s&&c||a&&f)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],r=[{key:"PLUGIN_KEY",get:function(){return"mergeCells"}},{key:"PLUGIN_PRIORITY",get:function(){return 150}}],n&&_A(t.prototype,n),r&&_A(t,r),s}(Vv);function AA(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return LA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LA(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xA(){ur(st(CA||(CA=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var NA="sort";function IA(e,t,n){var r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push("".concat(NA,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),r}function DA(e){var t=e.className.split(" "),n=new RegExp("^".concat(NA,"-[0-9]{1,2}$"));return t.filter((function(e){return n.test(e)}))}function PA(e){return PA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PA(e)}function HA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jA(e,t,n){return jA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},jA(e,t,n||e)}function FA(e,t){return FA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},FA(e,t)}function YA(e,t){if(t&&("object"===PA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function UA(e){return UA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},UA(e)}var BA="multiColumnSorting";ew(BA,(function(e,t){return function(n,r){var o=AA(n).slice(1),i=AA(r).slice(1);return function n(r){var a=e[r],s=t[r],u=o[r],l=i[r],c=s.multiColumnSorting,f=(c.compareFunctionFactory?c.compareFunctionFactory:nw(s.type))(a,s,c)(u,l);if(0===f){var h=r+1;if(void 0!==t[h])return n(h)}return f}(0)}}));var VA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FA(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=UA(o);if(i){var n=UA(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return YA(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).pluginKey=BA,t}return t=s,n=[{key:"isEnabled",value:function(){return jA(UA(s.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&xA(),jA(UA(s.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jA(UA(s.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){jA(UA(s.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){jA(UA(s.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jA(UA(s.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return jA(UA(s.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){jA(UA(s.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=jA(UA(s.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(r)),Jt(e,DA(e)),!1!==this.enabled&&qt(e,IA.apply(void 0,r))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&xA(),jA(UA(s.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==xb(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(pd()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,"append"))):this.sort(this.getColumnNextConfig(t.col)))}}],r=[{key:"PLUGIN_KEY",get:function(){return BA}},{key:"PLUGIN_PRIORITY",get:function(){return 170}}],n&&HA(t.prototype,n),r&&HA(t,r),s}(Sw);function WA(e){return WA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WA(e)}function zA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GA(e,t,n){return GA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},GA(e,t,n||e)}function KA(e,t){return KA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},KA(e,t)}function XA(e,t){if(t&&("object"===WA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $A(e){return $A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$A(e)}var qA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KA(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$A(o);if(i){var n=$A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return XA(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).dragged=[],t.eventManager=null,t.lastSetCell=null,t}return t=s,n=[{key:"isEnabled",value:function(){return Ke()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Fr(this)),this.registerListeners(),GA($A(s.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,n=this.hot.rootElement;function r(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(e){var n;return $t(e.target,"topLeftSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("topLeft"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):$t(e.target,"bottomRightSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottomRight"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(e){return $t(e.target,"topLeftSelectionHandle-HitArea")?(r.call(t,"topLeft"),t.touchStartRange=void 0,e.preventDefault(),!1):$t(e.target,"bottomRightSelectionHandle-HitArea")?(r.call(t,"bottomRight"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,s,u,l=e.hot,c=l.rootWindow,f=l.rootDocument,h=sn(c),d=un(c);if(0!==t.dragged.length){var p=f.elementFromPoint(n.touches[0].screenX-d,n.touches[0].screenY-h);p&&p!==t.lastSetCell&&("TD"!==p.nodeName&&"TH"!==p.nodeName||(-1===(r=t.hot.getCoords(p)).col&&(r.col=0),i=(o=t.hot.getSelectedRangeLast()).getWidth(),a=o.getHeight(),s=o.getDirection(),1===i&&1===a&&t.hot.selection.setRangeEnd(r),null!==(u=t.getCurrentRangeCoords(o,r,t.touchStartRange.direction,s,t.dragged[0])).start&&t.hot.selection.setRangeStart(u.start),t.hot.selection.setRangeEnd(u.end),t.lastSetCell=p),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,n,r,o){var i=e.getTopLeftCorner(),a=e.getBottomRightCorner(),s=e.getBottomLeftCorner(),u=e.getTopRightCorner(),l={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":l="topLeft"===o?{start:new $n(t.row,e.highlight.col),end:new $n(s.row,t.col)}:{start:new $n(e.highlight.row,t.col),end:new $n(t.row,i.col)};break;case"SE-NW":"bottomRight"===o&&(l={start:new $n(a.row,t.col),end:new $n(t.row,i.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"===o?l={start:t,end:s}:l.end=t;break;case"NW-SE":"topLeft"===o?l={start:t,end:a}:l.end=t;break;case"SE-NW":"topLeft"===o?l={start:t,end:i}:l.end=t;break;case"SW-NE":"topLeft"===o?l={start:t,end:u}:l.end=t}break;case"SW-NE":switch(r){case"NW-SE":l="bottomRight"===o?{start:new $n(t.row,i.col),end:new $n(s.row,t.col)}:{start:new $n(i.row,t.col),end:new $n(t.row,a.col)};break;case"SW-NE":l="topLeft"===o?{start:new $n(e.highlight.row,t.col),end:new $n(t.row,a.col)}:{start:new $n(t.row,i.col),end:new $n(i.row,t.col)};break;case"SE-NW":"bottomRight"===o?l={start:new $n(t.row,u.col),end:new $n(i.row,t.col)}:"topLeft"===o&&(l={start:s,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===o&&(l.end=t);break;case"SE-NW":"topLeft"===o?l.end=t:l={start:t,end:i}}}return l}},{key:"isDragged",value:function(){return this.dragged.length>0}}],r=[{key:"PLUGIN_KEY",get:function(){return"multipleSelectionHandles"}},{key:"PLUGIN_PRIORITY",get:function(){return 160}}],n&&zA(t.prototype,n),r&&zA(t,r),s}(Vv);function JA(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.label,n=void 0===t?"":t,r=e.colspan,o=void 0===r?1:r,i=e.origColspan,a=void 0===i?1:i,s=e.collapsible,u=void 0!==s&&s,l=e.crossHiddenColumns,c=void 0===l?[]:l,f=e.isCollapsed,h=void 0!==f&&f,d=e.isHidden,p=void 0!==d&&d,m=e.isRoot,y=void 0!==m&&m,v=e.isPlaceholder,g=void 0!==v&&v;return{label:n,colspan:o,origColspan:a,collapsible:u,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:y,isPlaceholder:g}}function QA(e){return function(e){if(Array.isArray(e))return ZA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ZA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ZA(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function eL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===t)return n;re(e,(function(e){var r=[],o=0;n.push(r),re(e,(function(e){var n=JA();if(ke(e)){var i=e.label,a=e.colspan;n.label=ct(i),"number"==typeof a&&a>1&&(n.colspan=a,n.origColspan=a)}else n.label=ct(e);var s=!1;if((o+=n.origColspan)>=t&&(n.colspan=n.origColspan-(o-t),n.origColspan=n.colspan,s=!0),r.push(n),n.colspan>1)for(var u=0;u<n.colspan-1;u++)r.push({label:"",isPlaceholder:!0});return!s}))}));var r=Math.max.apply(Math,QA(ne(n,(function(e){return e.length}))));return re(n,(function(e){if(e.length<r){var t=ne(new Array(r-e.length),(function(){return JA()}));e.splice.apply(e,[e.length,0].concat(QA(t)))}})),n}var tL=["row","col"];function nL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iL(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function aL(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,uL(e,t,"get"))}function sL(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,uL(e,t,"set"),n),n}function uL(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var lL=["label","collapsible"],cL=new WeakMap,fL=new WeakMap,hL=new WeakMap,dL=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),iL(this,cL,{writable:!0,value:[]}),iL(this,fL,{writable:!0,value:0}),iL(this,hL,{writable:!0,value:1/0})}var t,n;return t=e,n=[{key:"setColumnsLimit",value:function(e){sL(this,hL,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];sL(this,cL,eL(e,aL(this,hL))),sL(this,fL,aL(this,cL).length)}},{key:"getData",value:function(){return aL(this,cL)}},{key:"mergeWith",value:function(e){var t=this;re(e,(function(e){var n=e.row,r=e.col,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,tL),i=t.getHeaderSettings(n,r);null!==i&&ge(i,o,lL)}))}},{key:"map",value:function(e){re(aL(this,cL),(function(t){re(t,(function(t){var n=e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nL(Object(n),!0).forEach((function(t){rL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t));ke(n)&&ge(t,n,lL)}))}))}},{key:"getHeaderSettings",value:function(e,t){var n;if(e>=aL(this,fL)||e<0)return null;var r=aL(this,cL)[e];return t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(e>=aL(this,fL)||e<0)return r;for(var o=aL(this,cL)[e],i=0,a=t;a<o.length;a++){var s=o[a];if(s.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=s.colspan,r.push(s),s.colspan>1&&(a+=s.colspan-1),i===n)break;if(i>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return aL(this,fL)}},{key:"getColumnsCount",value:function(){return aL(this,fL)>0?aL(this,cL)[0].length:0}},{key:"clear",value:function(){sL(this,cL,[]),sL(this,fL,0)}}],n&&oL(t.prototype,n),e}();function pL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pL(Object(n),!0).forEach((function(t){vL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bL=new Map([["DF-pre-order",function e(t,n){for(var r=t.call(n,this),o=0;o<this.childs.length;o++){if(!1===r)return!1;r=e.call(this.childs[o],t,n)}return r}],["DF-post-order",function e(t,n){for(var r=0;r<this.childs.length;r++)if(!1===e.call(this.childs[r],t,n))return!1;return t.call(n,this)}],["BF",function(e,t){var n=[this];!function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,function(e){if(Array.isArray(e))return gL(e)}(i=o.childs)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return gL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gL(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),!1!==e.call(t,o)&&r()}var i}()}]]),wL=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vL(this,"data",{}),vL(this,"parent",null),vL(this,"childs",[]),this.data=t}var t,n;return t=e,n=[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new e(mL({},t.data)),r=0;r<t.childs.length;r++)n.addChild(this.cloneTree(t.childs[r]));return n}},{key:"replaceTreeWith",value:function(e){this.data=mL({},e.data),this.childs=[];for(var t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!bL.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));bL.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this;!function n(r){!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)}(this)}}],n&&yL(t.prototype,n),e}();function _L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_L(Object(n),!0).forEach((function(t){EL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function EL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TL(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function CL(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,ML(e,t,"get"))}function ML(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var OL,AL,LL=new WeakMap,xL=new WeakMap,NL=new WeakMap,IL=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),TL(this,LL,{writable:!0,value:new Map}),TL(this,xL,{writable:!0,value:new Map}),TL(this,NL,{writable:!0,value:null}),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,ML(e,t,"set"),n)}(this,NL,t)}var t,n;return t=e,n=[{key:"getRoots",value:function(){return Array.from(CL(this,LL).values())}},{key:"getRootByColumn",value:function(e){var t;return CL(this,xL).has(e)&&(t=CL(this,LL).get(CL(this,xL).get(e))),t}},{key:"getNode",value:function(e,t){var n=this.getRootByColumn(t);if(n){var r,o=t-CL(this,xL).get(t),i=0;return n.walkDown((function(t){var n=t.data,a=n.origColspan,s=n.headerLevel;if(e===s){if(o>=i&&o<=i+a-1)return r=t,!1;i+=a}})),r}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;CL(this,xL).clear(),re(CL(this,LL),(function(n){for(var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return kL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kL(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n,2)[1].data.colspan,o=t;o<t+r;o++)CL(e,xL).set(o,t);t+=r}))}},{key:"buildTree",value:function(){this.clear();for(var e=CL(this,NL).getColumnsCount(),t=0;t<e;){var n=CL(this,NL).getHeaderSettings(0,t),r=new wL;CL(this,LL).set(t,r),this.buildLeaves(r,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=CL(this,NL).getHeadersSettings(n,t,o);n+=1,re(i,(function(o){var i,a=SL(SL({},o),{},{headerLevel:n-1,columnIndex:t});1===n?(e.data=a,i=e):(i=new wL(a),e.addChild(i)),n<CL(r,NL).getLayersCount()&&r.buildLeaves(i,t,n,o.origColspan),t+=o.origColspan}))}},{key:"clear",value:function(){CL(this,LL).clear(),CL(this,xL).clear()}}],n&&RL(t.prototype,n),e}();function DL(e,t){e.walkDown((function(e){var n=e.data,r=e.childs;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(var o=1;o<n.colspan;o++)t(n.columnIndex+o)}))}function PL(e,t){var n=e.childs;if(0!==n.length)return n[0].data[t]}function HL(e){return PL(e,"origColspan")===e.data.origColspan}function jL(e){var t=e.data,n=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(HL(e))return jL(n[0]);t.isCollapsed=!1;var r=n.slice(1),o=new Set,i=0;if(r.length>0)re(r,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;i+=t.colspan,DL(e,(function(e){o.add(e)}))}));else{var a=t.colspan,s=t.origColspan,u=t.columnIndex;i=s-a;for(var l=1;l<s;l++)o.add(u+l)}return e.walkUp((function(e){var t=e.data;t.colspan+=i,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):HL(e)&&(t.isCollapsed=PL(e,"isCollapsed"))})),{rollbackModification:function(){return FL(e)},affectedColumns:Array.from(o),colspanCompensation:i}}function FL(e){var t,n=e.data,r=e.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(HL(e))return FL(r[0]);n.isCollapsed=!0;var o=r.slice(1),i=new Set;if(o.length>0)re(o,(function(e){DL(e,(function(e){i.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){e.data.isHidden=!0}))}));else for(var a=n.origColspan,s=n.columnIndex,u=1;u<a;u++){var l=s+u;i.add(l)}var c=n.colspan-(null!==(t=PL(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var t=e.data;t.colspan-=c,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):HL(e)&&(t.isCollapsed=PL(e,"isCollapsed"))})),{rollbackModification:function(){return jL(e)},affectedColumns:Array.from(i),colspanCompensation:c}}var YL=new Map([["collapse",FL],["expand",jL],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(st(OL||(OL=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));if(!e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(st(AL||(AL=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));if(e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}}]]),UL=["crossHiddenColumns"];function BL(e){var t=[];return re(e,(function(e){e.walkDown((function(e){for(var n=e.data,r=n.origColspan,o=n.columnIndex,i=n.headerLevel,a=n.crossHiddenColumns,s=function(e,t){var n;return Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n),n}(t,i),u=!1,l=o;l<o+r;l++)if(a.includes(l)||u)s.push({label:"",isPlaceholder:!0});else{var c=VL(n);c.isRoot=!0,s.push(c),u=!0}}))})),t}function VL(e){var t=JA(e);return t.crossHiddenColumns,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,UL)}var WL=["row"];function zL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zL(Object(n),!0).forEach((function(t){KL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function KL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $L(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function qL(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,QL(e,t,"set"),n),n}function JL(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,QL(e,t,"get"))}function QL(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ZL=new WeakMap,ex=new WeakMap,tx=new WeakMap,nx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$L(this,ZL,{writable:!0,value:new dL}),$L(this,ex,{writable:!0,value:new IL(JL(this,ZL))}),$L(this,tx,{writable:!0,value:[[]]})}var t,n;return t=e,n=[{key:"setState",value:function(e){JL(this,ZL).setData(e);var t=!1;try{JL(this,ex).buildTree()}catch(e){JL(this,ex).clear(),JL(this,ZL).clear(),t=!0}return qL(this,tx,BL(JL(this,ex).getRoots())),t}},{key:"setColumnsLimit",value:function(e){JL(this,ZL).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,n=ne(e,(function(e){var n=e.row,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,WL);return GL({row:n<0?t.rowCoordsToLevel(n):n},r)}));JL(this,ZL).mergeWith(n),JL(this,ex).buildTree(),qL(this,tx,BL(JL(this,ex).getRoots()))}},{key:"mapState",value:function(e){JL(this,ZL).map(e),JL(this,ex).buildTree(),qL(this,tx,BL(JL(this,ex).getRoots()))}},{key:"mapNodes",value:function(e){return ee(JL(this,ex).getRoots(),(function(t,n){return n.walkDown((function(n){var r=e(n.data);void 0!==r&&t.push(r)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));var r,o=JL(this,ex).getNode(t,n);return o&&(r=function(e,t,n){if(!YL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return YL.get(e)(t,n)}(e,o,n),qL(this,tx,BL(JL(this,ex).getRoots()))),r}},{key:"triggerColumnModification",value:function(e,t){return this.triggerNodeModification(e,-1,t)}},{key:"rowCoordsToLevel",value:function(e){var t=Math.max(this.getLayersCount(),1),n=t-1;return Math.min(Math.max(e+t,0),n)}},{key:"levelToRowCoords",value:function(e){var t=Math.max(this.getLayersCount(),1),n=-t;return Math.min(Math.max(e-t,n),-1)}},{key:"getHeaderSettings",value:function(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?null:null!==(n=null===(r=JL(this,tx)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(e,t){e<0&&(e=this.rowCoordsToLevel(e));var n=JL(this,ex).getNode(e,t);return n?GL({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,t){var n;if((null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0}).isRoot)return t;for(var r=t-1;r>=0;){var o;if((null!==(o=this.getHeaderSettings(e,r))&&void 0!==o?o:{isRoot:!0}).isRoot)break;r-=1}return r}},{key:"getLayersCount",value:function(){return JL(this,ZL).getLayersCount()}},{key:"getColumnsCount",value:function(){return JL(this,ZL).getColumnsCount()}},{key:"clear",value:function(){qL(this,tx,[]),JL(this,ZL).clear(),JL(this,ex).clear()}}],n&&XL(t.prototype,n),e}();function rx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ox=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}var t,n;return t=e,n=[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsCache.length=0;for(var n=0;n<t;n++)this.widthsCache.push(e[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var t=this.nestedHeaders.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("table"),o=!1,i=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.getLayersCount(),s=this.nestedHeaders.hot.countCols(),u=a-1,l=0;l<a;l++){var c=t.createElement("tr");o=!1;for(var f=0;f<s;f++){var h=t.createElement("th"),d=_e(this.nestedHeaders.getHeaderSettings(l,f));d&&!d.isHidden&&(l===u&&(d.colspan>1&&(o=!0),i&&(d.label+='<button class="changeType"></button>')),nn(h,d.label),void 0!==d.colspan&&(h.colSpan=d.colspan),c.appendChild(h))}r.appendChild(c)}if(o){for(var p=t.createElement("tr"),m=0;m<s;m++){var y=t.createElement("th");p.appendChild(y)}r.appendChild(p)}n.appendChild(r),e.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}],n&&rx(t.prototype,n),e}();const ix=ox;function ax(e){return ax="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ax(e)}var sx,ux;function lx(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function cx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hx(e,t,n){return hx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yx(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},hx(e,t,n||e)}function dx(e,t){return dx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dx(e,t)}function px(e,t){if(t&&("object"===ax(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return mx(e)}function mx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yx(e){return yx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yx(e)}function vx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function bx(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,_x(e,t,"set"),n),n}function wx(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,_x(e,t,"get"))}function _x(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Sx=new WeakMap,Ex=new WeakMap,kx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dx(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yx(o);if(i){var n=yx(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return px(this,e)});function s(){var e;cx(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gx(mx(e=a.call.apply(a,[this].concat(n))),Sx,{writable:!0,value:new nx}),gx(mx(e),Ex,{writable:!0,value:null}),vx(mx(e),"ghostTable",new ix(mx(e))),vx(mx(e),"detectedOverlappedHeaders",!1),e}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().nestedHeaders;Array.isArray(t)&&Array.isArray(t[0])||ur(st(sx||(sx=lx(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth.apply(e,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),hx(yx(s.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var e=this;if(this.hot.view){var t=this.hot.getSettings().nestedHeaders;wx(this,Sx).setColumnsLimit(this.hot.countSourceCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=wx(this,Sx).setState(t)),this.detectedOverlappedHeaders&&ur(st(ux||(ux=lx(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(t,n){var r=!0===t?"hide-column":"show-column";wx(e,Sx).triggerColumnModification(r,n)})),!wx(this,Ex)&&this.enabled&&bx(this,Ex,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(t){t.forEach((function(t){var n=t.op,r=t.index,o=t.newValue;if("replace"===n){var i=!0===o?"hide-column":"show-column";wx(e,Sx).triggerColumnModification(i,r)}}))}))),this.ghostTable.buildWidthsMapper(),hx(yx(s.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),wx(this,Sx).clear(),wx(this,Ex).unsubscribe(),bx(this,Ex,null),this.ghostTable.clear(),hx(yx(s.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return wx(this,Sx)}},{key:"getLayersCount",value:function(){return wx(this,Sx).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return wx(this,Sx).getHeaderSettings(e,t)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view.wt,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topLeftCornerOverlay?e.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var a=n.childNodes[i];if(!a)break;for(var s=r.childNodes[i],u=o?o.childNodes[i]:null,l=0,c=a.childNodes.length;l<c;l++)a.childNodes[l].removeAttribute("colspan"),Jt(a.childNodes[l],"hiddenHeader"),s&&s.childNodes[l]&&(s.childNodes[l].removeAttribute("colspan"),Jt(s.childNodes[l],"hiddenHeader")),o&&u&&u.childNodes[l]&&(u.childNodes[l].removeAttribute("colspan"),Jt(u.childNodes[l],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,n=this.hot.view.wt.getSetting("fixedColumnsLeft");return function(r,o){var i,a=t.hot,s=a.rootDocument,u=a.columnIndexMapper,l=a.view,c=u.getVisualFromRenderableIndex(r);null===c&&(c=r),o.removeAttribute("colspan"),Jt(o,"hiddenHeader");var f=null!==(i=wx(t,Sx).getHeaderSettings(e,c))&&void 0!==i?i:{label:""},h=f.colspan,d=f.label,p=f.isHidden;if(f.isPlaceholder||p)qt(o,"hiddenHeader");else if(h>1){var m,y,v=null===(m=l.wt.wtOverlays.topLeftCornerOverlay)||void 0===m?void 0:m.clone.wtTable.THEAD.contains(o),g=null===(y=l.wt.wtOverlays.leftOverlay)||void 0===y?void 0:y.clone.wtTable.THEAD.contains(o),b=v||g?Math.min(h,n-r):h;b>1&&o.setAttribute("colspan",b)}var w=s.createElement("div"),_=s.createElement("span");qt(w,"relative"),qt(_,"colHeader"),nn(_,d),w.appendChild(_),Zt(o),o.appendChild(w),t.hot.runHooks("afterGetColHeader",c,o)}}},{key:"onBeforeHighlightingColumnHeader",value:function(e,t,n){var r=wx(this,Sx).getHeaderTreeNodeData(t,e);if(!r)return e;var o=n.classNames,i=n.columnCursor,a=n.selectionType,s=n.selectionWidth,u=wx(this,Sx).getHeaderSettings(t,e),l=u.isRoot,c=u.colspan;if(a===bd){if(!l)return r.columnIndex}else a===md&&(c>s-i||!l)&&(o.length=0);return e}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){var n=this._getHeaderTreeNodeDataByCoords(t);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,i=[],a=n.columnIndex,s=n.origColspan,u=!r.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?i.push(o.getTopRightCorner().col,a,t.row):t.col>o.from.col?i.push(o.getTopLeftCorner().col,a+s-1,t.row):i.push(a,a+s-1,t.row):(sr(e)||ar(e)&&u)&&i.push(a,a+s-1,t.row),r.selectColumns.apply(r,i)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o;if(this.hot.view.isMouseDown()){var i=this._getHeaderTreeNodeDataByCoords(t);if(i){var a=i.columnIndex,s=i.origColspan,u=this.hot.getSelectedRangeLast(),l=u.getTopLeftCorner(),c=u.getBottomRightCorner(),f=u.from;r.column=!0,r.cell=!0;var h=[];t.col<f.col?h.push(c.col,a):t.col>f.col?h.push(l.col,a+s-1):h.push(a,a+s-1),(o=this.hot).selectColumns.apply(o,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=0;t<wx(this,Sx).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=wx(this,Sx).getLayersCount(),n=e.startColumn,r=!!t,o=0;o<t;o++){var i=wx(this,Sx).findLeftMostColumnIndex(o,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(r=!1),po(a)&&a<e.startColumn){n=a;break}}e.startColumn=r?wx(this,Sx).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.widthsCache[t];return e>n?e:n}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){bx(this,Sx,null),null!==wx(this,Ex)&&(wx(this,Ex).unsubscribe(),bx(this,Ex,null)),hx(yx(s.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(e){if(!(e.row>=0||e.col<0))return wx(this,Sx).getHeaderTreeNodeData(e.row,e.col)}}],r=[{key:"PLUGIN_KEY",get:function(){return"nestedHeaders"}},{key:"PLUGIN_PRIORITY",get:function(){return 280}}],n&&fx(t.prototype,n),r&&fx(t,r),s}(Vv);function Rx(e){return function(e){if(Array.isArray(e))return Tx(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Tx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tx(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cx(e){return Cx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cx(e)}function Mx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ox=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}var t,n;return t=e,n=[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},yo(0,this.data.length-1,(function(t){e.cacheNode(e.data[t],0,null)}))}},{key:"cacheNode",value:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&re(e.__children,(function(n){r.cacheNode(n,t+1,e)}))}},{key:"getDataObject",value:function(e){return null==e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,r){var o=this,i=!1,a=t;if(isNaN(a)&&a.end)return a;var s=e;return s||(s={__children:this.data},i=!0,a-=1),null!=n&&a===n?{result:s,end:!0}:null!=r&&s===r?{result:a,end:!0}:(a+=1,s.__children&&re(s.__children,(function(e){if(o.parentReference.set(e,i?null:s),a=o.readTreeNodes(e,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return Te(this.data[0],(function(t,n){e[n]=null})),e}},{key:"getRowIndex",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(re(r.__children,(function(e){n+=1,e.__children&&(n+=t.countChildren(e))})),n):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===Cx(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"getChild",value:function(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,t){var n=t;this.hot.runHooks("beforeAddChild",e,n);var r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",e,n)}},{key:"addChildAtIndex",value:function(e,t,n){var r,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){var i=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",i,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(i,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",i,1),r=i}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,o,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null)}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(e)?(yo(e[0],e[2],(function(e){var n=t.translateTrimmedRow(e);o.push(t.getDataObject(n))})),yo(0,o.length-2,(function(e){t.detachFromParent(o[e],!1)})),r=o[o.length-1]):r=e;var i=this.getRowIndex(r),a=this.countChildren(r),s=this.getRowIndexWithinParent(r),u=this.getRowParent(r),l=this.getRowParent(u),c=this.getRowIndex(l),f=null;if(this.hot.runHooks("beforeDetachChild",u,r),null!=s){var h=Array.from(new Array(i+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",i,a+1,h,this.plugin.pluginName),u.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,a+1,h,this.plugin.pluginName),l){f=c+this.countChildren(l);var d=this.getChild(l,this.countChildren(l)-1),p=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",p+1,a+1,this.plugin.pluginName),l.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,r,this.getRowIndex(r)),n&&this.hot.render()}},{key:"filterData",value:function(e,t,n){var r=this,o=[];re(n,(function(e){o.push(r.getDataObject(e))})),re(o,(function(e){var t=r.getRowIndexWithinParent(e),n=r.getRowParent(e);null===n?r.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){var r,o=this.getDataObject(e-1),i=null,a=e;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):e<this.countAllRows()&&(i=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),i)n?(r=i.__children).splice.apply(r,[a,t].concat(Rx(n))):i.__children.splice(a,t);else if(n){var s;(s=this.data).splice.apply(s,[a,t].concat(Rx(n)))}else this.data.splice(a,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,n=null;do{null!==(n=this.getRowParent(n))&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,n,r){var o=t===this.hot.countRows(),i=this.getRowParent(e),a=this.getRowIndexWithinParent(e),s=i.__children.slice(a,a+1),u=e>t,l=o?this.getRowParent(t-1):this.getRowParent(t);null==l&&(l=this.getRowParent(t-1)),null==l&&(l=this.getDataObject(t-1)),l?l.__children||(l.__children=[]):(l=this.getDataObject(t)).__children=[];var c=o||n||r?l.__children.length:this.getRowIndexWithinParent(t),f=i===l;l.__children.splice(c,0,s[0]),i.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(l)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}],n&&Mx(t.prototype,n),e}();const Ax=Ox,Lx=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.plugin=t};function xx(e){return xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xx(e)}function Nx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ix(e,t){return Ix=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ix(e,t)}function Dx(e,t){if(t&&("object"===xx(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Px(e){return Px=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Px(e)}var Hx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ix(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Px(o);if(i){var n=Px(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Dx(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsingUI=n.plugin.collapsingUI,n.rowHeaderWidthCache=null,n}return t=s,n=[{key:"appendLevelIndicators",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(n),o=this.dataManager.getDataObject(n),i=t.getElementsByTagName("DIV")[0],a=i.querySelector("span.rowHeader");if(re(i.querySelectorAll('[class^="ht_nesting"]'),(function(e){e&&i.removeChild(e)})),qt(t,s.CSS_CLASSES.indicatorContainer),r){var u=this.hot.rootDocument,l=a.cloneNode(!0);i.innerHTML="",yo(0,r-1,(function(){var e=u.createElement("SPAN");qt(e,s.CSS_CLASSES.emptyIndicator),i.appendChild(e)})),i.appendChild(l)}if(this.dataManager.hasChildren(o)){var c=this.hot.rootDocument.createElement("DIV");qt(t,s.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?qt(c,"".concat(s.CSS_CLASSES.button," ").concat(s.CSS_CLASSES.expandButton)):qt(c,"".concat(s.CSS_CLASSES.button," ").concat(s.CSS_CLASSES.collapseButton)),i.appendChild(c)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}],r=[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}],n&&Nx(t.prototype,n),r&&Nx(t,r),s}(Lx);const jx=Hx;function Fx(e){return Fx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fx(e)}function Yx(e){return function(e){if(Array.isArray(e))return Ux(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ux(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ux(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ux(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vx(e,t){return Vx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vx(e,t)}function Wx(e,t){if(t&&("object"===Fx(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zx(e){return zx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zx(e)}var Gx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vx(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zx(r);if(o){var n=zx(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Wx(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsedRows=[],n.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),re(n.lastCollapsedRows,(function(o,i){o>=e&&o<t&&(n.lastCollapsedRows[i]=o+r)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:function(e,t){yo(e,e+t-1,(function(e){var t=n.lastCollapsedRows.indexOf(e);t>-1&&n.lastCollapsedRows.splice(t,1)}))}},n}return t=a,n=[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(i)&&re(i.__children,(function(e){o.push(t.dataManager.getRowIndex(e))})),s=this.collapseRows(o,!0,!1),r&&this.trimRows(s),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),s}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];re(e,(function(e){o.push.apply(o,Yx(t.collapseChildren(e,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return re(e,(function(e){o.push(e),n&&t.collapseChildRows(e,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);re(o.__children,(function(e){var r=t.dataManager.getRowIndex(e);n.push(r),t.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return re(e,(function(e){o.push(e),n&&t.expandChildRows(e,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);re(o.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var r=t.dataManager.getRowIndex(e);n.push(r),t.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&re(i.__children,(function(e){var n=t.dataManager.getRowIndex(e);o.push(n)})),s=this.expandRows(o,!0,!1),r&&this.untrimRows(s),n&&this.renderAndAdjust(),s}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];re(e,(function(e){o.push.apply(o,Yx(t.expandChildren(e,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];re(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];re(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batchExecution((function(){re(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"untrimRows",value:function(e){var t=this;this.hot.batchExecution((function(){re(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&re(n.__children,(function(e){var n=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var n=this.translateTrimmedRow(t.row);$t(e.target,jx.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),or(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}],n&&Bx(t.prototype,n),a}(Lx);const Kx=Gx;function Xx(e){return Xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xx(e)}function $x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qx(e,t){return qx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qx(e,t)}function Jx(e,t){if(t&&("object"===Xx(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qx(e)}function Qx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zx(e){return Zx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zx(e)}var eN=new WeakMap;const tN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qx(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zx(r);if(o){var n=Zx(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Jx(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),n=i.call(this,e,t),eN.set(Qx(n),{row_above:function(e,t){var r=t[t.length-1];n.dataManager.addSibling(r.start.row,"above")},row_below:function(e,t){var r=t[t.length-1];n.dataManager.addSibling(r.start.row,"below")}}),n.dataManager=n.plugin.dataManager,n}return t=a,(n=[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(lh)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(ch)},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),n=t.dataManager.translateTrimmedRow(e[0]);return!t.dataManager.getRowParent(n)||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return yo(0,e.items.length-1,(function(t){if(0===t)return re(n,(function(n,r){e.items.splice(t+r,0,n)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=eN.get(this);return yo(0,e.items.length-1,(function(n){var r=t[e.items[n].key];null!=r&&(e.items[n].callback=r)})),e}}])&&$x(t.prototype,n),a}(Lx);var nN;function rN(e){return function(e){if(Array.isArray(e))return oN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oN(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var aN=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}var t,n;return t=e,n=[{key:"onBeforeRowMove",value:function(e,t,n,r){var o=this;if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;var i=n===this.hot.countRows(),a=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),s=!0,u=e.map((function(e){if(!s)return!1;var t=o.dataManager.translateTrimmedRow(e);return s=o.shouldAllowMoving(t,a),t})),l=-1===u.indexOf(a);if(!s||!l)return!1;var c=this.getBaseParent(u),f=this.getTargetParent(i,a),h=c===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,h),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,n=e.finalIndex,r=e.dropIndex,o=e.movePossible,i=!1;return ht(r)&&(ur(st(nN||(nN=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,r,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,n){n||(Math.max.apply(Math,rN(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,n){var r=this,o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){e.forEach((function(e){r.dataManager.moveRow(e,t,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(e,t){var n,r=this,o=[],i=Math.max.apply(Math,rN(e))<t;e.forEach((function(e){o.push(r.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(n=this.hot).spliceCellsMeta.apply(n,[t-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(e,t){var n,r=e.length,o=0,i=0,a=null;if(this.movedToCollapsed){var s;s=e[r-1]<t?this.dataManager.translateTrimmedRow(t-r):this.dataManager.translateTrimmedRow(t);var u=this.dataManager.getRowParent(null===s?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(u);i=o=this.dataManager.untranslateTrimmedRow(l)}else e[r-1]<t?o=(i=t-1)-r+1:i=(o=t)+r-1;a=this.hot.selection,n=this.hot.countCols()-1,a.setRangeStart(new $n(o,0)),a.setRangeEnd(new $n(i,n),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}}],n&&iN(t.prototype,n),e}();function sN(e){return sN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sN(e)}function uN(e){return function(e){if(Array.isArray(e))return lN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return lN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lN(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fN(e,t,n){return fN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},fN(e,t,n||e)}function hN(e,t){return hN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hN(e,t)}function dN(e,t){if(t&&("object"===sN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pN(e)}function pN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mN(e){return mN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mN(e)}var yN=new WeakMap,vN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hN(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mN(o);if(i){var n=mN(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dN(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).dataManager=null,t.headersUI=null,t.collapsedRowsMap=null,yN.set(pN(t),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Ic),this.dataManager=new Ax(this,this.hot),this.collapsingUI=new Kx(this,this.hot),this.headersUI=new jx(this,this.hot),this.contextMenuUI=new tN(this,this.hot),this.rowMoveController=new aN(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeViewRender",(function(){return e.onBeforeViewRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("filterData",(function(){return e.onFilterData.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(t){return e.onBeforeLoadData(t)})),fN(mN(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),fN(mN(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),fN(mN(s.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}},{key:"disableCoreAPIModifiers",value:function(){yN.get(this).skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){yN.get(this).skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){if(!yN.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){if(!yN.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,n){return!(!yN.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,n),1))}},{key:"onFilterData",value:function(e,t,n){var r=yN.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(r!==this.pluginName){var i=yN.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=Array.from(n.reduce((function(e,t){if(r.dataManager.isParent(t)){var n=r.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((function(t){return e.add(r.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));n.length=0,n.push.apply(n,uN(o))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,uN(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeViewRender",value:function(e,t){yN.get(this).skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){fN(mN(s.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(e){if(!Pl(e))return lr("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}}],r=[{key:"PLUGIN_KEY",get:function(){return"nestedRows"}},{key:"PLUGIN_PRIORITY",get:function(){return 300}}],n&&cN(t.prototype,n),r&&cN(t,r),s}(Vv);function gN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wN=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;gN(this,e),this.rootWindow=n,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}var t,n;return t=e,n=[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var n=void 0===e?t:e,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;re(this.savedKeys,(function(t,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}],n&&bN(t.prototype,n),e}();const _N=wN;function SN(e){return SN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SN(e)}function EN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kN(e,t,n){return kN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},kN(e,t,n||e)}function RN(e,t){return RN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},RN(e,t)}function TN(e,t){if(t&&("object"===SN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function CN(e){return CN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},CN(e)}br.getSingleton().register("persistentStateSave"),br.getSingleton().register("persistentStateLoad"),br.getSingleton().register("persistentStateReset");var MN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RN(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=CN(o);if(i){var n=CN(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return TN(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).storage=void 0,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new _N(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,n){return e.saveValue(t,n)})),this.addHook("persistentStateLoad",(function(t,n){return e.loadValue(t,n)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),kN(CN(s.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,kN(CN(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),kN(CN(s.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){kN(CN(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"persistentState"}},{key:"PLUGIN_PRIORITY",get:function(){return 0}}],n&&EN(t.prototype,n),r&&EN(t,r),s}(Vv);function ON(e){return ON="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ON(e)}function AN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xN(e,t,n){return xN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},xN(e,t,n||e)}function NN(e,t){return NN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},NN(e,t)}function IN(e,t){if(t&&("object"===ON(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function DN(e){return DN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},DN(e)}var PN=function(e,t,n,r,o){e.getCellMeta(t,n).isSearchResult=o},HN=function(e,t){return!(ht(e)||null===e||!e.toLowerCase||0===e.length||ht(t)||null===t||-1===t.toString().toLowerCase().indexOf(e.toLowerCase()))},jN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NN(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=DN(o);if(i){var n=DN(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return IN(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).callback=PN,t.queryMethod=HN,t.searchResultClass="htSearchResult",t}return t=s,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().search;this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),xN(DN(s.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("beforeRenderer",t)})),xN(DN(s.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xN(DN(s.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],s=this.hot;return yo(0,o-1,(function(o){yo(0,i-1,(function(i){var u=t.hot.getDataAtCell(o,i),l=t.hot.getCellMeta(o,i),c=l.search.callback||n,f=(l.search.queryMethod||r)(e,u,l);if(f){var h={row:o,col:i,data:u};a.push(h)}c&&c(s,o,i,u,f)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){ke(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,n,r,o,i){var a,s,u=i.className||[],l=[];"string"==typeof u?l=u.split(" "):(a=l).push.apply(a,function(e){if(Array.isArray(e))return AN(e)}(s=u)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||function(e,t){if(e){if("string"==typeof e)return AN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AN(e,t):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.isEnabled()&&i.isSearchResult?l.includes(this.searchResultClass)||l.push("".concat(this.searchResultClass)):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),i.className=l.join(" ")}},{key:"destroy",value:function(){xN(DN(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"search"}},{key:"PLUGIN_PRIORITY",get:function(){return 190}}],n&&LN(t.prototype,n),r&&LN(t,r),s}(Vv);function FN(e){return FN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FN(e)}function YN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UN(e,t,n){return UN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},UN(e,t,n||e)}function BN(e,t){return BN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},BN(e,t)}function VN(e,t){if(t&&("object"===FN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function WN(e){return WN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},WN(e)}var zN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BN(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=WN(o);if(i){var n=WN(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return VN(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).scrollbars=[],t.clones=[],t.lockedCollection=!1,t.freezeOverlays=!1,t}return t=s,n=[{key:"isEnabled",value:function(){return K()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterViewRender",(function(){return e.onAfterViewRender()})),this.registerEvents(),UN(WN(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,UN(WN(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){UN(WN(s.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.leftOverlay,o=e.topLeftCornerOverlay,i=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,re(this.clones,(function(e){qt(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,re(this.clones,(function(e){Jt(e,"hide-tween"),qt(e,"show-tween")})),setTimeout((function(){re(e.clones,(function(e){Jt(e,"show-tween")}))}),400),re(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}],r=[{key:"PLUGIN_KEY",get:function(){return"touchScroll"}},{key:"PLUGIN_PRIORITY",get:function(){return 200}}],n&&YN(t.prototype,n),r&&YN(t,r),s}(Vv);function GN(e){return GN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GN(e)}function KN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XN(e,t,n){return XN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},XN(e,t,n||e)}function $N(e,t){return $N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$N(e,t)}function qN(e,t){if(t&&("object"===GN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function JN(e){return JN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},JN(e)}var QN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$N(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=JN(o);if(i){var n=JN(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return qN(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).trimmedRowsMap=null,t}return t=s,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Ic),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),XN(JN(s.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){e.trimmedRowsMap.clear(),re(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),XN(JN(s.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),XN(JN(s.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,n=this.getTrimmedRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",n,o,r)&&(r&&this.hot.batchExecution((function(){re(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e),r=t,o=this.trimmedRowsMap.getValues().slice(),i=e.length>0;n&&i&&(re(e,(function(e){o[e]=!1})),r=ee(o,(function(e,t,n){return t&&e.push(n),e}),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&i)&&(n&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,r,n&&i,n&&r.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){re(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"destroy",value:function(){XN(JN(s.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return"trimRows"}},{key:"PLUGIN_PRIORITY",get:function(){return 330}}],n&&KN(t.prototype,n),r&&KN(t,r),s}(Vv);function ZN(e){return ZN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZN(e)}function eI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nI(e,t,n){return t&&tI(e.prototype,t),n&&tI(e,n),e}function rI(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oI(e,t)}function oI(e,t){return oI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oI(e,t)}function iI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sI(e);if(t){var o=sI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aI(this,n)}}function aI(e,t){if(t&&("object"===ZN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sI(e){return sI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sI(e)}function uI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||lI(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lI(e,t){if(e){if("string"==typeof e)return cI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cI(e,t):void 0}}function cI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fI(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,r){var o=this,i=n&&n.length;i&&n.find((function(e){var t=uI(e,4);return t[2]!==t[3]}))&&t.done((function(){var t=n.reduce((function(e,t){return e.push(function(e){return function(e){if(Array.isArray(e))return cI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lI(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t)),e}),[]);re(t,(function(t){t[1]=e.propToCol(t[1])}));var r=i>1?o.getSelected():[[t[0][0],t[0][1]]];return new fI.ChangeAction(t,r)}),r)})),e.addHook("afterCreateRow",(function(e,n,r){t.done((function(){return new fI.CreateRowAction(e,n)}),r)})),e.addHook("beforeRemoveRow",(function(n,r,o,i){t.done((function(){var o=t.instance.getSourceDataArray(),i=(o.length+n)%o.length,a=e.toPhysicalRow(i),s=we(o.slice(a,a+r));return new fI.RemoveRowAction(i,s,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)}),i)})),e.addHook("afterCreateCol",(function(e,n,r){t.done((function(){return new fI.CreateColumnAction(e,n)}),r)})),e.addHook("beforeRemoveCol",(function(n,r,o,i){t.done((function(){var o=t.instance.getSourceDataArray(),i=(t.instance.countCols()+n)%t.instance.countCols(),a=[],s=[],u=[];yo(o.length-1,(function(t){var n=[],s=o[t];yo(i,i+(r-1),(function(t){n.push(s[e.toPhysicalColumn(t)])})),a.push(n)})),yo(r-1,(function(t){u.push(e.toPhysicalColumn(i+t))})),Array.isArray(e.getSettings().colHeaders)&&yo(r-1,(function(t){s.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}));var l=e.columnIndexMapper.getIndexesSequence(),c=e.rowIndexMapper.getIndexesSequence();return new fI.RemoveColumnAction(i,u,a,s,l,c,e.getSettings().fixedColumnsLeft)}),i)})),e.addHook("beforeCellAlignment",(function(e,n,r,o){t.done((function(){return new fI.CellAlignmentAction(e,n,r,o)}))})),e.addHook("beforeFilter",(function(e){t.done((function(){return new fI.FiltersAction(e)}))})),e.addHook("beforeRowMove",(function(e,n){!1!==e&&t.done((function(){return new fI.RowMoveAction(e,n)}))})),e.addHook("beforeMergeCells",(function(n,r){r||t.done((function(){return new fI.MergeCellsAction(e,n)}))})),e.addHook("afterUnmergeCells",(function(n,r){r||t.done((function(){return new fI.UnmergeCellsAction(e,n)}))})),e.addHook("afterInit",(function(){t.init()}))}fI.prototype.done=function(e,t){if(!this.ignoreNewActions&&"UndoRedo.undo"!==t&&"UndoRedo.redo"!==t&&"auto"!==t){var n=this.doneActions.slice();if(!1!==this.instance.runHooks("beforeUndoStackChange",n,t)){var r=e(),o=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}},fI.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var n=we(t);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;var r=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),t.undo(this.instance,(function(){r.ignoreNewActions=!1,r.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},fI.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var n=we(t);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;var r=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),t.redo(this.instance,(function(){r.ignoreNewActions=!1,r.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},fI.prototype.isUndoAvailable=function(){return this.doneActions.length>0},fI.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},fI.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},fI.prototype.isEnabled=function(){return this.enabled},fI.prototype.enable=function(){if(!this.isEnabled()){var e,t=this.instance;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},t.addHook("beforeKeyDown",pI),t.addHook("afterChange",mI)}},fI.prototype.disable=function(){if(this.isEnabled()){var e,t=this.instance;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,t.removeHook("beforeKeyDown",pI),t.removeHook("afterChange",mI)}},fI.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},fI.Action=function(){},fI.Action.prototype.undo=function(){},fI.Action.prototype.redo=function(){},fI.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},ve(fI.ChangeAction,fI.Action),fI.ChangeAction.prototype.undo=function(e,t){for(var n=we(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");for(var s=0,u=n.length;s<u;s++){var l=uI(n[s],2),c=l[0],f=l[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&r===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},fI.ChangeAction.prototype.redo=function(e,t){for(var n=we(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},fI.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},ve(fI.CreateRowAction,fI.Action),fI.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},fI.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},fI.RemoveRowAction=function(e,t,n,r){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r},ve(fI.RemoveRowAction,fI.Action),fI.RemoveRowAction.prototype.undo=function(e,t){var n=e.getSettings();n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},fI.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},fI.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},ve(fI.CreateColumnAction,fI.Action),fI.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},fI.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},fI.RemoveColumnAction=function(e,t,n,r,o,i,a){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsLeft=a},ve(fI.RemoveColumnAction,fI.Action),fI.RemoveColumnAction.prototype.undo=function(e,t){var n=this;e.getSettings().fixedColumnsLeft=this.fixedColumnsLeft;for(var r=this.indexes.slice(0).sort(),o=function(e,t,o){return o[n.indexes.indexOf(r[t])]},i=this.data.length,a=[],s=0;s<i;s++)a.push(ne(this.data[s],o));var u=ne(this.headers,o),l=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),re(e.getSourceDataArray(),(function(e,t){re(r,(function(n,r){e[n]=a[t][r],l.push([t,n,e[n]])}))})),e.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(r[0],r.length),void 0!==this.headers&&re(u,(function(t,n){e.getSettings().colHeaders[r[n]]=t})),e.batchExecution((function(){e.rowIndexMapper.setIndexesSequence(n.rowPositions),e.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},fI.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},fI.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},fI.CellAlignmentAction.prototype.undo=function(e,t){var n=this;re(this.range,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"className",n.stateBefore[t][r]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},fI.CellAlignmentAction.prototype.redo=function(e,t){Vw(this.range,this.type,this.alignment,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),e.addHookOnce("afterViewRender",t),e.render()},fI.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},ve(fI.FiltersAction,fI.Action),fI.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},fI.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var hI=function(e){rI(n,e);var t=iI(n);function n(e,r){var o;eI(this,n),(o=t.call(this)).cellRange=r;var i=o.cellRange.getTopLeftCorner(),a=o.cellRange.getBottomRightCorner();return o.rangeData=e.getData(i.row,i.col,a.row,a.col),o}return nI(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopLeftCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}]),n}(fI.Action);fI.MergeCellsAction=hI;var dI=function(e){rI(n,e);var t=iI(n);function n(e,r){var o;return eI(this,n),(o=t.call(this)).cellRange=r,o}return nI(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}]),n}(fI.Action);function pI(e){if(!ir(e)){var t=this,n=t.getActiveEditor();if(!n||!n.isOpened()){var r=e.altKey,o=e.ctrlKey,i=e.keyCode,a=e.metaKey,s=e.shiftKey;!o&&!a||r||(89===i||s&&90===i?(t.undoRedo.redo(),or(e)):90===i&&(t.undoRedo.undo(),or(e)))}}}function mI(e,t){if("loadData"===t)return this.undoRedo.clear()}fI.UnmergeCellsAction=dI,fI.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},ve(fI.RowMoveAction,fI.Action),fI.RowMoveAction.prototype.undo=function(e,t){var n=this,r=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(e){return e>n.finalIndex})),a=o.filter((function(e){return e<=n.finalIndex})),s=i.sort((function(e,t){return t-e})).concat(a.sort((function(e,t){return e-t})));e.addHookOnce("afterViewRender",t);for(var u=0;u<s.length;u+=1){var l=e.toVisualRow(s[u]);r.moveRow(l,s[u])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},fI.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},fI.prototype.init=function(){var e=this.instance.getSettings().undo,t=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};var yI=br.getSingleton();yI.add("afterUpdateSettings",(function(){this.getPlugin("undoRedo").init()})),yI.register("beforeUndo"),yI.register("afterUndo"),yI.register("beforeRedo"),yI.register("afterRedo"),fI.PLUGIN_KEY="undoRedo";const vI=fI;Nr(qr),Nr(yy),Nr(Ey),Nr(xy),Nr(Yy),Nr(sy),Nr(Ky),Nr(tv),Nr(cv),Nr(Vm),Qo(Wm),Qo(hv),Qo(gv),Qo(fv),Qo(_v),Qo(Sv),Qo(zm),ii(Ev),ii(Rv),ii(Tv),ii(Mv),Sl(Ov),Sl(Av),Sl(Lv),Sl(xv),Sl(Nv),Sl(Iv),Sl(Dv),Sl(Pv),Sl(Gm),function(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n,r=this.first(),o=r.data("handsontable");if("string"!=typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if(void 0===o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var a,s=arguments.length,u=new Array(s>1?s-1:0),l=1;l<s;l++)u[l-1]=arguments[l];n=(a=o[t]).call.apply(a,[o].concat(u)),"destroy"===t&&r.removeData()}return n})}(Xm),zo(rg),zo(pg),zo(Eg),zo(tb),zo(bb),zo(Sw),zo(Nw),zo(f_),zo(Q_),zo(bS),zo(PS),zo(WS),zo(ZS),zo(RE),zo(PT),zo(_C),zo(FC),zo(rM),zo(pM),zo(KM),zo(rO),zo(PO),zo(qO),zo(OA),zo(VA),zo(qA),zo(kx),zo(vN),zo(MN),zo(jN),zo(zN),zo(QN),zo(vI),Xm.__GhostTable=Qm,Xm._getListenersCounter=function(){return Pr},Xm._getRegisteredMapsCounter=function(){return Wc},Xm.DefaultSettings=Zp(),Xm.EventManager=Fr,Xm.hooks=br.getSingleton();var gI=[t,o,d,m,e,u,i,h,r,a,l,f],bI=[s,c];Xm.helper={},Xm.dom={},re(gI,(function(e){re(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(Xm.helper[t]=e[t])}))})),re(bI,(function(e){re(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(Xm.dom[t]=e[t])}))})),Xm.cellTypes={},re(wl(),(function(e){Xm.cellTypes[e]=_l(e)})),Xm.cellTypes.registerCellType=Sl,Xm.cellTypes.getCellType=_l,Xm.editors={},re(Or(),(function(e){Xm.editors["".concat(Mt(e),"Editor")]=xr(e)})),Xm.editors.registerEditor=Nr,Xm.editors.getEditor=xr,Xm.renderers={},re(qo(),(function(e){var t=Jo(e);"base"===e&&(Xm.renderers.cellDecorator=t),Xm.renderers["".concat(Mt(e),"Renderer")]=t})),Xm.renderers.registerRenderer=Qo,Xm.renderers.getRenderer=Jo,Xm.validators={},re(ri(),(function(e){Xm.validators["".concat(Mt(e),"Validator")]=oi(e)})),Xm.validators.registerValidator=ii,Xm.validators.getValidator=oi,Xm.plugins={},re(Vo(),(function(e){Xm.plugins[e]=Wo(e)})),Xm.plugins["".concat(Mt(Vv.PLUGIN_KEY),"Plugin")]=Vv,Xm.plugins.registerPlugin=zo,Xm.plugins.getPlugin=Wo;const wI=Xm;function _I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_I(Object(n),!0).forEach((function(t){CI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function EI(e){return EI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EI(e)}function kI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TI(e,t,n){return t&&RI(e.prototype,t),n&&RI(e,n),e}function CI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MI(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AI(e,t)}function OI(e){return OI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},OI(e)}function AI(e,t){return AI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},AI(e,t)}function LI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xI(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return LI(e)}function NI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=OI(e);if(t){var o=OI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xI(this,n)}}var II=null,DI="hot-wrapper-editor-container";function PI(e,t){var n=v.Children.toArray(e),r=v.Children.count(e),o=null;return 0!==r&&(o=1===r&&n[0].props[t]?n[0]:n.find((function(e){return void 0!==e.props[t]}))),o||null}function HI(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function jI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;e.querySelectorAll('[class^="'.concat(DI,'"]')).forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}function FI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(null!==t){var n=e.createElement("DIV"),r=UI(t.props,!1),o=r.id,i=r.className,a=r.style;return o&&(n.id=o),n.className=[DI,i].join(" "),a&&Object.assign(n.style,a),e.body.appendChild(n),g.createPortal(t,n)}}function YI(e,t){var n=PI(e,"hot-editor"),r=HI(n);return n?v.cloneElement(n,{emitEditorInstance:function(e){t.set(r,e)},isEditor:!0}):null}function UI(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}function BI(e){var t=v.version.split(".").map((function(e){return parseInt(e)}));t[0]>=16&&t[1]>=3&&(e.UNSAFE_componentWillUpdate=e.componentWillUpdate,e.componentWillUpdate=void 0,e.UNSAFE_componentWillMount=e.componentWillMount,e.componentWillMount=void 0)}var VI=function(){function e(){kI(this,e)}return TI(e,null,[{key:"getSettings",value:function(e){var t={};if(e.settings){var n=e.settings;for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}for(var o in e)"settings"!==o&&"children"!==o&&e.hasOwnProperty(o)&&(t[o]=e[o]);return t}}]),e}(),WI=function(e){MI(n,e);var t=NI(n);function n(e,r){var o;return kI(this,n),(o=t.call(this,e,r)).localEditorPortal=null,BI(LI(o)),o}return TI(n,[{key:"getLocalEditorPortal",value:function(){return this.localEditorPortal}},{key:"setLocalEditorPortal",value:function(e){this.localEditorPortal=e}},{key:"getSettingsProps",value:function(){var e=this;return this.internalProps=["__componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter((function(t){return!e.internalProps.includes(t)})).reduce((function(t,n){return t[n]=e.props[n],t}),{})}},{key:"hasProp",value:function(e){return!!this.props[e]}},{key:"getLocalEditorElement",value:function(){return YI(this.props.children,this.props._getEditorCache())}},{key:"createColumnSettings",value:function(){var e=this.props._getChildElementByType(this.props.children,"hot-renderer"),t=this.getLocalEditorElement();this.columnSettings=VI.getSettings(this.getSettingsProps()),null!==e?(this.columnSettings.renderer=this.props._getRendererWrapper(e),this.props._componentRendererColumns.set(this.props._columnIndex,!0)):this.hasProp("renderer")?this.columnSettings.renderer=this.props.renderer:this.columnSettings.renderer=void 0,null!==t?this.columnSettings.editor=this.props._getEditorClass(t):this.hasProp("editor")?this.columnSettings.editor=this.props.editor:this.columnSettings.editor=void 0}},{key:"createLocalEditorPortal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.children,t=this.props._getEditorCache(),n=YI(e,t);n&&this.setLocalEditorPortal(FI(this.props._getOwnerDocument(),n,t))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentWillMount",value:function(){this.createLocalEditorPortal()}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentWillUpdate",value:function(e,t,n){this.createLocalEditorPortal(e.children)}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){return v.createElement(v.Fragment,null,this.getLocalEditorPortal())}}]),n}(v.Component),zI=function(e){MI(n,e);var t=NI(n);function n(e){var r;return kI(this,n),(r=t.call(this,e)).state={portals:[]},r}return TI(n,[{key:"render",value:function(){return v.createElement(v.Fragment,null,this.state.portals)}}]),n}(v.Component);function GI(e,t){return e(t={exports:{}},t.exports),t.exports}var KI="function"==typeof Symbol&&Symbol.for,XI=KI?Symbol.for("react.element"):60103,$I=KI?Symbol.for("react.portal"):60106,qI=KI?Symbol.for("react.fragment"):60107,JI=KI?Symbol.for("react.strict_mode"):60108,QI=KI?Symbol.for("react.profiler"):60114,ZI=KI?Symbol.for("react.provider"):60109,eD=KI?Symbol.for("react.context"):60110,tD=KI?Symbol.for("react.async_mode"):60111,nD=KI?Symbol.for("react.concurrent_mode"):60111,rD=KI?Symbol.for("react.forward_ref"):60112,oD=KI?Symbol.for("react.suspense"):60113,iD=KI?Symbol.for("react.suspense_list"):60120,aD=KI?Symbol.for("react.memo"):60115,sD=KI?Symbol.for("react.lazy"):60116,uD=KI?Symbol.for("react.block"):60121,lD=KI?Symbol.for("react.fundamental"):60117,cD=KI?Symbol.for("react.responder"):60118,fD=KI?Symbol.for("react.scope"):60119;function hD(e){if("object"===EI(e)&&null!==e){var t=e.$$typeof;switch(t){case XI:switch(e=e.type){case tD:case nD:case qI:case QI:case JI:case oD:return e;default:switch(e=e&&e.$$typeof){case eD:case rD:case sD:case aD:case ZI:return e;default:return t}}case $I:return t}}}function dD(e){return hD(e)===nD}var pD={AsyncMode:tD,ConcurrentMode:nD,ContextConsumer:eD,ContextProvider:ZI,Element:XI,ForwardRef:rD,Fragment:qI,Lazy:sD,Memo:aD,Portal:$I,Profiler:QI,StrictMode:JI,Suspense:oD,isAsyncMode:function(e){return dD(e)||hD(e)===tD},isConcurrentMode:dD,isContextConsumer:function(e){return hD(e)===eD},isContextProvider:function(e){return hD(e)===ZI},isElement:function(e){return"object"===EI(e)&&null!==e&&e.$$typeof===XI},isForwardRef:function(e){return hD(e)===rD},isFragment:function(e){return hD(e)===qI},isLazy:function(e){return hD(e)===sD},isMemo:function(e){return hD(e)===aD},isPortal:function(e){return hD(e)===$I},isProfiler:function(e){return hD(e)===QI},isStrictMode:function(e){return hD(e)===JI},isSuspense:function(e){return hD(e)===oD},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===qI||e===nD||e===QI||e===JI||e===oD||e===iD||"object"===EI(e)&&null!==e&&(e.$$typeof===sD||e.$$typeof===aD||e.$$typeof===ZI||e.$$typeof===eD||e.$$typeof===rD||e.$$typeof===lD||e.$$typeof===cD||e.$$typeof===fD||e.$$typeof===uD)},typeOf:hD},mD=GI((function(e,t){}));mD.AsyncMode,mD.ConcurrentMode,mD.ContextConsumer,mD.ContextProvider,mD.Element,mD.ForwardRef,mD.Fragment,mD.Lazy,mD.Memo,mD.Portal,mD.Profiler,mD.StrictMode,mD.Suspense,mD.isAsyncMode,mD.isConcurrentMode,mD.isContextConsumer,mD.isContextProvider,mD.isElement,mD.isForwardRef,mD.isFragment,mD.isLazy,mD.isMemo,mD.isPortal,mD.isProfiler,mD.isStrictMode,mD.isSuspense,mD.isValidElementType,mD.typeOf,GI((function(e){e.exports=pD}));Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==r.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(e){o[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}})()&&Object.assign;function yD(){}function vD(){}Function.call.bind(Object.prototype.hasOwnProperty),vD.resetWarningCache=yD;var gD=GI((function(e){e.exports=function(){function e(e,t,n,r,o,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:vD,resetWarningCache:yD};return n.PropTypes=n,n}()})),bD=function(e){MI(n,e);var t=NI(n);function n(e,r){var o;return kI(this,n),(o=t.call(this,e,r)).id=null,o.__hotInstance=null,o.hotElementRef=null,o.columnSettings=[],o.portalManager=null,o.portalCacheArray=[],o.globalEditorPortal=null,o.renderedCellCache=new Map,o.editorCache=new Map,o.componentRendererColumns=new Map,BI(LI(o)),o}return TI(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(e){this.__hotInstance=e}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"getGlobalEditorPortal",value:function(){return this.globalEditorPortal}},{key:"setGlobalEditorPortal",value:function(e){this.globalEditorPortal=e}},{key:"clearCache",value:function(){var e=this.getRenderedCellCache();this.setGlobalEditorPortal(null),jI(this.getOwnerDocument()),this.getEditorCache().clear(),e.clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(e){this.hotElementRef=e}},{key:"getRendererWrapper",value:function(e){var t=this;return function(n,r,o,i,a,s,u){var l=t.getRenderedCellCache();if(l.has("".concat(o,"-").concat(i))&&(r.innerHTML=l.get("".concat(o,"-").concat(i)).innerHTML),r&&!r.getAttribute("ghost-table")){for(var c=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document;r||(r=document),II||(II=r.createDocumentFragment());var o=r.createElement("DIV");II.appendChild(o);var i=v.cloneElement(e,SI({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:g.createPortal(i,o,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:o}}(e,{TD:r,row:o,col:i,prop:a,value:s,cellProperties:u,isRenderer:!0},(function(){}),r.ownerDocument),f=c.portal,h=c.portalContainer;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(h),t.portalCacheArray.push(f)}return l.set("".concat(o,"-").concat(i),r),r}}},{key:"getEditorClass",value:function(e){var t=HI(e),n=this.getEditorCache().get(t);return this.makeEditorClass(n)}},{key:"makeEditorClass",value:function(e){var t=function(t){MI(r,t);var n=NI(r);function r(t,o,i,a,s,u){var l;return kI(this,r),l=n.call(this,t,o,i,a,s,u),e.hotCustomEditorInstance=LI(l),l.editorComponent=e,l}return TI(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(wI.editors.BaseEditor);return Object.getOwnPropertyNames(wI.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=e[n]).call.apply(t,[e].concat(o))})})),t}},{key:"getGlobalRendererElement",value:function(){return PI(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.children;return YI(e,this.getEditorCache())}},{key:"createGlobalEditorPortal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.children,t=this.getGlobalEditorElement(e);t&&this.setGlobalEditorPortal(FI(this.getOwnerDocument(),t,this.getEditorCache()))}},{key:"createNewGlobalSettings",value:function(){var e=VI.getSettings(this.props),t=this.getGlobalRendererElement(),n=this.getGlobalEditorElement();return e.columns=this.columnSettings.length?this.columnSettings:e.columns,e.editor=n?this.getEditorClass(n):this.props.editor||(this.props.settings?this.props.settings.editor:void 0),t?(e.renderer=this.getRendererWrapper(t),this.componentRendererColumns.set("global",!0)):e.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),e}},{key:"displayAutoSizeWarning",value:function(e){this.hotInstance&&(this.hotInstance.getPlugin("autoRowSize").enabled||this.hotInstance.getPlugin("autoColumnSize").enabled)&&this.componentRendererColumns.size>0&&function(){var e;"undefined"!=typeof console&&(e=console).warn.apply(e,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(e,t){this.columnSettings[t]=e}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var e=this;this.portalManager.setState((function(){return Object.assign({},{portals:e.portalCacheArray})}),(function(){e.portalCacheArray.length=0}))}},{key:"updateHot",value:function(e){this.hotInstance&&this.hotInstance.updateSettings(e,!1)}},{key:"setPortalManagerRef",value:function(e){this.portalManager=e}},{key:"componentWillMount",value:function(){this.clearCache(),this.createGlobalEditorPortal()}},{key:"componentDidMount",value:function(){var e=this,t=this.createNewGlobalSettings();this.hotInstance=new wI.Core(this.hotElementRef,t),this.hotInstance.addHook("beforeViewRender",(function(t){e.handsontableBeforeViewRender()})),this.hotInstance.addHook("afterViewRender",(function(){e.handsontableAfterViewRender()})),this.hotInstance.init(),this.displayAutoSizeWarning(t)}},{key:"componentWillUpdate",value:function(e,t,n){this.clearCache(),jI(this.getOwnerDocument()),this.createGlobalEditorPortal(e.children)}},{key:"componentDidUpdate",value:function(){var e=this.createNewGlobalSettings();this.updateHot(e),this.displayAutoSizeWarning(e)}},{key:"componentWillUnmount",value:function(){this.hotInstance&&this.hotInstance.destroy(),jI(this.getOwnerDocument())}},{key:"render",value:function(){var e=this,t=UI(this.props),n=t.id,r=t.className,o=t.style,i=v.Children.toArray(this.props.children),a=(i=i.filter((function(e){return function(e){return e.type===WI}(e)}))).map((function(t,n){return v.cloneElement(t,{_componentRendererColumns:e.componentRendererColumns,_emitColumnSettings:e.setHotColumnSettings.bind(e),_columnIndex:n,_getChildElementByType:PI.bind(e),_getRendererWrapper:e.getRendererWrapper.bind(e),_getEditorClass:e.getEditorClass.bind(e),_getOwnerDocument:e.getOwnerDocument.bind(e),_getEditorCache:e.getEditorCache.bind(e),children:t.props.children})}));return a.push(this.getGlobalEditorPortal()),v.createElement(v.Fragment,null,v.createElement("div",{ref:this.setHotElementRef.bind(this),id:n,className:r,style:o},a),v.createElement(zI,{ref:this.setPortalManagerRef.bind(this)}))}}],[{key:"version",get:function(){return"10.0.0"}}]),n}(v.Component);bD.propTypes={style:gD.object,id:gD.string,className:gD.string},v.Component;var wD=n(26065),_D={};function SD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ED(e,t,n){return t&&SD(e.prototype,t),n&&SD(e,n),e}function kD(e){return kD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kD(e)}function RD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xD(e,t)}function CD(e){var t=LD();return function(){var n,r=ND(e);if(t){var o=ND(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MD(this,n)}}function MD(e,t){if(t&&("object"===kD(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function OD(e){var t="function"==typeof Map?new Map:void 0;return OD=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return AD(e,arguments,ND(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),xD(r,e)},OD(e)}function AD(e,t,n){return AD=LD()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&xD(o,n.prototype),o},AD.apply(null,arguments)}function LD(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function xD(e,t){return xD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xD(e,t)}function ND(e){return ND=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ND(e)}_D.styleTagTransform=A(),_D.setAttributes=T(),_D.insert=k().bind(null,"head"),_D.domAPI=S(),_D.insertStyleElement=M(),w()(wD.Z,_D),wD.Z&&wD.Z.locals&&wD.Z.locals,n(77588),n(74176);var ID=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"There's no sheet with id = ".concat(e))}return n}(OD(Error)),DD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"There's no sheet with name '".concat(e,"'"))}return n}(OD(Error)),PD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Sheet with name ".concat(e," already exists"))}return n}(OD(Error)),HD=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Sheet size limit exceeded")}return n}(OD(Error)),jD=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"This is not a formula")}return n}(OD(Error)),FD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Address (row = ".concat(e.row,", col = ").concat(e.col,") is invalid"))}return n}(OD(Error)),YD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Invalid arguments, expected ".concat(e))}return n}(OD(Error)),UD=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Sheets ".concat(e," and ").concat(r," are not equal."))}return n}(OD(Error)),BD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Name of Named Expression '".concat(e,"' is already present"))}return n}(OD(Error)),VD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Name of Named Expression '".concat(e,"' is invalid"))}return n}(OD(Error)),WD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Named Expression '".concat(e,"' does not exist"))}return n}(OD(Error)),zD=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"There is no operation to undo")}return n}(OD(Error)),GD=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"There is no operation to redo")}return n}(OD(Error)),KD=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"There is nothing to paste")}return n}(OD(Error));function XD(e,t){switch(kD(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}var $D,qD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Unable to parse value: ".concat(JSON.stringify(e,XD,4)))}return n}(OD(Error)),JD=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Expected value of type: ".concat(e," for config parameter: ").concat(r))}return n}(OD(Error)),QD=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Config parameter ".concat(e," cannot be empty."))}return n}(OD(Error)),ZD=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Config parameter ".concat(e," should be at least ").concat(r))}return n}(OD(Error)),eP=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Config parameter ".concat(e," should be at most ").concat(r))}return n}(OD(Error)),tP=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Expected one of ".concat(e," for config parameter: ").concat(r))}return n}(OD(Error)),nP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Computations are suspended")}return n}(OD(Error)),rP=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Translation for ".concat(e," is missing in the translation package you're using."))}return n}(OD(Error)),oP=function(e){TD(n,e);var t=CD(n);function n(e){return RD(this,n),t.call(this,"Cannot register translation for function with id: ".concat(e))}return n}(OD(Error)),iP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Language not registered.")}return n}(OD(Error)),aP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Language already registered.")}return n}(OD(Error)),sP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.apply(this,arguments)}return ED(n,null,[{key:"functionNotDeclaredInPlugin",value:function(e,t){return new n("Function with id ".concat(e," not declared in plugin ").concat(t))}},{key:"functionMethodNotFound",value:function(e,t){return new n("Function method ".concat(e," not found in plugin ").concat(t))}}]),n}(OD(Error)),uP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.apply(this,arguments)}return ED(n,null,[{key:"cannotRegisterFunctionWithId",value:function(e){return new n("Cannot register function with id ".concat(e))}},{key:"cannotUnregisterFunctionWithId",value:function(e){return new n("Cannot unregister function with id ".concat(e))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new n("Cannot unregister protected plugin")}}]),n}(OD(Error)),lP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Cannot perform this operation, source location has an array inside.")}return n}(OD(Error)),cP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Cannot perform this operation, target location has an array inside.")}return n}(OD(Error)),fP=function(e){TD(n,e);var t=CD(n);function n(){return RD(this,n),t.call(this,"Relative addresses not allowed in named expressions.")}return n}(OD(Error)),hP=function(e){TD(n,e);var t=CD(n);function n(e,r){return RD(this,n),t.call(this,"Alias id ".concat(e," in plugin ").concat(r," already defined as a function or alias."))}return n}(OD(Error));function dP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}($D||($D={}));var pP,mP=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.col=t,this.row=n,this.type=r,this.sheet=o}var t,n,r;return t=e,n=[{key:"toSimpleCellAddress",value:function(e){var t=lB(this,e);return this.type===$D.CELL_REFERENCE_ABSOLUTE?oB(t,this.col,this.row):this.type===$D.CELL_REFERENCE_ABSOLUTE_ROW?oB(t,e.col+this.col,this.row):this.type===$D.CELL_REFERENCE_ABSOLUTE_COL?oB(t,this.col,e.row+this.row):oB(t,e.col+this.col,e.row+this.row)}},{key:"toSimpleColumnAddress",value:function(e){var t=lB(this,e),n=this.col;return this.isColumnRelative()&&(n+=e.col),nB(t,n)}},{key:"toSimpleRowAddress",value:function(e){var t=lB(this,e),n=this.row;return this.isRowRelative()&&(n+=e.row),eB(t,n)}},{key:"isRowAbsolute",value:function(){return this.type===$D.CELL_REFERENCE_ABSOLUTE||this.type===$D.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===$D.CELL_REFERENCE_ABSOLUTE||this.type===$D.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===$D.CELL_REFERENCE_RELATIVE||this.type===$D.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===$D.CELL_REFERENCE_RELATIVE||this.type===$D.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===$D.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}},{key:"shiftedByRows",value:function(t){return new e(this.col,this.row+t,this.type,this.sheet)}},{key:"shiftedByColumns",value:function(t){return new e(this.col+t,this.row,this.type,this.sheet)}},{key:"moved",value:function(t,n,r){var o=void 0===this.sheet?void 0:t;return new e(this.col+n,this.row+r,this.type,o)}},{key:"withAbsoluteSheet",value:function(t){return new e(this.col,this.row,this.type,t)}},{key:"isInvalid",value:function(e){return iB(this.toSimpleCellAddress(e))}},{key:"shiftRelativeDimensions",value:function(t,n){return new e(this.isColumnAbsolute()?this.col:this.col+t,this.isRowAbsolute()?this.row:this.row+n,this.type,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(t,n){return new e(this.isColumnRelative()?this.col:this.col+t,this.isRowRelative()?this.row:this.row+n,this.type,this.sheet)}},{key:"hash",value:function(e){var t=e&&void 0!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case $D.CELL_REFERENCE_RELATIVE:return"".concat(t,"#").concat(this.row,"R").concat(this.col);case $D.CELL_REFERENCE_ABSOLUTE:return"".concat(t,"#").concat(this.row,"A").concat(this.col);case $D.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(t,"#").concat(this.row,"AC").concat(this.col);case $D.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(t,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleCellAddress(e);if(!iB(t)){var n=dH(t.col),r=this.type===$D.CELL_REFERENCE_ABSOLUTE||this.type===$D.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",o=this.type===$D.CELL_REFERENCE_ABSOLUTE||this.type===$D.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(o).concat(n).concat(r).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.row>=t||this.col>=e}}],r=[{key:"relative",value:function(t,n,r){return new e(n,t,$D.CELL_REFERENCE_RELATIVE,r)}},{key:"absolute",value:function(t,n,r){return new e(t,n,$D.CELL_REFERENCE_ABSOLUTE,r)}},{key:"absoluteCol",value:function(t,n,r){return new e(t,n,$D.CELL_REFERENCE_ABSOLUTE_COL,r)}},{key:"absoluteRow",value:function(t,n,r){return new e(t,n,$D.CELL_REFERENCE_ABSOLUTE_ROW,r)}}],n&&dP(t.prototype,n),r&&dP(t,r),e}();function yP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(pP||(pP={}));var vP=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.col=n,this.sheet=r}var t,n,r;return t=e,n=[{key:"isColumnAbsolute",value:function(){return this.type===pP.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===pP.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===pP.ABSOLUTE&&void 0!==this.sheet}},{key:"moved",value:function(t,n,r){var o=void 0===this.sheet?void 0:t;return new e(this.type,this.col+n,o)}},{key:"shiftedByColumns",value:function(t){return new e(this.type,this.col+t,this.sheet)}},{key:"toSimpleColumnAddress",value:function(e){var t=lB(this,e),n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),nB(t,n)}},{key:"shiftRelativeDimensions",value:function(t,n){var r=this.isColumnRelative()?this.col+t:this.col;return new e(this.type,r,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(t,n){var r=this.isColumnAbsolute()?this.col+t:this.col;return new e(this.type,r,this.sheet)}},{key:"withAbsoluteSheet",value:function(t){return new e(this.type,this.col,t)}},{key:"isInvalid",value:function(e){return this.toSimpleColumnAddress(e).col<0}},{key:"hash",value:function(e){var t=e&&void 0!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case pP.RELATIVE:return"".concat(t,"#COLR").concat(this.col);case pP.ABSOLUTE:return"".concat(t,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleColumnAddress(e);if(!rB(t)){var n=dH(t.col),r=this.type===pP.ABSOLUTE?"$":"";return"".concat(r).concat(n)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}],r=[{key:"absolute",value:function(t,n){return new e(pP.ABSOLUTE,t,n)}},{key:"relative",value:function(t,n){return new e(pP.RELATIVE,t,n)}}],n&&yP(t.prototype,n),r&&yP(t,r),e}(),gP=n(38321);function bP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wP=":",_P="$",SP=(0,gP.createToken)({name:"AdditionOp",pattern:gP.Lexer.NA}),EP=(0,gP.createToken)({name:"PlusOp",pattern:/\+/,categories:SP}),kP=(0,gP.createToken)({name:"MinusOp",pattern:/-/,categories:SP}),RP=(0,gP.createToken)({name:"MultiplicationOp",pattern:gP.Lexer.NA}),TP=(0,gP.createToken)({name:"TimesOp",pattern:/\*/,categories:RP}),CP=(0,gP.createToken)({name:"DivOp",pattern:/\//,categories:RP}),MP=(0,gP.createToken)({name:"PowerOp",pattern:/\^/}),OP=(0,gP.createToken)({name:"PercentOp",pattern:/%/}),AP=(0,gP.createToken)({name:"BooleanOp",pattern:gP.Lexer.NA}),LP=(0,gP.createToken)({name:"EqualsOp",pattern:/=/,categories:AP}),xP=(0,gP.createToken)({name:"NotEqualOp",pattern:/<>/,categories:AP}),NP=(0,gP.createToken)({name:"GreaterThanOp",pattern:/>/,categories:AP}),IP=(0,gP.createToken)({name:"LessThanOp",pattern:/</,categories:AP}),DP=(0,gP.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:AP}),PP=(0,gP.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:AP}),HP=(0,gP.createToken)({name:"ConcatenateOp",pattern:/&/}),jP="[A-Za-z0-9_-]+",FP="(".concat(jP,"|").concat("'(((?!').|'')*)'",")!"),YP=(0,gP.createToken)({name:"CellReference",pattern:new RegExp("(".concat(FP,")?\\").concat(_P,"?[A-Za-z]+\\").concat(_P,"?[0-9]+"))}),UP=(0,gP.createToken)({name:"ColumnRange",pattern:new RegExp("(".concat(FP,")?\\").concat(_P,"?[A-Za-z]+").concat(wP,"(").concat(FP,")?\\").concat(_P,"?[A-Za-z]+"))}),BP=(0,gP.createToken)({name:"RowRange",pattern:new RegExp("(".concat(FP,")?\\").concat(_P,"?[0-9]+").concat(wP,"(").concat(FP,")?\\").concat(_P,"?[0-9]+"))}),VP=(0,gP.createToken)({name:"RangeSeparator",pattern:"".concat(wP)}),WP=(0,gP.createToken)({name:"LParen",pattern:/\(/}),zP=(0,gP.createToken)({name:"RParen",pattern:/\)/}),GP=(0,gP.createToken)({name:"ArrayLParen",pattern:/{/}),KP=(0,gP.createToken)({name:"ArrayRParen",pattern:/}/}),XP=(0,gP.createToken)({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/}),$P=(0,gP.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/}),qP=(0,gP.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),JP=(0,gP.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),QP=(0,gP.createToken)({name:"WhiteSpace",pattern:/[ \t\n\r]+/}),ZP=function(e){var t,n,r=e.translationPackage.getFunctionTranslation("OFFSET"),o=e.errorMapping,i=e.translationPackage.buildFunctionMapping(),a=(0,gP.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=(0,gP.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator});e.functionArgSeparator===e.arrayColumnSeparator?(t=s,n=[]):e.functionArgSeparator===e.arrayRowSeparator?(t=a,n=[]):n=[t=(0,gP.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator})];var u,l=(0,gP.createToken)({name:"NumberLiteral",pattern:new RegExp("(([".concat(e.decimalSeparator,"]\\d+)|(\\d+([").concat(e.decimalSeparator,"]\\d*)?))(e[+-]?\\d+)?"))}),c=(0,gP.createToken)({name:"OffsetProcedureName",pattern:new RegExp(r,"i")}),f=[QP,EP,kP,TP,CP,MP,LP,xP,OP,DP,PP,NP,IP,WP,zP,GP,KP,c,XP,VP].concat(function(e){if(Array.isArray(e))return bP(e)}(u=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(u)||function(e,t){if(e){if("string"==typeof e)return bP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bP(e,t):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[UP,BP,l,qP,JP,HP,AP,SP,RP,YP,$P,a,s]);return{ArgSeparator:t,NumberLiteral:l,OffsetProcedureName:c,ArrayRowSeparator:a,ArrayColSeparator:s,allTokens:f,errorMapping:o,functionMapping:i,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}};function eH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tH=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.row=n,this.sheet=r}var t,n,r;return t=e,n=[{key:"isRowAbsolute",value:function(){return this.type===pP.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===pP.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===pP.ABSOLUTE&&void 0!==this.sheet}},{key:"moved",value:function(t,n,r){var o=void 0===this.sheet?void 0:t;return new e(this.type,this.row+r,o)}},{key:"shiftedByRows",value:function(t){return new e(this.type,this.row+t,this.sheet)}},{key:"toSimpleRowAddress",value:function(e){var t=lB(this,e),n=this.row;return this.isRowRelative()&&(n=e.row+this.row),eB(t,n)}},{key:"shiftRelativeDimensions",value:function(t,n){var r=this.isRowRelative()?this.row+n:this.row;return new e(this.type,r,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(t,n){var r=this.isRowAbsolute()?this.row+n:this.row;return new e(this.type,r,this.sheet)}},{key:"withAbsoluteSheet",value:function(t){return new e(this.type,this.row,t)}},{key:"isInvalid",value:function(e){return this.toSimpleRowAddress(e).row<0}},{key:"hash",value:function(e){var t=e&&void 0!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case pP.RELATIVE:return"".concat(t,"#ROWR").concat(this.row);case pP.ABSOLUTE:return"".concat(t,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var t=this.toSimpleRowAddress(e);if(!tB(t)){var n=this.type===pP.ABSOLUTE?"$":"";return"".concat(n).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}],r=[{key:"absolute",value:function(t,n){return new e(pP.ABSOLUTE,t,n)}},{key:"relative",value:function(t,n){return new e(pP.RELATIVE,t,n)}}],n&&eH(t.prototype,n),r&&eH(t,r),e}();function nH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rH=new RegExp("^(".concat(FP,")?(\\").concat(_P,"?)([A-Za-z]+)(\\").concat(_P,"?)([0-9]+)$")),oH=new RegExp("^(".concat(FP,")?(\\").concat(_P,"?)([A-Za-z]+)$")),iH=new RegExp("^(".concat(FP,")?(\\").concat(_P,"?)([0-9]+)$")),aH=new RegExp("^".concat(jP,"$")),sH=function(e,t,n){var r=rH.exec(t),o=hH(r[6]),i=mH(r,e);if(void 0!==i){null===i&&(i=void 0);var a=Number(r[8])-1;return r[5]===_P&&r[7]===_P?mP.absolute(o,a,i):r[5]===_P?mP.absoluteCol(o,a-n.row,i):r[7]===_P?mP.absoluteRow(o-n.col,a,i):mP.relative(a-n.row,o-n.col,i)}},uH=function(e,t,n){var r=oH.exec(t),o=mH(r,e);if(void 0!==o){null===o&&(o=void 0);var i=hH(r[6]);return r[5]===_P?vP.absolute(i,o):vP.relative(i-n.col,o)}},lH=function(e,t,n){var r=iH.exec(t),o=mH(r,e);if(void 0!==o){null===o&&(o=void 0);var i=Number(r[6])-1;return r[5]===_P?tH.absolute(i,o):tH.relative(i-n.row,o)}},cH=function(e,t,n){var r=rH.exec(t),o=hH(r[6]),i=mH(r,e);if(void 0!==i){null===i&&(i=n);var a=Number(r[8])-1;return oB(i,o,a)}},fH=function(e,t,n){var r=dH(t.col),o=pH(t.sheet,e);if(void 0!==o)return n!==t.sheet?"".concat(o,"!").concat(r).concat(t.row+1):"".concat(r).concat(t.row+1)};function hH(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((function(e,t){return 26*e+(t.toUpperCase().charCodeAt(0)-64)}),0)-1}function dH(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function pH(e,t){var n=t(e);if(void 0!==n)return aH.test(n)?n:(n=n.replace(/'/g,"''"),"'".concat(n,"'"))}function mH(e,t){var n,r=null!==(n=e[3])&&void 0!==n?n:e[2];return r?t(r=r.replace(/''/g,"'")):null}var yH,vH,gH,bH=function(e,t){return{type:e,message:t}};!function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed"}(yH||(yH={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",e.ARRAY="ARRAY"}(vH||(vH={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(gH||(gH={}));var wH,_H=function(e,t){return{type:vH.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}},SH=function(e,t,n,r){return CH(e,t,n),{type:vH.CELL_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:r}},EH=function(e,t,n){return{type:vH.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}},kH=function(e,t){return{type:vH.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}},RH=function(e,t,n){return{type:vH.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==n?void 0:n.image}},TH=function(){return{type:vH.ERROR,error:ZU.parsingError()}};function CH(e,t,n){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&n!==gH.RELATIVE||void 0!==e.sheet&&n===gH.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function MH(e,t){return(null!=t?t:"")+e}function OH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AH=(OH(wH={},vH.PLUS_OP,"+"),OH(wH,vH.MINUS_OP,"-"),OH(wH,vH.TIMES_OP,"*"),OH(wH,vH.DIV_OP,"/"),OH(wH,vH.CONCATENATE_OP,"&"),OH(wH,vH.POWER_OP,"^"),OH(wH,vH.EQUALS_OP,"="),OH(wH,vH.NOT_EQUAL_OP,"<>"),OH(wH,vH.GREATER_THAN_OP,">"),OH(wH,vH.GREATER_THAN_OR_EQUAL_OP,">="),OH(wH,vH.LESS_THAN_OP,"<"),OH(wH,vH.LESS_THAN_OR_EQUAL_OP,"<="),wH);function LH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xH=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functionRegistry=t,this.cache=new Map}var t,n;return t=e,(n=[{key:"set",value:function(e,t){var n=function(e,t,n,r){return{ast:e,relativeDependencies:t,hasVolatileFunction:n,hasStructuralChangeFunction:r}}(t,tj(t,this.functionRegistry),NH(t,this.functionRegistry.isFunctionVolatile),NH(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}},{key:"get",value:function(e){return this.cache.get(e)}},{key:"maybeSetAndThenGet",value:function(e,t){var n=this.cache.get(e);return void 0!==n?n.ast:(this.set(e,t),t)}}])&&LH(t.prototype,n),e}(),NH=function e(t,n){switch(t.type){case vH.EMPTY:case vH.NUMBER:case vH.STRING:case vH.ERROR:case vH.ERROR_WITH_RAW_INPUT:case vH.CELL_REFERENCE:case vH.CELL_RANGE:case vH.COLUMN_RANGE:case vH.ROW_RANGE:case vH.NAMED_EXPRESSION:return!1;case vH.PERCENT_OP:case vH.PLUS_UNARY_OP:case vH.MINUS_UNARY_OP:return e(t.value,n);case vH.CONCATENATE_OP:case vH.EQUALS_OP:case vH.NOT_EQUAL_OP:case vH.LESS_THAN_OP:case vH.GREATER_THAN_OP:case vH.LESS_THAN_OR_EQUAL_OP:case vH.GREATER_THAN_OR_EQUAL_OP:case vH.MINUS_OP:case vH.PLUS_OP:case vH.TIMES_OP:case vH.DIV_OP:case vH.POWER_OP:return e(t.left,n)||e(t.right,n);case vH.PARENTHESIS:return e(t.expression,n);case vH.FUNCTION_CALL:return!!n(t.procedureName)||t.args.some((function(t){return e(t,n)}));case vH.ARRAY:return t.args.some((function(t){return t.some((function(t){return e(t,n)}))}))}},IH=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};function DH(e){return DH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DH(e)}function PH(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return HH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HH(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YH(e,t,n){return t&&FH(e.prototype,t),n&&FH(e,n),e}function UH(e,t,n){return UH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},UH(e,t,n||e)}function BH(e,t){return BH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},BH(e,t)}function VH(e,t){if(t&&("object"===DH(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function WH(e){return WH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},WH(e)}IH.DistinctSigns="Distinct signs.",IH.WrongArgNumber="Wrong number of arguments.",IH.EmptyArg="Empty function argument.",IH.EmptyArray="Empty array not allowed.",IH.ArrayDimensions="Array dimensions are not compatible.",IH.NoSpaceForArrayResult="No space for array result.",IH.ValueSmall="Value too small.",IH.ValueLarge="Value too large.",IH.BadCriterion="Incorrect criterion.",IH.RangeManySheets="Range spans more than one sheet.",IH.CellRangeExpected="Cell range expected.",IH.WrongDimension="Wrong range dimension.",IH.ScalarExpected="Cell range not allowed.",IH.NumberCoercion="Value cannot be coerced to number.",IH.NumberExpected="Number argument expected.",IH.IntegerExpected="Value needs to be an integer.",IH.BadMode="Mode not recognized.",IH.DateBounds="Date outside of bounds.",IH.OutOfSheet="Resulting reference is out of the sheet.",IH.WrongType="Wrong type of argument.",IH.NaN="NaN or infinite value encountered.",IH.EqualLength="Ranges need to be of equal length.",IH.Negative="Value cannot be negative.",IH.NotBinary="String does not represent a binary number.",IH.NotOctal="String does not represent an octal number.",IH.NotHex="String does not represent a hexadecimal number.",IH.EndStartPeriod="End period needs to be at least start period.",IH.CellRefExpected="Cell reference expected.",IH.EmptyRange="Empty range not allowed.",IH.BadRef="Address is not correct.",IH.NumberRange="Number-only range expected.",IH.ValueNotFound="Value not found.",IH.ValueBaseLarge="Value in base too large.",IH.ValueBaseSmall="Value in base too small.",IH.ValueBaseLong="Value in base too long.",IH.NegativeLength="Length cannot be negative.",IH.PatternNotFound="Pattern not found.",IH.OneValue="Needs at least one value.",IH.TwoValues="Range needs to contain at least two elements.",IH.ThreeValues="Range needs to contain at least three elements.",IH.IndexBounds="Index out of bounds.",IH.IndexLarge="Index too large.",IH.Formula="Expected formula.",IH.NegativeCount="Count cannot be negative.",IH.ParseError="Parsing error.",IH.SheetRef="Sheet does not exist.",IH.PeriodLong="Period number cannot exceed life length.",IH.InvalidDate="Invalid date.",IH.BitshiftLong="Result of bitshift is too long.",IH.EmptyString="Empty-string argument not allowed.",IH.LengthBounds="Length out of bounds.",IH.NegativeTime="Time cannot be negative.",IH.NoDefault="No default option.",IH.Selector="Selector cannot exceed the number of arguments.",IH.StartEndDate="Start date needs to be earlier than end date.",IH.IncorrectDateTime="String does not represent correct DateTime.",IH.CharacterCodeBounds="Character code out of bounds.",IH.NonZero="Argument cannot be 0.",IH.LessThanOne="Argument cannot be less than 1.",IH.WeekendString="Incorrect weekend bitmask string.",IH.InvalidRoman="Invalid roman numeral.",IH.WrongOrder="Wrong order of values.",IH.ComplexNumberExpected="Complex number expected.",IH.ShouldBeIorJ="Should be 'i' or 'j'.",IH.SizeMismatch="Array dimensions mismatched.",IH.FunctionName=function(e){return"Function name ".concat(e," not recognized.")},IH.NamedExpressionName=function(e){return"Named expression ".concat(e," not recognized.")},IH.LicenseKey=function(e){return"License key is ".concat(e,".")};var zH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BH(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=WH(t);if(n){var o=WH(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return VH(this,e)});function o(e,t){var n;return jH(this,o),(n=r.call(this,e.allTokens,{outputCst:!1,maxLookahead:7})).formula=n.RULE("formula",(function(){return n.CONSUME(LP),n.SUBRULE(n.booleanExpression)})),n.booleanExpression=n.RULE("booleanExpression",(function(){var e=n.SUBRULE(n.concatenateExpression);return n.MANY((function(){var t=n.CONSUME(AP),r=n.SUBRULE2(n.concatenateExpression);(0,gP.tokenMatcher)(t,LP)?e=function(e,t,n){return{type:vH.EQUALS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,xP)?e=function(e,t,n){return{type:vH.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,NP)?e=function(e,t,n){return{type:vH.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,IP)?e=function(e,t,n){return{type:vH.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,DP)?e=function(e,t,n){return{type:vH.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,PP)?e=function(e,t,n){return{type:vH.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):n.ACTION((function(){throw Error("Operator not supported")}))})),e})),n.booleanExpressionOrEmpty=n.RULE("booleanExpressionOrEmpty",(function(){return n.OR([{ALT:function(){return n.SUBRULE(n.booleanExpression)}},{ALT:(0,gP.EMPTY_ALT)({type:vH.EMPTY,leadingWhitespace:void 0})}])})),n.concatenateExpression=n.RULE("concatenateExpression",(function(){var e=n.SUBRULE(n.additionExpression);return n.MANY((function(){var t=n.CONSUME(HP),r=n.SUBRULE2(n.additionExpression);e=function(e,t,n){return{type:vH.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace)})),e})),n.additionExpression=n.RULE("additionExpression",(function(){var e=n.SUBRULE(n.multiplicationExpression);return n.MANY((function(){var t=n.CONSUME(SP),r=n.SUBRULE2(n.multiplicationExpression);(0,gP.tokenMatcher)(t,EP)?e=function(e,t,n){return{type:vH.PLUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,kP)?e=function(e,t,n){return{type:vH.MINUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):n.ACTION((function(){throw Error("Operator not supported")}))})),e})),n.multiplicationExpression=n.RULE("multiplicationExpression",(function(){var e=n.SUBRULE(n.powerExpression);return n.MANY((function(){var t=n.CONSUME(RP),r=n.SUBRULE2(n.powerExpression);(0,gP.tokenMatcher)(t,TP)?e=function(e,t,n){return{type:vH.TIMES_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):(0,gP.tokenMatcher)(t,CP)?e=function(e,t,n){return{type:vH.DIV_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):n.ACTION((function(){throw Error("Operator not supported")}))})),e})),n.powerExpression=n.RULE("powerExpression",(function(){var e=n.SUBRULE(n.atomicExpression);return n.MANY((function(){var t=n.CONSUME(MP),r=n.SUBRULE2(n.atomicExpression);(0,gP.tokenMatcher)(t,MP)?e=function(e,t,n){return{type:vH.POWER_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,r,t.leadingWhitespace):n.ACTION((function(){throw Error("Operator not supported")}))})),e})),n.atomicExpression=n.RULE("atomicExpression",(function(){return n.OR([{ALT:function(){var e=n.CONSUME(SP),t=n.SUBRULE(n.atomicExpression);return(0,gP.tokenMatcher)(e,EP)?function(e,t){return{type:vH.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}}(t,e.leadingWhitespace):(0,gP.tokenMatcher)(e,kP)?function(e,t){return{type:vH.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}}(t,e.leadingWhitespace):(n.customParsingError=bH(yH.ParserError,"Mismatched token type"),n.customParsingError)}},{ALT:function(){return n.SUBRULE2(n.rightUnaryOpAtomicExpression)}}])})),n.rightUnaryOpAtomicExpression=n.RULE("rightUnaryOpAtomicExpression",(function(){var e=n.SUBRULE(n.positiveAtomicExpression),t=n.OPTION((function(){return n.CONSUME(OP)}));return t?function(e,t){return{type:vH.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}}(e,t.leadingWhitespace):e})),n.positiveAtomicExpression=n.RULE("positiveAtomicExpression",(function(){var e;return n.OR(null!==(e=n.atomicExpCache)&&void 0!==e?e:n.atomicExpCache=[{ALT:function(){return n.SUBRULE(n.arrayExpression)}},{ALT:function(){return n.SUBRULE(n.cellRangeExpression)}},{ALT:function(){return n.SUBRULE(n.columnRangeExpression)}},{ALT:function(){return n.SUBRULE(n.rowRangeExpression)}},{ALT:function(){return n.SUBRULE(n.offsetExpression)}},{ALT:function(){return n.SUBRULE(n.cellReference)}},{ALT:function(){return n.SUBRULE(n.procedureExpression)}},{ALT:function(){return n.SUBRULE(n.namedExpressionExpression)}},{ALT:function(){var e=n.CONSUME(n.lexerConfig.NumberLiteral);return function(e,t){return{type:vH.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}}(n.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:function(){return function(e){var t;return{type:vH.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}}(n.CONSUME(qP))}},{ALT:function(){var e=n.CONSUME(JP),t=e.image.toUpperCase(),r=n.lexerConfig.errorMapping[t];return r?kH(new ZU(r),e.leadingWhitespace):n.parsingError(yH.ParserError,"Unknown error literal")}}])})),n.procedureExpression=n.RULE("procedureExpression",(function(){var e,t=n.CONSUME(XP),r=t.image.toUpperCase().slice(0,-1),o=null!==(e=n.lexerConfig.functionMapping[r])&&void 0!==e?e:r,i=[],a=n.SUBRULE(n.booleanExpressionOrEmpty);n.MANY((function(){var e,t=n.CONSUME(n.lexerConfig.ArgSeparator);a.type===vH.EMPTY&&(a.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),i.push(a),a=n.SUBRULE2(n.booleanExpressionOrEmpty)})),i.push(a),1===i.length&&i[0].type===vH.EMPTY&&(i.length=0);var s=n.CONSUME(zP);return function(e,t,n,r){return{type:vH.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==n?void 0:n.image,internalWhitespace:null==r?void 0:r.image}}(o,i,t.leadingWhitespace,s.leadingWhitespace)})),n.namedExpressionExpression=n.RULE("namedExpressionExpression",(function(){var e,t,r=n.CONSUME($P);return e=r.image,t=r.leadingWhitespace,{type:vH.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}})),n.offsetExpression=n.RULE("offsetExpression",(function(){var e,t=n.SUBRULE(n.offsetProcedureExpression);return n.OPTION((function(){n.CONSUME(VP),e=t.type===vH.CELL_RANGE?n.parsingError(yH.RangeOffsetNotAllowed,"Range offset not allowed here"):n.SUBRULE(n.endOfRangeWithOffsetStartExpression,{ARGS:[t]})})),void 0!==e?e:t})),n.offsetProcedureExpression=n.RULE("offsetProcedureExpression",(function(){var e=[];return n.CONSUME(n.lexerConfig.OffsetProcedureName),n.CONSUME(WP),n.MANY_SEP({SEP:n.lexerConfig.ArgSeparator,DEF:function(){e.push(n.SUBRULE(n.booleanExpression))}}),n.CONSUME(zP),n.handleOffsetHeuristic(e)})),n.cellRangeExpression=n.RULE("cellRangeExpression",(function(){var e=n.CONSUME(YP);return n.CONSUME2(VP),n.SUBRULE(n.endOfRangeExpression,{ARGS:[e]})})),n.columnRangeExpression=n.RULE("columnRangeExpression",(function(){var e=n.CONSUME(UP),t=PH(e.image.split(":"),2),r=t[0],o=t[1],i=n.ACTION((function(){return uH(n.sheetMapping,r,n.formulaAddress)})),a=n.ACTION((function(){return uH(n.sheetMapping,o,n.formulaAddress)}));if(void 0===i||void 0===a)return kH(new ZU(BU.REF));if(i.exceedsSheetSizeLimits(n.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(n.lexerConfig.maxColumns))return RH(e.image,new ZU(BU.NAME),e.leadingWhitespace);if(void 0===i.sheet&&void 0!==a.sheet)return n.parsingError(yH.ParserError,"Malformed range expression");var s=n.rangeSheetReferenceType(i.sheet,a.sheet);return void 0!==i.sheet&&void 0===a.sheet&&(a=a.withAbsoluteSheet(i.sheet)),function(e,t,n,r){return CH(e,t,n),{type:vH.COLUMN_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}}(i,a,s,e.leadingWhitespace)})),n.rowRangeExpression=n.RULE("rowRangeExpression",(function(){var e=n.CONSUME(BP),t=PH(e.image.split(":"),2),r=t[0],o=t[1],i=n.ACTION((function(){return lH(n.sheetMapping,r,n.formulaAddress)})),a=n.ACTION((function(){return lH(n.sheetMapping,o,n.formulaAddress)}));if(void 0===i||void 0===a)return kH(new ZU(BU.REF));if(i.exceedsSheetSizeLimits(n.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(n.lexerConfig.maxRows))return RH(e.image,new ZU(BU.NAME),e.leadingWhitespace);if(void 0===i.sheet&&void 0!==a.sheet)return n.parsingError(yH.ParserError,"Malformed range expression");var s=n.rangeSheetReferenceType(i.sheet,a.sheet);return void 0!==i.sheet&&void 0===a.sheet&&(a=a.withAbsoluteSheet(i.sheet)),function(e,t,n,r){return CH(e,t,n),{type:vH.ROW_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}}(i,a,s,e.leadingWhitespace)})),n.cellReference=n.RULE("cellReference",(function(){var e=n.CONSUME(YP),t=n.ACTION((function(){return sH(n.sheetMapping,e.image,n.formulaAddress)}));return void 0===t?RH(e.image,new ZU(BU.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(n.lexerConfig.maxColumns,n.lexerConfig.maxRows)?RH(e.image,new ZU(BU.NAME),e.leadingWhitespace):_H(t,e.leadingWhitespace)})),n.endOfRangeExpression=n.RULE("endOfRangeExpression",(function(e){return n.OR([{ALT:function(){return n.SUBRULE(n.endRangeReference,{ARGS:[e]})}},{ALT:function(){var t,r=n.SUBRULE(n.offsetProcedureExpression),o=n.ACTION((function(){return sH(n.sheetMapping,e.image,n.formulaAddress)}));if(void 0===o)return kH(new ZU(BU.REF));if(r.type===vH.CELL_REFERENCE){var i=r.reference,a=gH.RELATIVE;return void 0!==o.sheet&&(a=gH.START_ABSOLUTE,i=i.withAbsoluteSheet(o.sheet)),SH(o,i,a,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)}return n.parsingError(yH.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),n.endOfRangeWithOffsetStartExpression=n.RULE("endOfRangeWithOffsetStartExpression",(function(e){return n.OR([{ALT:function(){return n.SUBRULE(n.endRangeWithOffsetStartReference,{ARGS:[e]})}},{ALT:function(){var t=n.SUBRULE(n.offsetProcedureExpression);if(t.type===vH.CELL_REFERENCE){var r=t.reference,o=gH.RELATIVE;return void 0!==e.reference.sheet&&(o=gH.START_ABSOLUTE,r=r.withAbsoluteSheet(e.reference.sheet)),SH(e.reference,r,o,e.leadingWhitespace)}return n.parsingError(yH.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),n.endRangeReference=n.RULE("endRangeReference",(function(e){var t,r=n.CONSUME(YP),o=n.ACTION((function(){return sH(n.sheetMapping,e.image,n.formulaAddress)})),i=n.ACTION((function(){return sH(n.sheetMapping,r.image,n.formulaAddress)}));return void 0===o||void 0===i?n.ACTION((function(){return RH("".concat(e.image,":").concat(r.image),new ZU(BU.REF),e.leadingWhitespace)})):o.exceedsSheetSizeLimits(n.lexerConfig.maxColumns,n.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(n.lexerConfig.maxColumns,n.lexerConfig.maxRows)?n.ACTION((function(){return RH("".concat(e.image,":").concat(r.image),new ZU(BU.NAME),e.leadingWhitespace)})):n.buildCellRange(o,i,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),n.endRangeWithOffsetStartReference=n.RULE("endRangeWithOffsetStartReference",(function(e){var t=n.CONSUME(YP),r=n.ACTION((function(){return sH(n.sheetMapping,t.image,n.formulaAddress)}));return void 0===r?n.ACTION((function(){return kH(new ZU(BU.REF))})):n.buildCellRange(e.reference,r,e.leadingWhitespace)})),n.arrayExpression=n.RULE("arrayExpression",(function(){return n.OR([{ALT:function(){var e=n.CONSUME(GP),t=n.SUBRULE(n.insideArrayExpression),r=n.CONSUME(KP);return EH(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:function(){return n.SUBRULE(n.parenthesisExpression)}}])})),n.insideArrayExpression=n.RULE("insideArrayExpression",(function(){var e=[[]];return e[e.length-1].push(n.SUBRULE(n.booleanExpression)),n.MANY((function(){n.OR([{ALT:function(){n.CONSUME(n.lexerConfig.ArrayColSeparator),e[e.length-1].push(n.SUBRULE2(n.booleanExpression))}},{ALT:function(){n.CONSUME(n.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(n.SUBRULE3(n.booleanExpression))}}])})),EH(e)})),n.parenthesisExpression=n.RULE("parenthesisExpression",(function(){var e=n.CONSUME(WP),t=n.SUBRULE(n.booleanExpression),r=n.CONSUME(zP);return function(e,t,n){return{type:vH.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}}(t,e.leadingWhitespace,r.leadingWhitespace)})),n.numericStringToNumber=function(e){var t=e.replace(n.lexerConfig.decimalSeparator,".");return Number(t)},n.lexerConfig=e,n.sheetMapping=t,n.formulaAddress=oB(0,0,0),n.performSelfAnalysis(),n}return YH(o,[{key:"parseFromTokens",value:function(e,t){this.input=e;var n=this.formulaWithContext(t),r=[];return this.customParsingError&&r.push(this.customParsingError),r=r.concat(this.errors.map((function(e){return{type:yH.ParserError,message:e.message}}))),r.length>0&&(n=TH()),{ast:n,errors:r}}},{key:"formulaWithContext",value:function(e){return this.formulaAddress=e,this.formula()}},{key:"reset",value:function(){UH(WH(o.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"buildCellRange",value:function(e,t,n){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(yH.ParserError,"Malformed range expression");var r=this.rangeSheetReferenceType(e.sheet,t.sheet);return void 0!==e.sheet&&void 0===t.sheet&&(t=t.withAbsoluteSheet(e.sheet)),SH(e,t,r,n)}},{key:"handleOffsetHeuristic",value:function(e){var t=e[0];if(t.type!==vH.CELL_REFERENCE)return this.parsingError(yH.StaticOffsetError,"First argument to OFFSET is not a reference");var n,r=e[1];if(r.type===vH.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===vH.PLUS_UNARY_OP&&r.value.type===vH.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==vH.MINUS_UNARY_OP||r.value.type!==vH.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(yH.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}var o,i=e[2];if(i.type===vH.NUMBER&&Number.isInteger(i.value))o=i.value;else if(i.type===vH.PLUS_UNARY_OP&&i.value.type===vH.NUMBER&&Number.isInteger(i.value.value))o=i.value.value;else{if(i.type!==vH.MINUS_UNARY_OP||i.value.type!==vH.NUMBER||!Number.isInteger(i.value.value))return this.parsingError(yH.StaticOffsetError,"Third argument to OFFSET is not a static number");o=-i.value.value}var a,s=e[3];if(void 0===s)a=1;else{if(s.type!==vH.NUMBER)return this.parsingError(yH.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((a=s.value)<1)return this.parsingError(yH.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(a))return this.parsingError(yH.StaticOffsetError,"Fourth argument to OFFSET is not integer")}var u,l=e[4];if(void 0===l)u=1;else{if(l.type!==vH.NUMBER)return this.parsingError(yH.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((u=l.value)<1)return this.parsingError(yH.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(yH.StaticOffsetError,"Fifth argument to OFFSET is not integer")}var c=new mP(t.reference.col+o,t.reference.row+n,t.reference.type),f=c.col,h=c.row;if(t.reference.type!==$D.CELL_REFERENCE_RELATIVE&&t.reference.type!==$D.CELL_REFERENCE_ABSOLUTE_COL||(h+=this.formulaAddress.row),t.reference.type!==$D.CELL_REFERENCE_RELATIVE&&t.reference.type!==$D.CELL_REFERENCE_ABSOLUTE_ROW||(f+=this.formulaAddress.col),f<0||h<0)return kH(new ZU(BU.REF,IH.OutOfSheet));if(1===u&&1===a)return _H(c);var d=new mP(c.col+u-1,c.row+a-1,c.type);return SH(c,d,gH.RELATIVE)}},{key:"parsingError",value:function(e,t){return this.customParsingError=bH(e,t),TH()}},{key:"rangeSheetReferenceType",value:function(e,t){return void 0===e?gH.RELATIVE:void 0===t?gH.START_ABSOLUTE:gH.BOTH_ABSOLUTE}}]),o}(gP.EmbeddedActionsParser),GH=function(){function e(t){jH(this,e),this.lexerConfig=t,this.lexer=new gP.Lexer(t.allTokens,{ensureOptimizations:!0})}return YH(e,[{key:"tokenizeFormula",value:function(e){var t=this.lexer.tokenize(e),n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}},{key:"skipWhitespacesInsideRanges",value:function(e){return this.filterTokensByNeighbors(e,(function(e,t,n){return((0,gP.tokenMatcher)(e,YP)||(0,gP.tokenMatcher)(e,VP))&&(0,gP.tokenMatcher)(t,QP)&&((0,gP.tokenMatcher)(n,YP)||(0,gP.tokenMatcher)(n,VP))}))}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var t=this;return this.filterTokensByNeighbors(e,(function(e,n,r){return!(0,gP.tokenMatcher)(e,t.lexerConfig.ArgSeparator)&&(0,gP.tokenMatcher)(n,QP)&&(0,gP.tokenMatcher)(r,t.lexerConfig.ArgSeparator)}))}},{key:"filterTokensByNeighbors",value:function(e,t){if(e.length<3)return e;for(var n=0,r=[e[n++]];n<e.length-1;)t(e[n-1],e[n],e[n+1])||r.push(e[n]),++n;return r.push(e[n]),r}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&(0,gP.tokenMatcher)(e[e.length-1],QP)&&e.pop(),e}}]),e}();function KH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var XH=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.lexerConfig=n,this.sheetMappingFn=r,this.namedExpressions=o}var t,n;return t=e,n=[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var n,r,o=this;switch(e.type){case vH.EMPTY:return MH("",e.leadingWhitespace);case vH.NUMBER:return MH($H(e.value,this.config.decimalSeparator),e.leadingWhitespace);case vH.STRING:return MH('"'+e.value+'"',e.leadingWhitespace);case vH.FUNCTION_CALL:var i=e.args.map((function(e){return void 0!==e?o.unparseAst(e,t):""})).join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+i+MH(")",e.internalWhitespace);return MH(a,e.leadingWhitespace);case vH.NAMED_EXPRESSION:return MH((null===(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===n?void 0:n.displayName)||e.expressionName,e.leadingWhitespace);case vH.CELL_REFERENCE:var s;return s=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",MH(s+=null!==(r=e.reference.unparse(t))&&void 0!==r?r:this.config.translationPackage.getErrorTranslation(BU.REF),e.leadingWhitespace);case vH.COLUMN_RANGE:case vH.ROW_RANGE:case vH.CELL_RANGE:return MH(this.formatRange(e,t),e.leadingWhitespace);case vH.PLUS_UNARY_OP:var u=this.unparseAst(e.value,t);return MH("+",e.leadingWhitespace)+u;case vH.MINUS_UNARY_OP:var l=this.unparseAst(e.value,t);return MH("-",e.leadingWhitespace)+l;case vH.PERCENT_OP:return this.unparseAst(e.value,t)+MH("%",e.leadingWhitespace);case vH.ERROR:return MH(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:BU.ERROR),e.leadingWhitespace);case vH.ERROR_WITH_RAW_INPUT:return MH(e.rawInput,e.leadingWhitespace);case vH.PARENTHESIS:var c="("+this.unparseAst(e.expression,t)+MH(")",e.internalWhitespace);return MH(c,e.leadingWhitespace);case vH.ARRAY:var f="{"+e.args.map((function(e){return e.map((function(e){return o.unparseAst(e,t)})).join(o.config.arrayColumnSeparator)})).join(this.config.arrayRowSeparator)+MH("}",e.internalWhitespace);return MH(f,e.leadingWhitespace);default:var h=this.unparseAst(e.left,t),d=this.unparseAst(e.right,t);return h+MH(AH[e.type],e.leadingWhitespace)+d}}},{key:"unparseSheetName",value:function(e){var t=pH(e,this.sheetMappingFn);if(void 0===t)throw new ID(e);return t}},{key:"formatRange",value:function(e,t){var n="",r="";void 0!==e.start.sheet&&e.sheetReferenceType!==gH.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===gH.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!");var o=e.start.unparse(t),i=e.end.unparse(t);return void 0===o||void 0===i?this.config.translationPackage.getErrorTranslation(BU.REF):"".concat(n).concat(o,":").concat(r).concat(i)}}],n&&KH(t.prototype,n),e}();function $H(e,t){return e.toString().replace(".",t)}function qH(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return JH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?JH(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ZH=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functionRegistry=n,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=ZP(t),this.lexer=new GH(this.lexerConfig),this.formulaParser=new zH(this.lexerConfig,this.sheetMapping),this.cache=new xH(this.functionRegistry)}var t,n;return t=e,n=[{key:"parse",value:function(e,t){var n=this.lexer.tokenizeFormula(e);if(n.errors.length>0){var r=n.errors.map((function(e){return{type:yH.LexingError,message:e.message}}));return{ast:TH(),errors:r,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var o=this.computeHashFromTokens(n.tokens,t),i=this.cache.get(o);if(void 0!==i)++this.statsCacheUsed;else{var a=function(e){var t=[],n=e[0];(0,gP.tokenMatcher)(n,QP)||t.push(n);for(var r=1;r<e.length;++r){var o=e[r];if(!(0,gP.tokenMatcher)(o,QP)){var i=e[r-1];(0,gP.tokenMatcher)(i,QP)&&(o.leadingWhitespace=i),t.push(o)}}return t}(n.tokens),s=this.formulaParser.parseFromTokens(a,t);if(s.errors.length>0)return Object.assign(Object.assign({},s),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(o,s.ast)}var u=i;return{ast:u.ast,errors:[],hasVolatileFunction:u.hasVolatileFunction,hasStructuralChangeFunction:u.hasStructuralChangeFunction,dependencies:u.relativeDependencies}}},{key:"fetchCachedResultForAst",value:function(e){var t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}},{key:"fetchCachedResult",value:function(e){var t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");return{ast:t.ast,errors:[],hasVolatileFunction:t.hasVolatileFunction,hasStructuralChangeFunction:t.hasStructuralChangeFunction,dependencies:t.relativeDependencies}}},{key:"computeHashFromTokens",value:function(e,t){for(var n,r="",o=0;o<e.length;){var i=e[o];if((0,gP.tokenMatcher)(i,YP)){var a=sH(this.sheetMapping,i.image,t);r=void 0===a?r.concat(i.image):r.concat(a.hash(!0))}else if((0,gP.tokenMatcher)(i,XP)){var s=i.image.toUpperCase().slice(0,-1),u=null!==(n=this.lexerConfig.functionMapping[s])&&void 0!==n?n:s;r=r.concat(u,"(")}else if((0,gP.tokenMatcher)(i,UP)){var l=qH(i.image.split(":"),2),c=l[0],f=l[1],h=uH(this.sheetMapping,c,t),d=uH(this.sheetMapping,f,t);r=void 0===h||void 0===d?r.concat("!REF"):r.concat(h.hash(!0),":",d.hash(!0))}else if((0,gP.tokenMatcher)(i,BP)){var p=qH(i.image.split(":"),2),m=p[0],y=p[1],v=lH(this.sheetMapping,m,t),g=lH(this.sheetMapping,y,t);r=void 0===v||void 0===g?r.concat("!REF"):r.concat(v.hash(!0),":",g.hash(!0))}else r=r.concat(i.image);o++}return r}},{key:"rememberNewAst",value:function(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"computeHashOfAstNode",value:function(e){var t=this;switch(e.type){case vH.EMPTY:return e.leadingWhitespace||"";case vH.NUMBER:return MH($H(e.value,this.config.decimalSeparator),e.leadingWhitespace);case vH.STRING:return MH('"'+e.value+'"',e.leadingWhitespace);case vH.NAMED_EXPRESSION:return MH(e.expressionName,e.leadingWhitespace);case vH.FUNCTION_CALL:var n=e.args.map((function(e){return t.computeHashOfAstNode(e)})).join(this.config.functionArgSeparator),r=e.procedureName+"("+n+MH(")",e.internalWhitespace);return MH(r,e.leadingWhitespace);case vH.CELL_REFERENCE:return MH(e.reference.hash(!0),e.leadingWhitespace);case vH.COLUMN_RANGE:case vH.ROW_RANGE:case vH.CELL_RANGE:return MH(e.start.hash(e.sheetReferenceType!==gH.RELATIVE)+":"+e.end.hash(e.sheetReferenceType===gH.BOTH_ABSOLUTE),e.leadingWhitespace);case vH.MINUS_UNARY_OP:return MH("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case vH.PLUS_UNARY_OP:return MH("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case vH.PERCENT_OP:return this.computeHashOfAstNode(e.value)+MH("%",e.leadingWhitespace);case vH.ERROR:return MH(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:BU.ERROR),e.leadingWhitespace);case vH.ERROR_WITH_RAW_INPUT:return MH(e.rawInput,e.leadingWhitespace);case vH.ARRAY:var o=e.args.map((function(e){return e.map((function(e){return t.computeHashOfAstNode(e)})).join(",")})).join(";");return MH("{"+o+MH("}",e.internalWhitespace),e.leadingWhitespace);case vH.PARENTHESIS:var i="("+this.computeHashOfAstNode(e.expression)+MH(")",e.internalWhitespace);return MH(i,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+MH(AH[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}}],n&&QH(t.prototype,n),e}(),ej=function e(t,n,r,o){switch(t.type){case vH.EMPTY:case vH.NUMBER:case vH.STRING:case vH.ERROR:return;case vH.NAMED_EXPRESSION:return void(o&&r.push(new lj(t.expressionName)));case vH.CELL_REFERENCE:return void(o&&r.push(new ij(t.reference)));case vH.CELL_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new aj(t.start,t.end)));case vH.COLUMN_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new sj(t.start,t.end)));case vH.ROW_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new uj(t.start,t.end)));case vH.PERCENT_OP:case vH.PLUS_UNARY_OP:case vH.MINUS_UNARY_OP:return void e(t.value,n,r,!0);case vH.CONCATENATE_OP:case vH.EQUALS_OP:case vH.NOT_EQUAL_OP:case vH.LESS_THAN_OP:case vH.GREATER_THAN_OP:case vH.LESS_THAN_OR_EQUAL_OP:case vH.GREATER_THAN_OR_EQUAL_OP:case vH.MINUS_OP:case vH.PLUS_OP:case vH.TIMES_OP:case vH.DIV_OP:case vH.POWER_OP:return e(t.left,n,r,!0),void e(t.right,n,r,!0);case vH.PARENTHESIS:return void e(t.expression,n,r,o);case vH.FUNCTION_CALL:var i=!n.doesFunctionNeedArgumentToBeComputed(t.procedureName);return void t.args.forEach((function(t){return e(t,n,r,i)}))}},tj=function(e,t){var n=new Array;return ej(e,t,n,!0),n};function nj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oj(e,t,n){return t&&rj(e.prototype,t),n&&rj(e,n),e}var ij=function(){function e(t){nj(this,e),this.dependency=t}return oj(e,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),e}(),aj=function(){function e(t,n){nj(this,e),this.start=t,this.end=n}return oj(e,[{key:"absolutize",value:function(e){return new Cj(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),e}(),sj=function(){function e(t,n){nj(this,e),this.start=t,this.end=n}return oj(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new Mj(t.sheet,t.col,n.col)}}]),e}(),uj=function(){function e(t,n){nj(this,e),this.start=t,this.end=n}return oj(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new Oj(t.sheet,t.row,n.row)}}]),e}(),lj=function(){function e(t){nj(this,e),this.name=t}return oj(e,[{key:"absolutize",value:function(e){return this}}]),e}();function cj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hj(e,t,n){return t&&fj(e.prototype,t),n&&fj(e,n),e}var dj=function(){function e(t,n,r){if(cj(this,e),this.sheet=t,this.rowStart=n,this.rowEnd=r,n<0)throw Error("Starting row cant be less than 0");if(r<n)throw Error("Row span cant end before start")}return hj(e,[{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"rows",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.rowStart;case 1:if(!(t<=this.rowEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.rowStart,t.rowStart),r=Math.min(this.rowEnd,t.rowEnd);return n>r?null:new e(this.sheet,n,r)}},{key:"firstRow",value:function(){return new e(this.sheet,this.rowStart,this.rowStart)}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}}],[{key:"fromNumberOfRows",value:function(t,n,r){return new e(t,n,n+r-1)}},{key:"fromRowStartAndEnd",value:function(t,n,r){return new e(t,n,r)}}]),e}(),pj=function(){function e(t,n,r){if(cj(this,e),this.sheet=t,this.columnStart=n,this.columnEnd=r,n<0)throw Error("Starting column cant be less than 0");if(r<n)throw Error("Column span cant end before start")}return hj(e,[{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"columns",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.columnStart;case 1:if(!(t<=this.columnEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.columnStart,t.columnStart),r=Math.min(this.columnEnd,t.columnEnd);return n>r?null:new e(this.sheet,n,r)}},{key:"firstColumn",value:function(){return new e(this.sheet,this.columnStart,this.columnStart)}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}}],[{key:"fromNumberOfColumns",value:function(t,n,r){return new e(t,n,n+r-1)}},{key:"fromColumnStartAndEnd",value:function(t,n,r){return new e(t,n,r)}}]),e}();function mj(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yj(e,t)}function yj(e,t){return yj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yj(e,t)}function vj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bj(e);if(t){var o=bj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gj(this,n)}}function gj(e,t){if(t&&("object"===Ej(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bj(e){return bj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bj(e)}function wj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sj(e,t,n){return t&&_j(e.prototype,t),n&&_j(e,n),e}function Ej(e){return Ej="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ej(e)}var kj="AbsoluteCellRange: Wrong range size";function Rj(e){return!(!e||"object"!==Ej(e)&&"function"!=typeof e)&&"start"in e&&uB(e.start)&&"end"in e&&uB(e.end)}var Tj=function(e,t){return{start:e,end:t}},Cj=function(){function e(t,n){if(wj(this,e),t.sheet!==n.sheet)throw new UD(t.sheet,n.sheet);this.start=oB(t.sheet,t.col,t.row),this.end=oB(n.sheet,n.col,n.row)}return Sj(e,[{key:"sheet",get:function(){return this.start.sheet}},{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}},{key:"addressInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"columnInRange",value:function(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"rowInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(t){if(this.sheet===t.start.sheet){var n=Math.max(this.start.row,t.start.row),r=Math.min(this.end.row,t.end.row),o=Math.max(this.start.col,t.start.col),i=Math.min(this.end.col,t.end.col);if(!(n>r||o>i))return new e(oB(this.sheet,o,n),oB(this.sheet,i,r))}}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(t,n){return e.spanFrom(oB(this.sheet,this.start.col+t,this.start.row+n),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof dj?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"removeRows",value:function(e,t){if(!(e>this.end.row)){if(t<this.start.row){var n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,t){if(!(e>this.end.col)){if(t<this.start.col){var n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(t,n){return e.spanFrom(oB(this.sheet,this.start.col,t),this.width(),n)}},{key:"rangeWithSameHeight",value:function(t,n){return e.spanFrom(oB(this.sheet,t,this.start.row),n,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],t=0;t<this.height();++t){e[t]=[];for(var n=0;n<this.width();++n){var r=oB(this.sheet,this.start.col+n,this.start.row+t);e[t].push(r)}}return e}},{key:"withStart",value:function(t){return new e(t,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"sameAs",value:function(e){return cB(this.start,e.start)&&cB(this.end,e.end)}},{key:"addressesArrayMap",value:function(e,t){for(var n=[],r=this.start.row;r<=this.effectiveEndRow(e);){for(var o=this.start.col,i=[];o<=this.effectiveEndColumn(e);)i.push(t(oB(this.start.sheet,o,r))),o++;n.push(i),r++}return n}},{key:"addresses",value:function(e){for(var t=[],n=this.start.row,r=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);n<=r;){for(var i=this.start.col;i<=o;)t.push(oB(this.start.sheet,i,n)),i++;n++}return t}},{key:"addressesWithDirection",value:regeneratorRuntime.mark((function e(t,n,r){var o,i,a,s,u,l,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=30;break}if(!(n>0)){e.next=16;break}o=this.effectiveEndRow(r);case 3:if(!(o>=this.start.row)){e.next=14;break}i=this.effectiveEndColumn(r);case 5:if(!(i>=this.start.col)){e.next=11;break}return e.next=8,oB(this.start.sheet,i,o);case 8:i-=1,e.next=5;break;case 11:o-=1,e.next=3;break;case 14:e.next=28;break;case 16:a=this.start.row;case 17:if(!(a<=this.effectiveEndRow(r))){e.next=28;break}s=this.effectiveEndColumn(r);case 19:if(!(s>=this.start.col)){e.next=25;break}return e.next=22,oB(this.start.sheet,s,a);case 22:s-=1,e.next=19;break;case 25:a+=1,e.next=17;break;case 28:e.next=57;break;case 30:if(!(n>0)){e.next=45;break}u=this.effectiveEndRow(r);case 32:if(!(u>=this.start.row)){e.next=43;break}l=this.start.col;case 34:if(!(l<=this.effectiveEndColumn(r))){e.next=40;break}return e.next=37,oB(this.start.sheet,l,u);case 37:l+=1,e.next=34;break;case 40:u-=1,e.next=32;break;case 43:e.next=57;break;case 45:c=this.start.row;case 46:if(!(c<=this.effectiveEndRow(r))){e.next=57;break}f=this.start.col;case 48:if(!(f<=this.effectiveEndColumn(r))){e.next=54;break}return e.next=51,oB(this.start.sheet,f,c);case 51:f+=1,e.next=48;break;case 54:c+=1,e.next=46;break;case 57:case"end":return e.stop()}}),e,this)}))},{key:"getAddress",value:function(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return oB(this.start.sheet,this.start.col+e,this.start.row+t)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e||this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}}],[{key:"fromAst",value:function(t,n){return t.type===vH.CELL_RANGE?e.fromCellRange(t,n):t.type===vH.COLUMN_RANGE?Mj.fromColumnRange(t,n):Oj.fromRowRangeAst(t,n)}},{key:"fromCellRange",value:function(t,n){return new e(t.start.toSimpleCellAddress(n),t.end.toSimpleCellAddress(n))}},{key:"fromCellRangeOrUndef",value:function(t,n){try{return new e(t.start.toSimpleCellAddress(n),t.end.toSimpleCellAddress(n))}catch(e){return}}},{key:"spanFrom",value:function(t,n,r){if(!Number.isFinite(n)&&Number.isFinite(r)){if(0!==t.col)throw new Error(kj);return new Oj(t.sheet,t.row,t.row+r-1)}if(!Number.isFinite(r)&&Number.isFinite(n)){if(0!==t.row)throw new Error(kj);return new Mj(t.sheet,t.col,t.col+n-1)}if(Number.isFinite(r)&&Number.isFinite(n))return new e(t,oB(t.sheet,t.col+n-1,t.row+r-1));throw new Error(kj)}},{key:"fromCoordinates",value:function(t,n,r,o,i){return new e(oB(t,n,r),oB(t,o,i))}}]),e}(),Mj=function(e){mj(n,e);var t=vj(n);function n(e,r,o){return wj(this,n),t.call(this,oB(e,r,0),oB(e,o,Number.POSITIVE_INFINITY))}return Sj(n,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(e){}},{key:"expandByRows",value:function(e){}},{key:"shifted",value:function(e,t){return new n(this.sheet,this.start.col+e,this.end.col+e)}},{key:"removeRows",value:function(e,t){}},{key:"rangeWithSameHeight",value:function(e,t){return new n(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e}},{key:"effectiveEndRow",value:function(e){return e.getSheetHeight(this.sheet)-1}}],[{key:"fromColumnRange",value:function(e,t){var r=e.start.toSimpleColumnAddress(t),o=e.end.toSimpleColumnAddress(t);if(r.sheet!==o.sheet)throw new UD(r.sheet,o.sheet);return new n(r.sheet,r.col,o.col)}}]),n}(Cj),Oj=function(e){mj(n,e);var t=vj(n);function n(e,r,o){return wj(this,n),t.call(this,oB(e,0,r),oB(e,Number.POSITIVE_INFINITY,o))}return Sj(n,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(e){}},{key:"expandByColumns",value:function(e){}},{key:"shifted",value:function(e,t){return new n(this.sheet,this.start.row+t,this.end.row+t)}},{key:"removeColumns",value:function(e,t){}},{key:"rangeWithSameWidth",value:function(e,t){return new n(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return e.getSheetWidth(this.sheet)-1}}],[{key:"fromRowRangeAst",value:function(e,t){var r=e.start.toSimpleRowAddress(t),o=e.end.toSimpleRowAddress(t);if(r.sheet!==o.sheet)throw new UD(r.sheet,o.sheet);return new n(r.sheet,r.row,o.row)}}]),n}(Cj),Aj=function(e,t){return e.map((function(e){return e.absolutize(t)}))},Lj=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formulaAddress=t,this.arraysFlag=n,this.formulaVertex=r},xj=n(70268),Nj=n.n(xj);function Ij(e){return Ij="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ij(e)}function Dj(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pj(e,t)}function Pj(e,t){return Pj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pj(e,t)}function Hj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fj(e);if(t){var o=Fj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jj(this,n)}}function jj(e,t){if(t&&("object"===Ij(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fj(e){return Fj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fj(e)}function Yj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bj(e,t,n){return t&&Uj(e.prototype,t),n&&Uj(e,n),e}var Vj=Symbol("Empty value");function Wj(e){return e instanceof zj?e.val:e}var zj=function(){function e(t,n){Yj(this,e),this.val=t,this.format=n}return Bj(e,[{key:"fromNumber",value:function(e){return new this.constructor(e)}}]),e}();function Gj(e,t){if("number"==typeof e)return t;var n=e.fromNumber(t);return n.format=e.format,n}var Kj,Xj=function(e){Dj(n,e);var t=Hj(n);function n(){return Yj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"getDetailedType",value:function(){return Kj.NUMBER_DATE}}]),n}(zj),$j=function(e){Dj(n,e);var t=Hj(n);function n(){return Yj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"getDetailedType",value:function(){return Kj.NUMBER_CURRENCY}}]),n}(zj),qj=function(e){Dj(n,e);var t=Hj(n);function n(){return Yj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"getDetailedType",value:function(){return Kj.NUMBER_TIME}}]),n}(zj),Jj=function(e){Dj(n,e);var t=Hj(n);function n(){return Yj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"getDetailedType",value:function(){return Kj.NUMBER_DATETIME}}]),n}(zj),Qj=function(e){Dj(n,e);var t=Hj(n);function n(){return Yj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"getDetailedType",value:function(){return Kj.NUMBER_PERCENT}}]),n}(zj);function Zj(e){return"number"==typeof e||e instanceof zj}function eF(e){return e instanceof zj?{type:e.getDetailedType(),format:e.format}:{type:Kj.NUMBER_RAW}}function tF(e){return function(e){if(Array.isArray(e))return oF(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||rF(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nF(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=rF(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function rF(e,t){if(e){if("string"==typeof e)return oF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oF(e,t):void 0}}function oF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(Kj||(Kj={}));var aF=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/,sF=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.dateTimeHelper=n,this.numberLiteralsHelper=r,this.lt=function(e,t){return o.compare(e,t)<0},this.leq=function(e,t){return o.compare(e,t)<=0},this.gt=function(e,t){return o.compare(e,t)>0},this.geq=function(e,t){return o.compare(e,t)>=0},this.eq=function(e,t){return 0===o.compare(e,t)},this.neq=function(e,t){return 0!==o.compare(e,t)},this.pow=function(e,t){return Math.pow(Wj(e),Wj(t))},this.addWithEpsilonRaw=function(e,t){var n=e+t;return Math.abs(n)<o.actualEps*Math.abs(e)?0:n},this.addWithEpsilon=function(e,t){var n=RF(e,t);return o.ExtendedNumberFactory(o.addWithEpsilonRaw(Wj(e),Wj(t)),n)},this.unaryMinus=function(e){return Gj(e,-Wj(e))},this.unaryPlus=function(e){return e},this.unaryPercent=function(e){return new Qj(Wj(e)/100)},this.concat=function(e,t){return e.concat(t)},this.nonstrictadd=function(e,t){return e instanceof ZU?e:t instanceof ZU?t:"number"==typeof e?"number"==typeof t?o.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0},this.subtract=function(e,t){var n=RF(e,t),r=Wj(e),i=r-Wj(t);return Math.abs(i)<o.actualEps*Math.abs(r)&&(i=0),o.ExtendedNumberFactory(i,n)},this.divide=function(e,t){var n=Wj(e),r=Wj(t);if(0===r)return new ZU(BU.DIV_BY_ZERO);var i=TF(e,t);return o.ExtendedNumberFactory(n/r,i)},this.multiply=function(e,t){var n=TF(e,t);return o.ExtendedNumberFactory(Wj(e)*Wj(t),n)},this.manyToExactComplex=function(e){var t,n=[],r=nF(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof ZU)return i;if(Zj(i)||"string"==typeof i){var a=o.coerceScalarToComplex(i);a instanceof ZU||n.push(a)}}}catch(e){r.e(e)}finally{r.f()}return n},this.coerceNumbersExactRanges=function(e){return o.manyToNumbers(e,o.manyToExactNumbers)},this.coerceNumbersCoerceRangesDropNulls=function(e){return o.manyToNumbers(e,o.manyToCoercedNumbersDropNulls)},this.manyToExactNumbers=function(e){var t,n=[],r=nF(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof ZU)return o;Zj(o)&&n.push(Wj(o))}}catch(e){r.e(e)}finally{r.f()}return n},this.manyToOnlyNumbersDropNulls=function(e){var t,n=[],r=nF(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof ZU)return o;if(o!==Vj){if(!Zj(o))return new ZU(BU.VALUE,IH.NumberExpected);n.push(Wj(o))}}}catch(e){r.e(e)}finally{r.f()}return n},this.manyToCoercedNumbersDropNulls=function(e){var t,n=[],r=nF(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof ZU)return i;if(i!==Vj){var a=o.coerceScalarToNumberOrError(i);Zj(a)&&n.push(Wj(a))}}}catch(e){r.e(e)}finally{r.f()}return n},this.collator=function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",n=e.caseFirst,r=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:n,ignorePunctuation:r})}(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}var t,n;return t=e,n=[{key:"eqMatcherFunction",value:function(e){var t=this,n=this.buildRegex(e);return function(e){return"string"==typeof e&&n.test(t.normalizeString(e))}}},{key:"neqMatcherFunction",value:function(e){var t=this,n=this.buildRegex(e);return function(e){return!("string"==typeof e&&n.test(t.normalizeString(e)))}}},{key:"searchString",value:function(e,t){var n,r=this.buildRegex(e,!1).exec(t);return null!==(n=null==r?void 0:r.index)&&void 0!==n?n:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var t=0;t<e.length;t++){var n=e.charAt(t);if(gF(n)||this.config.useRegularExpressions&&_F(n))return!0}return!1}},{key:"buildRegex",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=this.normalizeString(e);var r=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch(e){o=!1,r=!1}return t=o?kF(e,this.config.caseSensitive):r?SF(e,this.config.caseSensitive):EF(e,this.config.caseSensitive),this.config.matchWholeCell&&n?RegExp("^("+t+")$"):RegExp(t)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=OF(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,t){if("string"==typeof e||"string"==typeof t){var n="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,r="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(Zj(n)&&Zj(r))return this.floatCmp(n,r)}return e===Vj?e=fF(t):t===Vj&&(t=fF(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?mF(cF(e),cF(t)):Zj(e)&&Zj(t)?this.floatCmp(e,t):e===Vj&&t===Vj?0:mF(JU(QU(e)),JU(QU(t)))}},{key:"floatCmp",value:function(e,t){var n=Wj(e),r=Wj(t),o=1+this.actualEps;return r>=0&&n*o>=r&&n<=r*o||r<=0&&n*o<=r&&n>=r*o?0:n>r?1:-1}},{key:"stringCmp",value:function(e,t){return this.collator.compare(e,t)}},{key:"coerceScalarToNumberOrError",value:function(e){var t;return e instanceof ZU?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new ZU(BU.VALUE,IH.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){return e===Vj?0:"string"==typeof e?""===e?0:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):Zj(e)?e:"boolean"==typeof e?Number(e):void 0}},{key:"coerceComplexExactRanges",value:function(e){var t,n=[],r=nF(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof XF)n.push(o);else if(o!==Vj){var i=this.coerceScalarToComplex(o);if(i instanceof ZU)return i;n.push(i)}}}catch(e){r.e(e)}finally{r.f()}for(var a=[],s=0,u=n;s<u.length;s++){var l=u[s];if(l instanceof XF){var c=this.manyToExactComplex(l.valuesFromTopLeftCorner());if(c instanceof ZU)return c;a.push.apply(a,tF(c))}else a.push(l)}return a}},{key:"manyToNumbers",value:function(e,t){var n,r=[],o=nF(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i instanceof XF)r.push(i);else{var a=Wj(this.coerceScalarToNumberOrError(i));if(a instanceof ZU)return a;r.push(a)}}}catch(e){o.e(e)}finally{o.f()}for(var s=[],u=0,l=r;u<l.length;u++){var c=l[u];if(c instanceof XF){var f=t(c.valuesFromTopLeftCorner());if(f instanceof ZU)return f;s.push.apply(s,tF(f))}else s.push(c)}return s}},{key:"coerceScalarToComplex",value:function(e){return e instanceof ZU?e:e===Vj?[0,0]:Zj(e)?[Wj(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new ZU(BU.NUM,IH.ComplexNumberExpected)}},{key:"coerceStringToComplex",value:function(e){var t,n,r=aF.exec(e);return null===r?new ZU(BU.NUM,IH.ComplexNumberExpected):(t=void 0!==r[6]?"-"===r[1]?[0,-1]:[0,1]:this.parseComplexToken(r[1]+r[3],r[5]))instanceof ZU||void 0===r[8]?t:(n=void 0!==r[14]?"-"===r[9]?[0,-1]:[0,1]:this.parseComplexToken(r[9]+r[11],r[13]))instanceof ZU?n:""!==r[5]||""===r[13]?new ZU(BU.NUM,IH.ComplexNumberExpected):"+"===r[8]?[t[0]+n[0],t[1]+n[1]]:[t[0]-n[0],t[1]-n[1]]}},{key:"parseComplexToken",value:function(e,t){var n=Wj(this.coerceNonDateScalarToMaybeNumber(e));return void 0===n?new ZU(BU.NUM,IH.ComplexNumberExpected):""===t?[n,0]:[0,n]}},{key:"ExtendedNumberFactory",value:function(e,t){var n=t.type,r=t.format;switch(n){case Kj.NUMBER_RAW:return e;case Kj.NUMBER_CURRENCY:return new $j(e,null!=r?r:this.config.currencySymbol[0]);case Kj.NUMBER_DATE:return new Xj(e,r);case Kj.NUMBER_DATETIME:return new Jj(e,r);case Kj.NUMBER_TIME:return new qj(e,r);case Kj.NUMBER_PERCENT:return new Qj(e,r)}}}],n&&iF(t.prototype,n),e}();function uF(e,t){var n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||rF(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];if(!isFinite(i)||!isFinite(a))return new ZU(BU.NUM,IH.NaN);if(t=null!=t?t:"i",0===a)return"".concat(i);var s="".concat(-1===a||1===a?"":Math.abs(a)).concat(t);return 0===i?"".concat(a<0?"-":"").concat(s):"".concat(i).concat(a<0?"-":"+").concat(s)}function lF(e){return e instanceof XF?e:XF.fromScalar(e)}function cF(e){return Number(e)}function fF(e){return"string"==typeof e?"":Zj(e)?0:"boolean"!=typeof e&&Vj}function hF(e){if(e instanceof ZU||"boolean"==typeof e)return e;if(e===Vj)return!1;if(Zj(e))return 0!==Wj(e);var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0}function dF(e){return e instanceof ZU||"string"==typeof e?e:e===Vj?"":Zj(e)?Wj(e).toString():e?"TRUE":"FALSE"}function pF(e){return e===Vj?0:e}function mF(e,t){var n=Wj(e),r=Wj(t);return n>r?1:n<r?-1:0}function yF(e){return isNaN(e)||e===1/0||e===-1/0}function vF(e){return 0===e?0:e}function gF(e){return["*","?"].includes(e)}var bF,wF=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function _F(e){return wF.includes(e)}function SF(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);if("~"===o){if(r==e.length-1){n+="~";continue}var i=e.charAt(r+1);gF(i)||_F(i)?(n+="\\"+i,r++):(n+=i,r++)}else gF(o)?n+="."+o:_F(o)?n+="\\"+o:n+=t?o:o.toLowerCase()}return n}function EF(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);gF(o)||_F(o)?n+="\\"+o:n+=t?o:o.toLowerCase()}return n}function kF(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);gF(o)||_F(o)?n+=o:n+=t?o:o.toLowerCase()}return n}function RF(e,t){var n=eF(e),r=n.type,o=n.format,i=eF(t),a=i.type,s=i.format;if(r===Kj.NUMBER_RAW)return{type:a,format:s};if(a===Kj.NUMBER_RAW)return{type:r,format:o};if(!(r!==Kj.NUMBER_DATETIME&&r!==Kj.NUMBER_DATE||a!==Kj.NUMBER_DATETIME&&a!==Kj.NUMBER_DATE))return{type:Kj.NUMBER_RAW};if(r===Kj.NUMBER_TIME){if(a===Kj.NUMBER_DATE)return{type:Kj.NUMBER_DATETIME,format:s+" "+o};if(a===Kj.NUMBER_DATETIME)return{type:Kj.NUMBER_DATETIME,format:s}}if(a===Kj.NUMBER_TIME){if(r===Kj.NUMBER_DATE)return{type:Kj.NUMBER_DATETIME,format:o+" "+s};if(r===Kj.NUMBER_DATETIME)return{type:Kj.NUMBER_DATETIME,format:o}}return{type:r,format:o}}function TF(e,t){var n=eF(e),r=n.type,o=n.format,i=eF(t),a=i.type,s=i.format;return r===Kj.NUMBER_PERCENT&&(r=Kj.NUMBER_RAW,o=void 0),a===Kj.NUMBER_PERCENT&&(a=Kj.NUMBER_RAW,s=void 0),r===Kj.NUMBER_RAW?{type:a,format:s}:a===Kj.NUMBER_RAW?{type:r,format:o}:{type:Kj.NUMBER_RAW}}function CF(e){return OF(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function MF(e,t){var n;if(e.isAdHoc())return null===(n=e.data[0])||void 0===n?void 0:n[0];var r=e.range;if(t.formulaAddress.sheet===r.sheet)if(1===r.width()){var o=t.formulaAddress.row-r.start.row;if(o>=0&&o<r.height())return e.data[o][0]}else if(1===r.height()){var i=t.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return e.data[0][i]}}function OF(e,t){return"function"==typeof e.normalize?e.normalize(t.toUpperCase()):Nj()[t](e)}function AF(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=NF(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function LF(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||NF(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xF(e){return function(e){if(Array.isArray(e))return IF(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||NF(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NF(e,t){if(e){if("string"==typeof e)return IF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IF(e,t):void 0}}function IF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function DF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(bF||(bF={}));var PF=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coerceScalarToNumberOrError=function(e){return n.arithmeticHelper.coerceScalarToNumberOrError(e)},this.runFunction=function(e,t,r,o){var i,a,s,u,l,c,f=r.parameters;if(c=r.expandRanges?n.listOfScalarValues(e,t):e.map((function(e){return[n.evaluateAst(e,t),!1]})),void 0===r.repeatLastArgs&&f.length<c.length)return new ZU(BU.NA,IH.WrongArgNumber);if(void 0!==r.repeatLastArgs&&f.length<c.length&&(c.length-f.length)%r.repeatLastArgs!=0)return new ZU(BU.NA,IH.WrongArgNumber);for(f=xF(f);f.length<c.length;){var h;(h=f).push.apply(h,xF(f.slice(f.length-r.repeatLastArgs)))}var d=1,p=1;if(!r.vectorizationForbidden&&t.arraysFlag)for(var m=0;m<c.length;m++){var y=LF(c[m],1)[0];y instanceof XF&&f[m].argumentType!==bF.RANGE&&f[m].argumentType!==bF.ANY&&(p=Math.max(p,y.height()),d=Math.max(d,y.width()))}for(var v=c.length;v<f.length;v++)if(void 0===(null===(i=f[v])||void 0===i?void 0:i.defaultValue)&&!(null===(a=f[v])||void 0===a?void 0:a.optionalArg))return new ZU(BU.NA,IH.WrongArgNumber);for(var g=[],b=0;b<p;b++){for(var w=[],_=0;_<d;_++){for(var S=void 0,E=[],k=0;k<f.length;k++){var R=LF(null!==(s=c[k])&&void 0!==s?s:[void 0,void 0],2),T=R[0],C=R[1];T instanceof XF&&f[k].argumentType!==bF.RANGE&&f[k].argumentType!==bF.ANY&&!r.vectorizationForbidden&&t.arraysFlag&&(T=null===(u=T.data[1!==T.height()?b:0])||void 0===u?void 0:u[1!==T.width()?_:0]);var M=null!=T?T:null===(l=f[k])||void 0===l?void 0:l.defaultValue;if(void 0===M)E.push(void 0);else{var O=void 0!==T?n.coerceToType(M,f[k],t):M;void 0!==O?(O instanceof ZU&&f[k].argumentType!==bF.SCALAR&&(S=null!=S?S:O),E.push(O)):C||(S=null!=S?S:new ZU(BU.VALUE,IH.WrongType))}}var A=null!=S?S:n.returnNumberWrapper(o.apply(void 0,E),r.returnNumberType);if(1===p&&1===d)return A;if(A instanceof XF)throw"Function returning array cannot be vectorized.";w.push(A)}g.push(w)}return XF.onlyValues(g)},this.runFunctionWithReferenceArgument=function(e,t,r,o,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return new ZU(BU.NA,IH.CellRefExpected)};if(0===e.length)return n.returnNumberWrapper(o(),r.returnNumberType);if(e.length>1)return new ZU(BU.NA,IH.WrongArgNumber);for(var s,u=e[0];u.type===vH.PARENTHESIS;)u=u.expression;if(u.type===vH.CELL_REFERENCE)s=u.reference.toSimpleCellAddress(t.formulaAddress);else if(u.type===vH.CELL_RANGE||u.type===vH.COLUMN_RANGE||u.type===vH.ROW_RANGE)try{s=Cj.fromAst(u,t.formulaAddress).start}catch(e){return new ZU(BU.REF,IH.CellRefExpected)}return void 0!==s?n.returnNumberWrapper(i(s),r.returnNumberType):n.runFunction(e,t,r,a)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization,this.arraySizePredictor=t.arraySizePredictor,this.dateTimeHelper=t.dateTimeHelper,this.arithmeticHelper=t.arithmeticHelper}var t,n;return t=e,n=[{key:"evaluateAst",value:function(e,t){return this.interpreter.evaluateAst(e,t)}},{key:"arraySizeForAst",value:function(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}},{key:"listOfScalarValues",value:function(e,t){var n,r=[],o=AF(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=this.evaluateAst(i,t);if(a instanceof XF){var s,u=AF(a.valuesFromTopLeftCorner());try{for(u.s();!(s=u.n()).done;){var l=s.value;r.push([l,!0])}}catch(e){u.e(e)}finally{u.f()}}else r.push([a,!1])}}catch(e){o.e(e)}finally{o.f()}return r}},{key:"coerceToType",value:function(e,t,n){var r;if(e instanceof XF)switch(t.argumentType){case bF.RANGE:case bF.ANY:r=e;break;default:var o=MF(e,n);if(void 0===o)return;e=o}if(!(e instanceof XF))switch(t.argumentType){case bF.INTEGER:case bF.NUMBER:var i=this.coerceScalarToNumberOrError(e);if(!Zj(i)){r=i;break}var a=Wj(i);if(void 0!==t.maxValue&&a>t.maxValue)return new ZU(BU.NUM,IH.ValueLarge);if(void 0!==t.minValue&&a<t.minValue)return new ZU(BU.NUM,IH.ValueSmall);if(void 0!==t.lessThan&&a>=t.lessThan)return new ZU(BU.NUM,IH.ValueLarge);if(void 0!==t.greaterThan&&a<=t.greaterThan)return new ZU(BU.NUM,IH.ValueSmall);if(t.argumentType===bF.INTEGER&&!Number.isInteger(a))return new ZU(BU.NUM,IH.IntegerExpected);r=i;break;case bF.STRING:r=dF(e);break;case bF.BOOLEAN:r=hF(e);break;case bF.SCALAR:case bF.NOERROR:case bF.ANY:r=e;break;case bF.RANGE:if(e instanceof ZU)return e;r=lF(e);break;case bF.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(Wj(e))}return t.passSubtype||void 0===r?r:Wj(r)}},{key:"metadata",value:function(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error("No metadata for function ".concat(e,"."))}},{key:"returnNumberWrapper",value:function(e,t,n){return void 0!==t&&Zj(e)?this.arithmeticHelper.ExtendedNumberFactory(Wj(e),{type:t,format:n}):e}}],n&&DF(t.prototype,n),e}();function HF(e){return function(e){if(Array.isArray(e))return FF(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||jF(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jF(e,t){if(e){if("string"==typeof e)return FF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FF(e,t):void 0}}function FF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function YF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BF(e,t,n){return t&&UF(e.prototype,t),n&&UF(e,n),e}var VF=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(YF(this,e),this.width=t,this.height=n,this.isRef=r,t<=0||n<=0)throw Error("Incorrect array size")}return BF(e,[{key:"isScalar",value:function(){return this.width<=1&&this.height<=1||this.isRef}}],[{key:"fromArray",value:function(t){return new e(t.length>0?t[0].length:0,t.length)}},{key:"error",value:function(){return new e(1,1,!0)}},{key:"scalar",value:function(){return new e(1,1,!1)}}]),e}(),WF=function(){function e(t,n){YF(this,e),this.config=t,this.functionRegistry=n}return BF(e,[{key:"checkArraySize",value:function(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}},{key:"checkArraySizeForFunction",value:function(e,t){var n=this,r=this.functionRegistry.getMetadata(e.procedureName),o=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==o)return o(e,t);var i=e.args.map((function(e){var o;return n.checkArraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))}));if(void 0===r||r.expandRanges||!t.arraysFlag||r.vectorizationForbidden||void 0===r.parameters)return new VF(1,1);var a=HF(r.parameters);if(void 0===r.repeatLastArgs&&a.length<i.length)return VF.error();if(void 0!==r.repeatLastArgs&&a.length<i.length&&(i.length-a.length)%r.repeatLastArgs!=0)return VF.error();for(;a.length<i.length;)a.push.apply(a,HF(a.slice(a.length-r.repeatLastArgs)));for(var s=1,u=1,l=0;l<i.length;l++)a[l].argumentType!==bF.RANGE&&a[l].argumentType!==bF.ANY&&(u=Math.max(u,i[l].height),s=Math.max(s,i[l].width));return new VF(s,u)}},{key:"checkArraySizeForAst",value:function(e,t){var n,r,o,i=this;switch(e.type){case vH.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case vH.CELL_RANGE:var a=Cj.fromCellRangeOrUndef(e,t.formulaAddress);return void 0===a?VF.error():new VF(a.width(),a.height(),!0);case vH.ARRAY:var s,u=[],l=[],c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=jF(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.args);try{for(c.s();!(s=c.n()).done;){var f=s.value.map((function(e){return i.checkArraySizeForAst(e,t)})),h=Math.min.apply(Math,HF(f.map((function(e){return e.height})))),d=f.reduce((function(e,t){return e+t.width}),0);u.push(h),l.push(d)}}catch(e){c.e(e)}finally{c.f()}var p=u.reduce((function(e,t){return e+t}),0),m=Math.min.apply(Math,l);return new VF(m,p);case vH.STRING:case vH.NUMBER:return VF.scalar();case vH.CELL_REFERENCE:return new VF(1,1,!0);case vH.DIV_OP:case vH.CONCATENATE_OP:case vH.EQUALS_OP:case vH.GREATER_THAN_OP:case vH.GREATER_THAN_OR_EQUAL_OP:case vH.LESS_THAN_OP:case vH.LESS_THAN_OR_EQUAL_OP:case vH.MINUS_OP:case vH.NOT_EQUAL_OP:case vH.PLUS_OP:case vH.POWER_OP:case vH.TIMES_OP:var y=this.checkArraySizeForAst(e.left,t),v=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(y.height>1||y.width>1||v.height>1||v.width>1)?VF.error():(r=y,o=v,new VF(Math.max(r.width,o.width),Math.max(r.height,o.height)));case vH.MINUS_UNARY_OP:case vH.PLUS_UNARY_OP:case vH.PERCENT_OP:var g=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(g.height>1||g.width>1)?VF.error():new VF((n=g).width,n.height);case vH.EMPTY:default:return VF.error()}}}]),e}();function zF(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return GF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?GF(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function GF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function KF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var XF=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data=t,this.range=n,this.dependencyGraph=r,this._hasOnlyNumbers=o,this.size=void 0===t?new VF(n.width(),n.height()):new VF(t[0].length,t.length)}var t,n,r;return t=e,n=[{key:"isAdHoc",value:function(){return void 0===this.range}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"data",get:function(){return this.ensureThatComputed(),this._data}},{key:"ensureThatComputed",value:function(){var t=this;void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,(function(n){var r=t.dependencyGraph.getCellValue(n);return r instanceof e?(t._hasOnlyNumbers=!1,new ZU(BU.VALUE,IH.ScalarExpected)):(Zj(r)||(t._hasOnlyNumbers=!1),r)})))}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],t=0;t<this._data.length;t++)for(var n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}},{key:"effectiveAddressesFromData",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.data.length)){e.next=13;break}r=this.data[n],o=0;case 4:if(!(o<r.length)){e.next=10;break}return e.next=7,oB(t.sheet,t.col+o,t.row+n);case 7:++o,e.next=4;break;case 10:++n,e.next=1;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.ensureThatComputed(),n=0;case 2:if(!(n<this.size.height)){e.next=13;break}r=0;case 4:if(!(r<this.size.width)){e.next=10;break}return e.next=7,[this._data[n][r],oB(t.sheet,t.col+r,t.row+n)];case 7:++r,e.next=4;break;case 10:++n,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.valuesFromTopLeftCorner(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"numberOfElements",value:function(){return this.size.width*this.size.height}},{key:"hasOnlyNumbers",value:function(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;var e,t=zF(this.data);try{for(t.s();!(e=t.n()).done;){var n,r=zF(e.value);try{for(r.s();!(n=r.n()).done;)if("number"!=typeof n.value)return this._hasOnlyNumbers=!1,!1}catch(e){r.e(e)}finally{r.f()}}}catch(e){t.e(e)}finally{t.f()}}return this._hasOnlyNumbers}},{key:"rawNumbers",value:function(){return this._data}},{key:"rawData",value:function(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}}],r=[{key:"fromRange",value:function(t,n,r){return new e(t,n,r,!0)}},{key:"onlyNumbers",value:function(t){return new e(t,void 0,void 0,!0)}},{key:"onlyValues",value:function(t){return new e(t,void 0,void 0,void 0)}},{key:"onlyRange",value:function(t,n){return new e(void 0,t,n,void 0)}},{key:"fromScalar",value:function(t){return new e([[t]],void 0,void 0,void 0)}}],n&&KF(t.prototype,n),r&&KF(t,r),e}();function $F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return qF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qF(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function qF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var QF,ZF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changes=new Map}var t,n,r;return t=e,n=[{key:"addAll",value:function(e){var t,n=$F(e.changes.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r.address,r)}}catch(e){n.e(e)}finally{n.f()}return this}},{key:"addChange",value:function(e,t,n){this.addInterpreterValue(e,t,n)}},{key:"exportChanges",value:function(e){var t=[];return this.changes.forEach((function(n){var r=e.exportChange(n);Array.isArray(r)?t=t.concat(r):t.push(r)})),t}},{key:"getChanges",value:function(){return Array.from(this.changes.values())}},{key:"isEmpty",value:function(){return 0===this.changes.size}},{key:"add",value:function(e,t){var n=t.value;if(n instanceof XF){var r,o=$F(n.effectiveAddressesFromData(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;this.changes.delete("".concat(i.sheet,",").concat(i.col,",").concat(i.row))}}catch(e){o.e(e)}finally{o.f()}}this.changes.set(sB(e),t)}},{key:"addInterpreterValue",value:function(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}],r=[{key:"empty",value:function(){return new e}}],n&&JF(t.prototype,n),r&&JF(t,r),e}();function eY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",e.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",e.TOP_SORT="TOP_SORT",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(QF||(QF={}));var tY=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=new Map([[QF.CRITERION_FUNCTION_FULL_CACHE_USED,0],[QF.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}var t,n;return t=e,(n=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e,t=(null!==(e=this.stats.get(QF.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(QF.CRITERION_FUNCTION_FULL_CACHE_USED,t)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e,t=(null!==(e=this.stats.get(QF.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(QF.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(QF.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(QF.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var t,n=Date.now(),r=this.startTimes.get(e);if(!r)throw Error("Statistics ".concat(e," not started"));var o=null!==(t=this.stats.get(e))&&void 0!==t?t:0;o+=n-r,this.stats.set(e,o),this.startTimes.delete(e)}},{key:"measure",value:function(e,t){this.start(e);var n=t();return this.end(e),n}},{key:"snapshot",value:function(){return new Map(this.stats)}}])&&eY(t.prototype,n),e}();function nY(e){return nY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nY(e)}function rY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iY(e,t){return iY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},iY(e,t)}function aY(e,t){if(t&&("object"===nY(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sY(e){return sY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sY(e)}var uY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iY(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sY(r);if(o){var n=sY(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return aY(this,e)});function a(){return rY(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(e){}},{key:"end",value:function(e){}}])&&oY(t.prototype,n),a}(tY);function lY(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=cY(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function cY(e,t){if(e){if("string"==typeof e)return fY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fY(e,t):void 0}}function fY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dY=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.policy=t,this.mapping=new Map}var t,n;return t=e,n=[{key:"getCell",value:function(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new ID(e.sheet);return t.getCell(e)}},{key:"fetchCell",value:function(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new ID(e.sheet);var n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}},{key:"strategyFor",value:function(e){var t=this.mapping.get(e);if(void 0===t)throw new ID(e);return t}},{key:"addSheet",value:function(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}},{key:"autoAddSheet",value:function(e,t,n){var r=n.height,o=n.width,i=n.fill,a=this.policy.call(i);this.addSheet(e,new a(o,r))}},{key:"getCellValue",value:function(e){var t=this.getCell(e);return void 0===t?Vj:t instanceof YY?t.getArrayCellValue(e):t.getCellValue()}},{key:"getRawValue",value:function(e){var t=this.getCell(e);return t instanceof LU?t.getValues().rawValue:t instanceof YY?t.getArrayCellRawValue(e):null}},{key:"setCell",value:function(e,t){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}},{key:"moveCell",value:function(e,t){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");var r=n.getCell(e);if(void 0===r)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,r),this.removeCell(e)}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}},{key:"has",value:function(e){var t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}},{key:"getHeight",value:function(e){var t=this.mapping.get(e);if(void 0===t)throw new ID(e);return t.getHeight()}},{key:"getWidth",value:function(e){var t=this.mapping.get(e);if(!t)throw new ID(e);return t.getWidth()}},{key:"addRows",value:function(e,t,n){var r=this.mapping.get(e);if(void 0===r)throw new ID(e);r.addRows(t,n)}},{key:"removeRows",value:function(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new ID(e.sheet);t.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,t,n){var r=this.mapping.get(e);if(void 0===r)throw new ID(e);r.addColumns(t,n)}},{key:"removeColumns",value:function(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new ID(e.sheet);t.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entries",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=lY(this.mapping.entries()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=8;break}return a=n.value,s=2,r=function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(a,s)||cY(a,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=r[0],i=r[1],e.delegateYield(i.getEntries(o),"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}var a,s}),e,this,[[1,10,13,16]])}))},{key:"sheetEntries",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.mapping.get(t))){e.next=5;break}return e.delegateYield(n.getEntries(t),"t0",3);case 3:e.next=6;break;case 5:throw new ID(t);case 6:case"end":return e.stop()}}),e,this)}))}],n&&hY(t.prototype,n),e}();function pY(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||yY(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mY(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=yY(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function yY(e,t){if(e){if("string"==typeof e)return vY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vY(e,t):void 0}}function vY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bY=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arrayMapping=new Map}var t,n;return t=e,n=[{key:"getArray",value:function(e){var t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}},{key:"getArrayByCorner",value:function(e){return this.arrayMapping.get(sB(e))}},{key:"setArray",value:function(e,t){this.arrayMapping.set(sB(e.start),t)}},{key:"removeArray",value:function(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete(sB(e.start))}},{key:"count",value:function(){return this.arrayMapping.size}},{key:"arraysInRows",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=mY(this.arrayMapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=pY(r.value,2),i=o[0],!(a=o[1]).spansThroughSheetRows(t.sheet,t.rowStart,t.rowEnd)){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"arraysInCols",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=mY(this.arrayMapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=pY(r.value,2),i=o[0],!(a=o[1]).spansThroughSheetColumn(t.sheet,t.columnStart,t.columnEnd)){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"isFormulaArrayInRow",value:function(e,t){var n,r=mY(this.arrayMapping.values());try{for(r.s();!(n=r.n()).done;)if(n.value.spansThroughSheetRows(e,t))return!0}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaArrayInAllRows",value:function(e){var t,n=!0,r=mY(e.rows());try{for(r.s();!(t=r.n()).done;){var o=t.value;this.isFormulaArrayInRow(e.sheet,o)||(n=!1)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"isFormulaArrayInColumn",value:function(e,t){var n,r=mY(this.arrayMapping.values());try{for(r.s();!(n=r.n()).done;)if(n.value.spansThroughSheetColumn(e,t))return!0}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaArrayInAllColumns",value:function(e){var t,n=!0,r=mY(e.columns());try{for(r.s();!(t=r.n()).done;){var o=t.value;this.isFormulaArrayInColumn(e.sheet,o)||(n=!1)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"isFormulaArrayInRange",value:function(e){var t,n=mY(this.arrayMapping.values());try{for(n.s();!(t=n.n()).done;)if(t.value.getRange().doesOverlap(e))return!0}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaArrayAtAddress",value:function(e){var t,n=mY(this.arrayMapping.values());try{for(n.s();!(t=n.n()).done;)if(t.value.getRange().addressInRange(e))return!0}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"moveArrayVerticesAfterRowByRows",value:function(e,t,n){this.updateArrayVerticesInSheet(e,(function(e,r){var o=r.getRange();return t<=o.start.row?[o.shifted(0,n),r]:void 0}))}},{key:"moveArrayVerticesAfterColumnByColumns",value:function(e,t,n){this.updateArrayVerticesInSheet(e,(function(e,r){var o=r.getRange();return t<=o.start.col?[o.shifted(n,0),r]:void 0}))}},{key:"updateArrayVerticesInSheet",value:function(e,t){var n,r=this,o=Array(),i=mY(this.arrayMapping.entries());try{for(i.s();!(n=i.n()).done;){var a=pY(n.value,2),s=a[0],u=a[1];if(u.sheet===e){var l=t(s,u);void 0!==l&&(this.removeArray(s),o.push(l))}}}catch(e){i.e(e)}finally{i.f()}o.forEach((function(e){var t=pY(e,2),n=t[0],o=t[1];r.setArray(n,o)}))}}],n&&gY(t.prototype,n),e}();function wY(e){return function(e){if(Array.isArray(e))return SY(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_Y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _Y(e,t){if(e){if("string"==typeof e)return SY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SY(e,t):void 0}}function SY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function EY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RY(e,t,n){return t&&kY(e.prototype,t),n&&kY(e,n),e}var TY=function(){function e(t){EY(this,e),this.size=t}return RY(e,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,t){throw Error("Array not computed yet.")}},{key:"simpleRangeValue",value:function(){throw Error("Array not computed yet.")}}]),e}(),CY=function(){function e(t){EY(this,e),this.size=new VF(t.length>0?t[0].length:0,t.length),this.array=t}return RY(e,[{key:"simpleRangeValue",value:function(){return XF.onlyValues(this.array)}},{key:"addRows",value:function(e,t){var n;(n=this.array).splice.apply(n,[e,0].concat(wY(this.nullArrays(t,this.width())))),this.size.height+=t}},{key:"addColumns",value:function(e,t){for(var n=0;n<this.height();n++){var r;(r=this.array[n]).splice.apply(r,[e,0].concat(wY(new Array(t).fill(Vj))))}this.size.width+=t}},{key:"removeRows",value:function(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");var n=t-e+1;this.array.splice(e,n),this.size.height-=n}},{key:"removeColumns",value:function(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");var n,r=t-e+1,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_Y(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.array);try{for(o.s();!(n=o.n()).done;)n.value.splice(e,r)}catch(e){o.e(e)}finally{o.f()}this.size.width-=r}},{key:"nullArrays",value:function(e,t){for(var n=[],r=0;r<e;++r)n.push(new Array(t).fill(Vj));return n}},{key:"get",value:function(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}},{key:"set",value:function(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.array}},{key:"resize",value:function(e){if(this.height()<e.height&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw"Resizing to smaller array";if(this.width()<e.width&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw"Resizing to smaller array"}},{key:"outOfBound",value:function(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}],[{key:"fromInterpreterValue",value:function(t){return new e(t instanceof XF?t.data:[[t]])}}]),e}(),MY=function(){function e(t,n){EY(this,e),this.error=t,this.size=n}return RY(e,[{key:"get",value:function(e,t){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"simpleRangeValue",value:function(){return this.error}}]),e}();function OY(e){return OY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OY(e)}function AY(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LY(e,t)}function LY(e,t){return LY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},LY(e,t)}function xY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IY(e);if(t){var o=IY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NY(this,n)}}function NY(e,t){if(t&&("object"===OY(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function IY(e){return IY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},IY(e)}function DY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jY(e,t,n){return t&&HY(e.prototype,t),n&&HY(e,n),e}var FY=function(){function e(t,n,r){PY(this,e),this.formula=t,this.cellAddress=n,this.version=r}return jY(e,[{key:"width",get:function(){return 1}},{key:"height",get:function(){return 1}},{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var t=(i=e.applyTransformations(this.formula,this.cellAddress,this.version),a=3,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(i,a)||function(e,t){if(e){if("string"==typeof e)return DY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DY(e,t):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],r=t[1],o=t[2];this.formula=n,this.cellAddress=r,this.version=o}var i,a}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}}],[{key:"fromAst",value:function(e,t,n,r){return n.isScalar()?new UY(e,t,r):new YY(e,t,n,r)}}]),e}(),YY=function(e){AY(n,e);var t=xY(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return PY(this,n),i=t.call(this,e,r,a),o.isRef?i.array=new MY(new ZU(BU.REF,IH.NoSpaceForArrayResult),VF.error()):i.array=new TY(o),i}return jY(n,[{key:"width",get:function(){return this.array.width()}},{key:"height",get:function(){return this.array.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}},{key:"leftCorner",get:function(){return this.cellAddress}},{key:"setCellValue",value:function(e){if(e instanceof ZU)return this.setErrorValue(e),e;var t=CY.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}},{key:"getCellValue",value:function(){if(this.array instanceof TY)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}},{key:"valueOrUndef",value:function(){if(!(this.array instanceof TY))return this.array.simpleRangeValue()}},{key:"getArrayCellValue",value:function(e){var t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch(e){return new ZU(BU.REF)}}},{key:"getArrayCellRawValue",value:function(e){var t=this.getArrayCellValue(e);return t instanceof ZU||t===Vj?void 0:Wj(t)}},{key:"setArrayCellValue",value:function(e,t){var n=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;this.array instanceof CY&&this.array.set(n,r,t)}},{key:"setNoSpace",value:function(){return this.array=new MY(new ZU(BU.SPILL,IH.NoSpaceForArrayResult),VF.error()),this.getCellValue()}},{key:"getRange",value:function(){return Cj.spanFrom(this.cellAddress,this.width,this.height)}},{key:"setAddress",value:function(e){this.cellAddress=e}},{key:"setFormula",value:function(e){this.formula=e}},{key:"spansThroughSheetRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}},{key:"isComputed",value:function(){return!(this.array instanceof TY)}},{key:"columnsFromArray",value:function(){return pj.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromArray",value:function(){return dj.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"ensureRecentData",value:function(e){}},{key:"isLeftCorner",value:function(e){return cB(this.cellAddress,e)}},{key:"setErrorValue",value:function(e){this.array=new MY(e,this.array.size)}}]),n}(FY),UY=function(e){AY(n,e);var t=xY(n);function n(e,r,o){return PY(this,n),t.call(this,e,r,o)}return jY(n,[{key:"valueOrUndef",value:function(){return this.cachedCellValue}},{key:"setCellValue",value:function(e){return this.cachedCellValue=e,this.cachedCellValue}},{key:"getCellValue",value:function(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"isComputed",value:function(){return void 0!==this.cachedCellValue}}]),n}(FY);function BY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var VY,WY=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}var t,n;return t=e,n=[{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}},{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)}},{key:"setFunctionValue",value:function(e,t){this.functionCache.set(e,t)}},{key:"getCriterionFunctionValue",value:function(e,t){var n;return null===(n=this.getCriterionFunctionValues(e).get(t))||void 0===n?void 0:n[0]}},{key:"getCriterionFunctionValues",value:function(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}},{key:"setCriterionFunctionValues",value:function(e,t){this.criterionFunctionCache.set(e,t)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((function(e){return e.criterionFunctionCache.clear()})),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}],n&&BY(t.prototype,n),e}(),zY=function(e,t,n,r,o){if(t instanceof WY){var i=t.range.intersectionWith(n);return void 0!==i?Array.from(i.addresses(o)):[]}var a,s;return t instanceof FY?(a=t.getFormula(r),s=t.getAddress(r),tj(a,e).filter((function(e){return e instanceof ij})).map((function(e){return e.dependency.toSimpleCellAddress(s)})).filter((function(e){return n.addressInRange(e)}))):[]};function GY(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return KY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KY(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function KY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function XY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(VY||(VY={}));var $Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}var t,n;return t=e,n=[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,t){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(t))throw new Error("Unknown node ".concat(t));this.edges.get(e).add(t)}},{key:"removeEdge",value:function(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}},{key:"softRemoveEdge",value:function(e,t){var n;null===(n=this.edges.get(e))||void 0===n||n.delete(t)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach((function(t){t.delete(e)}))}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach((function(t){return e+=t.size})),e}},{key:"removeNode",value:function(e){var t,n=GY(this.adjacentNodes(e).values());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.markNodeAsSpecialRecentlyChanged(r)}}catch(e){n.e(e)}finally{n.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,t){var n,r;return null!==(r=null===(n=this.edges.get(e))||void 0===n?void 0:n.has(t))&&void 0!==r&&r}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(function(){return!0}),(function(){}))}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,t,n){var r=this,o=new Map,i=new Map,a=new Map,s=new Set,u=new Map,l=[],c=0,f=new Set;e.reverse(),e.forEach((function(e){if(void 0===u.get(e)){var t=[e],n=[];u.set(e,VY.ON_STACK);for(var h=function(){var e=t[t.length-1];switch(u.get(e)){case VY.ON_STACK:o.set(e,c),i.set(e,c),n.push(e),c++,r.adjacentNodes(e).forEach((function(n){void 0===o.get(n)&&(t.push(n),a.set(n,e),u.set(n,VY.ON_STACK))})),u.set(e,VY.PROCESSED);break;case VY.PROCESSED:var h;if(h=o.get(e),r.adjacentNodes(e).forEach((function(t){s.has(t)||(h=a.get(t)===e?Math.min(h,i.get(t)):Math.min(h,o.get(t)))})),i.set(e,h),h===o.get(e)){var d=[];do{d.push(n[n.length-1]),n.pop()}while(d[d.length-1]!==e);d.forEach((function(e){s.add(e)})),l.push.apply(l,d),d.length>1&&d.forEach((function(e){f.add(e)}))}t.pop(),u.set(e,VY.POPPED);break;case VY.POPPED:t.pop()}};t.length>0;)h()}}));var h=new Set(e),d=[],p=[];return l.reverse(),l.forEach((function(e){f.has(e)||r.adjacentNodes(e).has(e)?(p.push(e),n(e),r.adjacentNodes(e).forEach((function(e){return h.add(e)}))):(d.push(e),h.has(e)&&t(e)&&r.adjacentNodes(e).forEach((function(e){return h.add(e)})))})),{sorted:d,cycled:p}}},{key:"getDependencies",value:function(e){var t=[];return this.edges.forEach((function(n,r){n.has(e)&&t.push(r)})),t}},{key:"removeDependencies",value:function(e){var t,n=this.dependencyQuery(e),r=GY(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;this.softRemoveEdge(o,e)}}catch(e){r.e(e)}finally{r.f()}return n}}],n&&XY(t.prototype,n),e}();function qY(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||QY(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JY(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=QY(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function QY(e,t){if(e){if("string"==typeof e)return ZY(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ZY(e,t):void 0}}function ZY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function eU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rangeMapping=new Map}var t,n;return t=e,n=[{key:"getMappingSize",value:function(e){var t,n;return null!==(n=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==n?n:0}},{key:"setRange",value:function(e){var t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var n=nU(e.getStart(),e.getEnd());t.set(n,e)}},{key:"removeRange",value:function(e){var t=e.getStart().sheet,n=this.rangeMapping.get(t);if(void 0!==n){var r=nU(e.getStart(),e.getEnd());n.delete(r),0===n.size&&this.rangeMapping.delete(t)}}},{key:"getRange",value:function(e,t){var n=this.rangeMapping.get(e.sheet),r=nU(e,t);return null==n?void 0:n.get(r)}},{key:"fetchRange",value:function(e,t){var n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}},{key:"truncateRanges",value:function(e,t){var n,r=Array(),o=Array(),i=Array(),a=e.sheet,s=JY(this.entriesFromSheet(e.sheet));try{for(s.s();!(n=s.n()).done;){var u=qY(n.value,2),l=u[0],c=u[1],f=c.range;e.start<=t(c.range.end)&&(f.removeSpan(e),f.shouldBeRemoved()?(this.removeByKey(a,l),r.push(c)):o.push([l,c]),i.push(c))}}catch(e){s.e(e)}finally{s.f()}var h=[];o.sort((function(e,n){return oU(e[1],n[1],t)}));for(var d=0,p=o;d<p.length;d++){var m=qY(p[d],2),y=m[0],v=m[1],g=rU(v.range);if(g!==y){var b=this.getByKey(a,g);this.removeByKey(a,y),void 0!==b&&v!=b?h.push([b,v]):this.setRange(v)}}return{verticesToRemove:r,verticesToMerge:h,verticesWithChangedSize:i}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,t,n){return this.updateVerticesFromSheet(e,(function(e,r){return t<=r.start.row?(r.range.shiftByRows(n),{changedSize:!1,vertex:r}):t>r.start.row&&t<=r.end.row?(r.range.expandByRows(n),{changedSize:!0,vertex:r}):void 0}))}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,t,n){return this.updateVerticesFromSheet(e,(function(e,r){return t<=r.start.col?(r.range.shiftByColumns(n),{changedSize:!1,vertex:r}):t>r.start.col&&t<=r.end.col?(r.range.expandByColumns(n),{changedSize:!0,vertex:r}):void 0}))}},{key:"moveRangesInsideSourceRange",value:function(e,t,n,r){this.updateVerticesFromSheet(e.sheet,(function(o,i){return e.containsRange(i.range)?(i.range.shiftByColumns(t),i.range.shiftByRows(n),i.range.moveToSheet(r),{changedSize:!1,vertex:i}):void 0}))}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(n.values(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=JY(this.rangesInSheet(t.sheet)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=r.value,!t.containsRange(o.range)){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var t=oB(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(void 0!==n)return{smallerRangeVertex:n,restRange:new Cj(oB(e.start.sheet,e.start.col,e.end.row),e.end)}}return{restRange:e}}},{key:"entriesFromSheet",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(n.entries(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"removeByKey",value:function(e,t){this.rangeMapping.get(e).delete(t)}},{key:"getByKey",value:function(e,t){var n;return null===(n=this.rangeMapping.get(e))||void 0===n?void 0:n.get(t)}},{key:"updateVerticesFromSheet",value:function(e,t){var n,r=this,o=Array(),i=JY(this.entriesFromSheet(e));try{for(i.s();!(n=i.n()).done;){var a=qY(n.value,2),s=a[0],u=t(s,a[1]);void 0!==u&&(this.removeByKey(e,s),o.push(u))}}catch(e){i.e(e)}finally{i.f()}return o.forEach((function(e){r.setRange(e.vertex)})),{verticesWithChangedSize:o.filter((function(e){return e.changedSize})).map((function(e){return e.vertex}))}}}],n&&eU(t.prototype,n),e}();function nU(e,t){return"".concat(e.col,",").concat(e.row,",").concat(t.col,",").concat(t.row)}function rU(e){return nU(e.start,e.end)}var oU=function(e,t,n){var r=n(e.range.start),o=n(e.range.start);return r===o?n(e.range.end)-n(t.range.end):r-o};function iU(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return aU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aU(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function aU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var uU,lU=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions=t,this.errors=n,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}var t,n;return t=e,n=[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce((function(t,n){return t[e.functions[n]]=n,t}),{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce((function(t,n){return t[e.errors[n]]=n,t}),{})}},{key:"isFunctionTranslated",value:function(e){return void 0!==this.functions[e]}},{key:"getFunctionTranslations",value:function(e){var t,n=[],r=iU(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;this.isFunctionTranslated(o)&&n.push(this.functions[o])}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getFunctionTranslation",value:function(e){var t=this.functions[e];if(void 0===t)throw new rP("functions.".concat(e));return t}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===BU.LIC)return"#".concat(BU.LIC,"!");var t=this.errors[e];if(void 0===t)throw new rP("errors.".concat(e));return t}},{key:"getUITranslation",value:function(e){var t=this.ui[e];if(void 0===t)throw new rP("ui.".concat(e));return t}},{key:"checkUI",value:function(){for(var e=0,t=Object.values(uU);e<t.length;e++){var n=t[e];if(!(n in this.ui))throw new rP("ui.".concat(n))}}},{key:"checkErrors",value:function(){for(var e=0,t=Object.values(BU);e<t.length;e++){var n=t[e];if(!(n in this.errors)&&n!==BU.LIC)throw new rP("errors.".concat(n))}}},{key:"checkFunctionTranslations",value:function(e){var t,n=new Set(Object.getOwnPropertyNames(e)),r=iU(Object.getOwnPropertyNames(this._protectedTranslations));try{for(r.s();!(t=r.n()).done;){var o=t.value;if(n.has(o))throw new oP(o)}}catch(e){r.e(e)}finally{r.f()}}}],n&&sU(t.prototype,n),e}();function cU(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return fU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fU(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function fU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pU(e,t,n){return t&&dU(e.prototype,t),n&&dU(e,n),e}function mU(e){return e.toLowerCase()}!function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(uU||(uU={}));var yU=function(){function e(t,n){hU(this,e),this.id=t,this.displayName=n}return pU(e,[{key:"canonicalName",get:function(){return mU(this.displayName)}}]),e}(),vU=function(){function e(t){var n=this;hU(this,e),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(e){var t=n.mappingFromCanonicalName.get(mU(e));if(void 0===t)throw new DD(e);return t.id},this.get=function(e){var t;return null===(t=n.mappingFromCanonicalName.get(mU(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=function(e){return n.fetchSheetById(e).displayName},this.sheetNamePrefix=t.getUITranslation(uU.NEW_SHEET_PREFIX)}return pU(e,[{key:"addSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),t=mU(e);if(this.mappingFromCanonicalName.has(t))throw new PD(e);this.lastSheetId++;var n=new yU(this.lastSheetId,e);return this.store(n),n.id}},{key:"removeSheet",value:function(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}},{key:"getDisplayName",value:function(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}},{key:"displayNames",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=cU(this.mappingFromCanonicalName.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r.displayName;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(mU(e))}},{key:"renameSheet",value:function(e,t){var n=this.fetchSheetById(e),r=n.displayName;if(r!==t){var o=this.mappingFromCanonicalName.get(mU(t));if(void 0!==o&&o.id!==n.id)throw new PD(t);var i=n.canonicalName;return this.mappingFromCanonicalName.delete(i),n.displayName=t,this.store(n),r}}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map((function(e){return e.displayName}))}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new ID(e);return t}}]),e}();function gU(e,t,n){return gU=bU()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&wU(o,n.prototype),o},gU.apply(null,arguments)}function bU(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function wU(e,t){return wU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wU(e,t)}function _U(e){return function(e){if(Array.isArray(e))return RU(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kU(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SU(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=kU(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function EU(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||kU(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kU(e,t){if(e){if("string"==typeof e)return RU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?RU(e,t):void 0}}function RU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var CU=function(){function e(t,n,r,o,i,a,s,u){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addressMapping=t,this.rangeMapping=n,this.sheetMapping=r,this.arrayMapping=o,this.stats=i,this.lazilyTransformingAstService=a,this.functionRegistry=s,this.namedExpressions=u,this.changes=ZF.empty(),this.dependencyQueryAddresses=function(e){if(e instanceof WY)return l.rangeDependencyQuery(e).map((function(e){var t=EU(e,2),n=t[0];return t[1],n}));var t=l.formulaDependencyQuery(e);if(void 0!==t){var n=EU(t,2),r=n[0];return n[1].map((function(e){return e instanceof lj?l.namedExpressions.namedExpressionOrPlaceholder(e.name,r.sheet).address:uB(e)?e:Tj(e.start,e.end)}))}return[]},this.dependencyQueryVertices=function(e){if(e instanceof WY)return l.rangeDependencyQuery(e).map((function(e){var t=EU(e,2);return t[0],t[1]}));var t=l.formulaDependencyQuery(e);if(void 0!==t){var n=EU(t,2),r=n[0];return n[1].map((function(e){if(e instanceof Cj)return l.rangeMapping.fetchRange(e.start,e.end);if(e instanceof lj){var t=l.namedExpressions.namedExpressionOrPlaceholder(e.name,r.sheet);return l.addressMapping.fetchCell(t.address)}return l.addressMapping.fetchCell(e)}))}return[]},this.rangeDependencyQuery=function(e){var t,n=[],r=l.rangeMapping.findSmallerRange(e.range),o=r.smallerRangeVertex,i=r.restRange;void 0!==o&&l.graph.adjacentNodes(o).has(e)?(t=i,n.push([new Cj(o.start,o.end),o])):t=e.range;var a,s=SU(t.addresses(l));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=l.addressMapping.getCell(u);c instanceof OU&&(c.address=u),void 0!==c&&n.push([u,c])}}catch(e){s.e(e)}finally{s.f()}return n},this.formulaDependencyQuery=function(e){var t,n;if(e instanceof FY){n=e.getAddress(l.lazilyTransformingAstService),t=e.getFormula(l.lazilyTransformingAstService);var r=tj(t,l.functionRegistry);return[n,Aj(r,n)]}},this.graph=new $Y(this.dependencyQueryVertices)}var t,n,r;return t=e,n=[{key:"setFormulaToCell",value:function(e,t,n,r,o,i){var a=FY.fromAst(t,e,r,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(n,a),this.graph.markNodeAsSpecialRecentlyChanged(a),o&&this.markAsVolatile(a),i&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setParsingErrorToCell",value:function(e,t){var n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setValueToCell",value:function(e,t){var n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof YY&&this.arrayMapping.removeArray(n.getRange()),n instanceof LU)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsSpecialRecentlyChanged(n));else{var r=new LU(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setCellEmpty",value:function(e){var t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return ZF.empty();if(this.graph.adjacentNodes(t).size>0){var n=new OU(e);this.exchangeGraphNode(t,n),0===this.graph.adjacentNodesCount(n)?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}},{key:"ensureThatVertexIsNonArrayCellVertex",value:function(e){if(e instanceof YY)throw new Error("Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(_U(this.graph.specialNodesRecentlyChanged),_U(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,t){var n=this;e.forEach((function(e){if(e instanceof Cj){var r=e,o=n.getRange(r.start,r.end);void 0===o&&(o=new WY(r),n.rangeMapping.setRange(o)),n.graph.addNode(o),r.isFinite()||n.graph.markNodeAsInfiniteRange(o);var i=n.rangeMapping.findSmallerRange(r),a=i.smallerRangeVertex,s=i.restRange;if(void 0!==a){if(n.graph.addEdge(a,o),o.bruteForce){o.bruteForce=!1;var u,l=SU(r.addresses(n));try{for(l.s();!(u=l.n()).done;){var c=u.value;n.graph.removeEdge(n.fetchCell(c),o)}}catch(e){l.e(e)}finally{l.f()}}}else o.bruteForce=!0;var f=n.arrayMapping.getArray(s);if(void 0!==f)n.graph.addEdge(f,o);else{var h,d=SU(s.addresses(n));try{for(d.s();!(h=d.n()).done;){var p=h.value;n.graph.addEdge(n.fetchCellOrCreateEmpty(p),o)}}catch(e){d.e(e)}finally{d.f()}}n.graph.addEdge(o,t),r.isFinite()&&n.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(e instanceof lj){var m=t.getAddress(n.lazilyTransformingAstService).sheet,y=n.fetchNamedExpressionVertex(e.name,m);n.graph.addEdge(y,t)}else n.graph.addEdge(n.fetchCellOrCreateEmpty(e),t)}))}},{key:"fetchNamedExpressionVertex",value:function(e,t){var n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}},{key:"exchangeNode",value:function(e,t){var n=this.fetchCellOrCreateEmpty(e),r=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,r)}},{key:"correctInfiniteRangesDependency",value:function(e){var t,n=void 0,r=SU(this.graph.infiniteRanges);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.range.addressInRange(e)&&(n=null!=n?n:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(n,o))}}catch(e){r.e(e)}finally{r.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var t=this.addressMapping.getCell(e);return void 0===t&&(t=new OU(e),this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}},{key:"removeRows",value:function(e){var t=this;this.stats.measure(QF.ADJUSTING_GRAPH,(function(){var n,r=SU(t.addressMapping.entriesFromRowsSpan(e));try{for(r.s();!(n=r.n()).done;){var o,i=EU(n.value,2),a=i[0],s=i[1],u=SU(t.graph.adjacentNodes(s));try{for(u.s();!(o=u.n()).done;){var l=o.value;t.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){u.e(e)}finally{u.f()}if(s instanceof YY){if(!s.isLeftCorner(a))continue;t.shrinkArrayToCorner(s),t.arrayMapping.removeArray(s.getRange())}t.removeVertex(s)}}catch(e){r.e(e)}finally{r.f()}})),this.stats.measure(QF.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeRows(e)}));var n=this.stats.measure(QF.ADJUSTING_RANGES,(function(){var n=t.truncateRanges(e,(function(e){return e.row}));return t.getArrayVerticesRelatedToRanges(n)}));return this.stats.measure(QF.ADJUSTING_ARRAY_MAPPING,(function(){t.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"removeSheet",value:function(e){var t,n=this,r=new Set,o=SU(this.addressMapping.sheetEntries(e));try{for(o.s();!(t=o.n()).done;){var i=EU(t.value,2),a=i[0],s=i[1];if(s instanceof YY){if(r.has(s))continue;r.add(s)}var u,l=SU(this.graph.adjacentNodes(s));try{for(l.s();!(u=l.n()).done;){var c=u.value;this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(e){l.e(e)}finally{l.f()}this.removeVertex(s),this.addressMapping.removeCell(a)}}catch(e){o.e(e)}finally{o.f()}this.stats.measure(QF.ADJUSTING_ARRAY_MAPPING,(function(){var e,t=SU(r.values());try{for(t.s();!(e=t.n()).done;){var o=e.value;n.arrayMapping.removeArray(o.getRange())}}catch(e){t.e(e)}finally{t.f()}})),this.stats.measure(QF.ADJUSTING_RANGES,(function(){var t,r=SU(n.rangeMapping.removeRangesInSheet(e));try{for(r.s();!(t=r.n()).done;){var o=t.value;n.removeVertex(o)}}catch(e){r.e(e)}finally{r.f()}n.stats.measure(QF.ADJUSTING_ADDRESS_MAPPING,(function(){n.addressMapping.removeSheet(e)}))})),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var t,n=new Set,r=SU(this.addressMapping.sheetEntries(e));try{for(r.s();!(t=r.n()).done;){var o=EU(t.value,2),i=o[0],a=o[1];a instanceof YY?n.add(a):this.setCellEmpty(i)}}catch(e){r.e(e)}finally{r.f()}var s,u=SU(n.values());try{for(u.s();!(s=u.n()).done;){var l=s.value;this.setArrayEmpty(l)}}catch(e){u.e(e)}finally{u.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var t=this;this.stats.measure(QF.ADJUSTING_GRAPH,(function(){var n,r=SU(t.addressMapping.entriesFromColumnsSpan(e));try{for(r.s();!(n=r.n()).done;){var o,i=EU(n.value,2),a=i[0],s=i[1],u=SU(t.graph.adjacentNodes(s));try{for(u.s();!(o=u.n()).done;){var l=o.value;t.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){u.e(e)}finally{u.f()}if(s instanceof YY){if(!s.isLeftCorner(a))continue;t.shrinkArrayToCorner(s),t.arrayMapping.removeArray(s.getRange())}t.removeVertex(s)}}catch(e){r.e(e)}finally{r.f()}})),this.stats.measure(QF.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeColumns(e)}));var n=this.stats.measure(QF.ADJUSTING_RANGES,(function(){var n=t.truncateRanges(e,(function(e){return e.col}));return t.getArrayVerticesRelatedToRanges(n)}));return this.stats.measure(QF.ADJUSTING_ARRAY_MAPPING,(function(){return t.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"addRows",value:function(e){var t=this;this.stats.measure(QF.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)}));var n=this.stats.measure(QF.ADJUSTING_RANGES,(function(){var n=t.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return t.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),t.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)}));this.stats.measure(QF.ADJUSTING_ARRAY_MAPPING,(function(){t.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}));var r,o=SU(this.addressMapping.verticesFromRowsSpan(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;this.graph.markNodeAsSpecialRecentlyChanged(i)}}catch(e){o.e(e)}finally{o.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:n}}},{key:"addColumns",value:function(e){var t=this;this.stats.measure(QF.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)}));var n=this.stats.measure(QF.ADJUSTING_RANGES,(function(){var n=t.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return t.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),t.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)}));this.stats.measure(QF.ADJUSTING_ARRAY_MAPPING,(function(){return t.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)}));var r,o=SU(this.addressMapping.verticesFromColumnsSpan(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;this.graph.markNodeAsSpecialRecentlyChanged(i)}}catch(e){o.e(e)}finally{o.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:n,contentChanges:this.getAndClearContentChanges()}}},{key:"ensureNoArrayInRange",value:function(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}},{key:"isThereSpaceForArray",value:function(e){var t,n=SU(e.getRange().addresses(this));try{for(n.s();!(t=n.n()).done;){var r=t.value,o=this.addressMapping.getCell(r);if(void 0!==o&&!(o instanceof OU)&&o!==e)return!1}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"moveCells",value:function(e,t,n,r){var o,i=SU(e.addressesWithDirection(t,n,this));try{for(i.s();!(o=i.n()).done;){var a=o.value,s=oB(r,a.col+t,a.row+n),u=this.addressMapping.getCell(a),l=this.addressMapping.getCell(s);if(this.addressMapping.removeCell(a),void 0!==u){this.graph.markNodeAsSpecialRecentlyChanged(u),this.addressMapping.setCell(s,u);var c,f=void 0,h=SU(this.graph.adjacentNodes(u));try{for(h.s();!(c=h.n()).done;){var d=c.value;d instanceof WY&&!e.containsRange(d.range)&&(f=null!=f?f:this.fetchCellOrCreateEmpty(a),this.graph.addEdge(f,d),this.graph.removeEdge(u,d))}}catch(e){h.e(e)}finally{h.f()}f&&(this.graph.markNodeAsSpecialRecentlyChanged(f),this.addressMapping.setCell(a,f))}if(void 0!==l){void 0===u&&this.addressMapping.removeCell(s);var p,m=SU(this.graph.adjacentNodes(l));try{for(m.s();!(p=m.n()).done;){var y=p.value;u=null!=u?u:this.fetchCellOrCreateEmpty(s),this.graph.addEdge(u,y),this.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(e){m.e(e)}finally{m.f()}this.removeVertex(l)}}}catch(e){i.e(e)}finally{i.f()}var v,g=SU(this.rangeMapping.rangeVerticesContainedInRange(e));try{for(g.s();!(v=g.n()).done;){var b,w=v.value,_=SU(this.graph.adjacentNodes(w));try{for(_.s();!(b=_.n()).done;){var S=b.value;if(S instanceof WY&&!e.containsRange(S.range)){this.graph.removeEdge(w,S);var E,k=SU(w.range.addresses(this));try{for(k.s();!(E=k.n()).done;){var R=E.value,T=this.fetchCellOrCreateEmpty(R);this.graph.addEdge(T,S),this.addressMapping.setCell(R,T),this.graph.markNodeAsSpecialRecentlyChanged(T)}}catch(e){k.e(e)}finally{k.f()}}}}catch(e){_.e(e)}finally{_.f()}}}catch(e){g.e(e)}finally{g.f()}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,r)}},{key:"setArrayEmpty",value:function(e){var t,n=Cj.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e),o=SU(n.addresses(this));try{for(o.s();!(t=o.n()).done;){var i=t.value;this.addressMapping.removeCell(i)}}catch(e){o.e(e)}finally{o.f()}var a,s=SU(r.values());try{for(s.s();!(a=s.n()).done;){var u,l=a.value,c=zY(this.functionRegistry,l,e.getRange(),this.lazilyTransformingAstService,this),f=SU(c);try{for(f.s();!(u=f.n()).done;){var h=u.value,d=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(d,l)}}catch(e){f.e(e)}finally{f.f()}c.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){s.e(e)}finally{s.f()}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}},{key:"addVertex",value:function(e,t){this.graph.addNode(t),this.addressMapping.setCell(e,t)}},{key:"addArrayVertex",value:function(e,t){this.graph.addNode(t),this.setAddressMappingForArrayVertex(t,e)}},{key:"arrayFormulaNodes",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=SU(this.graph.nodes),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(!((r=n.value)instanceof YY)){e.next=8;break}return e.next=8,r;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getRawValue",value:function(e){return this.addressMapping.getRawValue(e)}},{key:"getScalarValue",value:function(e){var t=this.addressMapping.getCellValue(e);return t instanceof XF?new ZU(BU.VALUE,IH.ScalarExpected):t}},{key:"existsEdge",value:function(e,t){return this.graph.existsEdge(e,t)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getArray",value:function(e){return this.arrayMapping.getArray(e)}},{key:"setArray",value:function(e,t){this.arrayMapping.setArray(e,t)}},{key:"getRange",value:function(e,t){return this.rangeMapping.getRange(e,t)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e,t=SU(this.graph.nodes.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n instanceof UY&&n.ensureRecentData(this.lazilyTransformingAstService)}}catch(e){t.e(e)}finally{t.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"getArrayVerticesRelatedToRanges",value:function(e){var t=this,n=e.map((function(e){return t.graph.hasNode(e)?Array.from(t.graph.adjacentNodes(e)).filter((function(e){return e instanceof YY})):[]}));return gU(Set,_U(n))}},{key:"rawValuesFromRange",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=SU(t.addresses(this)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}if(o=r.value,(i=this.getScalarValue(o))===Vj){e.next=9;break}return e.next=9,[Wj(i),o];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"entriesFromRange",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=SU(t.addresses(this)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return o=r.value,e.next=7,[o,this.getCell(o)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"exchangeGraphNode",value:function(e,t){var n=this;this.graph.addNode(t);var r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach((function(e){n.graph.hasNode(e)&&n.graph.addEdge(t,e)}))}},{key:"exchangeOrAddGraphNode",value:function(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}},{key:"computeListOfValuesInRange",value:function(e){var t,n=[],r=SU(e.addresses(this));try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.getScalarValue(o);n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"shrinkArrayToCorner",value:function(e){this.cleanAddressMappingUnderArray(e);var t,n=SU(this.adjacentArrayVertices(e));try{for(n.s();!(t=n.n()).done;){var r,o=t.value;r=o instanceof FY?this.formulaDirectDependenciesToArray(o,e):this.rangeDirectDependenciesToArray(o,e);var i,a=!1,s=SU(r);try{for(s.s();!(i=s.n()).done;){var u=EU(i.value,2),l=u[0],c=u[1];e.isLeftCorner(l)&&(a=!0),this.graph.addEdge(c,o),this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(e){s.e(e)}finally{s.f()}a||this.graph.removeEdge(e,o)}}catch(e){n.e(e)}finally{n.f()}this.graph.markNodeAsSpecialRecentlyChanged(e)}},{key:"isArrayInternalCell",value:function(e){var t=this.getCell(e);return t instanceof YY&&!t.isLeftCorner(e)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=ZF.empty(),e}},{key:"getAdjacentNodesAddresses",value:function(e){var t=this,n=this.graph.adjacentNodes(e),r=[];return n.forEach((function(e){var n=e;n instanceof WY?r.push(Tj(n.start,n.end)):r.push(n.getAddress(t.lazilyTransformingAstService))})),r}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var t,n=SU(this.graph.infiniteRanges);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r,i=e.range.intersectionWith(o.range);if(void 0!==i){var a,s=SU(i.addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),r)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"cleanAddressMappingUnderArray",value:function(e){var t,n=SU(e.getRange().addresses(this));try{for(n.s();!(t=n.n()).done;){var r=t.value,o=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new ZU(BU.REF),r,o):(this.addressMapping.removeCell(r),this.changes.addChange(Vj,r,o)):this.changes.addChange(Vj,r,o)}}catch(e){n.e(e)}finally{n.f()}}},{key:"formulaDirectDependenciesToArray",value:regeneratorRuntime.mark((function e(t,n){var r,o,i,a,s,u,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!==(r=this.formulaDependencyQuery(t))&&void 0!==r?r:[],i=EU(o,2),void 0!==(a=i[1])){e.next=3;break}return e.abrupt("return");case 3:s=SU(a),e.prev=4,s.s();case 6:if((u=s.n()).done){e.next=16;break}if(!((l=u.value)instanceof lj||l instanceof Cj)){e.next=10;break}return e.abrupt("continue",14);case 10:if(!n.getRange().addressInRange(l)){e.next=14;break}return c=this.fetchCellOrCreateEmpty(l),e.next=14,[l,c];case 14:e.next=6;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),s.e(e.t0);case 21:return e.prev=21,s.f(),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[4,18,21,24]])}))},{key:"rangeDirectDependenciesToArray",value:regeneratorRuntime.mark((function e(t,n){var r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.rangeMapping.findSmallerRange(t.range),o=r.restRange,i=SU(o.addresses(this)),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=12;break}if(s=a.value,!n.getRange().addressInRange(s)){e.next=10;break}return u=this.fetchCellOrCreateEmpty(s),e.next=10,[s,u];case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])}))},{key:"adjacentArrayVertices",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.graph.adjacentNodes(t),r=SU(n),e.prev=2,r.s();case 4:if((o=r.n()).done){e.next=11;break}if(!((i=o.value)instanceof FY||i instanceof WY)){e.next=9;break}return e.next=9,i;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])}))},{key:"addStructuralNodesToChangeSet",value:function(){var e,t=SU(this.graph.specialNodesStructuralChanges);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.graph.markNodeAsSpecialRecentlyChanged(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,t,n){for(var r=0,o=Array.from(this.rangeMapping.rangesInSheet(e));r<o.length;r++){var i=o[r];if(i.range.includesRow(t+n))if(i.bruteForce){var a,s=SU(i.range.rangeWithSameWidth(t,n).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),i)}}catch(e){s.e(e)}finally{s.f()}}else{var l=i,c=this.rangeMapping.findSmallerRange(l.range);if(void 0!==c.smallerRangeVertex)continue;for(;void 0===c.smallerRangeVertex;){var f=new WY(Cj.spanFrom(l.range.start,l.range.width(),l.range.height()-1));this.rangeMapping.setRange(f),this.graph.addNode(f);var h=new Cj(oB(l.range.start.sheet,l.range.start.col,l.range.end.row),l.range.end);this.addAllFromRange(h,l),this.graph.addEdge(f,l),l=f,c=this.rangeMapping.findSmallerRange(l.range)}this.graph.addEdge(c.smallerRangeVertex,l),this.addAllFromRange(c.restRange,l),this.graph.removeEdge(c.smallerRangeVertex,i)}}}},{key:"addAllFromRange",value:function(e,t){var n,r=SU(e.addresses(this));try{for(r.s();!(n=r.n()).done;){var o=n.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(o),t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,t,n){var r,o=SU(this.rangeMapping.rangesInSheet(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.range.includesColumn(t+n)){var a,s=SU((i.bruteForce?i.range.rangeWithSameHeight(t,n):Cj.spanFrom(oB(e,t,i.range.end.row),n,1)).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),i)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){o.e(e)}finally{o.f()}}},{key:"exchangeOrAddFormulaVertex",value:function(e){var t=e.getAddress(this.lazilyTransformingAstService),n=Cj.spanFrom(t,e.width,e.height),r=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof YY&&this.setArray(n,e),this.exchangeOrAddGraphNode(r,e),this.addressMapping.setCell(t,e),e instanceof YY){if(!this.isThereSpaceForArray(e))return;var o,i=SU(n.addresses(this));try{for(i.s();!(o=i.n()).done;){var a=o.value;if(!e.isLeftCorner(a)){var s=this.getCell(a);this.exchangeOrAddGraphNode(s,e)}}}catch(e){i.e(e)}finally{i.f()}}var u,l=SU(n.addresses(this));try{for(l.s();!(u=l.n()).done;){var c=u.value;this.addressMapping.setCell(c,e)}}catch(e){l.e(e)}finally{l.f()}}},{key:"setAddressMappingForArrayVertex",value:function(e,t){if(this.addressMapping.setCell(t,e),e instanceof YY){var n=Cj.spanFrom(t,e.width,e.height);if(this.setArray(n,e),this.isThereSpaceForArray(e)){var r,o=SU(n.addresses(this));try{for(o.s();!(r=o.n()).done;){var i=r.value;this.addressMapping.setCell(i,e)}}catch(e){o.e(e)}finally{o.f()}}}}},{key:"truncateRanges",value:function(e,t){var n,r=this.rangeMapping.truncateRanges(e,t),o=r.verticesToRemove,i=r.verticesToMerge,a=r.verticesWithChangedSize,s=SU(i);try{for(s.s();!(n=s.n()).done;){var u=EU(n.value,2),l=u[0],c=u[1];this.mergeRangeVertices(l,c)}}catch(e){s.e(e)}finally{s.f()}var f,h=SU(o);try{for(h.s();!(f=h.n()).done;){var d=f.value;this.removeVertexAndCleanupDependencies(d)}}catch(e){h.e(e)}finally{h.f()}return a}},{key:"fixArraysAfterAddingRow",value:function(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0)){var r,o=SU(this.arrayMapping.arraysInRows(dj.fromRowStartAndEnd(e,t-1,t-1)));try{for(o.s();!(r=o.n()).done;)for(var i=EU(r.value,2)[1],a=i.getRange(),s=a.start.col;s<=a.end.col;++s)for(var u=t;u<=a.end.row;++u){var l=oB(e,s,u),c=oB(e,s,u+n),f=i.getArrayCellValue(l);this.addressMapping.moveCell(c,l),this.changes.addChange(Vj,c,f)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"fixArraysAfterRemovingRows",value:function(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0)){var r,o=SU(this.arrayMapping.arraysInRows(dj.fromRowStartAndEnd(e,t-1,t-1)));try{for(o.s();!(r=o.n()).done;){var i=EU(r.value,2)[1];if(this.isThereSpaceForArray(i)){var a,s=SU(i.getRange().addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.addressMapping.setCell(u,i)}}catch(e){s.e(e)}finally{s.f()}}else this.setNoSpaceIfArray(i)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"fixArraysAfterAddingColumn",value:function(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0)){var r,o=SU(this.arrayMapping.arraysInCols(pj.fromColumnStartAndEnd(e,t-1,t-1)));try{for(o.s();!(r=o.n()).done;)for(var i=EU(r.value,2)[1],a=i.getRange(),s=a.start.row;s<=a.end.row;++s)for(var u=t;u<=a.end.col;++u){var l=oB(e,u,s),c=oB(e,u+n,s),f=i.getArrayCellValue(l);this.addressMapping.moveCell(c,l),this.changes.addChange(Vj,c,f)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"fixArraysAfterRemovingColumns",value:function(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0)){var r,o=SU(this.arrayMapping.arraysInCols(pj.fromColumnStartAndEnd(e,t-1,t-1)));try{for(o.s();!(r=o.n()).done;){var i=EU(r.value,2)[1];if(this.isThereSpaceForArray(i)){var a,s=SU(i.getRange().addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.addressMapping.setCell(u,i)}}catch(e){s.e(e)}finally{s.f()}}else this.setNoSpaceIfArray(i)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"shrinkPossibleArrayAndGetCell",value:function(e){var t=this.getCell(e);return t instanceof YY?(this.setNoSpaceIfArray(t),this.getCell(e)):t}},{key:"setNoSpaceIfArray",value:function(e){e instanceof YY&&(this.shrinkArrayToCorner(e),e.setNoSpace())}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof WY&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,t){var n=this,r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.softRemoveEdge(e,t),r.forEach((function(t){n.graph.hasNode(t)&&n.graph.addEdge(e,t)}))}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var t=new Set(this.graph.removeNode(e));t.size>0;){var n=t.values().next().value;t.delete(n),this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof WY||n instanceof OU)&&this.graph.removeNode(n).forEach((function(e){return t.add(e)})),n instanceof WY?this.rangeMapping.removeRange(n):n instanceof OU&&this.addressMapping.removeCell(n.address))}}}],r=[{key:"buildEmpty",value:function(t,n,r,o,i){return new e(new dY(n.chooseAddressMappingPolicy),new tU,new vU(n.translationPackage),new bY,i,t,r,o)}}],n&&TU(t.prototype,n),r&&TU(t,r),e}();function MU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var OU=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.address=t}var t,n;return t=e,(n=[{key:"getCellValue",value:function(){return Vj}}])&&MU(t.prototype,n),e}();function AU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var LU=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parsedValue=t,this.rawValue=n}var t,n;return t=e,(n=[{key:"getValues",value:function(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}},{key:"setValues",value:function(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}},{key:"getCellValue",value:function(){return this.parsedValue}},{key:"setCellValue",value:function(e){throw"SetCellValue is deprecated for ValueCellVertex"}}])&&AU(t.prototype,n),e}();function xU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var NU=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors=t,this.rawInput=n}var t,n;return t=e,(n=[{key:"getCellValue",value:function(){return ZU.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}])&&xU(t.prototype,n),e}();function IU(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||PU(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DU(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=PU(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function PU(e,t){if(e){if("string"==typeof e)return HU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HU(e,t):void 0}}function HU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var FU=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n,this.mapping=new Map}var t,n;return t=e,n=[{key:"getCell",value:function(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}},{key:"has",value:function(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}},{key:"addRows",value:function(e,t){this.mapping.forEach((function(n){var r=new Map;n.forEach((function(o,i){i>=e&&(r.set(i+t,o),n.delete(i))})),r.forEach((function(e,t){n.set(t,e)}))})),this.height+=t}},{key:"addColumns",value:function(e,t){var n=this,r=new Map;this.mapping.forEach((function(o,i){i>=e&&(r.set(i+t,o),n.mapping.delete(i))})),r.forEach((function(e,t){n.mapping.set(t,e)})),this.width+=t}},{key:"removeRows",value:function(e){this.mapping.forEach((function(t){var n=new Map;t.forEach((function(r,o){o>=e.rowStart&&(t.delete(o),o>e.rowEnd&&n.set(o-e.numberOfRows,r))})),n.forEach((function(e,n){t.set(n,e)}))}));var t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){var t=this,n=new Map;this.mapping.forEach((function(r,o){o>=e.columnStart&&(t.mapping.delete(o),o>e.columnEnd&&n.set(o-e.numberOfColumns,r))})),n.forEach((function(e,n){t.mapping.set(n,e)}));var r=Math.min(this.width-1,e.columnEnd),o=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-o)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,l,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(this.mapping),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=24;break}o=IU(r.value,2),i=o[0],a=o[1],s=DU(a),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=14;break}return l=IU(u.value,2),c=l[0],f=l[1],e.next=12,[oB(t,i,c),f];case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),s.e(e.t0);case 19:return e.prev=19,s.f(),e.finish(19);case 22:e.next=3;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(1),n.e(e.t1);case 29:return e.prev=29,n.f(),e.finish(29);case 32:case"end":return e.stop()}}),e,this,[[1,26,29,32],[6,16,19,22]])}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.mapping.get(t))){e.next=3;break}return e.abrupt("return");case 3:r=DU(n),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=12;break}return(i=IU(o.value,2))[0],a=i[1],e.next=10,a;case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(this.mapping.values()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}if(o=r.value,void 0===(i=o.get(t))){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(t.columns()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=27;break}if(o=r.value,void 0!==(i=this.mapping.get(o))){e.next=8;break}return e.abrupt("continue",25);case 8:a=DU(i),e.prev=9,a.s();case 11:if((s=a.n()).done){e.next=17;break}return(u=IU(s.value,2))[0],l=u[1],e.next=15,l;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),n.e(e.t1);case 32:return e.prev=32,n.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,29,32,35],[9,19,22,25]])}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(this.mapping.values()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}o=r.value,i=DU(t.rows()),e.prev=6,i.s();case 8:if((a=i.n()).done){e.next=16;break}if(s=a.value,void 0===(u=o.get(s))){e.next=14;break}return e.next=14,u;case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(this.mapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}o=IU(r.value,2),i=o[0],a=o[1],s=DU(t.rows()),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=16;break}if(l=u.value,void 0===(c=a.get(l))){e.next=14;break}return e.next=14,[oB(t.sheet,i,l),c];case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),s.e(e.t0);case 21:return e.prev=21,s.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=DU(t.columns()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}if(o=r.value,void 0===(i=this.mapping.get(o))){e.next=24;break}a=DU(i.entries()),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=16;break}return u=IU(s.value,2),l=u[0],c=u[1],e.next=14,[oB(t.sheet,o,l),c];case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[8,18,21,24]])}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=DU(this.mapping),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=25;break}(r=IU(n.value,2))[0],o=r[1],i=DU(o),e.prev=6,i.s();case 8:if((a=i.n()).done){e.next=15;break}if((s=IU(a.value,2))[0],void 0===(u=s[1])){e.next=13;break}return e.next=13,u;case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:e.next=3;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t.e(e.t1);case 30:return e.prev=30,t.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[1,27,30,33],[6,17,20,23]])}))}],n&&jU(t.prototype,n),e}();function YU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var BU,VU,WU,zU,GU=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n,this.mapping=new Array(n);for(var r=0;r<n;r++)this.mapping[r]=new Array(t)}var t,n;return t=e,n=[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}},{key:"has",value:function(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,t){for(var n,r=[],o=0;o<t;o++)r.push(new Array(this.width));(n=this.mapping).splice.apply(n,[e,0].concat(r)),this.height+=t}},{key:"addColumns",value:function(e,t){for(var n=0;n<this.height;n++){var r;(r=this.mapping[n]).splice.apply(r,[e,0].concat(function(e){if(Array.isArray(e))return YU(e)}(o=new Array(t))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return YU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YU(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}var o;this.width+=t}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){for(var t=0;t<this.height;t++)this.mapping[t].splice(e.columnStart,e.numberOfColumns);var n=Math.min(this.width-1,e.columnEnd),r=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-r)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=14;break}r=0;case 3:if(!(r<this.width)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,[oB(t,r,n),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=9;break}if(!(r=this.getCellVertex(t,n))){e.next=6;break}return e.next=6,r;case 6:++n,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=9;break}if(!(r=this.getCellVertex(n,t))){e.next=6;break}return e.next=6,r;case 6:++n,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.columnStart;case 1:if(!(n<=t.columnEnd)){e.next=14;break}r=0;case 3:if(!(r<this.height)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,o;case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=14;break}r=t.rowStart;case 3:if(!(r<=t.rowEnd)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,o;case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=14;break}r=t.rowStart;case 3:if(!(r<=t.rowEnd)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,[oB(t.sheet,n,r),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=14;break}r=t.columnStart;case 3:if(!(r<=t.columnEnd)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,[oB(t.sheet,r,n),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.height)){e.next=14;break}n=0;case 3:if(!(n<this.width)){e.next=11;break}if(!(r=this.getCellVertex(n,t))){e.next=8;break}return e.next=8,r;case 8:++n,e.next=3;break;case 11:++t,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"getCellVertex",value:function(e,t){var n;return null===(n=this.mapping[t])||void 0===n?void 0:n[e]}}],n&&UU(t.prototype,n),e}();function KU(e){return KU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KU(e)}function XU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.SPILL="SPILL",e.LIC="LIC",e.ERROR="ERROR"}(BU||(BU={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.ARRAY="ARRAY",e.EMPTY="EMPTY",e.ARRAYFORMULA="ARRAYFORMULA"}(VU||(VU={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(WU||(WU={})),function(e){e.NUMBER="NUMBER"}(zU||(zU={}));var $U=Object.assign(Object.assign({},WU),zU),qU=Object.assign(Object.assign({},WU),Kj),JU=function(e){switch(e){case $U.EMPTY:return 0;case $U.NUMBER:return 1;case $U.STRING:return 2;case $U.BOOLEAN:return 3;case $U.ERROR:return 4}throw new Error("Cell value not computed")},QU=function(e){if(e===Vj)return $U.EMPTY;if(e instanceof ZU||e instanceof XF)return $U.ERROR;if("string"==typeof e)return $U.STRING;if(Zj(e))return $U.NUMBER;if("boolean"==typeof e)return $U.BOOLEAN;throw new Error("Cell value not computed")},ZU=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.message=n,this.root=r}var t,n,r;return t=e,r=[{key:"parsingError",value:function(){return new e(BU.ERROR,IH.ParseError)}}],(n=[{key:"attachRootVertex",value:function(t){return void 0===this.root?new e(this.type,this.message,t):this}}])&&XU(t.prototype,n),r&&XU(t,r),e}(),eB=function(e,t){return{sheet:e,row:t}},tB=function(e){return e.row<0},nB=function(e,t){return{sheet:e,col:t}},rB=function(e){return e.col<0},oB=function(e,t,n){return{sheet:e,col:t,row:n}},iB=function(e){return e.col<0||e.row<0},aB=function(e,t,n,r){return oB(t,e.col+n,e.row+r)},sB=function(e){return"".concat(e.sheet,",").concat(e.row,",").concat(e.col)};function uB(e){return!(!e||"object"!==KU(e)&&"function"!=typeof e)&&"col"in e&&"number"==typeof e.col&&"row"in e&&"number"==typeof e.row&&"sheet"in e&&"number"==typeof e.sheet}var lB=function(e,t){var n;return null!==(n=e.sheet)&&void 0!==n?n:t.sheet},cB=function(e,t){return e.sheet===t.sheet&&e.col===t.col&&e.row===t.row};function fB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hB=function(){function e(t,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=n,this.address=r,this.type=t.type,this.message=null!==(o=t.message)&&void 0!==o?o:""}var t,n;return t=e,(n=[{key:"toString",value:function(){return this.value}},{key:"valueOf",value:function(){return this.value}}])&&fB(t.prototype,n),e}();function dB(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return pB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pB(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function pB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mB(e){return mB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mB(e)}function yB(e,t,n){if(void 0===e)return FK.defaultConfig[n];if("string"==typeof t){if(mB(e)===t)return e;throw new JD(t,n)}if(t.includes(e))return e;throw new tP(t.map((function(e){return"'".concat(e,"'")})).join(" "),n)}function vB(e,t,n){if(e<n)throw new ZD(t,n)}function gB(e,t,n){if(e>n)throw new eP(t,n)}function bB(e,t,n,r){if(t(e))return e;if(void 0===e)return FK.defaultConfig[r];throw new JD(n,r)}function wB(){for(var e=new Map,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=e.get(t.value)||[];n.push(t.name),e.set(t.value,n)}));var o,i=[],a=dB(e.values());try{for(a.s();!(o=a.n()).done;){var s=o.value;s.length>1&&i.push(s)}}catch(e){a.e(e)}finally{a.f()}if(i.length>0){i.forEach((function(e){return e.sort()}));var u=i.map((function(e){return"[".concat(e,"]")})).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(u))}}function _B(e,t,n){if(mB(e)!==t)throw new JD(t,n)}var SB=/^ss\.(s+|0+)$/;function EB(e,t){if(void 0!==t){(t=t.toLowerCase()).endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var n=t.split(":"),r=void 0;"am"===e[e.length-1]||"a"===e[e.length-1]?(r=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(r=!0,e.pop());var o=0;if(n.length>=1&&SB.test(n[n.length-1])&&(o=n[n.length-1].length-3,n[n.length-1]="ss"),e.length===n.length){var i=n.indexOf("hh"),a=n.indexOf("mm"),s=n.indexOf("ss"),u=-1!==i?e[i]:"0";if(/^\d+$/.test(u)){var l=Number(u);if(void 0!==r){if(l<0||l>12)return;l%=12,r&&(l+=12)}var c=-1!==a?e[a]:"0";if(/^\d+$/.test(c)){var f=Number(c),h=-1!==s?e[s]:"0";if(/^\d+(\.\d+)?$/.test(h)){var d=Number(h);return{hours:l,minutes:f,seconds:d=Math.round(d*Math.pow(10,o))/Math.pow(10,o)}}}}}}}function kB(e,t){if(void 0!==t){var n=t.toLowerCase().split(/[ /.-]/g);if(e.length===n.length){var r=n.indexOf("mm"),o=n.indexOf("dd"),i=n.indexOf("yyyy"),a=n.indexOf("yy");if(r in e&&o in e&&(i in e||a in e)&&(!(i in e)||!(a in e))){var s;if(i in e){var u=e[i];if(!/^\d+$/.test(u))return;if((s=Number(u))<1e3||s>9999)return}else{var l=e[a];if(!/^\d+$/.test(l))return;if((s=Number(l))<0||s>99)return}var c=e[r];if(/^\d+$/.test(c)){var f=Number(c),h=e[o];if(/^\d+$/.test(h))return{year:s,month:f,day:Number(h)}}}}}}function RB(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return TB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?TB(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function TB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function CB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MB(e){return MB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MB(e)}var OB=[31,28,31,30,31,30,31,31,30,31,30,31],AB=[0,31,59,90,120,151,181,212,243,273,304,334];function LB(e){return!(!e||"object"!==MB(e)&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function xB(e){return!(!e||"object"!==MB(e)&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}var NB={year:9999,month:12,day:31},IB=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(NB),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}var t,n;return t=e,n=[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var t=this.parseDateTimeFromConfigFormats(e),n=t.dateTime,r=t.dateFormat,o=void 0===r?"":r,i=t.timeFormat,a=void 0===i?"":i;if(void 0!==n)return xB(n)?LB(n)?new Jj(jB(n)+this.dateToNumber(n),o+" "+a):new qj(jB(n),a):LB(n)?new Xj(this.dateToNumber(n),o):0}},{key:"parseSingleFormat",value:function(e,t,n){var r=this.parseDateTime(e,t,n);if(!LB(r)||(r.year>=0&&r.year<100&&(r.year<this.getNullYear()?r.year+=2e3:r.year+=1900),this.isValidDate(r)))return r}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"parseDateTimeFromFormats",value:function(e,t,n){var r,o=0===t.length?[void 0]:t,i=0===n.length?[void 0]:n,a=RB(o);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,l=RB(i);try{for(l.s();!(s=l.n()).done;){var c=s.value,f=this.parseSingleFormat(e,u,c);if(void 0!==f)return{dateTime:f,timeFormat:c,dateFormat:u}}}catch(e){l.e(e)}finally{l.f()}}}catch(e){a.e(e)}finally{a.f()}return{}}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=OB[e.month-1]))}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var t=Math.floor(e)+this.minDateAboluteValue,n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;var r=t-this.dateToNumberFromZero({year:n,month:1,day:1}),o=function(e){var t=0;return AB[t+6]<=e&&(t+=6),AB[t+3]<=e&&(t+=3),AB[t+2]<=e?t+=2:AB[t+1]<=e&&(t+=1),t}(r-(this.isLeapYear(n)&&r>=59?1:0));return{year:n,month:o+1,day:r-AB[o]-(this.isLeapYear(n)&&o>1?1:0)+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),HB(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"countLeapDays",value:function(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+AB[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}},{key:"daysInMonth",value:function(e,t){return this.isLeapYear(e)&&2===t?29:OB[t-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}},{key:"yearLengthForBasis",value:function(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}}],n&&CB(t.prototype,n),e}();function DB(e,t){var n=12*e.year+e.month-1+t;return{year:Math.floor(n/12),month:n%12+1,day:e.day}}function PB(e){return Math.round(3600*e*24)/86400}function HB(e){e=Math.round(24*e*60*60*1e5)/864e7,e*=24;var t=Math.floor(e);e-=t,e*=60;var n=Math.floor(e);return e-=n,e*=60,{hours:t,minutes:n,seconds:Math.round(1e5*e)/1e5}}function jB(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function FB(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}function YB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var UB,BB,VB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,(n=[{key:"call",value:function(){return GU}}])&&YB(t.prototype,n),r&&YB(t,r),e;var t,n,r}(),WB=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,zB=/(\\.|[#0]+(\.[#0]*)?)/g;function GB(e,t){return{type:e,value:t}}function KB(e,t){for(var n=[],r=0,o=0;o<e.length;++o){var i=e[o];if(i.index!==r){var a=t.substr(r,i.index-r);n.push(GB(UB.FREE_TEXT,a))}i[0].startsWith("\\")?n.push(GB(UB.FREE_TEXT,i[0])):n.push(GB(UB.FORMAT,i[0])),r=i.index+i[0].length}var s=e[e.length-1];if(s.index+s[0].length<t.length){var u=t.substr(s.index+s[0].length,t.length);n.push(GB(UB.FREE_TEXT,u))}return n}function XB(e){var t=function(e){WB.lastIndex=0;var t,n=[];do{null!==(t=WB.exec(e))&&n.push(t)}while(t);return n}(e);return t.every((function(e){return $B(e)}))?void 0:{type:BB.DATE,tokens:KB(t,e)}}function $B(e){return e[0].startsWith("\\")}function qB(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||JB(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JB(e,t){if(e){if("string"==typeof e)return QB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QB(e,t):void 0}}function QB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ZB(e,t,n,r){var o=n.stringifyDateTime(r.numberToSimpleDateTime(e),t);if(void 0!==o)return o;var i=n.stringifyDuration(HB(e),t);if(void 0!==i)return i;var a,s,u=(s=function(e){zB.lastIndex=0;var t=zB.exec(e);return null!==t?[t]:[]}(a=t)).every((function(e){return $B(e)}))?void 0:{type:BB.NUMBER,tokens:KB(s,a)};return void 0!==u?function(e,t){for(var n="",r=0;r<e.length;++r){var o=e[r];if(o.type!==UB.FREE_TEXT){var i=o.value.split("."),a=i[0],s=i[1]||"",u=i[1]?".":"",l=Number(t.toFixed(s.length)).toString().split("."),c=l[0]||"",f=l[1]||"";a.length>c.length&&(c=eV(c,nV(a.substr(0,a.length-c.length),"0")+c.length)),n+=c+u+(f=tV(f,nV(s.substr(f.length,s.length-f.length),"0")+f.length))}else n+=o.value}return n}(u.tokens,e):t}function eV(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function tV(e,t){for(var n=e+"";n.length<t;)n+="0";return n}function nV(e,t){return e.split(t).length-1}function rV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(UB||(UB={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(BB||(BB={}));var oV="length",iV=function(e){return parseInt(e,16)},aV=function(e){return parseInt(e,10)},sV=function(e){return(e+"").replace(/\-/g,"")},uV=function(e,t,n){return e.substr(t,n)},lV=function(e){return e.codePointAt(0)-65};function cV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fV,hV={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(e){var t=e.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(t,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},dV=!1;function pV(e){var t,n,r={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)r.template="valid";else if("string"==typeof e&&function(e){if((e=(e+"").replace(/\-/g,""))[oV]!==lV("Z"))return!1;var t=0;return[[0,lV("G")+1],[lV("H"),lV("H")-1],[lV("G")+lV("H"),lV("G")]].reduce((function(n,r,o){var i,a,s=(a=2,function(e){if(Array.isArray(e))return e}(i=r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(i,a)||function(e,t){if(e){if("string"==typeof e)return rV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rV(e,t):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],l=s[1];return n|=(aV("".concat(aV(iV(uV.apply(void 0,[e].concat([t+u-(0===o?0:2),l+(o?2:0)])))+(iV(uV.apply(void 0,[e].concat([t+u+l,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,n}),lV("A"))===[]+1>>1}(e)){var o=(t="23/09/2021".split("/"),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return cV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cV(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],s=o[2],u=Math.floor(new Date("".concat(a,"/").concat(i,"/").concat(s)).getTime()/864e5),l=function(e){return 25===sV(e)[oV]?iV(uV(sV(e),iV("12"),lV("F")))/(iV(uV(sV(e),lV("C"),lV("Y")>>4))||1+(~~![][oV]<<3)):0}(e);r.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],n=e.getDate(),r=e.getFullYear();return"".concat(t," ").concat(n,", ").concat(r)}(new Date(864e5*(l+1))),r.template=u>l?"expired":"valid"}else""!==e&&(r.template="invalid");return dV||"valid"===r.template||(console.warn(hV[r.template](r.vars)),dV=!0),r.template}function mV(e,t){if(e){if("string"==typeof e)return yV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yV(e,t):void 0}}function yV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gV(e,t,n){return t&&vV(e.prototype,t),n&&vV(e,n),e}function bV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){e.Number=function e(t){bV(this,e),this.value=t,this.value=Gj(this.value,vF(Wj(this.value)))},e.String=function e(t){bV(this,e),this.value=t},e.Boolean=function e(t){bV(this,e),this.value=t};var t=function(){function e(){bV(this,e)}return gV(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=t,e.Formula=function e(t){bV(this,e),this.formula=t},e.Error=function e(t,n){bV(this,e),this.value=new ZU(t,n)}}(fV||(fV={}));var wV,_V,SV=function(){function e(t,n,r){bV(this,e),this.config=t,this.dateHelper=n,this.numberLiteralsHelper=r}return gV(e,[{key:"currencyMatcher",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=mV(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.config.currencySymbol);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e.startsWith(r))return[r,e.slice(r.length)];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length)]}}catch(e){n.e(e)}finally{n.f()}}},{key:"parse",value:function(e){if(null==e)return fV.Empty.getSingletonInstance();if("number"==typeof e)return yF(e)?new fV.Error(BU.NUM,IH.ValueLarge):new fV.Number(e);if("boolean"==typeof e)return new fV.Boolean(e);if(e instanceof Date){var t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+jB({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new fV.Error(BU.NUM,IH.DateBounds):t%1==0?new fV.Number(new Xj(t,"Date()")):t<1?new fV.Number(new qj(t,"Date()")):new fV.Number(new Jj(t,"Date()"))}if("string"==typeof e){if("true"===(h=e.toLowerCase())||"false"===h)return new fV.Boolean("true"===e.toLowerCase());if(e.startsWith("="))return new fV.Formula(e);if(function(e,t){var n=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(n)&&Object.prototype.hasOwnProperty.call(t,n)}(e,this.config.errorMapping))return new fV.Error(this.config.errorMapping[e.toUpperCase()]);var n,r=e.trim(),o=0;if(r.endsWith("%"))o=1,r=r.slice(0,r.length-1);else{var i=this.currencyMatcher(r);if(void 0!==i){o=2;var a=(f=2,function(e){if(Array.isArray(e))return e}(c=i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(c,f)||mV(c,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());n=a[0],r=a[1]}}var s,u=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==u)return s=1===o?new Qj(u/100):2===o?new $j(u,n):u,new fV.Number(s);var l=this.dateHelper.dateStringToDateNumber(r);return void 0!==l?new fV.Number(l):new fV.String(e.startsWith("'")?e.slice(1):e)}var c,f,h;throw new qD(e)}}]),e}();function EV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RV(e,t,n){return t&&kV(e.prototype,t),n&&kV(e,n),e}!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(wV||(wV={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(_V||(_V={}));var TV=function(){function e(t,n,r,o,i){EV(this,e),this.sourceLeftCorner=t,this.width=n,this.height=r,this.type=o,this.content=i}return RV(e,[{key:"getContent",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:n=0;case 5:if(!(n<this.height)){e.next=16;break}r=0;case 7:if(!(r<this.width)){e.next=13;break}return e.next=10,[oB(t.sheet,t.col+r,t.row+n),this.content[n][r]];case 10:++r,e.next=7;break;case 13:++n,e.next=5;break;case 16:case"end":return e.stop()}}),e,this)}))}]),e}(),CV=function(){function e(t,n,r){EV(this,e),this.dependencyGraph=n,this.operations=r,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}return RV(e,[{key:"cut",value:function(e,t,n){this.clipboard=new TV(e,t,n,wV.CUT)}},{key:"copy",value:function(e,t,n){for(var r=[],o=0;o<n;++o){r[o]=[];for(var i=0;i<t;++i){var a=this.operations.getClipboardCell(oB(e.sheet,e.col+i,e.row+o));r[o].push(a)}}this.clipboard=new TV(e,t,n,wV.COPY,r)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===wV.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if(iB(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new YD("a valid target address.");var t=Cj.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new HD;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===wV.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===wV.COPY}}]),e}();function MV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AV(e,t,n){return t&&OV(e.prototype,t),n&&OV(e,n),e}var LV=function(){function e(t,n,r,o){MV(this,e),this.displayName=t,this.address=n,this.added=r,this.options=o}return AV(e,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new e(this.displayName,this.address,this.added,this.options)}}]),e}(),xV=function(){function e(){MV(this,e),this.mapping=new Map}return AV(e,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),e}(),NV=function(){function e(){MV(this,e),this.mapping=new Map}return AV(e,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e);return!this.mapping.has(t)}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}}]),e}(),IV=function(){function e(){MV(this,e),this.nextNamedExpressionRow=0,this.workbookStore=new xV,this.worksheetStores=new Map,this.addressCache=new Map}return AV(e,[{key:"isNameAvailable",value:function(e,t){var n,r;return void 0===t?this.workbookStore.isNameAvailable(e):null===(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.isNameAvailable(e))||void 0===r||r}},{key:"namedExpressionInAddress",value:function(e){var t=this.addressCache.get(e);return t&&t.added?t:void 0}},{key:"namedExpressionForScope",value:function(e,t){var n;return void 0===t?this.workbookStore.getExisting(e):null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e)}},{key:"nearestNamedExpression",value:function(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e))&&void 0!==r?r:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.has(e))&&void 0!==r&&r}},{key:"isNameValid",value:function(e){return!/^[A-Za-z]+[0-9]+$/.test(e)&&/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,t,n){var r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t),o=r.get(e);return void 0!==o?(o.added=!0,o.displayName=e,o.options=n):(o=new LV(e,this.nextAddress(),!0,n),r.add(o)),this.addressCache.set(o.address.row,o),o}},{key:"restoreNamedExpression",value:function(e,t){var n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}},{key:"worksheetStoreOrCreate",value:function(e){var t=this.worksheetStores.get(e);return t||(t=new NV,this.worksheetStores.set(e,t)),t}},{key:"worksheetStore",value:function(e){return this.worksheetStores.get(e)}},{key:"namedExpressionOrPlaceholder",value:function(e,t){var n;return null!==(n=this.worksheetStoreOrCreate(t).get(e))&&void 0!==n?n:this.workbookNamedExpressionOrPlaceholder(e)}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var t=this.workbookStore.get(e);return void 0===t&&(t=new LV(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}},{key:"remove",value:function(e,t){var n,r=null==(n=void 0===t?this.workbookStore:this.worksheetStore(t))?void 0:n.get(e);if(void 0===n||void 0===r||!r.added)throw"Named expression does not exist";n.remove(e),n instanceof NV&&0===n.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(r.address.row)}},{key:"getAllNamedExpressionsNamesInScope",value:function(e){return this.getAllNamedExpressions().filter((function(t){return t.scope===e})).map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressionsNames",value:function(){return this.getAllNamedExpressions().map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach((function(t,n){t.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:n})}))})),e}},{key:"getAllNamedExpressionsForScope",value:function(e){var t,n;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(n=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==n?n:[]}},{key:"nextAddress",value:function(){return oB(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}]),e}();IV.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;var DV=function e(t){switch(t.type){case vH.EMPTY:case vH.NUMBER:case vH.STRING:case vH.ERROR:case vH.ERROR_WITH_RAW_INPUT:return!1;case vH.CELL_REFERENCE:return!t.reference.isAbsolute();case vH.CELL_RANGE:case vH.COLUMN_RANGE:case vH.ROW_RANGE:return!t.start.isAbsolute();case vH.NAMED_EXPRESSION:return!1;case vH.PERCENT_OP:case vH.PLUS_UNARY_OP:case vH.MINUS_UNARY_OP:return e(t.value);case vH.CONCATENATE_OP:case vH.EQUALS_OP:case vH.NOT_EQUAL_OP:case vH.LESS_THAN_OP:case vH.GREATER_THAN_OP:case vH.LESS_THAN_OR_EQUAL_OP:case vH.GREATER_THAN_OR_EQUAL_OP:case vH.MINUS_OP:case vH.PLUS_OP:case vH.TIMES_OP:case vH.DIV_OP:case vH.POWER_OP:return e(t.left)||e(t.right);case vH.PARENTHESIS:return e(t.expression);case vH.FUNCTION_CALL:return t.args.some((function(t){return e(t)}));case vH.ARRAY:return t.args.some((function(t){return t.some((function(t){return e(t)}))}))}};function PV(e,t){if(e){if("string"==typeof e)return HV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HV(e,t):void 0}}function HV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var FV=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"performEagerTransformations",value:function(e,t){var n,r,o,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=PV(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.arrayFormulaNodes());try{for(i.s();!(n=i.n()).done;){var a=n.value,s=(r=this.transformSingleAst(a.getFormula(e.lazilyTransformingAstService),a.getAddress(e.lazilyTransformingAstService)),o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||PV(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],l=s[1],c=t.rememberNewAst(u);a.setFormula(c),a.setAddress(l)}}catch(e){i.e(e)}finally{i.f()}}},{key:"transformSingleAst",value:function(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}},{key:"transformAst",value:function(e,t){var n=this;switch(e.type){case vH.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case vH.CELL_RANGE:return this.transformCellRangeAst(e,t);case vH.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case vH.ROW_RANGE:return this.transformRowRangeAst(e,t);case vH.EMPTY:case vH.ERROR:case vH.NUMBER:case vH.NAMED_EXPRESSION:case vH.ERROR_WITH_RAW_INPUT:case vH.STRING:return e;case vH.PERCENT_OP:case vH.MINUS_UNARY_OP:case vH.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case vH.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map((function(e){return n.transformAst(e,t)}))});case vH.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case vH.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map((function(e){return e.map((function(e){return n.transformAst(e,t)}))}))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}},{key:"transformCellReferenceAst",value:function(e,t){var n=this.transformCellAddress(e.reference,t);return n instanceof mP?Object.assign(Object.assign({},e),{reference:n}):n===BU.REF?kH(new ZU(BU.REF)):e}},{key:"transformCellRangeAst",value:function(e,t){var n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===BU.REF?kH(new ZU(BU.REF)):e}},{key:"transformColumnRangeAst",value:function(e,t){var n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===BU.REF?kH(new ZU(BU.REF)):e}},{key:"transformRowRangeAst",value:function(e,t){var n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===BU.REF?kH(new ZU(BU.REF)):e}}],n&&jV(t.prototype,n),e}();function YV(e){return YV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YV(e)}function UV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BV(e,t){return BV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},BV(e,t)}function VV(e,t){if(t&&("object"===YV(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function WV(e){return WV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},WV(e)}var zV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BV(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=WV(r);if(o){var n=WV(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return VV(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).columnsSpan=e,t}return t=a,(n=[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformCellAddress",value:function(e,t){var n=lB(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;var r=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=r.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return r===BU.REF||o===BU.REF?BU.REF:!(!r&&!o)&&[r||e,o||t]}}])&&UV(t.prototype,n),a}(FV);function GV(e){return GV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GV(e)}function KV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XV(e,t){return XV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},XV(e,t)}function $V(e,t){if(t&&("object"===GV(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qV(e){return qV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qV(e)}var JV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XV(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qV(r);if(o){var n=qV(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $V(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).rowsSpan=e,t}return t=a,(n=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(e,t){var n=lB(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;var r=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=r.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return r===BU.REF||o===BU.REF?BU.REF:!(!r&&!o)&&[r||e,o||t]}}])&&KV(t.prototype,n),a}(FV);function QV(e){return QV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QV(e)}function ZV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eW(e,t){return eW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},eW(e,t)}function tW(e,t){if(t&&("object"===QV(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nW(e){return nW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nW(e)}var rW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eW(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nW(r);if(o){var n=nW(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tW(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).sheet=e,t}return t=a,(n=[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!e.isInvalid(t)&&BU.REF}},{key:"transformCellRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&BU.REF}},{key:"transformColumnRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&BU.REF}},{key:"transformRowRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&BU.REF}}])&&ZV(t.prototype,n),a}(FV);function oW(e){return oW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oW(e)}function iW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sW(e,t,n){return t&&aW(e.prototype,t),n&&aW(e,n),e}function uW(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lW(e,t)}function lW(e,t){return lW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lW(e,t)}function cW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hW(e);if(t){var o=hW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fW(this,n)}}function fW(e,t){if(t&&("object"===oW(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hW(e){return hW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hW(e)}var dW=function(e){uW(n,e);var t=cW(n);function n(e,r,o,i){var a;return iW(this,n),(a=t.call(this)).sourceRange=e,a.toRight=r,a.toBottom=o,a.toSheet=i,a.dependentFormulaTransformer=new pW(e,r,o,i),a}return sW(n,[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"transformSingleAst",value:function(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}},{key:"fixNodeAddress",value:function(e){return oB(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e,t)}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformAddress",value:function(e,t){var n=this.sourceRange;if(e instanceof mP){var r=e.toSimpleCellAddress(t);if(n.addressInRange(r))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(e,t,n){var r=this.sourceRange;if(e instanceof mP&&t instanceof mP){var o=e.toSimpleCellAddress(n),i=t.toSimpleCellAddress(n);if(r.addressInRange(o)&&r.addressInRange(i))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}]),n}(FV),pW=function(e){uW(n,e);var t=cW(n);function n(e,r,o,i){var a;return iW(this,n),(a=t.call(this)).sourceRange=e,a.toRight=r,a.toBottom=o,a.toSheet=i,a}return sW(n,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}},{key:"shouldMove",value:function(e,t){return e instanceof mP?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof tH?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return!(!r||!o)&&[r,o]}}]),n}(FV);function mW(e){return mW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mW(e)}function yW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vW(e,t){return vW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vW(e,t)}function gW(e,t){if(t&&("object"===mW(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bW(e){return bW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bW(e)}var wW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vW(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bW(r);if(o){var n=bW(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return gW(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).columnsSpan=e,t}return t=a,(n=[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformCellAddress",value:function(e,t){var n=lB(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){var r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var o=e.toSimpleColumnAddress(t);if(o.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(o.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return BU.REF}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,n){var r=lB(e,n),o=e,i=t;if(this.columnsSpan.sheet===r){var a=e.toSimpleColumnAddress(n),s=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=a.col&&this.columnsSpan.columnEnd>=s.col)return BU.REF;a.col>=this.columnsSpan.columnStart&&a.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-a.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(i=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}var u=this.transformCellAddress(o,n),l=this.transformCellAddress(i,n);if(!1===u&&!1===l)return[o,i];if(u===BU.REF||l===BU.REF)throw Error("Cannot happen");return[u||o,l||i]}}])&&yW(t.prototype,n),a}(FV);function _W(e){return _W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_W(e)}function SW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EW(e,t){return EW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},EW(e,t)}function kW(e,t){if(t&&("object"===_W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function RW(e){return RW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},RW(e)}var TW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EW(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=RW(r);if(o){var n=RW(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kW(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).rowsSpan=e,t}return t=a,(n=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellAddress",value:function(e,t){var n=lB(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){var r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var o=e.toSimpleRowAddress(t);if(o.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(o.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return BU.REF}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,n){var r=lB(e,n),o=e,i=t;if(this.rowsSpan.sheet===r){var a=e.toSimpleRowAddress(n),s=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=a.row&&this.rowsSpan.rowEnd>=s.row)return BU.REF;a.row>=this.rowsSpan.rowStart&&a.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-a.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(i=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}var u=this.transformCellAddress(o,n),l=this.transformCellAddress(i,n);return!1===u&&!1===l?[o,i]:u===BU.REF||l===BU.REF?BU.REF:[u||o,l||i]}}])&&SW(t.prototype,n),a}(FV);function CW(e){return CW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CW(e)}function MW(e,t){if(e){if("string"==typeof e)return OW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OW(e,t):void 0}}function OW(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function AW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LW(e,t){return LW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},LW(e,t)}function xW(e,t){if(t&&("object"===CW(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function NW(e){return NW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},NW(e)}var IW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LW(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=NW(r);if(o){var n=NW(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xW(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).sheet=e,t}return t=a,n=[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(e,t){var n,r,o,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=MW(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.arrayFormulaNodes());try{for(i.s();!(n=i.n()).done;){var a=n.value,s=(r=this.transformSingleAst(a.getFormula(e.lazilyTransformingAstService),a.getAddress(e.lazilyTransformingAstService)),o=1,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||MW(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];a.setFormula(s)}}catch(e){i.e(e)}finally{i.f()}}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e)}},{key:"transformCellRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformRowRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformAddress",value:function(e){return e.sheet===this.sheet&&BU.REF}}],n&&AW(t.prototype,n),a}(FV);function DW(e){if(!Array.isArray(e))throw new YD("an array of arrays.");for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new YD("an array of arrays.")}function PW(e){for(var t=0,n=0,r=0,o=0;o<e.length;o++){for(var i=0,a=0;a<e[o].length;a++){null!=e[o][a]&&(i=a+1,++r)}t=Math.max(t,i),i>0&&(n=o+1)}var s=t*n;return{height:n,width:t,fill:0===s?0:r/s}}function HW(e){return function(e){if(Array.isArray(e))return UW(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||YW(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jW(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||YW(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FW(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=YW(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function YW(e,t){if(e){if("string"==typeof e)return UW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UW(e,t):void 0}}function UW(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WW(e,t,n){return t&&VW(e.prototype,t),n&&VW(e,n),e}var zW=function(){function e(t,n){BW(this,e),this.sheet=t,this.indexes=n}return WW(e,[{key:"normalizedIndexes",value:function(){return qW(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return dj.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}(),GW=function(){function e(t,n){BW(this,e),this.sheet=t,this.indexes=n}return WW(e,[{key:"normalizedIndexes",value:function(){return JW(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return dj.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}(),KW=function(){function e(t,n){BW(this,e),this.sheet=t,this.indexes=n}return WW(e,[{key:"normalizedIndexes",value:function(){return JW(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return pj.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}(),XW=function(){function e(t,n){BW(this,e),this.sheet=t,this.indexes=n}return WW(e,[{key:"normalizedIndexes",value:function(){return qW(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return pj.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}(),$W=function(){function e(t,n,r,o,i,a,s,u,l){BW(this,e),this.dependencyGraph=n,this.columnSearch=r,this.cellContentParser=o,this.parser=i,this.stats=a,this.lazilyTransformingAstService=s,this.namedExpressions=u,this.arraySizePredictor=l,this.changes=ZF.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=t.maxColumns,this.maxRows=t.maxRows}return WW(e,[{key:"removeRows",value:function(e){var t,n=[],r=FW(e.rowsSpans());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.doRemoveRows(o);i&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"addRows",value:function(e){var t,n=FW(e.rowsSpans());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.doAddRows(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"addColumns",value:function(e){var t,n=FW(e.columnsSpans());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.doAddColumns(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"removeColumns",value:function(e){var t,n=[],r=FW(e.columnsSpans());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.doRemoveColumns(o);i&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"removeSheet",value:function(e){var t,n=this;this.dependencyGraph.removeSheet(e),this.stats.measure(QF.TRANSFORM_ASTS,(function(){var r=new IW(e);r.performEagerTransformations(n.dependencyGraph,n.parser),t=n.lazilyTransformingAstService.addTransformation(r)})),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);var r=this.namedExpressions.getAllNamedExpressionsForScope(e).map((function(t){return n.removeNamedExpression(t.normalizeExpressionName(),e)}));return{version:t,scopedNamedExpressions:r}}},{key:"removeSheetByName",value:function(e){var t=this.sheetMapping.fetch(e);return this.removeSheet(t)}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var t=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,n,PW(n)),this.sheetMapping.fetchDisplayName(t)}},{key:"renameSheet",value:function(e,t){return this.sheetMapping.renameSheet(e,t)}},{key:"moveRows",value:function(e,t,n,r){var o=dj.fromNumberOfRows(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),r<t&&(t+=n);var i=oB(e,0,t),a=oB(e,0,r);this.moveCells(i,Number.POSITIVE_INFINITY,n,a);var s=dj.fromNumberOfRows(e,t,n);return this.doRemoveRows(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,t,n,r){var o=pj.fromNumberOfColumns(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),r<t&&(t+=n);var i=oB(e,t,0),a=oB(e,r,0);this.moveCells(i,n,Number.POSITIVE_INFINITY,a);var s=pj.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,t,n,r){var o=this;this.ensureItIsPossibleToMoveCells(e,t,n,r);var i=Cj.spanFrom(e,t,n),a=Cj.spanFrom(r,t,n),s=r.col-e.col,u=r.row-e.row,l=r.sheet,c=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);var h,d=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(d,s,u,l),this.stats.measure(QF.TRANSFORM_ASTS,(function(){var e=new dW(i,s,u,l);e.performEagerTransformations(o.dependencyGraph,o.parser),h=o.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(i,s,u,l);var p=this.updateNamedExpressionsForMovedCells(e,t,n,r);return{version:h,overwrittenCellsData:c,addedGlobalNamedExpressions:p}}},{key:"setRowOrder",value:function(e,t){var n,r=this,o=[],i=[],a=FW(t);try{var s=function(){var t=jW(n.value,2),a=t[0],s=t[1];if(a!==s){var u=Cj.spanFrom({sheet:e,col:0,row:a},1/0,1),l=r.getRangeClipboardCells(u);i=i.concat(l),o.push(l.map((function(e){var t=jW(e,2),n=t[0],r=n.sheet,o=n.col,i=t[1];return[{sheet:r,col:o,row:s},i]})))}};for(a.s();!(n=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}return o.forEach((function(t){return r.restoreClipboardCells(e,t.values())})),i}},{key:"setColumnOrder",value:function(e,t){var n,r=this,o=[],i=[],a=FW(t);try{var s=function(){var t=jW(n.value,2),a=t[0],s=t[1];if(a!==s){var u=Cj.spanFrom({sheet:e,col:a,row:0},1,1/0),l=r.getRangeClipboardCells(u);i=i.concat(l),o.push(l.map((function(e){var t=jW(e,2),n=t[0],r=n.sheet,o=(n.col,n.row),i=t[1];return[{sheet:r,col:s,row:o},i]})))}};for(a.s();!(n=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}return o.forEach((function(t){return r.restoreClipboardCells(e,t.values())})),i}},{key:"addNamedExpression",value:function(e,t,n,r){var o=this.namedExpressions.addNamedExpression(e,n,r);this.storeNamedExpressionInCell(o.address,t),this.adjustNamedExpressionEdges(o,e,n)}},{key:"restoreNamedExpression",value:function(e,t,n){var r=e.displayName;this.restoreCell(e.address,t);var o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,r,n)}},{key:"changeNamedExpressionExpression",value:function(e,t,n,r){var o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new WD(e);var i=o.copy();o.options=r;var a=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[i,a]}},{key:"removeNamedExpression",value:function(e,t){var n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new WD(e);this.namedExpressions.remove(n.displayName,t);var r=this.getClipboardCell(n.address);if(void 0!==t){var o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,r]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,t,n,r){if(iB(e)||!(QW(t)&&QW(n)||function(e,t,n){return 0===e.row&&QW(t)&&n===Number.POSITIVE_INFINITY||0===e.col&&QW(n)&&t===Number.POSITIVE_INFINITY}(e,t,n))||iB(r)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(r.sheet))throw new YD("a valid range of cells to move.");var o=Cj.spanFrom(e,t,n),i=Cj.spanFrom(r,t,n);if(i.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new HD;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new lP;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new cP}},{key:"restoreClipboardCells",value:function(e,t){var n,r=[],o=FW(t);try{for(o.s();!(n=o.n()).done;){var i=jW(n.value,2),a=i[0],s=i[1];if(this.restoreCell(a,s),s.type===_V.FORMULA){var u=this.parser.fetchCachedResult(s.hash).dependencies;r.push.apply(r,HW(this.updateNamedExpressionsForTargetAddress(e,a,u)))}}}catch(e){o.e(e)}finally{o.f()}return r}},{key:"restoreCell",value:function(e,t){switch(t.type){case _V.VALUE:this.setValueToCell(t,e);break;case _V.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case _V.EMPTY:this.setCellEmpty(e);break;case _V.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}},{key:"doRemoveRows",value:function(e){var t=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var n,r=[],o=FW(this.dependencyGraph.entriesFromRowsSpan(e));try{for(o.s();!(n=o.n()).done;){var i=jW(n.value,1)[0];r.push({address:i,cellType:this.getClipboardCell(i)})}}catch(e){o.e(e)}finally{o.f()}var a,s=this.dependencyGraph.removeRows(e),u=s.affectedArrays,l=s.contentChanges;return this.columnSearch.applyChanges(l.getChanges()),this.stats.measure(QF.TRANSFORM_ASTS,(function(){var n=new TW(e);n.performEagerTransformations(t.dependencyGraph,t.parser),a=t.lazilyTransformingAstService.addTransformation(n)})),this.rewriteAffectedArrays(u),{version:a,removedCells:r,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var t=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var n,r=[],o=FW(this.dependencyGraph.entriesFromColumnsSpan(e));try{for(o.s();!(n=o.n()).done;){var i=jW(n.value,1)[0];r.push({address:i,cellType:this.getClipboardCell(i)})}}catch(e){o.e(e)}finally{o.f()}var a,s=this.dependencyGraph.removeColumns(e),u=s.affectedArrays,l=s.contentChanges;return this.columnSearch.applyChanges(l.getChanges()),this.columnSearch.removeColumns(e),this.stats.measure(QF.TRANSFORM_ASTS,(function(){var n=new wW(e);n.performEagerTransformations(t.dependencyGraph,t.parser),a=t.lazilyTransformingAstService.addTransformation(n)})),this.rewriteAffectedArrays(u),{version:a,removedCells:r,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var t=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var n=this.dependencyGraph.addRows(e).affectedArrays;this.stats.measure(QF.TRANSFORM_ASTS,(function(){var n=new JV(e);n.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(n)})),this.rewriteAffectedArrays(n)}}},{key:"rewriteAffectedArrays",value:function(e){var t,n=FW(e.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.array.size.isRef){var o=r.getFormula(this.lazilyTransformingAstService),i=r.getAddress(this.lazilyTransformingAstService),a=this.parser.computeHashFromAst(o);this.setFormulaToCellFromCache(a,i)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"doAddColumns",value:function(e){var t=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var n=this.dependencyGraph.addColumns(e),r=n.affectedArrays,o=n.contentChanges;this.columnSearch.addColumns(e),this.columnSearch.applyChanges(o.getChanges()),this.stats.measure(QF.TRANSFORM_ASTS,(function(){var n=new zV(e);n.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(n)})),this.rewriteAffectedArrays(r)}}},{key:"getOldContent",value:function(e){var t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof OU)return[e,{type:_V.EMPTY}];if(t instanceof LU)return[e,Object.assign({type:_V.VALUE},t.getValues())];if(t instanceof FY)return[t.getAddress(this.lazilyTransformingAstService),{type:_V.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof NU)return[e,{type:_V.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}},{key:"getClipboardCell",value:function(e){var t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof OU)return{type:_V.EMPTY};if(t instanceof LU)return Object.assign({type:_V.VALUE},t.getValues());if(t instanceof YY){var n=t.getArrayCellValue(e);return n===Vj?{type:_V.EMPTY}:{type:_V.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof UY)return{type:_V.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof NU)return{type:_V.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),r=new Array(t),o=0;o<t;o++){r[o]=new Array(n);for(var i=0;i<n;i++){var a=oB(e,i,o);r[o][i]=this.getClipboardCell(a)}}return r}},{key:"getRangeClipboardCells",value:function(e){var t,n=[],r=FW(e.addresses(this.dependencyGraph));try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push([o,this.getClipboardCell(o)])}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"setCellContent",value:function(e,t){var n=this.cellContentParser.parse(t),r=this.getOldContent(e);if(n instanceof fV.Formula){var o=this.parser.parse(n.formula,e),i=o.ast,a=o.errors;if(a.length>0)this.setParsingErrorToCell(n.formula,a,e);else{var s=this.arraySizePredictor.checkArraySize(i,e);this.setFormulaToCell(e,s,o)}}else n instanceof fV.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return r}},{key:"setSheetContent",value:function(e,t){this.clearSheet(e);for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var o=oB(e,r,n);this.setCellContent(o,t[n][r])}}},{key:"setParsingErrorToCell",value:function(e,t,n){var r=this.dependencyGraph.getCellValue(n),o=new NU(t,e),i=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(Wj(r),n),this.columnSearch.applyChanges(i.getChanges()),this.changes.addAll(i),this.changes.addChange(o.getCellValue(),n)}},{key:"setFormulaToCell",value:function(e,t,n){var r=n.ast,o=n.hasVolatileFunction,i=n.hasStructuralChangeFunction,a=n.dependencies,s=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,r,Aj(a,e),t,o,i);this.columnSearch.remove(Wj(s),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}},{key:"setValueToCell",value:function(e,t){var n=this.dependencyGraph.getCellValue(t),r=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(Wj(n),Wj(e.parsedValue),t),this.columnSearch.applyChanges(r.getChanges().filter((function(e){return!cB(e.address,t)}))),this.changes.addAll(r),this.changes.addChange(e.parsedValue,t)}},{key:"setCellEmpty",value:function(e){if(!this.dependencyGraph.isArrayInternalCell(e)){var t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(Wj(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(Vj,e)}}},{key:"setFormulaToCellFromCache",value:function(e,t){var n=this.parser.fetchCachedResult(e),r=n.ast,o=n.hasVolatileFunction,i=n.hasStructuralChangeFunction,a=n.dependencies,s=Aj(a,t),u=jW(new rW(t.sheet).transformSingleAst(r,t),1)[0];this.parser.rememberNewAst(u);var l=s.filter((function(e){return e instanceof lj||(e instanceof Cj?!(iB(e.start)||iB(e.end)):!iB(e))})),c=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,u,l,c,o,i)}},{key:"rowEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=ZF.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"columnEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}},{key:"adjustNamedExpressionEdges",value:function(e,t,n){if(void 0!==n){var r,o=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),a=this.dependencyGraph.fetchCellOrCreateEmpty(i.address),s=FW(this.dependencyGraph.graph.adjacentNodes(a));try{for(s.s();!(r=s.n()).done;){var u=r.value;if(u instanceof UY&&u.getAddress(this.lazilyTransformingAstService).sheet===n){var l,c=u.getFormula(this.lazilyTransformingAstService),f=u.getAddress(this.lazilyTransformingAstService),h=this.parser.fetchCachedResultForAst(c).dependencies,d=FW(Aj(h,f));try{for(d.s();!(l=d.n()).done;){var p=l.value;p instanceof lj&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(a,u),this.dependencyGraph.graph.addEdge(o,u))}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){s.e(e)}finally{s.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,t){var n=this.cellContentParser.parse(t);if(n instanceof fV.Formula){var r=this.parser.parse(n.formula,oB(-1,0,0));if(DV(r.ast))throw new fP;var o=r.ast,i=r.hasVolatileFunction,a=r.hasStructuralChangeFunction,s=r.dependencies;this.dependencyGraph.setFormulaToCell(e,o,Aj(s,e),VF.scalar(),i,a)}else n instanceof fV.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,t,n,r){if(e.sheet===r.sheet)return[];var o,i=[],a=FW(Cj.spanFrom(r,t,n).addresses(this.dependencyGraph));try{for(a.s();!(o=a.n()).done;){var s=o.value,u=this.addressMapping.fetchCell(s);if(u instanceof UY&&s.sheet!==e.sheet){var l=u.getFormula(this.lazilyTransformingAstService),c=this.parser.fetchCachedResultForAst(l).dependencies;i.push.apply(i,HW(this.updateNamedExpressionsForTargetAddress(e.sheet,s,c)))}}}catch(e){a.e(e)}finally{a.f()}return i}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,t,n){if(e===t.sheet)return[];var r,o=[],i=this.addressMapping.fetchCell(t),a=FW(Aj(n,t));try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof lj){var u=s.name,l=this.dependencyGraph.fetchNamedExpressionVertex(u,e),c=this.namedExpressions.isExpressionInScope(u,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(u,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(u,l,o);c!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,i),this.dependencyGraph.graph.addEdge(c,i))}}}catch(e){a.e(e)}finally{a.f()}return o}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new FU(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,t,n){var r=this.namedExpressions.namedExpressionForScope(e);if(void 0===r)if(r=this.namedExpressions.addNamedExpression(e),n.push(r.normalizeExpressionName()),t instanceof UY){var o=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),i=o.ast,a=o.hasVolatileFunction,s=o.hasStructuralChangeFunction,u=o.dependencies;this.dependencyGraph.setFormulaToCell(r.address,i,Aj(u,r.address),VF.scalar(),a,s)}else t instanceof OU?this.setCellEmpty(r.address):t instanceof LU&&this.setValueToCell(t.getValues(),r.address);return this.dependencyGraph.fetchCellOrCreateEmpty(r.address)}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}}]),e}();function qW(e){if(e.length<=1)return e;for(var t=HW(e).sort((function(e,t){return jW(e,1)[0]-jW(t,1)[0]})),n=t.reduce((function(e,t){var n=jW(t,2),r=n[0],o=n[1],i=e[e.length-1],a=i[0]+i[1];return r<=a?i[1]+=Math.max(0,o-(a-r)):e.push([r,o]),e}),[t[0]]),r=0,o=0;o<n.length;++o)n[o][0]-=r,r+=n[o][1];return n}function JW(e){if(e.length<=1)return e;for(var t=HW(e).sort((function(e,t){return jW(e,1)[0]-jW(t,1)[0]})),n=t.reduce((function(e,t){var n=jW(t,2),r=n[0],o=n[1],i=e[e.length-1];return r===i[0]?i[1]=Math.max(i[1],o):e.push([r,o]),e}),[t[0]]),r=0,o=0;o<n.length;++o)n[o][0]+=r,r+=n[o][1];return n}function QW(e){return Number.isInteger(e)&&e>0}function ZW(e){return ZW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZW(e)}function ez(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||nz(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tz(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=nz(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function nz(e,t){if(e){if("string"==typeof e)return rz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rz(e,t):void 0}}function rz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iz(e,t,n){return t&&oz(e.prototype,t),n&&oz(e,n),e}function az(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sz(e,t)}function sz(e,t){return sz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},sz(e,t)}function uz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cz(e);if(t){var o=cz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lz(this,n)}}function lz(e,t){if(t&&("object"===ZW(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cz(e){return cz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cz(e)}function fz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var hz=function e(){fz(this,e)},dz=function(e){az(n,e);var t=uz(n);function n(e,r){var o;return fz(this,n),(o=t.call(this)).command=e,o.rowsRemovals=r,o}return iz(n,[{key:"doUndo",value:function(e){e.undoRemoveRows(this)}},{key:"doRedo",value:function(e){e.redoRemoveRows(this)}}]),n}(hz),pz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i,a,s,u){var l;return fz(this,n),(l=t.call(this)).sourceLeftCorner=e,l.width=r,l.height=o,l.destinationLeftCorner=i,l.overwrittenCellsData=a,l.addedGlobalNamedExpressions=s,l.version=u,l}return iz(n,[{key:"doUndo",value:function(e){e.undoMoveCells(this)}},{key:"doRedo",value:function(e){e.redoMoveCells(this)}}]),n}(hz),mz=function(e){az(n,e);var t=uz(n);function n(e){var r;return fz(this,n),(r=t.call(this)).command=e,r}return iz(n,[{key:"doUndo",value:function(e){e.undoAddRows(this)}},{key:"doRedo",value:function(e){e.redoAddRows(this)}}]),n}(hz),yz=function(e){az(n,e);var t=uz(n);function n(e,r,o){var i;return fz(this,n),(i=t.call(this)).sheetId=e,i.rowMapping=r,i.oldContent=o,i}return iz(n,[{key:"doUndo",value:function(e){e.undoSetRowOrder(this)}},{key:"doRedo",value:function(e){e.redoSetRowOrder(this)}}]),n}(hz),vz=function(e){az(n,e);var t=uz(n);function n(e,r,o){var i;return fz(this,n),(i=t.call(this)).sheetId=e,i.columnMapping=r,i.oldContent=o,i}return iz(n,[{key:"doUndo",value:function(e){e.undoSetColumnOrder(this)}},{key:"doRedo",value:function(e){e.redoSetColumnOrder(this)}}]),n}(hz),gz=function(e){az(n,e);var t=uz(n);function n(e,r,o){var i;return fz(this,n),(i=t.call(this)).sheetId=e,i.oldSheetContent=r,i.newSheetContent=o,i}return iz(n,[{key:"doUndo",value:function(e){e.undoSetSheetContent(this)}},{key:"doRedo",value:function(e){e.redoSetSheetContent(this)}}]),n}(hz),bz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i,a){var s;return fz(this,n),(s=t.call(this)).sheet=e,s.startRow=r,s.numberOfRows=o,s.targetRow=i,s.version=a,s.undoStart=s.startRow<s.targetRow?s.targetRow-s.numberOfRows:s.targetRow,s.undoEnd=s.startRow>s.targetRow?s.startRow+s.numberOfRows:s.startRow,s}return iz(n,[{key:"doUndo",value:function(e){e.undoMoveRows(this)}},{key:"doRedo",value:function(e){e.redoMoveRows(this)}}]),n}(hz),wz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i,a){var s;return fz(this,n),(s=t.call(this)).sheet=e,s.startColumn=r,s.numberOfColumns=o,s.targetColumn=i,s.version=a,s.undoStart=s.startColumn<s.targetColumn?s.targetColumn-s.numberOfColumns:s.targetColumn,s.undoEnd=s.startColumn>s.targetColumn?s.startColumn+s.numberOfColumns:s.startColumn,s}return iz(n,[{key:"doUndo",value:function(e){e.undoMoveColumns(this)}},{key:"doRedo",value:function(e){e.redoMoveColumns(this)}}]),n}(hz),_z=function(e){az(n,e);var t=uz(n);function n(e){var r;return fz(this,n),(r=t.call(this)).command=e,r}return iz(n,[{key:"doUndo",value:function(e){e.undoAddColumns(this)}},{key:"doRedo",value:function(e){e.redoAddColumns(this)}}]),n}(hz),Sz=function(e){az(n,e);var t=uz(n);function n(e,r){var o;return fz(this,n),(o=t.call(this)).command=e,o.columnsRemovals=r,o}return iz(n,[{key:"doUndo",value:function(e){e.undoRemoveColumns(this)}},{key:"doRedo",value:function(e){e.redoRemoveColumns(this)}}]),n}(hz),Ez=function(e){az(n,e);var t=uz(n);function n(e){var r;return fz(this,n),(r=t.call(this)).sheetName=e,r}return iz(n,[{key:"doUndo",value:function(e){e.undoAddSheet(this)}},{key:"doRedo",value:function(e){e.redoAddSheet(this)}}]),n}(hz),kz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i,a){var s;return fz(this,n),(s=t.call(this)).sheetName=e,s.sheetId=r,s.oldSheetContent=o,s.scopedNamedExpressions=i,s.version=a,s}return iz(n,[{key:"doUndo",value:function(e){e.undoRemoveSheet(this)}},{key:"doRedo",value:function(e){e.redoRemoveSheet(this)}}]),n}(hz),Rz=function(e){az(n,e);var t=uz(n);function n(e,r,o){var i;return fz(this,n),(i=t.call(this)).sheetId=e,i.oldName=r,i.newName=o,i}return iz(n,[{key:"doUndo",value:function(e){e.undoRenameSheet(this)}},{key:"doRedo",value:function(e){e.redoRenameSheet(this)}}]),n}(hz),Tz=function(e){az(n,e);var t=uz(n);function n(e,r){var o;return fz(this,n),(o=t.call(this)).sheetId=e,o.oldSheetContent=r,o}return iz(n,[{key:"doUndo",value:function(e){e.undoClearSheet(this)}},{key:"doRedo",value:function(e){e.redoClearSheet(this)}}]),n}(hz),Cz=function(e){az(n,e);var t=uz(n);function n(e){var r;return fz(this,n),(r=t.call(this)).cellContents=e,r}return iz(n,[{key:"doUndo",value:function(e){e.undoSetCellContents(this)}},{key:"doRedo",value:function(e){e.redoSetCellContents(this)}}]),n}(hz),Mz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i){var a;return fz(this,n),(a=t.call(this)).targetLeftCorner=e,a.oldContent=r,a.newContent=o,a.addedGlobalNamedExpressions=i,a}return iz(n,[{key:"doUndo",value:function(e){e.undoPaste(this)}},{key:"doRedo",value:function(e){e.redoPaste(this)}}]),n}(hz),Oz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i){var a;return fz(this,n),(a=t.call(this)).name=e,a.newContent=r,a.scope=o,a.options=i,a}return iz(n,[{key:"doUndo",value:function(e){e.undoAddNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoAddNamedExpression(this)}}]),n}(hz),Az=function(e){az(n,e);var t=uz(n);function n(e,r,o){var i;return fz(this,n),(i=t.call(this)).namedExpression=e,i.content=r,i.scope=o,i}return iz(n,[{key:"doUndo",value:function(e){e.undoRemoveNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoRemoveNamedExpression(this)}}]),n}(hz),Lz=function(e){az(n,e);var t=uz(n);function n(e,r,o,i,a){var s;return fz(this,n),(s=t.call(this)).namedExpression=e,s.newContent=r,s.oldContent=o,s.scope=i,s.options=a,s}return iz(n,[{key:"doUndo",value:function(e){e.undoChangeNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoChangeNamedExpression(this)}}]),n}(hz),xz=function(e){az(n,e);var t=uz(n);function n(){var e;return fz(this,n),(e=t.apply(this,arguments)).operations=[],e}return iz(n,[{key:"add",value:function(e){this.operations.push(e)}},{key:"reversedOperations",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.operations.length-1;case 1:if(!(t>=0)){e.next=7;break}return e.next=4,this.operations[t];case 4:t--,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"doUndo",value:function(e){e.undoBatch(this)}},{key:"doRedo",value:function(e){e.redoBatch(this)}}]),n}(hz),Nz=function(){function e(t,n){fz(this,e),this.operations=n,this.undoStack=[],this.redoStack=[],this.oldData=new Map,this.undoLimit=t.undoLimit}return iz(e,[{key:"saveOperation",value:function(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new xz}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"commitBatchMode",value:function(){if(void 0===this.batchUndoEntry)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoEntry",value:function(e){e.doUndo(this)}},{key:"undoBatch",value:function(e){var t,n=tz(e.reversedOperations());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.undoEntry(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,n=e.rowsRemovals,r=n.length-1;r>=0;--r){var o=n[r];this.operations.addRows(new GW(t,[[o.rowFrom,o.rowCount]]));var i,a=tz(o.removedCells);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=s.address,l=s.cellType;this.operations.restoreCell(u,l)}}catch(e){a.e(e)}finally{a.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,n=e.columnsRemovals,r=n.length-1;r>=0;--r){var o=n[r];this.operations.addColumns(new KW(t,[[o.columnFrom,o.columnCount]]));var i,a=tz(o.removedCells);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=s.address,l=s.cellType;this.operations.restoreCell(u,l)}}catch(e){a.e(e)}finally{a.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoAddRows",value:function(e){for(var t=e.command.rowsSpans(),n=t.length-1;n>=0;--n){var r=t[n];this.operations.removeRows(new zW(e.command.sheet,[[r.rowStart,r.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var t=e.command.columnsSpans(),n=t.length-1;n>=0;--n){var r=t[n];this.operations.removeColumns(new XW(e.command.sheet,[[r.columnStart,r.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var t,n=tz(e.cellContents);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r.address,i=ez(r.oldContent,2),a=i[0],s=i[1];cB(o,a)||this.operations.setCellEmpty(o),this.operations.restoreCell(a,s)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoPaste",value:function(e){this.restoreOperationOldContent(e.oldContent);var t,n=tz(e.addedGlobalNamedExpressions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.removeNamedExpression(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoMoveRows",value:function(e){var t=e.sheet;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var t=e.sheet;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);var t,n=tz(e.addedGlobalNamedExpressions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.removeNamedExpression(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoAddSheet",value:function(e){var t=e.sheetName;this.operations.removeSheetByName(t)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var t=e.oldSheetContent,n=e.sheetId;this.operations.addSheet(e.sheetName);for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=oB(n,i,r);this.operations.restoreCell(s,a)}var u,l=tz(e.scopedNamedExpressions);try{for(l.s();!(u=l.n()).done;){var c=ez(u.value,2),f=c[0],h=c[1];this.operations.restoreNamedExpression(f,h,n)}}catch(e){l.e(e)}finally{l.f()}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var t=e.oldSheetContent,n=e.sheetId,r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=oB(n,i,r);this.operations.restoreCell(s,a)}}},{key:"undoSetSheetContent",value:function(e){var t=e.oldSheetContent,n=e.sheetId;this.operations.clearSheet(n);for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=oB(n,i,r);this.operations.restoreCell(s,a)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"undoSetRowOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"undoSetColumnOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"restoreOperationOldContent",value:function(e){var t,n=tz(e);try{for(n.s();!(t=n.n()).done;){var r=ez(t.value,2),o=r[0],i=r[1];this.operations.restoreCell(o,i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoEntry",value:function(e){e.doRedo(this)}},{key:"redoBatch",value:function(e){var t,n=tz(e.operations);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.redoEntry(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var t=e.targetLeftCorner,n=e.newContent,r=n.length,o=n[0].length,i=0;i<r;++i)for(var a=0;a<o;++a){var s=oB(t.sheet,t.col+a,t.row+i);this.operations.restoreCell(s,n[i][a])}}},{key:"redoSetCellContents",value:function(e){var t,n=tz(e.cellContents);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.setCellContent(r.address,r.newContent)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheetByName(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var t=e.sheetId,n=e.newSheetContent;this.operations.setSheetContent(t,n)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"redoSetRowOrder",value:function(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}},{key:"redoSetColumnOrder",value:function(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}},{key:"restoreOldDataFromVersion",value:function(e){var t,n=tz(this.oldData.get(e)||[]);try{for(n.s();!(t=n.n()).done;){var r=ez(t.value,2),o=r[0],i=r[1];this.operations.setFormulaToCellFromCache(i,o)}}catch(e){n.e(e)}finally{n.f()}}}]),e}();function Iz(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Pz(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dz(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Pz(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Pz(e,t){if(e){if("string"==typeof e)return Hz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hz(e,t):void 0}}function Hz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fz=function(){function e(t,n,r,o,i,a,s,u,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operations=n,this.undoRedo=r,this.clipboardOperations=o,this.dependencyGraph=i,this.columnSearch=a,this.parser=s,this.cellContentParser=u,this.lazilyTransformingAstService=l,this.namedExpressions=c,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}var t,n;return t=e,n=[{key:"addRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new GW(e,n);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(o),this.undoRedo.saveOperation(new mz(o))}},{key:"removeRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new zW(e,n);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.removeRows(o);this.undoRedo.saveOperation(new dz(o,i))}},{key:"addColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new KW(e,n);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(o),this.undoRedo.saveOperation(new _z(o))}},{key:"removeColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new XW(e,n);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.removeColumns(o);this.undoRedo.saveOperation(new Sz(o,i))}},{key:"moveCells",value:function(e,t,n,r){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveCells(e,t,n,r),i=o.version,a=o.overwrittenCellsData,s=o.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new pz(e,t,n,r,a,s,i))}},{key:"moveRows",value:function(e,t,n,r){this.ensureItIsPossibleToMoveRows(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveRows(e,t,n,r);this.undoRedo.saveOperation(new bz(e,t,n,r,o))}},{key:"moveColumns",value:function(e,t,n,r){this.ensureItIsPossibleToMoveColumns(e,t,n,r),this.undoRedo.clearRedoStack();var o=this.operations.moveColumns(e,t,n,r);this.undoRedo.saveOperation(new wz(e,t,n,r,o))}},{key:"cut",value:function(e,t,n){this.clipboardOperations.cut(e,t,n)}},{key:"ensureItIsPossibleToCopy",value:function(e,t,n){if(!Yz(t))throw new YD("width to be positive integer.");if(!Yz(n))throw new YD("height to be positive integer.")}},{key:"copy",value:function(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}},{key:"paste",value:function(e){var t=this.clipboardOperations.clipboard;if(void 0===t)throw new KD;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var n=Cj.spanFrom(e,t.width,t.height),r=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();var o=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new Mz(e,r,t.content,o))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return void 0===this.clipboardOperations.clipboard}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Ez(t)),t}},{key:"removeSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),r=this.operations.removeSheet(e),o=r.version,i=r.scopedNamedExpressions;this.undoRedo.saveOperation(new kz(t,e,n,i,o))}},{key:"renameSheet",value:function(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var n=this.operations.renameSheet(e,t);return void 0!==n&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Rz(e,n,t))),n}},{key:"clearSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Tz(e,t))}},{key:"setCellContents",value:function(e,t){if(t instanceof Array){for(var n=0;n<t.length;n++)if(!(t[n]instanceof Array))throw new YD("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();for(var r=[],o=0;o<t.length;o++)for(var i=0;i<t[o].length;i++){var a={sheet:e.sheet,row:e.row+o,col:e.col+i},s=t[o][i];this.clipboardOperations.abortCut();var u=this.operations.setCellContent(a,s);r.push({address:a,newContent:s,oldContent:u})}this.undoRedo.saveOperation(new Cz(r))}},{key:"setSheetContent",value:function(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),DW(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new gz(e,n,t))}},{key:"setRowOrder",value:function(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new yz(e,t,n))}},{key:"validateSwapRowIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);this.validateRowOrColumnMapping(e,t,"row")}},{key:"testColumnOrderForArrays",value:function(e,t){var n,r=Dz(t);try{for(r.s();!(n=r.n()).done;){var o=Iz(n.value,2),i=o[0];if(i!==o[1]){var a=Cj.spanFrom({sheet:e,col:i,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new lP}}}catch(e){r.e(e)}finally{r.f()}}},{key:"setColumnOrder",value:function(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new vz(e,t,n))}},{key:"validateSwapColumnIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);this.validateRowOrColumnMapping(e,t,"column")}},{key:"testRowOrderForArrays",value:function(e,t){var n,r=Dz(t);try{for(r.s();!(n=r.n()).done;){var o=Iz(n.value,2),i=o[0];if(i!==o[1]){var a=Cj.spanFrom({sheet:e,col:0,row:i},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new lP}}}catch(e){r.e(e)}finally{r.f()}}},{key:"mappingFromOrder",value:function(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==r)throw new YD("number of ".concat(n,"s provided to be sheet ").concat("row"===n?"height":"width","."));for(var o=[],i=0;i<r;i++)t[i]!==i&&o.push([i,t[i]]);return o}},{key:"validateRowOrColumnMapping",value:function(e,t,n){for(var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map((function(e){var t=Iz(e,2),n=t[0];return t[1],n})).sort((function(e,t){return e-t})),i=t.map((function(e){var t=Iz(e,2);return t[0],t[1]})).sort((function(e,t){return e-t})),a=0;a<o.length;a++){if(!Uz(o[a])||o[a]>=r)throw new YD("".concat(n," numbers to be nonnegative integers and less than sheet ").concat("row"===n?"height":"width","."));if(o[a]===o[a+1])throw new YD("source ".concat(n," numbers to be unique."));if(o[a]!==i[a])throw new YD("target ".concat(n," numbers to be permutation of source ").concat(n," numbers."))}}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new zD;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new GD;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,t,n,r){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Oz(e,t,n,r))}},{key:"changeNamedExpressionExpression",value:function(e,t,n,r){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);var o=Iz(this.operations.changeNamedExpressionExpression(e,n,t,r),2),i=o[0],a=o[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Lz(i,n,a,t,r))}},{key:"removeNamedExpression",value:function(e,t){this.ensureScopeIdIsValid(t);var n=Iz(this.operations.removeNamedExpression(e,t),2),r=n[0],o=n[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Az(r,o,t)),r}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,t,n){if(this.ensureScopeIdIsValid(n),void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new WD(e);this.ensureNamedExpressionIsValid(t)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new WD(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);for(var t=this.dependencyGraph.getSheetHeight(e),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+i>this.maxRows)throw new HD;for(var a=0,s=r;a<s.length;a++){var u=Iz(s[a],2),l=u[0],c=u[1];if(!Uz(l)||!Yz(c))throw new YD("row number to be nonnegative and number of rows to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=Iz(i[o],2),s=a[0],u=a[1],l=s+u-1;if(!Uz(s)||!Uz(l))throw new YD("starting and ending row to be nonnegative.");if(l<s)throw new YD("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e)}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);for(var t=this.dependencyGraph.getSheetWidth(e),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+i>this.maxColumns)throw new HD;for(var a=0,s=r;a<s.length;a++){var u=Iz(s[a],2),l=u[0],c=u[1];if(!Uz(l)||!Yz(c))throw new YD("column number to be nonnegative and number of columns to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=Iz(i[o],2),s=a[0],u=a[1],l=s+u-1;if(!Uz(s)||!Uz(l))throw new YD("starting and ending column to be nonnegative.");if(l<s)throw new YD("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e)}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,t,n,r){this.ensureItIsPossibleToAddRows(e,[r,n]);var o=oB(e,0,t),i=oB(e,0,r);if(!this.sheetMapping.hasSheetWithId(e)||iB(o)||iB(i)||!Yz(n)||r<=t+n&&r>=t)throw new YD("a valid range of rows to move.");var a=this.dependencyGraph.getSheetWidth(e),s=Cj.spanFrom(o,a,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new lP;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(dj.fromNumberOfRows(e,r-1,2)))throw new cP}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,t,n,r){this.ensureItIsPossibleToAddColumns(e,[r,n]);var o=oB(e,t,0),i=oB(e,r,0);if(!this.sheetMapping.hasSheetWithId(e)||iB(o)||iB(i)||!Yz(n)||r<=t+n&&r>=t)throw new YD("a valid range of columns to move.");var a=this.dependencyGraph.getSheetHeight(e),s=Cj.spanFrom(o,n,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new lP;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(pj.fromNumberOfColumns(e,r-1,2)))throw new cP}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new PD(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ID(e);var n=this.sheetMapping.get(t);if(void 0!==n&&n!==e)throw new PD(t)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if(iB(e))throw new FD(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new ID(e.sheet)}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,t){var n=PW(t),r=Cj.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(r);var o,i=Dz(r.addresses(this.dependencyGraph));try{for(i.s();!(o=i.n()).done;){var a=o.value;this.ensureItIsPossibleToChangeContent(a)}}catch(e){i.e(e)}finally{i.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,t){var n=PW(t),r=Cj.spanFrom(oB(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(r)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new HD}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureScopeIdIsValid",value:function(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new ID(e)}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"ensureNamedExpressionNameIsValid",value:function(e,t){if(!this.namedExpressions.isNameValid(e))throw new VD(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new BD(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var t=this.cellContentParser.parse(e);if(t instanceof fV.Formula){var n=this.parser.parse(t.formula,oB(-1,0,0));if(DV(n.ast))throw new fP}}}],n&&jz(t.prototype,n),e}();function Yz(e){return Number.isInteger(e)&&e>0}function Uz(e){return Number.isInteger(e)&&e>=0}function Bz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wz=function(){function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.stats=n,this.interpreter=r,this.lazilyTransformingAstService=o,this.dependencyGraph=i,this.columnSearch=a}var t,n;return t=e,n=[{key:"run",value:function(){var e=this;this.stats.start(QF.TOP_SORT);var t=this.dependencyGraph.topSortWithScc(),n=t.sorted,r=t.cycled;this.stats.end(QF.TOP_SORT),this.stats.measure(QF.EVALUATION,(function(){e.recomputeFormulas(r,n)}))}},{key:"partialRun",value:function(e){var t=this,n=ZF.empty();return this.stats.measure(QF.EVALUATION,(function(){t.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(function(e){if(e instanceof FY){var r=e.isComputed()?e.getCellValue():void 0,o=t.recomputeFormulaVertexValue(e);if(o!==r){var i=e.getAddress(t.lazilyTransformingAstService);return n.addChange(o,i),t.columnSearch.change(Wj(r),Wj(o),i),!0}return!1}return!(e instanceof WY&&(e.clearCache(),0))}),(function(e){if(e instanceof WY)e.clearCache();else if(e instanceof FY){var r=e.getAddress(t.lazilyTransformingAstService);t.columnSearch.remove(Wj(e.valueOrUndef()),r);var o=new ZU(BU.CYCLE,void 0,e);e.setCellValue(o),n.addChange(o,r)}}))})),n}},{key:"runAndForget",value:function(e,t,n){var r,o=this,i=[],a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Bz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bz(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(Aj(n,t));try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof Cj){var u=s;if(void 0===this.dependencyGraph.getRange(u.start,u.end)){var l=new WY(u);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}}}catch(e){a.e(e)}finally{a.f()}var c=this.evaluateAstToCellValue(e,new Lj(t,this.config.useArrayArithmetic));return i.forEach((function(e){o.dependencyGraph.rangeMapping.removeRange(e)})),c}},{key:"recomputeFormulas",value:function(e,t){var n=this;e.forEach((function(e){e instanceof FY&&e.setCellValue(new ZU(BU.CYCLE,void 0,e))})),t.forEach((function(e){if(e instanceof FY){var t=n.recomputeFormulaVertexValue(e),r=e.getAddress(n.lazilyTransformingAstService);n.columnSearch.add(Wj(t),r)}else e instanceof WY&&e.clearCache()}))}},{key:"recomputeFormulaVertexValue",value:function(e){var t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof YY&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();var n=e.getFormula(this.lazilyTransformingAstService),r=this.evaluateAstToCellValue(n,new Lj(t,this.config.useArrayArithmetic,e));return e.setCellValue(r)}},{key:"evaluateAstToCellValue",value:function(e,t){var n=this.interpreter.evaluateAst(e,t);return n instanceof XF?n:n===Vj&&this.config.evaluateNullToZero?0:n}}],n&&Vz(t.prototype,n),e}();function zz(e,t){if(e){if("string"==typeof e)return Gz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gz(e,t):void 0}}function Gz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $z(e,t,n){return t&&Xz(e.prototype,t),n&&Xz(e,n),e}n(59630);var qz=function(){function e(t,n){Kz(this,e),this.address=t,this.newValue=n}return $z(e,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),e}(),Jz=function e(t,n){Kz(this,e),this.name=t,this.newValue=n},Qz=function(){function e(t,n,r,o){Kz(this,e),this.config=t,this.namedExpressions=n,this.sheetIndexMapping=r,this.lazilyTransformingService=o}return $z(e,[{key:"exportChange",value:function(e){var t,n,r=e.value,o=e.address;if(o.sheet===IV.SHEET_FOR_WORKBOOK_EXPRESSIONS){var i=this.namedExpressions.namedExpressionInAddress(o.row);if(!i)throw new Error("Missing named expression");return new Jz(i.displayName,this.exportScalarOrRange(r))}if(r instanceof XF){var a,s=[],u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=zz(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(r.entriesFromTopLeftCorner(o));try{for(u.s();!(a=u.n()).done;){var l=(t=a.value,n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||zz(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],f=l[1];s.push(new qz(f,this.exportValue(c)))}}catch(e){u.e(e)}finally{u.f()}return s}return new qz(o,this.exportValue(r))}},{key:"exportValue",value:function(e){return e instanceof XF?this.detailedError(new ZU(BU.VALUE,IH.ScalarExpected)):this.config.smartRounding&&Zj(e)?this.cellValueRounding(Wj(e)):e instanceof ZU?this.detailedError(e):e===Vj?null:Wj(e)}},{key:"exportScalarOrRange",value:function(e){var t=this;return e instanceof XF?e.rawData().map((function(e){return e.map((function(e){return t.exportValue(e)}))})):this.exportValue(e)}},{key:"detailedError",value:function(e){var t,n,r=void 0,o=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==o&&(r=o.sheet===IV.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(n=this.namedExpressions.namedExpressionInAddress(o.row))||void 0===n?void 0:n.displayName:fH(this.sheetIndexMapping,o,-1)),new hB(e,this.config.translationPackage.getErrorTranslation(e.type),r)}},{key:"cellValueRounding",value:function(e){if(0===e)return e;var t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}]),e}();function Zz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tG(e,t,n){return t&&eG(e.prototype,t),n&&eG(e,n),e}var nG=function(){function e(t,n,r,o,i,a){Zz(this,e),this.dependencyGraph=t,this.columnSearch=n,this.parser=r,this.cellContentParser=o,this.stats=i,this.arraySizePredictor=a,this.buildStrategy=new rG(t,n,r,i,o,a)}return tG(e,[{key:"buildGraph",value:function(e,t){var n=this,r=t.measure(QF.COLLECT_DEPENDENCIES,(function(){return n.buildStrategy.run(e)}));this.dependencyGraph.getAndClearContentChanges(),t.measure(QF.PROCESS_DEPENDENCIES,(function(){return n.processDependencies(r)}))}},{key:"processDependencies",value:function(e){var t=this;e.forEach((function(e,n){t.dependencyGraph.processCellDependencies(e,n)}))}}]),e}(),rG=function(){function e(t,n,r,o,i,a){Zz(this,e),this.dependencyGraph=t,this.columnIndex=n,this.parser=r,this.stats=o,this.cellContentParser=i,this.arraySizePredictor=a}return tG(e,[{key:"run",value:function(e){var t=this,n=new Map;for(var r in e)for(var o=this.dependencyGraph.getSheetId(r),i=e[r],a=0;a<i.length;++a)for(var s=i[a],u=function(e){var r=s[e],i=oB(o,e,a),u=t.cellContentParser.parse(r);if(u instanceof fV.Formula){var l=t.stats.measure(QF.PARSER,(function(){return t.parser.parse(u.formula,i)}));if(l.errors.length>0){t.shrinkArrayIfNeeded(i);var c=new NU(l.errors,u.formula);t.dependencyGraph.addVertex(i,c)}else{t.shrinkArrayIfNeeded(i);var f=t.arraySizePredictor.checkArraySize(l.ast,i);if(f.isScalar()){var h=new UY(l.ast,i,0);n.set(h,Aj(l.dependencies,i)),t.dependencyGraph.addVertex(i,h),l.hasVolatileFunction&&t.dependencyGraph.markAsVolatile(h),l.hasStructuralChangeFunction&&t.dependencyGraph.markAsDependentOnStructureChange(h)}else{var d=new YY(l.ast,i,new VF(f.width,f.height));n.set(d,Aj(l.dependencies,i)),t.dependencyGraph.addArrayVertex(i,d)}}}else if(u instanceof fV.Empty);else{t.shrinkArrayIfNeeded(i);var p=new LU(u.value,r);t.columnIndex.add(Wj(u.value),i),t.dependencyGraph.addVertex(i,p)}},l=0;l<s.length;++l)u(l);return n}},{key:"shrinkArrayIfNeeded",value:function(e){var t=this.dependencyGraph.getCell(e);t instanceof YY&&this.dependencyGraph.shrinkArrayToCorner(t)}}]),e}();function oG(e){return oG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oG(e)}function iG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sG(e,t){return sG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},sG(e,t)}function uG(e,t){if(t&&("object"===oG(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function lG(e){return lG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lG(e)}var cG=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]),fG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sG(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lG(r);if(o){var n=lG(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return uG(this,e)});function a(){return iG(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"version",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("VERSION"),(function(){var e,t=n.config,r=t.licenseKeyValidityState,o=t.licenseKey;return cG.has(o)?e=cG.get(o):cG.has(r)?e=cG.get(r):"valid"===r&&(e=o.slice(-5)),"HyperFormula v".concat(xK.version,", ").concat(e)}))}}])&&aG(t.prototype,n),a}(PF);function hG(e){return function(e){if(Array.isArray(e))return yG(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||mG(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dG(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||mG(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pG(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=mG(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function mG(e,t){if(e){if("string"==typeof e)return yG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yG(e,t):void 0}}function yG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gG(e,t){var n,r=t.implementedFunctions[e],o=null===(n=t.aliases)||void 0===n?void 0:n[e];if(void 0!==o){if(void 0!==r)throw new hP(e,t.name);r=t.implementedFunctions[o]}if(void 0===r)throw sP.functionNotDeclaredInPlugin(e,t.name);return r}fG.implementedFunctions={VERSION:{method:"version",parameters:[]}};var bG,wG=function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=function(e){return n.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e)},this.isFunctionVolatile=function(e){return n.volatileFunctions.has(e)},this.isArrayFunction=function(e){return n.arrayFunctions.has(e)},this.isFunctionDependentOnSheetStructureChange=function(e){return n.structuralChangeFunctions.has(e)},t.functionPlugins.length>0){this.instancePlugins=new Map;var r,o=pG(t.functionPlugins);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.loadPluginFunctions(i,this.instancePlugins)}}catch(e){o.e(e)}finally{o.f()}}else this.instancePlugins=new Map(e.plugins);var a,s=pG(e.protectedFunctions());try{for(s.s();!(a=s.n()).done;){var u=dG(a.value,2),l=u[0],c=u[1];e.loadFunctionUnprotected(c,l,this.instancePlugins)}}catch(e){s.e(e)}finally{s.f()}var f,h=pG(this.instancePlugins.entries());try{for(h.s();!(f=h.n()).done;){var d=dG(f.value,2),p=d[0],m=d[1];this.categorizeFunction(p,gG(p,m))}}catch(e){h.e(e)}finally{h.f()}}var t,n,r;return t=e,n=[{key:"initializePlugins",value:function(e){var t,n=this,r=[],o=pG(this.instancePlugins.entries());try{var i=function(){var o=dG(t.value,2),i=o[0],a=o[1],s=r.find((function(e){return e instanceof a}));void 0===s&&(s=new a(e),r.push(s));var u=gG(i,a),l=u.method;n.functions.set(i,[l,s]);var c=u.arraySizeMethod;void 0!==c&&n.arraySizeFunctions.set(i,[c,s])};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}}},{key:"getFunctionPlugin",value:function(t){if(!e.functionIsProtected(t))return this.instancePlugins.get(t)}},{key:"getFunction",value:function(e){var t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){var n=dG(t,2),r=n[0],o=n[1];return function(e,t){return o[r](e,t)}}}},{key:"getArraySizeFunction",value:function(e){var t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){var n=dG(t,2),r=n[0],o=n[1];return function(e,t){return o[r](e,t)}}}},{key:"getMetadata",value:function(e){return this.functionsMetadata.get(e)}},{key:"getPlugins",value:function(){var t,n=new Set,r=pG(this.instancePlugins);try{for(r.s();!(t=r.n()).done;){var o=dG(t.value,2),i=o[0],a=o[1];e.functionIsProtected(i)||n.add(a)}}catch(e){r.e(e)}finally{r.f()}return Array.from(n)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}],r=[{key:"registerFunctionPlugin",value:function(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}},{key:"registerFunction",value:function(e,t,n){this.loadPluginFunction(t,e,this.plugins),void 0!==n&&this.loadTranslations(n)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw uP.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var t,n=pG(this.protectedPlugins());try{for(n.s();!(t=n.n()).done;)if(t.value===e)throw uP.cannotUnregisterProtectedPlugin()}catch(e){n.e(e)}finally{n.f()}var r,o=pG(this.plugins.entries());try{for(o.s();!(r=o.n()).done;){var i=dG(r.value,2),a=i[0];i[1]===e&&this.plugins.delete(a)}}catch(e){o.e(e)}finally{o.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(hG(Array.from(this.plugins.keys())),hG(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}},{key:"loadTranslations",value:function(e){var t=new Set(xK.getRegisteredLanguagesCodes());Object.keys(e).forEach((function(n){t.has(n)&&xK.getLanguage(n).extendFunctions(e[n])}))}},{key:"loadPluginFunctions",value:function(e,t){var n=this;Object.keys(e.implementedFunctions).forEach((function(r){n.loadPluginFunction(e,r,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((function(r){n.loadPluginFunction(e,r,t)}))}},{key:"loadPluginFunction",value:function(e,t,n){if(this.functionIsProtected(t))throw uP.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}},{key:"loadFunctionUnprotected",value:function(e,t,n){var r=gG(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,r))throw sP.functionMethodNotFound(r,e.name);n.set(t,e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"protectedFunctions",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=pG(this._protectedPlugins),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(r=dG(n.value,2),o=r[0],void 0===(i=r[1])){e.next=8;break}return e.next=8,[o,i];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"protectedPlugins",value:regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=pG(this._protectedPlugins),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(r=dG(n.value,2),void 0===(o=r[1])){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))}],n&&vG(t.prototype,n),r&&vG(t,r),e}();function _G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}wG.plugins=new Map,wG._protectedPlugins=new Map([["VERSION",fG],["OFFSET",void 0]]),function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(bG||(bG={}));var SG=function(e,t){return{operator:e,value:t}},EG=function(){function e(t){var n,r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trueString=null!==(r=null===(n=t.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"true",this.falseString=null!==(i=null===(o=t.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===o?void 0:o.toLowerCase())&&void 0!==i?i:"false"}var t,n;return t=e,n=[{key:"fromCellValue",value:function(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var n=this.parseCriterion(e,t);if(void 0!==n)return{raw:e,lambda:RG(n,t)}}}},{key:"parseCriterion",value:function(e,t){if("number"==typeof e||"boolean"==typeof e)return SG(bG.EQUAL,e);if("string"==typeof e){var n,r,o=kG.exec(e);o?(r=function(e){switch(e){case">":return bG.GREATER_THAN;case">=":return bG.GREATER_THAN_OR_EQUAL;case"<":return bG.LESS_THAN;case"<=":return bG.LESS_THAN_OR_EQUAL;case"<>":return bG.NOT_EQUAL;case"=":return bG.EQUAL;default:return}}(o[1]),n=o[2]):(r=bG.EQUAL,n=e);var i=t.coerceToMaybeNumber(n),a=n.toLowerCase()===this.trueString||n.toLowerCase()!==this.falseString&&void 0;if(void 0===r)return;if(""===n)return SG(r,null);if(void 0!==i)return SG(r,Wj(i));if(r===bG.EQUAL||r===bG.NOT_EQUAL)return SG(r,null!=a?a:n)}}}],n&&_G(t.prototype,n),e}(),kG=/([<>=]+)(.*)/,RG=function(e,t){switch(e.operator){case bG.GREATER_THAN:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)>0}:function(e){return!1};case bG.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)>=0}:function(e){return!1};case bG.LESS_THAN:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)<0}:function(e){return!1};case bG.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)<=0}:function(e){return!1};case bG.EQUAL:return"number"==typeof e.value?function(n){if("number"==typeof n)return 0===t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!1;var r=t.coerceToMaybeNumber(n);return void 0!==r&&0===t.floatCmp(r,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"==typeof t&&t===e.value}:function(e){return e===Vj};case bG.NOT_EQUAL:return"number"==typeof e.value?function(n){if("number"==typeof n)return 0!==t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!0;var r=t.coerceToMaybeNumber(n);return void 0===r||0!==t.floatCmp(r,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"!=typeof t||t!==e.value}:function(e){return e!==Vj}}};function TG(e){return function(e){if(Array.isArray(e))return AG(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||OG(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CG(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=OG(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function MG(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||OG(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OG(e,t){if(e){if("string"==typeof e)return AG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AG(e,t):void 0}}function AG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xG=function(){function e(t,n,r,o,i,a,s,u,l,c){var f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.dependencyGraph=n,this.columnSearch=r,this.stats=o,this.arithmeticHelper=i,this.functionRegistry=a,this.namedExpressions=s,this.serialization=u,this.arraySizePredictor=l,this.dateTimeHelper=c,this.equalOp=function(e,t){return IG(f.arithmeticHelper.eq,e,t)},this.notEqualOp=function(e,t){return IG(f.arithmeticHelper.neq,e,t)},this.greaterThanOp=function(e,t){return IG(f.arithmeticHelper.gt,e,t)},this.lessThanOp=function(e,t){return IG(f.arithmeticHelper.lt,e,t)},this.greaterThanOrEqualOp=function(e,t){return IG(f.arithmeticHelper.geq,e,t)},this.lessThanOrEqualOp=function(e,t){return IG(f.arithmeticHelper.leq,e,t)},this.concatOp=function(e,t){return IG(f.arithmeticHelper.concat,dF(e),dF(t))},this.plusOp=function(e,t){return IG(f.arithmeticHelper.addWithEpsilon,f.arithmeticHelper.coerceScalarToNumberOrError(e),f.arithmeticHelper.coerceScalarToNumberOrError(t))},this.minusOp=function(e,t){return IG(f.arithmeticHelper.subtract,f.arithmeticHelper.coerceScalarToNumberOrError(e),f.arithmeticHelper.coerceScalarToNumberOrError(t))},this.timesOp=function(e,t){return IG(f.arithmeticHelper.multiply,f.arithmeticHelper.coerceScalarToNumberOrError(e),f.arithmeticHelper.coerceScalarToNumberOrError(t))},this.powerOp=function(e,t){return IG(f.arithmeticHelper.pow,f.arithmeticHelper.coerceScalarToNumberOrError(e),f.arithmeticHelper.coerceScalarToNumberOrError(t))},this.divOp=function(e,t){return IG(f.arithmeticHelper.divide,f.arithmeticHelper.coerceScalarToNumberOrError(e),f.arithmeticHelper.coerceScalarToNumberOrError(t))},this.unaryMinusOp=function(e){return NG(f.arithmeticHelper.unaryMinus,f.arithmeticHelper.coerceScalarToNumberOrError(e))},this.percentOp=function(e){return NG(f.arithmeticHelper.unaryPercent,f.arithmeticHelper.coerceScalarToNumberOrError(e))},this.unaryPlusOp=function(e){return f.arithmeticHelper.unaryPlus(e)},this.functionRegistry.initializePlugins(this),this.criterionBuilder=new EG(t)}var t,n;return t=e,n=[{key:"evaluateAst",value:function(e,t){var n=this.evaluateAstWithoutPostprocessing(e,t);if(Zj(n)){if(yF(Wj(n)))return new ZU(BU.NUM,IH.NaN);n=Gj(n,vF(Wj(n)))}if(n instanceof XF&&1===n.height()&&1===n.width()){var r=MG(n.data,1);n=MG(r[0],1)[0]}return function(e,t){return e instanceof ZU&&void 0!==t?e.attachRootVertex(t):e}(n,t.formulaVertex)}},{key:"evaluateAstWithoutPostprocessing",value:function(e,t){switch(e.type){case vH.EMPTY:return Vj;case vH.CELL_REFERENCE:var n=e.reference.toSimpleCellAddress(t.formulaAddress);return iB(n)?new ZU(BU.REF,IH.BadRef):this.dependencyGraph.getCellValue(n);case vH.NUMBER:case vH.STRING:return e.value;case vH.CONCATENATE_OP:var r=this.evaluateAst(e.left,t),o=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,o,t);case vH.EQUALS_OP:var i=this.evaluateAst(e.left,t),a=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,i,a,t);case vH.NOT_EQUAL_OP:var s=this.evaluateAst(e.left,t),u=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,s,u,t);case vH.GREATER_THAN_OP:var l=this.evaluateAst(e.left,t),c=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,l,c,t);case vH.LESS_THAN_OP:var f=this.evaluateAst(e.left,t),h=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,f,h,t);case vH.GREATER_THAN_OR_EQUAL_OP:var d=this.evaluateAst(e.left,t),p=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,d,p,t);case vH.LESS_THAN_OR_EQUAL_OP:var m=this.evaluateAst(e.left,t),y=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,m,y,t);case vH.PLUS_OP:var v=this.evaluateAst(e.left,t),g=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,v,g,t);case vH.MINUS_OP:var b=this.evaluateAst(e.left,t),w=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,b,w,t);case vH.TIMES_OP:var _=this.evaluateAst(e.left,t),S=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,_,S,t);case vH.POWER_OP:var E=this.evaluateAst(e.left,t),k=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,E,k,t);case vH.DIV_OP:var R=this.evaluateAst(e.left,t),T=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,R,T,t);case vH.PLUS_UNARY_OP:var C=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,C,t);case vH.MINUS_UNARY_OP:var M=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,M,t);case vH.PERCENT_OP:var O=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,O,t);case vH.FUNCTION_CALL:if("valid"!==this.config.licenseKeyValidityState&&!wG.functionIsProtected(e.procedureName))return new ZU(BU.LIC,IH.LicenseKey(this.config.licenseKeyValidityState));var A=this.functionRegistry.getFunction(e.procedureName);return void 0!==A?A(e,new Lj(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new ZU(BU.NAME,IH.FunctionName(e.procedureName));case vH.NAMED_EXPRESSION:var L=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return L?this.dependencyGraph.getCellValue(L.address):new ZU(BU.NAME,IH.NamedExpressionName(e.expressionName));case vH.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new ZU(BU.REF,IH.RangeManySheets);var x=Cj.fromCellRange(e,t.formulaAddress),N=this.dependencyGraph.getArray(x);if(N){var I=N.array;if(I instanceof TY)throw new Error("Array should be already computed");if(I instanceof ZU)return I;if(I instanceof CY)return XF.fromRange(I.raw(),x,this.dependencyGraph);throw new Error("Unknown array")}return XF.onlyRange(x,this.dependencyGraph);case vH.COLUMN_RANGE:if(!this.rangeSpansOneSheet(e))return new ZU(BU.REF,IH.RangeManySheets);var D=Mj.fromColumnRange(e,t.formulaAddress);return XF.onlyRange(D,this.dependencyGraph);case vH.ROW_RANGE:if(!this.rangeSpansOneSheet(e))return new ZU(BU.REF,IH.RangeManySheets);var P=Oj.fromRowRangeAst(e,t.formulaAddress);return XF.onlyRange(P,this.dependencyGraph);case vH.PARENTHESIS:return this.evaluateAst(e.expression,t);case vH.ARRAY:var H,j=void 0,F=[],Y=CG(e.args);try{for(Y.s();!(H=Y.n()).done;){var U,B=H.value,V=void 0,W=[],z=CG(B);try{for(z.s();!(U=z.n()).done;){var G=U.value,K=lF(this.evaluateAst(G,t)),X=K.height();if(void 0===V)V=X,W.push.apply(W,TG(K.data));else{if(V!==X)return new ZU(BU.REF,IH.SizeMismatch);for(var $=0;$<X;$++){var q;(q=W[$]).push.apply(q,TG(K.data[$]))}}}}catch(e){z.e(e)}finally{z.f()}var J=W[0].length;if(void 0===j)j=J,F.push.apply(F,W);else{if(j!==J)return new ZU(BU.REF,IH.SizeMismatch);F.push.apply(F,W)}}}catch(e){Y.e(e)}finally{Y.f()}return XF.onlyValues(F);case vH.ERROR_WITH_RAW_INPUT:case vH.ERROR:return e.error}}},{key:"getGpuInstance",value:function(){var e=this.config.gpuMode,t=this.config.gpujs;if(void 0===t)throw Error("Cannot instantiate GPU.js. Constructor not provided.");return this.gpu||(this.gpu=new t({mode:e})),this.gpu}},{key:"destroyGpu",value:function(){var e;null===(e=this.gpu)||void 0===e||e.destroy()}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}},{key:"unaryRangeWrapper",value:function(e,t,n){var r;if(t instanceof XF&&!n.arraysFlag&&(t=null!==(r=MF(t,n))&&void 0!==r?r:new ZU(BU.VALUE,IH.ScalarExpected)),t instanceof ZU)return t;if(t instanceof XF){var o=t.data.map((function(t){return t.map(e)}));return XF.onlyValues(o)}return e(t)}},{key:"binaryRangeWrapper",value:function(e,t,n,r){var o,i;if(t instanceof XF&&!r.arraysFlag&&(t=null!==(o=MF(t,r))&&void 0!==o?o:new ZU(BU.VALUE,IH.ScalarExpected)),t instanceof ZU)return t;if(n instanceof XF&&!r.arraysFlag&&(n=null!==(i=MF(n,r))&&void 0!==i?i:new ZU(BU.VALUE,IH.ScalarExpected)),n instanceof ZU)return n;if(t instanceof XF||n instanceof XF){if(!(t instanceof XF)){if(n.isAdHoc()){for(var a=n.data,s=0;s<a.length;s++)for(var u=0;u<a[0].length;u++)a[s][u]=e(t,a[s][u]);return XF.onlyValues(a)}t=XF.fromScalar(t)}if(!(n instanceof XF)){if(t.isAdHoc()){for(var l=t.data,c=0;c<l.length;c++)for(var f=0;f<l[0].length;f++)l[c][f]=e(l[c][f],n);return XF.onlyValues(l)}n=XF.fromScalar(n)}if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){for(var h=t.data,d=n.data,p=0;p<h.length;p++)for(var m=0;m<h[0].length;m++)h[p][m]=e(h[p][m],d[p][m]);return XF.onlyValues(h)}if(n.isAdHoc()){for(var y=t.data,v=n.data,g=0;g<y.length;g++)for(var b=0;b<y[0].length;b++)v[g][b]=e(y[g][b],v[g][b]);return XF.onlyValues(v)}}for(var w=Math.max(t.width(),n.width()),_=Math.max(t.height(),n.height()),S=Array(_),E=0;E<_;E++)S[E]=Array(w);for(var k=0;k<_;k++)for(var R=1!==t.height()?k:0,T=1!==n.height()?k:0,C=0;C<w;C++){var M=1!==t.width()?C:0,O=1!==n.width()?C:0;R<t.height()&&T<n.height()&&M<t.width()&&O<n.width()?S[k][C]=e(t.data[R][M],n.data[T][O]):S[k][C]=new ZU(BU.NA)}return XF.onlyValues(S)}return e(t,n)}}],n&&LG(t.prototype,n),e}();function NG(e,t){return t instanceof ZU?t:e(t)}function IG(e,t,n){return t instanceof ZU?t:n instanceof ZU?n:e(t,n)}function DG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var HG=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.transformations=[]}var t,n;return t=e,n=[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,t){this.transformations.forEach((function(n){return n.performEagerTransformations(e,t)}))}},{key:"transformSingleAst",value:function(e,t){var n=e,r=t;return this.transformations.forEach((function(e){var t,o,i=(t=e.transformSingleAst(n,r),o=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,o)||function(e,t){if(e){if("string"==typeof e)return DG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DG(e,t):void 0}}(t,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());n=i[0],r=i[1]})),[n,r]}},{key:"isIrreversible",value:function(){return!0}}],n&&PG(t.prototype,n),e}();function jG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var YG=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=t,this.transformations=[]}var t,n;return t=e,n=[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new HG(e)}},{key:"commitCombinedMode",value:function(){if(void 0===this.combinedTransformer)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,t,n){this.stats.start(QF.TRANSFORM_ASTS_POSTPONED);for(var r=n;r<this.transformations.length;r++){var o=this.transformations[r];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(r,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var i=(a=o.transformSingleAst(e,t),s=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(a,s)||function(e,t){if(e){if("string"==typeof e)return jG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jG(e,t):void 0}}(a,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());e=i[0],t=i[1]}var a,s,u=this.parser.rememberNewAst(e);return this.stats.end(QF.TRANSFORM_ASTS_POSTPONED),[u,t,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t;case 1:if(!(r<this.transformations.length)){e.next=9;break}if(o=this.transformations[r],n&&!n(o)){e.next=6;break}return e.next=6,o;case 6:r++,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))}],n&&FG(t.prototype,n),e}();function UG(e){return UG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UG(e)}function BG(e,t,n,r){var o;o="col"===r?e.effectiveEndColumn(n):e.effectiveEndRow(n);var i,a=e.start[r],s=function(e,t,n,r){for(;n<=r;){var o=Math.floor((n+r)/2),i=VG(t,e(o));if(i>0)n=o+1;else if(i<0)r=o-1;else{if(n==o)return o;r=o}}return r}(i="row"===r?function(t){return Wj(n.getCellValue(oB(e.sheet,e.start.col,t)))}:function(t){return Wj(n.getCellValue(oB(e.sheet,t,e.start.row)))},t,a,o);return UG(i(s))!==UG(t)?-1:s-a}function VG(e,t){return UG(e)===UG(t)?e===Vj?0:e<t?-1:e>t?1:0:e===Vj?-1:t===Vj?1:t instanceof ZU||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}function WG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zG=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t}var t,n;return t=e,n=[{key:"advancedFind",value:function(e,t){var n,r=t.range;n=void 0===r?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(r);for(var o=0;o<n.length;o++)if(e(Wj(n[o])))return o;return-1}}],n&&WG(t.prototype,n),e}();function GG(e){return GG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GG(e)}function KG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XG(e,t){return XG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},XG(e,t)}function $G(e,t){if(t&&("object"===GG(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qG(e){return qG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qG(e)}var JG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XG(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qG(r);if(o){var n=qG(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $G(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e)).dependencyGraph=e,n.config=t,n}return t=a,n=[{key:"add",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"change",value:function(e,t,n){}},{key:"applyChanges",value:function(e){}},{key:"addColumns",value:function(e){}},{key:"removeColumns",value:function(e){}},{key:"removeSheet",value:function(e){}},{key:"moveValues",value:function(e,t,n,r){}},{key:"removeValues",value:function(e){}},{key:"find",value:function(e,t,n){"string"==typeof e&&(e=CF(e));var r=t.range;return void 0===r?t.valuesFromTopLeftCorner().map(Wj).map((function(e){return"string"==typeof e?CF(e):e})).indexOf(e):n?BG(r,e,this.dependencyGraph,"row"):this.dependencyGraph.computeListOfValuesInRange(r).findIndex((function(t){return(t="string"==typeof(t=Wj(t))?CF(t):t)===e}))}}],n&&KG(t.prototype,n),a}(zG);function QG(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||eK(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZG(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=eK(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function eK(e,t){if(e){if("string"==typeof e)return tK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tK(e,t):void 0}}function tK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rK=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.config=n,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new JG(t,n)}var t,n;return t=e,n=[{key:"add",value:function(e,t){if(!(e===Vj||e instanceof ZU))if(e instanceof XF){var n,r=ZG(e.entriesFromTopLeftCorner(t));try{for(r.s();!(n=r.n()).done;){var o=QG(n.value,2),i=o[0],a=o[1];this.addSingleCellValue(Wj(i),a)}}catch(e){r.e(e)}finally{r.f()}}else this.addSingleCellValue(e,t)}},{key:"remove",value:function(e,t){if(void 0!==e)if(e instanceof XF){var n,r=ZG(e.entriesFromTopLeftCorner(t));try{for(r.s();!(n=r.n()).done;){var o=QG(n.value,2),i=o[0],a=o[1];this.removeSingleValue(Wj(i),a)}}catch(e){r.e(e)}finally{r.f()}}else this.removeSingleValue(e,t)}},{key:"change",value:function(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}},{key:"applyChanges",value:function(e){var t,n=ZG(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;void 0!==r.oldValue&&this.change(Wj(r.oldValue),Wj(r.value),r.address)}}catch(e){n.e(e)}finally{n.f()}}},{key:"moveValues",value:function(e,t,n,r){var o,i=ZG(e);try{for(i.s();!(o=i.n()).done;){var a=QG(o.value,2),s=a[0],u=a[1],l=aB(u,r,t,n);this.remove(s,u),this.add(s,l)}}catch(e){i.e(e)}finally{i.f()}}},{key:"removeValues",value:function(e){var t,n=ZG(e);try{for(n.s();!(t=n.n()).done;){var r=QG(t.value,2),o=r[0],i=r[1];this.remove(o,i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"find",value:function(e,t,n){var r=t.range;if(void 0===r)return this.binarySearchStrategy.find(e,t,n);this.ensureRecentData(r.sheet,r.start.col,e);var o=this.getColumnMap(r.sheet,r.start.col);if(!o)return-1;"string"==typeof e&&(e=CF(e));var i=o.get(e);if(!i)return this.binarySearchStrategy.find(e,t,n);var a=oK(i.index,r.start.row),s=i.index[a];return s<=r.end.row?s-r.start.row:this.binarySearchStrategy.find(e,t,n)}},{key:"advancedFind",value:function(e,t){return this.binarySearchStrategy.advancedFind(e,t)}},{key:"addColumns",value:function(e){var t,n=this.index.get(e.sheet);n&&n.splice.apply(n,[e.columnStart,0].concat(function(e){if(Array.isArray(e))return tK(e)}(t=Array(e.numberOfColumns))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||eK(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}},{key:"removeColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,t){this.index.has(e)||this.index.set(e,[]);var n=this.index.get(e),r=n[t];return r||(r=new Map,n[t]=r),r}},{key:"getValueIndex",value:function(e,t,n){var r=this.getColumnMap(e,t),o=this.getColumnMap(e,t).get(n);return o||(o={version:this.transformingService.version(),index:[]},r.set(n,o)),o}},{key:"ensureRecentData",value:function(e,t,n){var r=this.getValueIndex(e,t,n),o=this.transformingService.version();if(r.version!==o){var i,a=this.transformingService.getTransformationsFrom(r.version,(function(t){return t.sheet===e&&(t instanceof JV||t instanceof TW)})),s=ZG(a);try{for(s.s();!(i=s.n()).done;){var u=i.value;u instanceof JV?this.addRows(t,u.rowsSpan,n):u instanceof TW&&this.removeRows(t,u.rowsSpan,n)}}catch(e){s.e(e)}finally{s.f()}r.version=o}}},{key:"addSingleCellValue",value:function(e,t){var n=this;this.stats.measure(QF.BUILD_COLUMN_INDEX,(function(){n.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=CF(e));var r=n.getValueIndex(t.sheet,t.col,e);n.addValue(r,t.row)}))}},{key:"removeSingleValue",value:function(e,t){var n=this;this.stats.measure(QF.BUILD_COLUMN_INDEX,(function(){n.ensureRecentData(t.sheet,t.col,e);var r=n.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=CF(e));var o=r.get(e);if(o){var i=oK(o.index,t.row);o.index.splice(i,1),0===o.index.length&&r.delete(e),0===r.size&&delete n.index.get(t.sheet)[t.col]}}))}},{key:"addRows",value:function(e,t,n){var r=this.getValueIndex(t.sheet,e,n);this.shiftRows(r,t.rowStart,t.numberOfRows)}},{key:"removeRows",value:function(e,t,n){var r=this.getValueIndex(t.sheet,e,n);this.removeRowsFromValues(r,t),this.shiftRows(r,t.rowEnd+1,-t.numberOfRows)}},{key:"addValue",value:function(e,t){var n=iK(e.index,t);e.index[n]!==t&&(n===e.index.length-1?e.index.push(t):e.index.splice(n+1,0,t))}},{key:"removeRowsFromValues",value:function(e,t){var n=oK(e.index,t.rowStart),r=iK(e.index,t.rowEnd);e.index[n]<=t.rowEnd&&e.index.splice(n,r-n+1)}},{key:"shiftRows",value:function(e,t,n){for(var r=oK(e.index,t);r<e.index.length;++r)e.index[r]+=n}}],n&&nK(t.prototype,n),e}();function oK(e,t){for(var n=0,r=e.length-1;n<=r;){var o=Math.floor((n+r)/2);if(t>e[o])n=o+1;else{if(!(t<e[o]))return o;r=o-1}}return n}function iK(e,t){for(var n=0,r=e.length-1;n<=r;){var o=Math.floor((n+r)/2);if(t>e[o])n=o+1;else{if(!(t<e[o]))return o;r=o-1}}return r}function aK(e,t,n){return t.useColumnIndex?new rK(e,t,n):new JG(e,t)}function sK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var uK=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t;var n="."===this.config.thousandSeparator?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,r="."===this.config.decimalSeparator?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(r,"\\d+)|(\\d+(").concat(n,"\\d{3,})*(").concat(r,"\\d*)?)))(e[+-]?\\d+)?$")),this.allThousandSeparatorsRegex=new RegExp("".concat(n),"g")}var t,n;return t=e,n=[{key:"numericStringToMaybeNumber",value:function(e){if(this.numberPattern.test(e)){var t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}},{key:"numericStringToNumber",value:function(e){var t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}],n&&sK(t.prototype,n),e}();function lK(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return cK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cK(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function cK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hK=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.unparser=n,this.exporter=r}var t,n;return t=e,n=[{key:"getCellFormula",value:function(e,t){var n=this.dependencyGraph.getCell(e);if(n instanceof UY){var r=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(r,t)}if(n instanceof YY){var o=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(o.row!==e.row||o.col!==e.col||o.sheet!==e.sheet)return;t=null!=t?t:e;var i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==i)return this.unparser.unparse(i,t)}else if(n instanceof NU)return n.getFormula()}},{key:"getCellSerialized",value:function(e,t){var n;return null!==(n=this.getCellFormula(e,t))&&void 0!==n?n:this.getRawValue(e)}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getRawValue",value:function(e){return this.dependencyGraph.getRawValue(e)}},{key:"getSheetValues",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellValue(e)}))}},{key:"getSheetFormulas",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellFormula(e)}))}},{key:"genericSheetGetter",value:function(e,t){for(var n=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),o=new Array(n),i=0;i<n;i++){o[i]=new Array(r);for(var a=0;a<r;a++){var s=oB(e,a,i);o[i][a]=t(s)}for(var u=r-1;u>=0&&(null===o[i][u]||void 0===o[i][u]);u--)o[i].pop()}for(var l=n-1;l>=0&&0===o[l].length;l--)o.pop();return o}},{key:"genericAllSheetsGetter",value:function(e){var t,n={},r=lK(this.dependencyGraph.sheetMapping.displayNames());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.dependencyGraph.sheetMapping.fetch(o);n[o]=e(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getSheetSerialized",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellSerialized(e)}))}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetValues(t)}))}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetFormulas(t)}))}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetSerialized(t)}))}},{key:"getAllNamedExpressionsSerialized",value:function(){var e,t=this,n=[],r=0,o=lK(this.dependencyGraph.sheetMapping.displayNames());try{for(o.s();!(e=o.n()).done;){var i=e.value,a=this.dependencyGraph.sheetMapping.fetch(i);n[a]=r,r++}}catch(e){o.e(e)}finally{o.f()}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((function(e){return{name:e.expression.displayName,expression:t.getCellSerialized(e.expression.address),scope:void 0!==e.scope?n[e.scope]:void 0,options:e.expression.options}}))}},{key:"withNewConfig",value:function(t,n){var r=new XH(t,ZP(t),this.dependencyGraph.sheetMapping.fetchDisplayName,n);return new e(this.dependencyGraph,r,this.exporter)}}],n&&fK(t.prototype,n),e}();function dK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mK=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"buildEngine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.useStats?new tY:new uY;r.start(QF.BUILD_ENGINE_TOTAL);var o=new IV,i=new wG(e),a=new YG(r),s=CU.buildEmpty(a,e,i,o,r),u=aK(s,e,r),l=s.sheetMapping,c=s.addressMapping;for(var f in t)if(Object.prototype.hasOwnProperty.call(t,f)){var h=t[f];DW(h);var d=PW(h);if(d.height>e.maxRows||d.width>e.maxColumns)throw new HD;var p=l.addSheet(f);c.autoAddSheet(p,h,d)}var m=new ZH(e,i,l.get);a.parser=m;var y=new XH(e,ZP(e),l.fetchDisplayName,o),v=new IB(e),g=new uK(e),b=new sF(e,v,g),w=new SV(e,v,g),_=new WF(e,i),S=new $W(e,s,u,w,m,r,a,o,_),E=new Nz(e,S);a.undoRedo=E;var k=new CV(e,s,S),R=new Fz(e,S,E,k,s,u,m,w,a,o);n.forEach((function(e){R.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),R.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)}));var T=new Qz(e,o,l.fetchDisplayName,a),C=new hK(s,y,T),M=new xG(e,s,u,r,b,i,o,C,_,v);r.measure(QF.GRAPH_BUILD,(function(){new nG(s,u,m,w,r,_).buildGraph(t,r)}));var O=new Wz(e,r,M,a,s,u);return O.run(),r.end(QF.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:s,columnSearch:u,parser:m,unparser:y,cellContentParser:w,evaluator:O,lazilyTransformingAstService:a,crudOperations:R,exporter:T,namedExpressions:o,serialization:C,functionRegistry:i}}},{key:"buildFromSheets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=new FK(t);return this.buildEngine(r,e,n)}},{key:"buildFromSheet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=new FK(t),o=r.translationPackage.getUITranslation(uU.NEW_SHEET_PREFIX)+"1";return this.buildEngine(r,dK({},o,e),n)}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.buildEngine(new FK(e),{},t)}},{key:"rebuildWithConfig",value:function(e,t,n,r){return this.buildEngine(e,t,n,r)}}],null&&pK(t.prototype,null),n&&pK(t,n),e}();function yK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vK(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this HyperFormula instance has been destroyed'))}}n(86737);var gK,bK=n(70438);function wK(e){return wK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wK(e)}function _K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EK(e,t,n){return EK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},EK(e,t,n||e)}function kK(e,t){return kK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kK(e,t)}function RK(e,t){if(t&&("object"===wK(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function TK(e){return TK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},TK(e)}!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(gK||(gK={}));var CK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kK(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=TK(r);if(o){var n=TK(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return RK(this,e)});function a(){return _K(this,a),i.apply(this,arguments)}return t=a,n=[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=EK(TK(a.prototype),"emit",this)).call.apply(t,[this,e].concat(r)),this}}],n&&SK(t.prototype,n),a}(bK.TinyEmitter);function MK(e){return function(e){if(Array.isArray(e))return AK(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||OK(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OK(e,t){if(e){if("string"==typeof e)return AK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AK(e,t):void 0}}function AK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xK=function(){function e(t,n,r,o,i,a,s,u,l,c,f,h,d,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._stats=n,this._dependencyGraph=r,this._columnSearch=o,this._parser=i,this._unparser=a,this._cellContentParser=s,this._evaluator=u,this._lazilyTransformingAstService=l,this._crudOperations=c,this._exporter=f,this._namedExpressions=h,this._serialization=d,this._functionRegistry=p,this._emitter=new CK,this._evaluationSuspended=!1}var t,n,r;return t=e,n=[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"arrayMapping",get:function(){return this.dependencyGraph.arrayMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new nP}},{key:"getCellFormula",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return _B(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return _B(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return _B(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter((function(t){return e.getSheetDimensions(t)}))}},{key:"getSheetDimensions",value:function(e){return _B(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),r=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),i=mK.rebuildWithConfig(t,r,o,this._stats);this._config=i.config,this._stats=i.stats,this._dependencyGraph=i.dependencyGraph,this._columnSearch=i.columnSearch,this._parser=i.parser,this._unparser=i.unparser,this._cellContentParser=i.cellContentParser,this._evaluator=i.evaluator,this._lazilyTransformingAstService=i.lazilyTransformingAstService,this._crudOperations=i.crudOperations,this._exporter=i.exporter,this._namedExpressions=i.namedExpressions,this._serialization=i.serialization,this._functionRegistry=i.functionRegistry}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var t;if(uB(e))t=new Cj(e,e);else{if(!Rj(e))throw new JD("SimpleCellAddress | SimpleCellRange","address");t=new Cj(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=OK(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(t.addresses(this._dependencyGraph));try{for(r.s();!(n=r.n()).done;){var o=n.value;this._crudOperations.ensureItIsPossibleToChangeContent(o)}}catch(e){r.e(e)}finally{r.f()}}catch(e){return!1}return!0}},{key:"setCellContents",value:function(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,t){return _B(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,t){_B(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(e){return!1}}},{key:"setRowOrder",value:function(e,t){_B(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}},{key:"isItPossibleToSetRowOrder",value:function(e,t){_B(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(e){return!1}}},{key:"swapColumnIndexes",value:function(e,t){return _B(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,t){_B(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(e){return!1}}},{key:"setColumnOrder",value:function(e,t){_B(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}},{key:"isItPossibleToSetColumnOrder",value:function(e,t){_B(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(e){return!1}}},{key:"isItPossibleToAddRows",value:function(e){_B(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=JW(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToAddRows.apply(i,[e].concat(MK(o))),!0}catch(e){return!1}}},{key:"addRows",value:function(e){var t;_B(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).addRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){_B(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=qW(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(i,[e].concat(MK(o))),!0}catch(e){return!1}}},{key:"removeRows",value:function(e){var t;_B(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).removeRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){_B(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=JW(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToAddColumns.apply(i,[e].concat(MK(o))),!0}catch(e){return!1}}},{key:"addColumns",value:function(e){var t;_B(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).addColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){_B(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=qW(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(i,[e].concat(MK(o))),!0}catch(e){return!1}}},{key:"removeColumns",value:function(e){var t;_B(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).removeColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,t){if(!uB(t))throw new JD("SimpleCellAddress","destinationLeftCorner");if(!Rj(e))throw new JD("SimpleCellRange","source");try{var n=new Cj(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch(e){return!1}}},{key:"moveCells",value:function(e,t){if(!uB(t))throw new JD("SimpleCellAddress","destinationLeftCorner");if(!Rj(e))throw new JD("SimpleCellRange","source");var n=new Cj(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,t,n,r){_B(e,"number","sheetId"),_B(t,"number","startRow"),_B(n,"number","numberOfRows"),_B(r,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(e){return!1}}},{key:"moveRows",value:function(e,t,n,r){return _B(e,"number","sheetId"),_B(t,"number","startRow"),_B(n,"number","numberOfRows"),_B(r,"number","targetRow"),this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,t,n,r){_B(e,"number","sheetId"),_B(t,"number","startColumn"),_B(n,"number","numberOfColumns"),_B(r,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(e){return!1}}},{key:"moveColumns",value:function(e,t,n,r){return _B(e,"number","sheetId"),_B(t,"number","startColumn"),_B(n,"number","numberOfColumns"),_B(r,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e){if(!Rj(e))throw new JD("SimpleCellRange","source");var t=new Cj(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}},{key:"cut",value:function(e){if(!Rj(e))throw new JD("SimpleCellRange","source");var t=new Cj(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}},{key:"paste",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e){var t=this;if(!Rj(e))throw new JD("SimpleCellRange","source");return new Cj(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellValue(e)}))}))}},{key:"getRangeFormulas",value:function(e){var t=this;if(!Rj(e))throw new JD("SimpleCellRange","source");return new Cj(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellFormula(e)}))}))}},{key:"getRangeSerialized",value:function(e){var t=this;if(!Rj(e))throw new JD("SimpleCellRange","source");return new Cj(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellSerialized(e)}))}))}},{key:"getFillRangeData",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Rj(e))throw new JD("SimpleCellRange","source");if(!Rj(t))throw new JD("SimpleCellRange","target");var o=new Cj(e.start,e.end),i=new Cj(t.start,t.end);if(o.sheet!==i.sheet)throw new UD(o.sheet,i.sheet);return this.ensureEvaluationIsNotSuspended(),i.arrayOfAddressesInRange().map((function(a){return a.map((function(a){var s=((a.row-(r?t:e).start.row)%o.height()+o.height())%o.height()+e.start.row,u=((a.col-(r?t:e).start.col)%o.width()+o.width())%o.width()+e.start.col;return n._serialization.getCellSerialized({row:s,col:u,sheet:i.sheet},a)}))}))}},{key:"isItPossibleToAddSheet",value:function(e){_B(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}},{key:"addSheet",value:function(e){void 0!==e&&_B(e,"string","sheetName");var t=this._crudOperations.addSheet(e);return this._emitter.emit(gK.SheetAdded,t),t}},{key:"isItPossibleToRemoveSheet",value:function(e){_B(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}},{key:"removeSheet",value:function(e){_B(e,"number","sheetId");var t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(gK.SheetRemoved,t,n),n}},{key:"isItPossibleToClearSheet",value:function(e){_B(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}},{key:"clearSheet",value:function(e){return _B(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,t){_B(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(e){return!1}}},{key:"setSheetContent",value:function(e,t){return _B(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,t){return _B(e,"string","cellAddress"),_B(t,"number","sheetId"),cH(this.sheetMapping.get,e,t)}},{key:"simpleCellRangeFromString",value:function(e,t){return _B(e,"string","cellRange"),_B(t,"number","sheetId"),function(e,t,n){var r,o,i=t.split(wP);if(2===i.length){var a=(o=2,function(e){if(Array.isArray(e))return e}(r=i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(r,o)||function(e,t){if(e){if("string"==typeof e)return nH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nH(e,t):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],u=a[1],l=cH(e,s,n);if(void 0!==l){var c=cH(e,u,l.sheet);if(void 0!==c&&l.sheet===c.sheet)return Tj(l,c)}}}(this.sheetMapping.get,e,t)}},{key:"simpleCellAddressToString",value:function(e,t){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return _B(t,"number","sheetId"),fH(this.sheetMapping.fetchDisplayName,e,t)}},{key:"simpleCellRangeToString",value:function(e,t){if(!Rj(e))throw new JD("SimpleCellRange","cellRange");return _B(t,"number","sheetId"),n=this.sheetMapping.fetchDisplayName,o=t,i=fH(n,(r=e).start,o),a=fH(n,r.end,r.start.sheet),void 0===i||void 0===a?void 0:"".concat(i).concat(wP).concat(a);var n,r,o,i,a}},{key:"getCellDependents",value:function(e){var t;if(uB(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!Rj(e))throw new JD("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}},{key:"getCellPrecedents",value:function(e){var t;if(uB(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!Rj(e))throw new JD("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}},{key:"getSheetName",value:function(e){return _B(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return _B(e,"string","sheetName"),this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return _B(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return t=this.dependencyGraph.getCell(e),n=e,t instanceof YY?t.isLeftCorner(n)?VU.ARRAYFORMULA:VU.ARRAY:t instanceof UY||t instanceof NU?VU.FORMULA:t instanceof LU?VU.VALUE:VU.EMPTY;var t,n}},{key:"doesCellHaveSimpleValue",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return this.getCellType(e)===VU.VALUE}},{key:"doesCellHaveFormula",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");var t=this.getCellType(e);return t===VU.FORMULA||t===VU.ARRAYFORMULA}},{key:"isCellEmpty",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");return this.getCellType(e)===VU.EMPTY}},{key:"isCellPartOfArray",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");var t=this.getCellType(e);return t===VU.ARRAY||t===VU.ARRAYFORMULA}},{key:"getCellValueType",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return QU(t)}},{key:"getCellValueDetailedType",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t,n,r=this.dependencyGraph.getCellValue(e);return Zj(t=r)?(n=t)instanceof zj?n.getDetailedType():Kj.NUMBER_RAW:QU(t)}},{key:"getCellValueFormat",value:function(e){if(!uB(e))throw new JD("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t,n,r=this.dependencyGraph.getCellValue(e);return Zj(t=r)&&(n=t)instanceof zj?n.format:void 0}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,t){_B(e,"number","sheetId"),_B(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}},{key:"renameSheet",value:function(e,t){_B(e,"number","sheetId"),_B(t,"string","newName");var n=this._crudOperations.renameSheet(e,t);void 0!==n&&this._emitter.emit(gK.SheetRenamed,n,t)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(gK.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(gK.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,t,n){_B(e,"string","expressionName"),void 0!==n&&_B(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(e){return!1}}},{key:"addNamedExpression",value:function(e,t,n,r){_B(e,"string","expressionName"),void 0!==n&&_B(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,r);var o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(gK.NamedExpressionAdded,e,o),o}},{key:"getNamedExpressionValue",value:function(e,t){_B(e,"string","expressionName"),void 0!==t&&_B(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);var n=this._namedExpressions.namedExpressionForScope(e,t);return n?this._serialization.getCellValue(n.address):void 0}},{key:"getNamedExpressionFormula",value:function(e,t){_B(e,"string","expressionName"),void 0!==t&&_B(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);var n=this._namedExpressions.namedExpressionForScope(e,t);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}},{key:"getNamedExpression",value:function(e,t){_B(e,"string","expressionName"),void 0!==t&&_B(t,"number","scope");var n=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==n)return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,t,n){_B(e,"string","expressionName"),void 0!==n&&_B(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(e){return!1}}},{key:"changeNamedExpression",value:function(e,t,n,r){return _B(e,"string","expressionName"),void 0!==n&&_B(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){_B(e,"string","expressionName"),void 0!==t&&_B(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}},{key:"removeNamedExpression",value:function(e,t){_B(e,"string","expressionName"),void 0!==t&&_B(t,"number","scope");var n=this._crudOperations.removeNamedExpression(e,t);if(n){var r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(gK.NamedExpressionRemoved,n.displayName,r),r}return[]}},{key:"listNamedExpressions",value:function(e){return void 0!==e&&_B(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}},{key:"getAllNamedExpressionsSerialized",value:function(){return this._serialization.getAllNamedExpressionsSerialized()}},{key:"normalizeFormula",value:function(e){_B(e,"string","formulaString");var t=this.extractTemporaryFormula(e),n=t.ast,r=t.address;if(void 0===n)throw new jD;return this._unparser.unparse(n,r)}},{key:"calculateFormula",value:function(e,t){_B(e,"string","formulaString"),_B(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);var n=this.extractTemporaryFormula(e,t),r=n.ast,o=n.address,i=n.dependencies;if(void 0===r)throw new jD;var a=this.evaluator.runAndForget(r,o,i);return this._exporter.exportScalarOrRange(a)}},{key:"validateFormula",value:function(e){_B(e,"string","formulaString");var t=this.extractTemporaryFormula(e).ast;return void 0!==t&&!(t.type===vH.ERROR&&!t.error)}},{key:"getRegisteredFunctionNames",value:function(){return e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return _B(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return _B(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return _B(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return _B(e,"number","val"),HB(e)}},{key:"extractTemporaryFormula",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this._cellContentParser.parse(e),r={sheet:t,col:0,row:0};if(!(n instanceof fV.Formula))return{address:r,dependencies:[]};var o=this._parser.parse(n.formula,r),i=o.ast,a=o.errors,s=o.dependencies;return a.length>0?{address:r,dependencies:[]}:{ast:i,address:r,dependencies:s}}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"destroy",value:function(){this._evaluator.interpreter.destroyGpu(),function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(a=n[t],s=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(a,s)||function(e,t){if(e){if("string"==typeof e)return yK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yK(e,t):void 0}}(a,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];i instanceof Function?e[o]=vK(i):delete e[o]}var a,s}(this)}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));var n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(gK.ValuesUpdated,n),n}}],r=[{key:"buildFromEngineState",value:function(t){return new e(t.config,t.stats,t.dependencyGraph,t.columnSearch,t.parser,t.unparser,t.cellContentParser,t.evaluator,t.lazilyTransformingAstService,t.crudOperations,t.exporter,t.namedExpressions,t.serialization,t.functionRegistry)}},{key:"buildFromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.buildFromEngineState(mK.buildFromSheet(e,t,n))}},{key:"buildFromSheets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.buildFromEngineState(mK.buildFromSheets(e,t,n))}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.buildFromEngineState(mK.buildEmpty(e,t))}},{key:"getLanguage",value:function(e){_B(e,"string","languageCode");var t=this.registeredLanguages.get(e);if(void 0===t)throw new iP;return t}},{key:"registerLanguage",value:function(e,t){if(_B(e,"string","languageCode"),this.registeredLanguages.has(e))throw new aP;var n;this.registeredLanguages.set(e,(n=t,new lU(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))))}},{key:"unregisterLanguage",value:function(e){if(_B(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new iP;this.registeredLanguages.delete(e)}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,t){wG.registerFunctionPlugin(e,t)}},{key:"unregisterFunctionPlugin",value:function(e){wG.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,t,n){_B(e,"string","functionId"),wG.registerFunction(e,t,n)}},{key:"unregisterFunction",value:function(e){_B(e,"string","functionId"),wG.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){wG.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){_B(e,"string","code");var t=wG.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}},{key:"getFunctionPlugin",value:function(e){return _B(e,"string","functionId"),wG.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return wG.getPlugins()}}],n&&LK(t.prototype,n),r&&LK(t,r),e}();function NK(e){return function(e){if(Array.isArray(e))return IK(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return IK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IK(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function DK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}xK.version="1.2.0",xK.buildDate="23/09/2021 13:29:51",xK.releaseDate="23/09/2021",xK.languages={},xK.registeredLanguages=new Map;var HK=["gpu","cpu","dev"],jK=new WeakMap,FK=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.accentSensitive,r=t.binarySearchThreshold,o=t.caseSensitive,i=t.caseFirst,a=t.chooseAddressMappingPolicy,s=t.currencySymbol,u=t.dateFormats,l=t.decimalSeparator,c=t.evaluateNullToZero,f=t.functionArgSeparator,h=t.functionPlugins,d=t.gpujs,p=t.gpuMode,m=t.ignorePunctuation,y=t.leapYear1900,v=t.localeLang,g=t.language,b=t.licenseKey,w=t.matchWholeCell,_=t.arrayColumnSeparator,S=t.arrayRowSeparator,E=t.maxRows,k=t.maxColumns,R=t.nullYear,T=t.nullDate,C=t.parseDateTime,M=t.precisionEpsilon,O=t.precisionRounding,A=t.stringifyDateTime,L=t.stringifyDuration,x=t.smartRounding,N=t.timeFormats,I=t.thousandSeparator,D=t.useArrayArithmetic,P=t.useStats,H=t.undoLimit,j=t.useColumnIndex,F=t.useRegularExpressions,Y=t.useWildcards;DK(this,e),this.useArrayArithmetic=yB(D,"boolean","useArrayArithmetic"),this.accentSensitive=yB(n,"boolean","accentSensitive"),this.caseSensitive=yB(o,"boolean","caseSensitive"),this.caseFirst=yB(i,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=yB(m,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=a?a:e.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=NK(bB(u,Array.isArray,"array","dateFormats")),this.timeFormats=NK(bB(N,Array.isArray,"array","timeFormats")),this.functionArgSeparator=yB(f,"string","functionArgSeparator"),this.decimalSeparator=yB(l,[".",","],"decimalSeparator"),this.language=yB(g,"string","language"),this.licenseKey=yB(b,"string","licenseKey"),this.thousandSeparator=yB(I,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=yB(_,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=yB(S,[";","|"],"arrayRowSeparator"),this.localeLang=yB(v,"string","localeLang"),this.functionPlugins=NK(null!=h?h:e.defaultConfig.functionPlugins),this.gpujs=null!=d?d:e.defaultConfig.gpujs,this.gpuMode=yB(p,HK,"gpuMode"),this.smartRounding=yB(x,"boolean","smartRounding"),this.evaluateNullToZero=yB(c,"boolean","evaluateNullToZero"),this.nullYear=yB(R,"number","nullYear"),vB(this.nullYear,"nullYear",0),gB(this.nullYear,"nullYear",100),this.precisionRounding=yB(O,"number","precisionRounding"),vB(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=yB(M,"number","precisionEpsilon"),vB(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=yB(j,"boolean","useColumnIndex"),this.useStats=yB(P,"boolean","useStats"),this.binarySearchThreshold=yB(r,"number","binarySearchThreshold"),vB(this.binarySearchThreshold,"binarySearchThreshold",1),this.parseDateTime=yB(C,"function","parseDateTime"),this.stringifyDateTime=yB(A,"function","stringifyDateTime"),this.stringifyDuration=yB(L,"function","stringifyDuration"),this.translationPackage=xK.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=bB(T,LB,"IDate","nullDate"),this.leapYear1900=yB(y,"boolean","leapYear1900"),this.undoLimit=yB(H,"number","undoLimit"),this.useRegularExpressions=yB(F,"boolean","useRegularExpressions"),this.useWildcards=yB(Y,"boolean","useWildcards"),this.matchWholeCell=yB(w,"boolean","matchWholeCell"),vB(this.undoLimit,"undoLimit",0),this.maxRows=yB(E,"number","maxRows"),vB(this.maxRows,"maxRows",1),this.maxColumns=yB(k,"number","maxColumns"),this.currencySymbol=NK(bB(s,Array.isArray,"array","currencySymbol")),this.currencySymbol.forEach((function(e){if("string"!=typeof e)throw new JD("string[]","currencySymbol");if(""===e)throw new QD("currencySymbol")})),vB(this.maxColumns,"maxColumns",1),this.warnDeprecatedIfUsed(r,"binarySearchThreshold","1.1"),this.warnDeprecatedIfUsed(d,"gpujs","1.2"),p!==e.defaultConfig.gpuMode&&this.warnDeprecatedIfUsed(p,"gpuMode","1.2"),jK.set(this,{licenseKeyValidityState:pV(this.licenseKey)}),wB({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),wB({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}var t,n;return t=e,(n=[{key:"licenseKeyValidityState",get:function(){return jK.get(this).licenseKeyValidityState}},{key:"getConfig",value:function(){var t={};for(var n in e.defaultConfig){var r=this[n];Array.isArray(r)?t[n]=NK(r):t[n]=r}return t}},{key:"mergeConfig",value:function(t){return new e(Object.assign({},this.getConfig(),t))}},{key:"warnDeprecatedIfUsed",value:function(e,t,n,r){void 0!==e&&(void 0===r?console.warn("".concat(t," option is deprecated since ").concat(n)):console.warn("".concat(t," option is deprecated since ").concat(n,", please use ").concat(r)))}}])&&PK(t.prototype,n),e}();FK.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new VB,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],gpujs:void 0,gpuMode:"gpu",ignorePunctuation:!1,language:"enGB",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:function(e,t,n){var r=(e=e.replace(/\s\s+/g," ").trim().toLowerCase()).substring(e.length-2);"am"===r||"pm"===r?e=e.substring(0,e.length-2).trim():"a"===(r=e.substring(e.length-1))||"p"===r?e=e.substring(0,e.length-1).trim():r=void 0;var o=e.split(/[ /.-]/g);o.length>=2&&o[o.length-2].includes(":")&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());var i=o[o.length-1].split(":");if(void 0!==r&&i.push(r),1===o.length)return EB(i,n);if(1===i.length)return kB(o,t);var a=kB(o.slice(0,o.length-1),t),s=EB(i,n);return void 0===a||void 0===s?void 0:Object.assign(Object.assign({},a),s)},precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:function(e,t){var n=XB(t);if(void 0!==n){for(var r=n.tokens,o="",i=!1,a=r.some((function(e){return e.type===UB.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)})),s=0;s<r.length;s++){var u=r[s];if(u.type!==UB.FREE_TEXT)if(SB.test(u.value)){var l=u.value.length-3;o+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,l))/Math.pow(10,l)}else switch(u.value.toLowerCase()){case"h":case"hh":i=!0,o+=eV(a?(e.hours+11)%12+1:e.hours,u.value.length);break;case"d":case"dd":o+=eV(e.day,u.value.length);break;case"s":case"ss":o+=eV(Math.round(e.seconds),u.value.length);break;case"m":case"mm":s+1<r.length&&r[s+1].value.startsWith(":")&&(i=!0),o+=eV(i?e.minutes:e.month,u.value.length),i=!0;break;case"yy":o+=eV(e.year%100,u.value.length);break;case"yyyy":o+=e.year;break;case"am/pm":case"a/p":var c=qB(u.value.split("/"),2),f=c[0],h=c[1];o+=e.hours<12?f:h;break;default:return}else o+=u.value}return o}},stringifyDuration:function(e,t){var n=XB(t);if(void 0!==n){var r,o="",i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=JB(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(n.tokens);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.type!==UB.FREE_TEXT)if(SB.test(a.value)){var s=a.value.length-3;o+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,s))/Math.pow(10,s)}else switch(a.value.toLowerCase()){case"h":case"hh":o+=eV(e.hours,a.value.length),e.hours=0;break;case"[hh]":o+=eV(e.hours,a.value.length-2),e.hours=0;break;case"m":case"mm":o+=eV(e.minutes,a.value.length),e.minutes=0;break;case"[mm]":o+=eV(e.minutes+60*e.hours,a.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":o+=eV(e.seconds,a.value.length);break;default:return}else o+=a.value}}catch(e){i.e(e)}finally{i.f()}return o}},timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};const YK={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};function UK(e){return UK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UK(e)}function BK(e){return function(e){if(Array.isArray(e))return zK(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||WK(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VK(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=WK(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function WK(e,t){if(e){if("string"==typeof e)return zK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zK(e,t):void 0}}function zK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function GK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XK(e,t){return XK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},XK(e,t)}function $K(e,t){if(t&&("object"===UK(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qK(e){return qK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qK(e)}var JK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XK(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qK(r);if(o){var n=qK(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $K(this,e)});function a(){return GK(this,a),i.apply(this,arguments)}return t=a,n=[{key:"arrayformula",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),(function(e){return e}))}},{key:"arrayformulaArraySize",value:function(e,t){var n=this;if(1!==e.args.length)return VF.error();var r=this.metadata("ARRAYFORMULA");return e.args.map((function(e){var o;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))}))[0]}},{key:"arrayconstrain",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(function(e,t,n){t=Math.min(t,e.height()),n=Math.min(n,e.width());for(var r=e.data,o=[],i=0;i<t;i++)o.push(r[i].slice(0,n));return XF.onlyValues(o)}))}},{key:"arrayconstrainArraySize",value:function(e,t){var n=this;if(3!==e.args.length)return VF.error();var r=this.metadata("ARRAY_CONSTRAIN"),o=e.args.map((function(e){var o;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))}))[0],i=o.height,a=o.width;return e.args[1].type===vH.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===vH.NUMBER&&(a=Math.min(a,e.args[2].value)),i<1||a<1||!Number.isInteger(i)||!Number.isInteger(a)?VF.error():new VF(a,i)}},{key:"filter",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=i[o];if(e.width()!==a.width()||e.height()!==a.height())return new ZU(BU.NA,IH.EqualLength)}if(e.width()>1&&e.height()>1)return new ZU(BU.NA,IH.WrongDimension);for(var s=e.data,u=[],l=0;l<e.height();l++){for(var c=[],f=0;f<e.width();f++){var h,d=!0,p=VK(n);try{for(p.s();!(h=p.n()).done;){var m=h.value,y=hF(m.data[l][f]);if(!0!==y){d=!1;break}}}catch(e){p.e(e)}finally{p.f()}d&&c.push(s[l][f])}c.length>0&&u.push(c)}return u.length>0?XF.onlyValues(u):new ZU(BU.NA,IH.EmptyRange)}))}},{key:"filterArraySize",value:function(e,t){var n=this;if(e.args.length<=1)return VF.error();var r=this.metadata("FILTER"),o=e.args.map((function(e){var o;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))})),i=Math.max.apply(Math,BK(o.map((function(e){return e.width})))),a=Math.max.apply(Math,BK(o.map((function(e){return e.height}))));return new VF(i,a)}}],n&&KK(t.prototype,n),a}(PF);function QK(e){return QK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QK(e)}function ZK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tX(e,t){return tX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tX(e,t)}function nX(e,t){if(t&&("object"===QK(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function rX(e){return rX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rX(e)}JK.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:bF.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:bF.RANGE},{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}],repeatLastArgs:1}};var oX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rX(r);if(o){var n=rX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return nX(this,e)});function a(){return ZK(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"abs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}])&&eX(t.prototype,n),a}(PF);function iX(e){return iX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iX(e)}function aX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uX(e,t){return uX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},uX(e,t)}function lX(e,t){if(t&&("object"===iX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cX(e){return cX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cX(e)}oX.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:bF.NUMBER}]}};var fX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cX(r);if(o){var n=cX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return lX(this,e)});function a(){return aX(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"bitlshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),hX)}},{key:"bitrshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),dX)}}])&&sX(t.prototype,n),a}(PF);function hX(e,t){return t<0?dX(e,-t):pX(e*Math.pow(2,t))}function dX(e,t){return t<0?hX(e,-t):pX(Math.floor(e/Math.pow(2,t)))}function pX(e){return e>0xffffffffffff?new ZU(BU.NUM,IH.BitshiftLong):e}function mX(e){return mX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mX(e)}function yX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gX(e,t){return gX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gX(e,t)}function bX(e,t){if(t&&("object"===mX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wX(e){return wX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wX(e)}fX.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:-53,maxValue:53}]}};var _X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=wX(r);if(o){var n=wX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return bX(this,e)});function a(){return yX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"bitand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(function(e,t){return e&t}))}},{key:"bitor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(function(e,t){return e|t}))}},{key:"bitxor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(function(e,t){return e^t}))}}],n&&vX(t.prototype,n),a}(PF);function SX(e){return SX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SX(e)}function EX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RX(e,t){return RX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},RX(e,t)}function TX(e,t){if(t&&("object"===SX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function CX(e){return CX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},CX(e)}_X.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:0}]}};var MX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=CX(r);if(o){var n=CX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return TX(this,e)});function a(){return EX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"literalTrue",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(function(){return!0}))}},{key:"literalFalse",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(function(){return!1}))}},{key:"conditionalIf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(function(e,t,n){return e?t:n}))}},{key:"and",value:function(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!e}))}))}},{key:"or",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return e}))}))}},{key:"not",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(function(e){return!e}))}},{key:"xor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t&&e++})),e%2==1}))}},{key:"switch",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SWITCH"),(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];for(var i=r.length,a=0;a+1<i;a+=2)if(!(r[a]instanceof ZU)&&n.arithmeticHelper.eq(e,r[a]))return r[a+1];return a<i?r[a]:new ZU(BU.NA,IH.NoDefault)}))}},{key:"iferror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(function(e,t){return e instanceof ZU?t:e}))}},{key:"ifna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(function(e,t){return e instanceof ZU&&e.type===BU.NA?t:e}))}},{key:"choose",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(function(e){return e>(arguments.length<=1?0:arguments.length-1)?new ZU(BU.NUM,IH.Selector):e-1+1<1||arguments.length<=e-1+1?void 0:arguments[e-1+1]}))}}],n&&kX(t.prototype,n),a}(PF);function OX(e){return OX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OX(e)}function AX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xX(e,t){return xX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xX(e,t)}function NX(e,t){if(t&&("object"===OX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function IX(e){return IX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},IX(e)}MX.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:bF.BOOLEAN},{argumentType:bF.SCALAR,passSubtype:!0},{argumentType:bF.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:bF.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:bF.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:bF.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:bF.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:bF.NOERROR},{argumentType:bF.SCALAR,passSubtype:!0},{argumentType:bF.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:bF.SCALAR,passSubtype:!0},{argumentType:bF.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:bF.SCALAR,passSubtype:!0},{argumentType:bF.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.SCALAR,passSubtype:!0}],repeatLastArgs:1}},n(45777),n(40594);var DX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=IX(r);if(o){var n=IX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return NX(this,e)});function a(){return AX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"char",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=256?new ZU(BU.VALUE,IH.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))}))}},{key:"unichar",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=1114112?new ZU(BU.VALUE,IH.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))}))}}],n&&LX(t.prototype,n),a}(PF);function PX(e){return PX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PX(e)}function HX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FX(e,t){return FX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},FX(e,t)}function YX(e,t){if(t&&("object"===PX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function UX(e){return UX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},UX(e)}DX.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:bF.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:bF.NUMBER}]}};var BX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=UX(r);if(o){var n=UX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return YX(this,e)});function a(){return HX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"code",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(function(e){return 0===e.length?new ZU(BU.VALUE,IH.EmptyString):e.charCodeAt(0)}))}},{key:"unicode",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(function(e){var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new ZU(BU.VALUE,IH.EmptyString)}))}}],n&&jX(t.prototype,n),a}(PF);function VX(e){return VX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VX(e)}function WX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GX(e,t){return GX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},GX(e,t)}function KX(e,t){if(t&&("object"===VX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function XX(e){return XX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},XX(e)}BX.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:bF.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:bF.STRING}]}};var $X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=XX(r);if(o){var n=XX(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return KX(this,e)});function a(){return WX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"countblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t===Vj&&e++})),e}))}}],n&&zX(t.prototype,n),a}(PF);function qX(e){return qX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qX(e)}function JX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZX(e,t){return ZX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ZX(e,t)}function e$(e,t){if(t&&("object"===qX(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function t$(e){return t$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t$(e)}$X.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:bF.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var n$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZX(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=t$(r);if(o){var n=t$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return e$(this,e)});function a(){return JX(this,a),i.apply(this,arguments)}return t=a,n=[{key:"countunique",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(function(){for(var e=new Set,t=new Set,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var i=0,a=r;i<a.length;i++){var s=a[i];s instanceof ZU?t.add(s.type):""!==s&&e.add(s)}return e.size+t.size}))}}],n&&QX(t.prototype,n),a}(PF);function r$(e){return r$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r$(e)}function o$(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a$(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function i$(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||a$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a$(e,t){if(e){if("string"==typeof e)return s$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s$(e,t):void 0}}function s$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c$(e,t){return c$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c$(e,t)}function f$(e,t){if(t&&("object"===r$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h$(e){return h$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h$(e)}n$.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:bF.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var d$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h$(r);if(o){var n=h$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f$(this,e)});function a(){var e;return u$(this,a),(e=i.apply(this,arguments)).isoweeknumCore=function(t){var n=Math.floor(e.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),r=e.dateTimeHelper.numberToSimpleDate(t),o=e.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),i=e.dateTimeHelper.relativeNumberToAbsoluteNumber(o),a=i+((4-i)%7+7)%7,s=Math.floor((n-1)/7)-Math.floor((a-1)/7)+1;return 0===s?e.isoweeknumCore(t-7)+1:s},e.days360Core=function(t,n,r){var o,i,a=e.dateTimeHelper.numberToSimpleDate(t),s=e.dateTimeHelper.numberToSimpleDate(n);if(r)o=FB(a),i=FB(s);else{var u=i$(e.dateTimeHelper.toBasisUS(a,s),2);o=u[0],i=u[1]}return 360*(i.year-o.year)+30*(i.month-o.month)+i.day-o.day},e}return t=a,n=[{key:"date",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATE"),(function(e,t,r){var o=Math.trunc(r),i=Math.trunc(t),a=Math.trunc(e);a<n.dateTimeHelper.getEpochYearZero()&&(a+=n.dateTimeHelper.getEpochYearZero());var s=Math.floor((i-1)/12),u={year:a+=s,month:i-=12*s,day:1};if(n.dateTimeHelper.isValidDate(u)){var l=n.dateTimeHelper.dateToNumber(u)+(o-1);return void 0===(l=n.dateTimeHelper.getWithinBounds(l))?new ZU(BU.NUM,IH.DateBounds):l}return new ZU(BU.VALUE,IH.InvalidDate)}))}},{key:"time",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(function(e,t,n){var r=jB({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(n)});return r<0?new ZU(BU.NUM,IH.NegativeTime):r%1}))}},{key:"eomonth",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("EOMONTH"),(function(e,t){var r=n.dateTimeHelper.numberToSimpleDate(e),o=n.dateTimeHelper.dateToNumber(n.dateTimeHelper.endOfMonth(DB(r,t)));return void 0===(o=n.dateTimeHelper.getWithinBounds(o))?new ZU(BU.NUM,IH.DateBounds):o}))}},{key:"day",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DAY"),(function(e){return n.dateTimeHelper.numberToSimpleDate(e).day}))}},{key:"days",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(function(e,t){return Math.trunc(e)-Math.trunc(t)}))}},{key:"month",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MONTH"),(function(e){return n.dateTimeHelper.numberToSimpleDate(e).month}))}},{key:"year",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("YEAR"),(function(e){return n.dateTimeHelper.numberToSimpleDate(e).year}))}},{key:"hour",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(function(e){return HB(PB(e)%1).hours}))}},{key:"minute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(function(e){return HB(PB(e)%1).minutes}))}},{key:"second",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(function(e){return HB(PB(e)%1).seconds}))}},{key:"text",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TEXT"),(function(e,t){return ZB(e,t,n.config,n.dateTimeHelper)}))}},{key:"weekday",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(function(e,t){var r=Math.floor(n.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;var o=y$.get(t);return void 0===o?new ZU(BU.NUM,IH.BadMode):(r-o)%7+1}))}},{key:"weeknum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(function(e,t){var r=Math.floor(n.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),o=n.dateTimeHelper.numberToSimpleDate(e),i=n.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),a=n.dateTimeHelper.relativeNumberToAbsoluteNumber(i);if(21===t)return n.isoweeknumCore(e);var s=y$.get(t);return void 0===s?new ZU(BU.NUM,IH.BadMode):Math.floor((r-s)/7)-Math.floor((a-s)/7)+1}))}},{key:"isoweeknum",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(function(e){var t=n.dateTimeHelper.parseDateTimeFromConfigFormats(e).dateTime;return void 0===t?new ZU(BU.VALUE,IH.IncorrectDateTime):LB(t)?(xB(t)?Math.trunc(jB(t)):0)+n.dateTimeHelper.dateToNumber(t):0}))}},{key:"timevalue",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(function(e){var t=n.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new ZU(BU.VALUE,IH.IncorrectDateTime):Wj(t)%1}))}},{key:"now",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NOW"),(function(){var e=new Date(Date.now());return jB({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+n.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}},{key:"today",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TODAY"),(function(){var e=new Date(Date.now());return n.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}},{key:"edate",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("EDATE"),(function(e,t){var r,o={year:(r=DB(n.dateTimeHelper.numberToSimpleDate(e),t)).year,month:r.month,day:Math.min(r.day,OB[r.month-1])},i=n.dateTimeHelper.dateToNumber(o);return void 0===(i=n.dateTimeHelper.getWithinBounds(i))?new ZU(BU.NUM,IH.DateBounds):i}))}},{key:"datedif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATEDIF"),(function(e,t,r){if(e>t)return new ZU(BU.NUM,IH.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);var o=n.dateTimeHelper.numberToSimpleDate(e),i=n.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(i.year-o.year)+(i.month-o.month)-(i.day<o.day?1:0);case"YM":return(i.month-o.month+12-(i.day<o.day?1:0))%12;case"Y":return i.month>o.month||i.month===o.month&&i.day>=o.day?i.year-o.year:i.year-o.year-1;case"MD":if(i.day>=o.day)return i.day-o.day;var a=1===i.month?12:i.month-1,s=1===i.month?i.year-1:i.year;return n.dateTimeHelper.daysInMonth(s,a)+i.day-o.day;case"YD":return i.month>o.month||i.month===o.month&&i.day>=o.day?Math.floor(t)-n.dateTimeHelper.dateToNumber({year:i.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(i.year-o.year-1)-n.dateTimeHelper.leapYearsCount(i.year-1)+n.dateTimeHelper.leapYearsCount(o.year);default:return new ZU(BU.NUM,IH.BadMode)}}))}},{key:"days360",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(function(e,t,r){if((e=Math.trunc(e))>(t=Math.trunc(t))){var o=[t,e];e=o[0],t=o[1]}switch(r){case 0:return n.days360Core(e,t,!1)/360;case 1:return(t-e)/n.dateTimeHelper.yearLengthForBasis(n.dateTimeHelper.numberToSimpleDate(e),n.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return n.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}},{key:"interval",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(function(e){var t=(e=Math.trunc(e))%60,n=(e=Math.trunc(e/60))%60,r=(e=Math.trunc(e/60))%24,o=(e=Math.trunc(e/24))%30,i=(e=Math.trunc(e/30))%12,a=Math.trunc(e/12);return"P"+(a>0?a+"Y":"")+(i>0?i+"M":"")+(o>0?o+"D":"")+"T"+(r>0?r+"H":"")+(n>0?n+"M":"")+(t>0?t+"S":"")}))}},{key:"networkdays",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(function(e,t,r){return n.networkdayscore(e,t,1,r)}))}},{key:"networkdaysintl",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(function(e,t,r,o){return n.networkdayscore(e,t,r,o)}))}},{key:"workday",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WORKDAY"),(function(e,t,r){return n.workdaycore(e,t,1,r)}))}},{key:"workdayintl",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(function(e,t,r,o){return n.workdaycore(e,t,r,o)}))}},{key:"networkdayscore",value:function(e,t,n,r){var o=1;if((e=Math.trunc(e))>(t=Math.trunc(t))){var i=[t,e];e=i[0],t=i[1],o=-1}var a=m$(n);if(a instanceof ZU)return a;var s=this.simpleRangeToFilteredHolidays(a,r);return s instanceof ZU?s:o*this.countWorkdays(e,t,a,s)}},{key:"workdaycore",value:function(e,t,n,r){e=Math.trunc(e),t=Math.trunc(t);var o=m$(n);if(o instanceof ZU)return o;var i=this.simpleRangeToFilteredHolidays(o,r);if(i instanceof ZU)return i;if(t>0){for(var a=1;this.countWorkdays(e+1,e+a,o,i)<t;)a*=2;for(var s=1;s+1<a;){var u=Math.trunc((s+a)/2);this.countWorkdays(e+1,e+u,o,i)<t?s=u:a=u}return e+a}if(t<0){t*=-1;for(var l=1;this.countWorkdays(e-l,e-1,o,i)<t;)l*=2;for(var c=1;c+1<l;){var f=Math.trunc((c+l)/2);this.countWorkdays(e-f,e-1,o,i)<t?c=f:l=f}return e-l}return e}},{key:"countWorkdays",value:function(e,t,n,r){for(var o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),a=0,s=0;s<7;s++)"0"===n.charAt(s)&&(a+=Math.floor((o+6-s)/7),a-=Math.floor((i-1+6-s)/7));return a-(p$(t+1,r)-p$(e,r))}},{key:"simpleRangeToFilteredHolidays",value:function(e,t){var n,r,o=this,i=null!==(n=null==t?void 0:t.valuesFromTopLeftCorner())&&void 0!==n?n:[],a=o$(i);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof ZU)return s}}catch(e){a.e(e)}finally{a.f()}var u,l,c=[],f=o$(i);try{for(f.s();!(u=f.n()).done;){var h=u.value;if(h!==Vj){if(!Zj(h))return new ZU(BU.VALUE,IH.WrongType);c.push(Math.trunc(Wj(h)))}}}catch(e){f.e(e)}finally{f.f()}return(l=new Set(c),function(e){if(Array.isArray(e))return s$(e)}(l)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(l)||a$(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return e-t})).filter((function(t){var n=(o.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(n)}))}}],n&&l$(t.prototype,n),a}(PF);function p$(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;for(var n=0,r=t.length-1;n+1<r;){var o=Math.floor((r+n)/2);t[o]>=e?r=o:n=o}return r}function m$(e){var t;return"number"!=typeof e&&"string"!=typeof e?new ZU(BU.VALUE,IH.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new ZU(BU.NUM,IH.WeekendString):null!==(t=v$.get(e))&&void 0!==t?t:new ZU(BU.NUM,IH.BadMode)}d$.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:bF.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:bF.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:bF.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:bF.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:bF.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:bF.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:bF.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:bF.STRING}],returnNumberType:Kj.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:bF.STRING}],returnNumberType:Kj.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Kj.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Kj.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:bF.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NOERROR,defaultValue:1},{argumentType:bF.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER},{argumentType:bF.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER},{argumentType:bF.NOERROR,defaultValue:1},{argumentType:bF.RANGE,optionalArg:!0}]}};var y$=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),v$=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);function g$(e){return g$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g$(e)}function b$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _$(e,t){return _$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_$(e,t)}function S$(e,t){if(t&&("object"===g$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E$(e){return E$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E$(e)}var k$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E$(r);if(o){var n=E$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S$(this,e)});function a(){return b$(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"degrees",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(function(e){return e*(180/Math.PI)}))}}])&&w$(t.prototype,n),a}(PF);function R$(e){return R$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R$(e)}function T$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M$(e,t){return M$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M$(e,t)}function O$(e,t){if(t&&("object"===R$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A$(e){return A$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A$(e)}k$.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:bF.NUMBER}]}};var L$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A$(r);if(o){var n=A$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O$(this,e)});function a(){return T$(this,a),i.apply(this,arguments)}return t=a,n=[{key:"delta",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(function(e,t){return e===t?1:0}))}}],n&&C$(t.prototype,n),a}(PF);function x$(e){return x$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x$(e)}function N$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D$(e,t){return D$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},D$(e,t)}function P$(e,t){if(t&&("object"===x$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function H$(e){return H$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},H$(e)}L$.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0}]}};var j$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=H$(r);if(o){var n=H$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P$(this,e)});function a(){return N$(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"exp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}])&&I$(t.prototype,n),a}(PF);function F$(e){return F$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F$(e)}function Y$(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return U$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U$(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function U$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W$(e,t){return W$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},W$(e,t)}function z$(e,t){if(t&&("object"===F$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function G$(e){return G$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},G$(e)}j$.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:bF.NUMBER}]}};var K$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=G$(r);if(o){var n=G$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return z$(this,e)});function a(){return B$(this,a),i.apply(this,arguments)}return t=a,n=[{key:"pmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),X$)}},{key:"ipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),$$)}},{key:"ppmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),J$)}},{key:"fv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FV"),q$)}},{key:"cumipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(function(e,t,n,r,o,i){if(r>o)return new ZU(BU.NUM,IH.EndStartPeriod);for(var a=0,s=r;s<=o;s++)a+=$$(e,s,t,n,0,i);return a}))}},{key:"cumprinc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(function(e,t,n,r,o,i){if(r>o)return new ZU(BU.NUM,IH.EndStartPeriod);for(var a=0,s=r;s<=o;s++)a+=J$(e,s,t,n,0,i);return a}))}},{key:"db",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(function(e,t,n,r,o){if(12===o&&r>n||r>n+1)return new ZU(BU.NUM,IH.PeriodLong);if(t>=e)return 0;var i=Math.round(1e3*(1-Math.pow(t/e,1/n)))/1e3,a=e*i*o/12;if(1===r)return a;for(var s=a,u=0;u<r-2;u++)s+=(e-s)*i;return r===n+1?(e-s)*i*(12-o)/12:(e-s)*i}))}},{key:"ddb",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(function(e,t,n,r,o){if(r>n)return new ZU(BU.NUM);var i,a=o/n;a>=1?(a=1,i=1===r?e:0):i=e*Math.pow(1-a,r-1);var s=e*Math.pow(1-a,r);return Math.max(i-Math.max(t,s),0)}))}},{key:"dollarde",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(function(e,t){if(t<1)return new ZU(BU.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}},{key:"dollarfr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(function(e,t){if(t<1)return new ZU(BU.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}},{key:"effect",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(function(e,t){return t=Math.trunc(t),Math.pow(1+e/t,t)-1}))}},{key:"ispmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(function(e,t,n,r){return 0===n?new ZU(BU.DIV_BY_ZERO):r*e*(t/n-1)}))}},{key:"nominal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(function(e,t){return t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t}))}},{key:"nper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(function(e,t,n,r,o){return 0===e?0===t?new ZU(BU.DIV_BY_ZERO):(-n-r)/t:(o&&(t*=1+e),Math.log((t-r*e)/(n*e+t))/Math.log(1+e))}))}},{key:"rate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(function(e,t,n,r,o,i){if(i<=-1)return new ZU(BU.VALUE);var a=1e-10,s=i;o=o?1:0;for(var u=0;u<20;u++){if(s<=-1)return new ZU(BU.NUM);var l=void 0;if(Math.abs(s)<a)l=n*(1+e*s)+t*(1+s*o)*e+r;else{var c=Math.pow(1+s,e);l=n*c+t*(1/s+o)*(c-1)+r}if(Math.abs(l)<a)return s;var f=void 0;if(Math.abs(s)<a)f=n*e+t*o*e;else{var h=Math.pow(1+s,e),d=e*Math.pow(1+s,e-1);f=n*d+t*(1/s+o)*d+t*(-1/(s*s))*(h-1)}s-=l/f}return new ZU(BU.NUM)}))}},{key:"pv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(function(e,t,n,r,o){return o=o?1:0,-1===e?new ZU(0===t?BU.NUM:BU.DIV_BY_ZERO):0===e?-n*t-r:((1-Math.pow(1+e,t))*n*(1+e*o)/e-r)/Math.pow(1+e,t)}))}},{key:"rri",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(function(e,t,n){return 0===t||n<0&&t>0||n>0&&t<0?new ZU(BU.NUM):Math.pow(n/t,1/e)-1}))}},{key:"sln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(function(e,t,n){return 0===n?new ZU(BU.DIV_BY_ZERO):(e-t)/n}))}},{key:"syd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(function(e,t,n,r){return r>n?new ZU(BU.NUM):(e-t)*(n-r+1)*2/(n*(n+1))}))}},{key:"tbilleq",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new ZU(BU.NUM);var o=n.dateTimeHelper.numberToSimpleDate(e),i=n.dateTimeHelper.numberToSimpleDate(t);if(i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day))return new ZU(BU.NUM);var a=360-r*(t-e);return 0===a?0:a<0?new ZU(BU.NUM):365*r/a}))}},{key:"tbillprice",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new ZU(BU.NUM);var o=n.dateTimeHelper.numberToSimpleDate(e),i=n.dateTimeHelper.numberToSimpleDate(t);if(i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day))return new ZU(BU.NUM);var a=360-r*(t-e);return 0===a?0:a<0?new ZU(BU.NUM):100*(1-r*(t-e)/360)}))}},{key:"tbillyield",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new ZU(BU.NUM);var o=n.dateTimeHelper.numberToSimpleDate(e),i=n.dateTimeHelper.numberToSimpleDate(t);return i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day)?new ZU(BU.NUM):360*(100-r)/(r*(t-e))}))}},{key:"fvschedule",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(function(e,t){var n,r=t.valuesFromTopLeftCorner(),o=Y$(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i instanceof ZU)return i}}catch(e){o.e(e)}finally{o.f()}var a,s=Y$(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(Zj(u))e*=1+Wj(u);else if(u!==Vj)return new ZU(BU.VALUE,IH.NumberExpected)}}catch(e){s.e(e)}finally{s.f()}return e}))}},{key:"npv",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NPV"),(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];var i=n.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof ZU?i:Q$(e,i)}))}},{key:"mirr",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MIRR"),(function(e,t,r){var o=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(o instanceof ZU)return o;var i,a=!1,s=!1,u=[],l=[],c=Y$(o);try{for(c.s();!(i=c.n()).done;){var f=i.value;f>0?(a=!0,u.push(f),l.push(0)):f<0?(s=!0,l.push(f),u.push(0)):(l.push(0),u.push(0))}}catch(e){c.e(e)}finally{c.f()}if(!a||!s)return new ZU(BU.DIV_BY_ZERO);var h=o.length,d=Q$(r,u);if(d instanceof ZU)return d;var p=Q$(t,l);return p instanceof ZU?p:Math.pow(-d*Math.pow(1+r,h)/p/(1+t),1/(h-1))-1}))}},{key:"pduration",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(function(e,t,n){return(Math.log(n)-Math.log(t))/Math.log(1+e)}))}},{key:"xnpv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(function(e,t,n){var r,o=t.valuesFromTopLeftCorner(),i=Y$(o);try{for(i.s();!(r=i.n()).done;)if("number"!=typeof r.value)return new ZU(BU.VALUE,IH.NumberExpected)}catch(e){i.e(e)}finally{i.f()}var a,s=o,u=n.valuesFromTopLeftCorner(),l=Y$(u);try{for(l.s();!(a=l.n()).done;)if("number"!=typeof a.value)return new ZU(BU.VALUE,IH.NumberExpected)}catch(e){l.e(e)}finally{l.f()}var c=u;if(c.length!==s.length)return new ZU(BU.NUM,IH.EqualLength);var f=c.length,h=0;if(c[0]<0)return new ZU(BU.NUM,IH.ValueSmall);for(var d=0;d<f;d++){if(c[d]=Math.floor(c[d]),c[d]<c[0])return new ZU(BU.NUM,IH.ValueSmall);h+=s[d]/Math.pow(1+e,(c[d]-c[0])/365)}return h}))}}],n&&V$(t.prototype,n),a}(PF);function X$(e,t,n,r,o){if(0===e)return(-n-r)/t;var i=Math.pow(1+e,t);return(r*e+n*e*i)*(o?1/(1+e):1)/(1-i)}function $$(e,t,n,r,o,i){var a=X$(e,n,r,o,i);return 1===t?e*(i?0:-r):e*(i?q$(e,t-2,a,r,i)-a:q$(e,t-1,a,r,i))}function q$(e,t,n,r,o){if(0===e)return-r-n*t;var i=Math.pow(1+e,t);return n*(o?1+e:1)*(1-i)/e-r*i}function J$(e,t,n,r,o,i){return X$(e,n,r,o,i)-$$(e,t,n,r,o,i)}function Q$(e,t){for(var n=0,r=t.length-1;r>=0;r--){if(n+=t[r],-1===e){if(0===n)continue;return new ZU(BU.DIV_BY_ZERO)}n/=1+e}return n}function Z$(e){return Z$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z$(e)}function eq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nq(e,t){return nq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},nq(e,t)}function rq(e,t){if(t&&("object"===Z$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oq(e){return oq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oq(e)}K$.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}],returnNumberType:Kj.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}],returnNumberType:Kj.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}],returnNumberType:Kj.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}],returnNumberType:Kj.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.INTEGER,minValue:0,maxValue:1}],returnNumberType:Kj.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.INTEGER,minValue:1},{argumentType:bF.INTEGER,minValue:0,maxValue:1}],returnNumberType:Kj.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Kj.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.INTEGER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Kj.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1}],returnNumberType:Kj.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1}],returnNumberType:Kj.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0}],returnNumberType:Kj.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:.1}],returnNumberType:Kj.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0}],returnNumberType:Kj.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0}],returnNumberType:Kj.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0}],returnNumberType:Kj.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0}],returnNumberType:Kj.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.RANGE}],returnNumberType:Kj.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.ANY}],repeatLastArgs:1,returnNumberType:Kj.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],returnNumberType:Kj.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:bF.NUMBER,greaterThan:-1},{argumentType:bF.RANGE},{argumentType:bF.RANGE}]}};var iq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oq(r);if(o){var n=oq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rq(this,e)});function a(){return eq(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"formulatext",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(function(){return new ZU(BU.NA,IH.WrongArgNumber)}),(function(e){var t;return null!==(t=n.serialization.getCellFormula(e))&&void 0!==t?t:new ZU(BU.NA,IH.Formula)}))}}])&&tq(t.prototype,n),a}(PF);function aq(e){return aq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aq(e)}function sq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lq(e,t){return lq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lq(e,t)}function cq(e,t){if(t&&("object"===aq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fq(e){return fq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fq(e)}iq.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:bF.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};var hq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fq(r);if(o){var n=fq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return cq(this,e)});function a(){return sq(this,a),i.apply(this,arguments)}return t=a,n=[{key:"isbinary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(function(e){return/^[01]{1,10}$/.test(e)}))}},{key:"iserr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(function(e){return e instanceof ZU&&e.type!==BU.NA}))}},{key:"iserror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(function(e){return e instanceof ZU}))}},{key:"isformula",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(function(){return new ZU(BU.NA,IH.WrongArgNumber)}),(function(e){return n.dependencyGraph.addressMapping.getCell(e)instanceof FY}))}},{key:"isblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(function(e){return e===Vj}))}},{key:"isna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(function(e){return e instanceof ZU&&e.type==BU.NA}))}},{key:"isnumber",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),Zj)}},{key:"islogical",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(function(e){return"boolean"==typeof e}))}},{key:"isref",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(function(e){return e instanceof ZU&&(e.type==BU.REF||e.type==BU.CYCLE)}))}},{key:"istext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(function(e){return"string"==typeof e}))}},{key:"isnontext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(function(e){return!("string"==typeof e)}))}},{key:"column",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(function(){return t.formulaAddress.col+1}),(function(e){return e.col+1}))}},{key:"columns",value:function(e,t){if(1!==e.args.length)return new ZU(BU.NA,IH.WrongArgNumber);if(e.args.some((function(e){return e.type===vH.EMPTY})))return new ZU(BU.NUM,IH.EmptyArg);for(var n=e.args[0];n.type===vH.PARENTHESIS;)n=n.expression;if(n.type===vH.CELL_RANGE||n.type===vH.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===vH.CELL_REFERENCE)return 1;if(n.type===vH.ROW_RANGE)return this.config.maxColumns;var r=this.evaluateAst(n,t);return r instanceof XF?r.width():r instanceof ZU?r:1}},{key:"row",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(function(){return t.formulaAddress.row+1}),(function(e){return e.row+1}))}},{key:"rows",value:function(e,t){if(1!==e.args.length)return new ZU(BU.NA,IH.WrongArgNumber);if(e.args.some((function(e){return e.type===vH.EMPTY})))return new ZU(BU.NUM,IH.EmptyArg);for(var n=e.args[0];n.type===vH.PARENTHESIS;)n=n.expression;if(n.type===vH.CELL_RANGE||n.type===vH.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===vH.CELL_REFERENCE)return 1;if(n.type===vH.COLUMN_RANGE)return this.config.maxRows;var r=this.evaluateAst(n,t);return r instanceof XF?r.height():r instanceof ZU?r:1}},{key:"index",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(function(e,t,n){var r,o,i,a,s,u;return n<1||t<1?new ZU(BU.VALUE,IH.LessThanOne):n>e.width()||t>e.height()?new ZU(BU.NUM,IH.ValueLarge):null!==(u=null!==(i=null===(o=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r[t-1])||void 0===o?void 0:o[n-1])&&void 0!==i?i:null===(s=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a[0])||void 0===s?void 0:s[0])&&void 0!==u?u:new ZU(BU.VALUE,IH.CellRangeExpected)}))}},{key:"na",value:function(e,t){return new ZU(BU.NA)}},{key:"sheet",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),(function(){return t.formulaAddress.sheet+1}),(function(e){return e.sheet+1}),(function(e){var t=n.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new ZU(BU.NA,IH.SheetRef)}))}},{key:"sheets",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),(function(){return n.dependencyGraph.sheetMapping.numberOfSheets()}),(function(){return 1}),(function(){return new ZU(BU.VALUE,IH.CellRefExpected)}))}}],n&&uq(t.prototype,n),a}(PF);function dq(e){return dq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dq(e)}function pq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yq(e,t){return yq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yq(e,t)}function vq(e,t){if(t&&("object"===dq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gq(e){return gq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gq(e)}hq.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:bF.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:bF.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:bF.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:bF.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:bF.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:bF.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:bF.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:bF.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:bF.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:bF.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:bF.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:bF.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:bF.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:bF.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:bF.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:bF.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:bF.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};var bq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gq(r);if(o){var n=gq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vq(this,e)});function a(){return pq(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"iseven",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(function(e){return e%2==0}))}}])&&mq(t.prototype,n),a}(PF);function wq(e){return wq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wq(e)}function _q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eq(e,t){return Eq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Eq(e,t)}function kq(e,t){if(t&&("object"===wq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Rq(e){return Rq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rq(e)}bq.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:bF.NUMBER}]}};var Tq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rq(r);if(o){var n=Rq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kq(this,e)});function a(){return _q(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"isodd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(function(e){return e%2==1}))}}])&&Sq(t.prototype,n),a}(PF);function Cq(e){return Cq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cq(e)}function Mq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Aq(e,t){return Aq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Aq(e,t)}function Lq(e,t){if(t&&("object"===Cq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xq(e){return xq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xq(e)}Tq.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:bF.NUMBER}]}};var Nq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xq(r);if(o){var n=xq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Lq(this,e)});function a(){return Mq(this,a),i.apply(this,arguments)}return t=a,n=[{key:"log10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(function(e,t){return Math.log(e)/Math.log(t)}))}},{key:"ln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}],n&&Oq(t.prototype,n),a}(PF);function Iq(e){return Iq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iq(e)}function Dq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hq(e,t){return Hq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hq(e,t)}function jq(e,t){if(t&&("object"===Iq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fq(e){return Fq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fq(e)}Nq.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:bF.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:bF.NUMBER}]}};var Yq=parseFloat(Math.PI.toFixed(14)),Uq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fq(r);if(o){var n=Fq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jq(this,e)});function a(){return Dq(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"pi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(function(){return Yq}))}},{key:"sqrtpi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(function(e){return Math.sqrt(Yq*e)}))}}])&&Pq(t.prototype,n),a}(PF);function Bq(e){return Bq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bq(e)}function Vq(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wq(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wq(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gq(e,t){return Gq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Gq(e,t)}function Kq(e,t){if(t&&("object"===Bq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xq(e){return Xq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xq(e)}function $q(e,t){return new VF(t.width,e.height)}function qq(e,t,n){return new VF(1+(e.width-t)/n,1+(e.height-t)/n)}Uq.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:bF.NUMBER,minValue:0}]}};var Jq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gq(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xq(r);if(o){var n=Xq(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Kq(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).createCpuKernel=function(e,t){return function(){for(var n=[],r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];for(var a=0;a<t.height;++a){n.push([]);for(var s=0;s<t.width;++s)n[a][s]=e.apply({thread:{x:s,y:a}},o)}return n}},t.createGpuJsKernel=function(e,n){return t.interpreter.getGpuInstance().createKernel(e).setPrecision("unsigned").setOutput([n.width,n.height])},void 0===t.config.gpujs?t.createKernel=t.createCpuKernel:t.createKernel=t.createGpuJsKernel,t}return t=a,n=[{key:"mmult",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MMULT"),(function(e,t){if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new ZU(BU.VALUE,IH.NumberRange);if(t.height()!==e.width())return new ZU(BU.VALUE,IH.ArrayDimensions);var r=$q(e.size,t.size),o=n.createKernel((function(e,t,n){for(var r=0,o=0;o<n;++o)r+=e[this.thread.y][o]*t[o][this.thread.x];return r}),r)(e.rawNumbers(),t.rawNumbers(),e.width());return XF.onlyNumbers(o)}))}},{key:"mmultArraySize",value:function(e,t){var n=this;if(2!==e.args.length)return VF.error();var r=this.metadata("MMULT"),o=Vq(e.args.map((function(e){var o;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))})),2);return $q(o[0],o[1])}},{key:"maxpool",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new ZU(BU.VALUE,IH.NumberRange);var o=qq(e.size,t,r),i=n.createKernel((function(e,t,n){for(var r=this.thread.x*n,o=this.thread.y*n,i=e[o][r],a=0;a<t;a++)for(var s=0;s<t;s++)i=Math.max(i,e[o+a][r+s]);return i}),o)(e.rawNumbers(),t,r);return XF.onlyNumbers(i)}))}},{key:"medianpool",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new ZU(BU.VALUE,IH.NumberRange);var o=qq(e.size,t,r),i=n.createKernel((function(e,t,n){for(var r=this.thread.x*n,o=this.thread.y*n,i=e[o][r],a=0;a<t;a++)for(var s=0;s<t;s++)i=Math.max(i,e[o+a][r+s]);for(var u=e[o][r],l=0;l<t;l++)for(var c=0;c<t;c++)u=Math.min(u,e[o+l][r+c]);for(var f=t*t,h=u,d=i,p=42,m=0;m<32;m++){for(var y=(h+d)/2,v=0,g=0;g<t;g++)for(var b=0;b<t;b++)e[o+g][r+b]>y&&v++;if(t%2==0){if(v===f/2){p=y;break}v>f/2?h=y:d=y}else{if(v===(f-1)/2){p=y;break}v>(f-1)/2?h=y:d=y}}return p}),o)(e.rawNumbers(),t,r);return XF.onlyNumbers(i)}))}},{key:"maxpoolArraySize",value:function(e,t){var n=this;if(e.args.length<2||e.args.length>3)return VF.error();var r,o=this.metadata("MAXPOOL"),i=e.args.map((function(e){var r;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(r=null==o?void 0:o.arrayFunction)&&void 0!==r&&r))}))[0],a=e.args[1],s=r=a.type===vH.NUMBER?a.value:1;if(3===e.args.length){var u=e.args[2];s=u.type===vH.NUMBER?u.value:1}return r>i.width||r>i.height||s>r||(i.width-r)%s!=0||(i.height-r)%s!=0?VF.error():qq(i,r,s)}},{key:"medianpoolArraySize",value:function(e,t){return this.maxpoolArraySize(e,t)}},{key:"transpose",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),(function(e){for(var t=e.rawData(),n=e.size,r=[],o=0;o<n.width;++o){r[o]=[];for(var i=0;i<n.height;++i)r[o][i]=t[i][o]}return XF.onlyValues(r)}))}},{key:"transposeArraySize",value:function(e,t){var n=this;if(1!==e.args.length)return VF.error();var r=this.metadata("MMULT"),o=Vq(e.args.map((function(e){var o;return n.arraySizeForAst(e,new Lj(t.formulaAddress,t.arraysFlag||null!==(o=null==r?void 0:r.arrayFunction)&&void 0!==o&&o))})),1)[0];return new VF(o.height,o.width)}}],n&&zq(t.prototype,n),a}(PF);function Qq(e){return Qq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qq(e)}function Zq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tJ(e,t){return tJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tJ(e,t)}function nJ(e,t){if(t&&("object"===Qq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function rJ(e){return rJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rJ(e)}Jq.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:bF.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};var oJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tJ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rJ(r);if(o){var n=rJ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return nJ(this,e)});function a(){return Zq(this,a),i.apply(this,arguments)}return t=a,n=[{key:"median",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MEDIAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);return o instanceof ZU?o:0===o.length?new ZU(BU.NUM,IH.OneValue):(o.sort((function(e,t){return e-t})),o.length%2==0?(o[o.length/2-1]+o[o.length/2])/2:o[Math.floor(o.length/2)])}))}},{key:"large",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("LARGE"),(function(e,t){var r=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof ZU?r:(r.sort((function(e,t){return e-t})),(t=Math.trunc(t))>r.length?new ZU(BU.NUM,IH.ValueLarge):r[r.length-t])}))}},{key:"small",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SMALL"),(function(e,t){var r=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof ZU?r:(r.sort((function(e,t){return e-t})),(t=Math.trunc(t))>r.length?new ZU(BU.NUM,IH.ValueLarge):r[t-1])}))}}],n&&eJ(t.prototype,n),a}(PF);function iJ(e){return iJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iJ(e)}function aJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uJ(e,t){return uJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},uJ(e,t)}function lJ(e,t){if(t&&("object"===iJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cJ(e){return cJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cJ(e)}oJ.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER,minValue:1}]}};var fJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uJ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cJ(r);if(o){var n=cJ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return lJ(this,e)});function a(){return aJ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"mod",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(function(e,t){return 0===t?new ZU(BU.DIV_BY_ZERO):e%t}))}}])&&sJ(t.prototype,n),a}(PF);function hJ(e){return hJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hJ(e)}function dJ(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return pJ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pJ(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function pJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mJ(e,t){return mJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mJ(e,t)}function yJ(e,t){if(t&&("object"===hJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vJ(e){return vJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vJ(e)}function gJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wJ(e,t,n){return t&&bJ(e.prototype,t),n&&bJ(e,n),e}function _J(e){return Zj(e)&&!Number.isFinite(Wj(e))?0:e}fJ.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]}};var SJ=function(){function e(t,n,r){gJ(this,e),this.sumsq=t,this.sum=n,this.count=r}return wJ(e,[{key:"compose",value:function(t){return new e(this.sumsq+t.sumsq,this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}},{key:"varSValue",value:function(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}},{key:"varPValue",value:function(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}],[{key:"single",value:function(t){return new e(t*t,t,1)}}]),e}();SJ.empty=new SJ(0,0,0);var EJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mJ(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=vJ(t);if(n){var o=vJ(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return yJ(this,e)});function o(){var e;return gJ(this,o),(e=r.apply(this,arguments)).addWithEpsilonRaw=function(t,n){return e.arithmeticHelper.addWithEpsilonRaw(t,n)},e}return wJ(o,[{key:"sum",value:function(e,t){return this.doSum(e.args,t)}},{key:"sumsq",value:function(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(function(e){return Math.pow(Wj(e),2)}),kJ)}},{key:"max",value:function(e,t){return this.doMax(e.args,t)}},{key:"maxa",value:function(e,t){var n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(function(e,t){return Math.max(e,t)}),Wj,RJ);return _J(n)}},{key:"min",value:function(e,t){return this.doMin(e.args,t)}},{key:"mina",value:function(e,t){var n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(function(e,t){return Math.min(e,t)}),Wj,RJ);return _J(n)}},{key:"count",value:function(e,t){return this.doCount(e.args,t)}},{key:"counta",value:function(e,t){return this.doCounta(e.args,t)}},{key:"average",value:function(e,t){return this.doAverage(e.args,t)}},{key:"averagea",value:function(e,t){var n,r=this.reduce(e.args,t,SJ.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return SJ.single(Wj(e))}),RJ);return r instanceof ZU?r:null!==(n=r.averageValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"vars",value:function(e,t){return this.doVarS(e.args,t)}},{key:"varp",value:function(e,t){return this.doVarP(e.args,t)}},{key:"vara",value:function(e,t){var n,r=this.reduceAggregateA(e.args,t);return r instanceof ZU?r:null!==(n=r.varSValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"varpa",value:function(e,t){var n,r=this.reduceAggregateA(e.args,t);return r instanceof ZU?r:null!==(n=r.varPValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"stdevs",value:function(e,t){return this.doStdevS(e.args,t)}},{key:"stdevp",value:function(e,t){return this.doStdevP(e.args,t)}},{key:"stdeva",value:function(e,t){var n=this.reduceAggregateA(e.args,t);if(n instanceof ZU)return n;var r=n.varSValue();return void 0===r?new ZU(BU.DIV_BY_ZERO):Math.sqrt(r)}},{key:"stdevpa",value:function(e,t){var n=this.reduceAggregateA(e.args,t);if(n instanceof ZU)return n;var r=n.varPValue();return void 0===r?new ZU(BU.DIV_BY_ZERO):Math.sqrt(r)}},{key:"product",value:function(e,t){return this.doProduct(e.args,t)}},{key:"subtotal",value:function(e,t){if(e.args.length<2)return new ZU(BU.NA,IH.WrongArgNumber);var n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:bF.NUMBER},t),r=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(r,t);case 2:case 102:return this.doCount(r,t);case 3:case 103:return this.doCounta(r,t);case 4:case 104:return this.doMax(r,t);case 5:case 105:return this.doMin(r,t);case 6:case 106:return this.doProduct(r,t);case 7:case 107:return this.doStdevS(r,t);case 8:case 108:return this.doStdevP(r,t);case 9:case 109:return this.doSum(r,t);case 10:case 110:return this.doVarS(r,t);case 11:case 111:return this.doVarP(r,t);default:return new ZU(BU.VALUE,IH.BadMode)}}},{key:"reduceAggregate",value:function(e,t){return this.reduce(e,t,SJ.empty,"_AGGREGATE",(function(e,t){return e.compose(t)}),(function(e){return SJ.single(Wj(e))}),kJ)}},{key:"reduceAggregateA",value:function(e,t){return this.reduce(e,t,SJ.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return SJ.single(Wj(e))}),RJ)}},{key:"doAverage",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof ZU?r:null!==(n=r.averageValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"doVarS",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof ZU?r:null!==(n=r.varSValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"doVarP",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof ZU?r:null!==(n=r.varPValue())&&void 0!==n?n:new ZU(BU.DIV_BY_ZERO)}},{key:"doStdevS",value:function(e,t){var n=this.reduceAggregate(e,t);if(n instanceof ZU)return n;var r=n.varSValue();return void 0===r?new ZU(BU.DIV_BY_ZERO):Math.sqrt(r)}},{key:"doStdevP",value:function(e,t){var n=this.reduceAggregate(e,t);if(n instanceof ZU)return n;var r=n.varPValue();return void 0===r?new ZU(BU.DIV_BY_ZERO):Math.sqrt(r)}},{key:"doCount",value:function(e,t){return this.reduce(e,t,0,"COUNT",(function(e,t){return e+t}),Wj,(function(e){return Zj(e)?1:0}))}},{key:"doCounta",value:function(e,t){return this.reduce(e,t,0,"COUNTA",(function(e,t){return e+t}),Wj,(function(e){return e===Vj?0:1}))}},{key:"doMax",value:function(e,t){var n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(function(e,t){return Math.max(e,t)}),Wj,kJ);return _J(n)}},{key:"doMin",value:function(e,t){var n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(function(e,t){return Math.min(e,t)}),Wj,kJ);return _J(n)}},{key:"doSum",value:function(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,Wj,kJ)}},{key:"doProduct",value:function(e,t){return this.reduce(e,t,1,"PRODUCT",(function(e,t){return e*t}),Wj,kJ)}},{key:"reduce",value:function(e,t,n,r,o,i,a){var s=this;return e.length<1?new ZU(BU.NA,IH.WrongArgNumber):e.reduce((function(e,u){if(e instanceof ZU)return e;if(u.type===vH.CELL_RANGE||u.type===vH.COLUMN_RANGE||u.type===vH.ROW_RANGE){var l=s.evaluateRange(u,t,n,r,o,i,a);return l instanceof ZU?l:o(l,e)}var c;if((c=s.evaluateAst(u,t))instanceof XF){var f=Array.from(c.valuesFromTopLeftCorner()).map(a).filter((function(e){return void 0!==e}));return f.map((function(e){return e instanceof ZU?e:i(e)})).reduce((function(e,t){return e instanceof ZU?e:t instanceof ZU?t:o(e,t)}),e)}if(u.type===vH.CELL_REFERENCE){if(void 0===(c=a(c)))return e}else if(c=s.coerceScalarToNumberOrError(c),void 0===(c=a(c)))return e;return c instanceof ZU?c:o(e,i(c))}),n)}},{key:"evaluateRange",value:function(e,t,n,r,o,i,a){var s;try{s=Cj.fromAst(e,t.formulaAddress)}catch(e){if(e instanceof UD)return new ZU(BU.REF,IH.RangeManySheets);throw e}var u=s.start,l=s.end,c=this.dependencyGraph.getRange(u,l);if(void 0===c)throw new Error("Range does not exists in graph");var f=c.getFunctionValue(r);return void 0===f&&(f=this.getRangeValues(r,s,i,a).reduce((function(e,t){return e instanceof ZU?e:t instanceof ZU?t:o(e,t)}),n),c.setFunctionValue(r,f)),f}},{key:"getRangeValues",value:function(e,t,n,r){var o,i=[],a=this.dependencyGraph.rangeMapping.findSmallerRange(t),s=a.smallerRangeVertex,u=a.restRange,l=this.dependencyGraph.getRange(t.start,t.end);if(void 0!==s&&this.dependencyGraph.existsEdge(s,l)){var c=s.getFunctionValue(e);if(void 0!==c)i.push(c);else{var f,h=dJ(s.range.addresses(this.dependencyGraph));try{for(h.s();!(f=h.n()).done;){var d=f.value,p=r(this.dependencyGraph.getScalarValue(d));p instanceof ZU?i.push(p):void 0!==p&&i.push(n(p))}}catch(e){h.e(e)}finally{h.f()}}o=u}else o=t;var m,y=dJ(o.addresses(this.dependencyGraph));try{for(y.s();!(m=y.n()).done;){var v=m.value,g=r(this.dependencyGraph.getScalarValue(v));g instanceof ZU?i.push(g):void 0!==g&&i.push(n(g))}}catch(e){y.e(e)}finally{y.f()}return i}}]),o}(PF);function kJ(e){return Zj(e)||e instanceof ZU?e:void 0}function RJ(e){return"boolean"==typeof e?cF(e):Zj(e)||e instanceof ZU?e:"string"==typeof e?0:void 0}function TJ(e){return TJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TJ(e)}function CJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OJ(e,t){return OJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},OJ(e,t)}function AJ(e,t){if(t&&("object"===TJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function LJ(e){return LJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},LJ(e)}EJ.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.ANY}],repeatLastArgs:1}},EJ.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};var xJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OJ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=LJ(r);if(o){var n=LJ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return AJ(this,e)});function a(){return CJ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"power",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}])&&MJ(t.prototype,n),a}(PF);function NJ(e){return NJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NJ(e)}function IJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PJ(e,t){return PJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},PJ(e,t)}function HJ(e,t){if(t&&("object"===NJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jJ(e){return jJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jJ(e)}xJ.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]}};var FJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PJ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=jJ(r);if(o){var n=jJ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return HJ(this,e)});function a(){return IJ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"radians",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(function(e){return e*(Math.PI/180)}))}}])&&DJ(t.prototype,n),a}(PF);function YJ(e){return YJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YJ(e)}function UJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VJ(e,t){return VJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},VJ(e,t)}function WJ(e,t){if(t&&("object"===YJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zJ(e){return zJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zJ(e)}FJ.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:bF.NUMBER}]}};var GJ=10,KJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VJ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zJ(r);if(o){var n=zJ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return WJ(this,e)});function a(){return UJ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"dec2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(function(e,t){return $J(e,2,t)}))}},{key:"dec2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(function(e,t){return $J(e,8,t)}))}},{key:"dec2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(function(e,t){return $J(e,16,t)}))}},{key:"bin2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(function(e){var t=XJ(e,2,GJ);return void 0===t?new ZU(BU.NUM,IH.NotBinary):ZJ(t,2)}))}},{key:"bin2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(function(e,t){var n=XJ(e,2,GJ);return void 0===n?new ZU(BU.NUM,IH.NotBinary):$J(ZJ(n,2),8,t)}))}},{key:"bin2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(function(e,t){var n=XJ(e,2,GJ);return void 0===n?new ZU(BU.NUM,IH.NotBinary):$J(ZJ(n,2),16,t)}))}},{key:"oct2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(function(e){var t=XJ(e,8,GJ);return void 0===t?new ZU(BU.NUM,IH.NotOctal):ZJ(t,8)}))}},{key:"oct2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(function(e,t){var n=XJ(e,8,GJ);return void 0===n?new ZU(BU.NUM,IH.NotOctal):$J(ZJ(n,8),2,t)}))}},{key:"oct2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(function(e,t){var n=XJ(e,8,GJ);return void 0===n?new ZU(BU.NUM,IH.NotOctal):$J(ZJ(n,8),16,t)}))}},{key:"hex2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(function(e){var t=XJ(e,16,GJ);return void 0===t?new ZU(BU.NUM,IH.NotHex):ZJ(t,16)}))}},{key:"hex2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(function(e,t){var n=XJ(e,16,GJ);return void 0===n?new ZU(BU.NUM,IH.NotHex):$J(ZJ(n,16),2,t)}))}},{key:"hex2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(function(e,t){var n=XJ(e,16,GJ);return void 0===n?new ZU(BU.NUM,IH.NotHex):$J(ZJ(n,16),8,t)}))}},{key:"base",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),JJ)}},{key:"decimal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(function(e,t){var n=XJ(e,t,255);return void 0===n?new ZU(BU.NUM,IH.NotHex):parseInt(n,t)}))}}],n&&BJ(t.prototype,n),a}(PF);function XJ(e,t,n){var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),o=new RegExp("^[".concat(r,"]+$"));if(!(e.length>n)&&o.test(e))return e}function $J(e,t,n){if(e>function(e){return-qJ(e)-1}(t))return new ZU(BU.NUM,IH.ValueBaseLarge);if(e<qJ(t))return new ZU(BU.NUM,IH.ValueBaseSmall);var r=QJ(e,t);return void 0===n||e<0?r:r.length>n?new ZU(BU.NUM,IH.ValueBaseLong):eV(r,n)}function qJ(e){return-Math.pow(e,GJ)/2}function JJ(e,t,n){var r=QJ(e,t);return void 0!==n&&n>r.length?eV(r,n):r}function QJ(e,t){return(e+(e<0?Math.pow(t,GJ):0)).toString(t).toUpperCase()}function ZJ(e,t){var n=parseInt(e,t),r=Math.pow(t,GJ);return n>=r/2?n-r:n}function eQ(e){return eQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eQ(e)}function tQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rQ(e,t){return rQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},rQ(e,t)}function oQ(e,t){if(t&&("object"===eQ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function iQ(e){return iQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},iQ(e)}KJ.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:bF.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:bF.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:bF.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:GJ}]},DECIMAL:{method:"decimal",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:2,maxValue:36},{argumentType:bF.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}};var aQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rQ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=iQ(r);if(o){var n=iQ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return oQ(this,e)});function a(){return tQ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"rand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}},{key:"randbetween",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(function(e,t){return t<e?new ZU(BU.NUM,IH.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))}))}}])&&nQ(t.prototype,n),a}(PF);function sQ(e){return sQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sQ(e)}function uQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cQ(e,t){return cQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},cQ(e,t)}function fQ(e,t){if(t&&("object"===sQ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hQ(e){return hQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hQ(e)}function dQ(e){var t=Math.ceil(e);return t%2==1?t:t+1}function pQ(e){var t=Math.ceil(e);return t%2==0?t:t+1}aQ.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}],isVolatile:!0}};var mQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cQ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hQ(r);if(o){var n=hQ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fQ(this,e)});function a(){return uQ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"roundup",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.ceil(-e*n)/n:Math.ceil(e*n)/n}))}},{key:"rounddown",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.floor(-e*n)/n:Math.floor(e*n)/n}))}},{key:"round",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}))}},{key:"intFunc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(function(e){return e<0?-Math.floor(-e):Math.floor(e)}))}},{key:"even",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(function(e){return e<0?-pQ(-e):pQ(e)}))}},{key:"odd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(function(e){return e<0?-dQ(-e):dQ(e)}))}},{key:"ceilingmath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(function(e,t,n){return 0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t=-t),Math.ceil(e/t)*t)}))}},{key:"ceiling",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(function(e,t){return 0===e?0:0===t?new ZU(BU.DIV_BY_ZERO):e>0&&t<0?new ZU(BU.NUM,IH.DistinctSigns):Math.ceil(e/t)*t}))}},{key:"ceilingprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)}))}},{key:"floormath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(function(e,t,n){return 0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t*=-1),Math.floor(e/t)*t)}))}},{key:"floor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(function(e,t){return 0===e?0:0===t?new ZU(BU.DIV_BY_ZERO):e>0&&t<0?new ZU(BU.NUM,IH.DistinctSigns):Math.floor(e/t)*t}))}},{key:"floorprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)}))}}],n&&lQ(t.prototype,n),a}(PF);function yQ(e){return yQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yQ(e)}function vQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bQ(e,t){return bQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},bQ(e,t)}function wQ(e,t){if(t&&("object"===yQ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _Q(e){return _Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_Q(e)}mQ.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:bF.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:bF.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:bF.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:1},{argumentType:bF.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:1},{argumentType:bF.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,defaultValue:1}]}},mQ.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};var SQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bQ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_Q(r);if(o){var n=_Q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return wQ(this,e)});function a(){return vQ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"sqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}])&&gQ(t.prototype,n),a}(PF);SQ.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:bF.NUMBER}]}};var EQ=regeneratorRuntime.mark(kQ);function kQ(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),EQ)}function RQ(e){var t=e[Symbol.iterator](),n=t.next(),r=n.done,o=n.value;return r?{rest:kQ()}:{value:o,rest:t}}var TQ=regeneratorRuntime.mark(PQ),CQ=regeneratorRuntime.mark(HQ);function MQ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||AQ(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OQ(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=AQ(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function AQ(e,t){if(e){if("string"==typeof e)return LQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LQ(e,t):void 0}}function LQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var IQ=function(){function e(t,n,r,o,i){xQ(this,e),this.interpreter=t,this.cacheKey=n,this.reduceInitialValue=r,this.composeFunction=o,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}var t,n;return t=e,n=[{key:"compute",value:function(e,t){var n,r=this,o=OQ(t);try{for(o.s();!(n=o.n()).done;)if(!n.value.conditionRange.sameDimensionsAs(e))return new ZU(BU.VALUE,IH.EqualLength)}catch(e){o.e(e)}finally{o.f()}var i=this.tryToGetRangeVertexForRangeValue(e),a=t.map((function(e){return r.tryToGetRangeVertexForRangeValue(e.conditionRange)}));if(i&&a.every((function(e){return void 0!==e}))){var s=t.map((function(e){return e.criterionPackage.raw})).join(","),u=this.findAlreadyComputedValueInCache(i,this.cacheKey(t),s);if(void 0!==u)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),u;var l=this.buildNewCriterionCache(this.cacheKey(t),t.map((function(e){return e.conditionRange.range})),e.range);return l.has(s)||l.set(s,[this.evaluateRangeValue(e,t),t.map((function(e){return e.criterionPackage.lambda}))]),i.setCriterionFunctionValues(this.cacheKey(t),l),a.forEach((function(e){void 0!==e&&e.addDependentCacheRange(i)})),l.get(s)[0]}return this.evaluateRangeValue(e,t)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}},{key:"reduceFunction",value:function(e){var t,n=this.reduceInitialValue,r=OQ(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n=this.composeFunction(n,o)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"findAlreadyComputedValueInCache",value:function(e,t,n){return e.getCriterionFunctionValue(t,n)}},{key:"evaluateRangeValue",value:function(e,t){var n=t.map((function(e){return e.criterionPackage.lambda})),r=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=HQ(n,t.map((function(e){return e.conditionRange.iterateValuesFromTopLeftCorner()})),r);return this.reduceFunction(o)}},{key:"buildNewCriterionCache",value:function(e,t,n){var r,o=this,i=this.dependencyGraph.getRange(n.start,n.end),a=function(e,t,n){if(n.end.row>n.start.row){var r=oB(n.end.sheet,n.end.col,n.end.row-1),o=e.getRange(n.start,r);if(void 0!==o)return{smallerRangeVertex:o,restValuesRange:n.withStart(oB(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:t.map((function(e){return e.withStart(oB(e.start.sheet,e.start.col,e.end.row))}))}}return{restValuesRange:n,restConditionRanges:t}}(this.dependencyGraph,t,n),s=a.smallerRangeVertex,u=a.restConditionRanges,l=a.restValuesRange;r=void 0!==s&&this.dependencyGraph.existsEdge(s,i)?s.getCriterionFunctionValues(e):new Map;var c=new Map;return r.forEach((function(e,t){var n=MQ(e,2),r=n[0],i=n[1],a=HQ(i,u.map((function(e){return PQ(o.dependencyGraph,e)})),Array.from(PQ(o.dependencyGraph,l)).map(o.mapFunction)[Symbol.iterator]()),s=o.composeFunction(r,o.reduceFunction(a));o.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),c.set(t,[s,i])})),c}}],n&&NQ(t.prototype,n),e}(),DQ=function e(t,n){xQ(this,e),this.conditionRange=t,this.criterionPackage=n};function PQ(e,t){var n,r,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=OQ(t.addresses(e)),i.prev=1,n.s();case 3:if((r=n.n()).done){i.next=9;break}return o=r.value,i.next=7,Wj(e.getScalarValue(o));case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),n.e(i.t0);case 14:return i.prev=14,n.f(),i.finish(14);case 17:case"end":return i.stop()}}),TQ,null,[[1,11,14,17]])}function HQ(e,t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:r=OQ(n),s.prev=1,r.s();case 3:if((o=r.n()).done){s.next=15;break}if(i=o.value,(a=t.map((function(e){return RQ(e)}))).every((function(e){return Object.prototype.hasOwnProperty.call(e,"value")}))){s.next=8;break}return s.abrupt("return");case 8:if(!jQ(a.map((function(e){return e.value})),e).every((function(e){var t=MQ(e,2),n=t[0];return(0,t[1])(n)}))){s.next=12;break}return s.next=12,i;case 12:t=a.map((function(e){return e.rest}));case 13:s.next=3;break;case 15:s.next=20;break;case 17:s.prev=17,s.t0=s.catch(1),r.e(s.t0);case 20:return s.prev=20,r.f(),s.finish(20);case 23:case"end":return s.stop()}}),CQ,null,[[1,17,20,23]])}function jQ(e,t){for(var n=[],r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}function FQ(e){return FQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FQ(e)}function YQ(e,t){return YQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},YQ(e,t)}function UQ(e,t){if(t&&("object"===FQ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function BQ(e){return BQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},BQ(e)}function VQ(e){return function(e){if(Array.isArray(e))return WQ(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return WQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WQ(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KQ(e,t,n){return t&&GQ(e.prototype,t),n&&GQ(e,n),e}var XQ=function(){function e(t,n){zQ(this,e),this.sum=t,this.count=n}return KQ(e,[{key:"compose",value:function(t){return new e(this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}}],[{key:"single",value:function(t){return new e(t,1)}}]),e}();function $Q(e){var t=e.map((function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)}));return["SUMIF"].concat(VQ(t)).join(",")}function qQ(e){var t=e.map((function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)}));return["AVERAGEIF"].concat(VQ(t)).join(",")}function JQ(e){var t=e.map((function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)}));return["COUNTIFS"].concat(VQ(t)).join(",")}XQ.empty=new XQ(0,0);var QQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YQ(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=BQ(t);if(n){var o=BQ(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return UQ(this,e)});function o(){return zQ(this,o),r.apply(this,arguments)}return KQ(o,[{key:"sumif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMIF"),(function(e,t,r){var o=n.interpreter.criterionBuilder.fromCellValue(t,n.arithmeticHelper);return void 0===o?new ZU(BU.VALUE,IH.BadCriterion):(r=null!=r?r:e,new IQ(n.interpreter,$Q,0,(function(e,t){return n.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return Wj(e)})).compute(r,[new DQ(e,o)]))}))}},{key:"sumifs",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMIFS"),(function(e){for(var t=[],r=0;r<(arguments.length<=1?0:arguments.length-1);r+=2){var o=r+1<1||arguments.length<=r+1?void 0:arguments[r+1],i=n.interpreter.criterionBuilder.fromCellValue(r+1+1<1||arguments.length<=r+1+1?void 0:arguments[r+1+1],n.arithmeticHelper);if(void 0===i)return new ZU(BU.VALUE,IH.BadCriterion);t.push(new DQ(o,i))}return new IQ(n.interpreter,$Q,0,(function(e,t){return n.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return Wj(e)})).compute(e,t)}))}},{key:"averageif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(function(e,t,r){var o=n.interpreter.criterionBuilder.fromCellValue(t,n.arithmeticHelper);if(void 0===o)return new ZU(BU.VALUE,IH.BadCriterion);r=null!=r?r:e;var i=new IQ(n.interpreter,qQ,XQ.empty,(function(e,t){return e.compose(t)}),(function(e){return Zj(e)?XQ.single(Wj(e)):XQ.empty})).compute(r,[new DQ(e,o)]);return i instanceof ZU?i:i.averageValue()||new ZU(BU.DIV_BY_ZERO)}))}},{key:"countif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("COUNTIF"),(function(e,t){var r=n.interpreter.criterionBuilder.fromCellValue(t,n.arithmeticHelper);return void 0===r?new ZU(BU.VALUE,IH.BadCriterion):new IQ(n.interpreter,(function(){return"COUNTIF"}),0,(function(e,t){return e+t}),(function(){return 1})).compute(e,[new DQ(e,r)])}))}},{key:"countifs",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(function(){for(var e=[],t=0;t<arguments.length;t+=2){var r=t<0||arguments.length<=t?void 0:arguments[t],o=n.interpreter.criterionBuilder.fromCellValue(t+1<0||arguments.length<=t+1?void 0:arguments[t+1],n.arithmeticHelper);if(void 0===o)return new ZU(BU.VALUE,IH.BadCriterion);e.push(new DQ(r,o))}return new IQ(n.interpreter,JQ,0,(function(e,t){return e+t}),(function(){return 1})).compute(e[0].conditionRange,e)}))}}]),o}(PF);function ZQ(e){return ZQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZQ(e)}function eZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nZ(e,t){return nZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},nZ(e,t)}function rZ(e,t){if(t&&("object"===ZQ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oZ(e){return oZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oZ(e)}QQ.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NOERROR},{argumentType:bF.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NOERROR},{argumentType:bF.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE},{argumentType:bF.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NOERROR}],repeatLastArgs:2}};var iZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oZ(r);if(o){var n=oZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rZ(this,e)});function a(){return eZ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"sumproduct",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.VALUE,IH.EqualLength);for(var r,o,i=0,a=e.iterateValuesFromTopLeftCorner(),s=t.iterateValuesFromTopLeftCorner();r=a.next(),o=s.next(),!r.done&&!o.done;){if(r.value instanceof ZU)return r.value;if(o.value instanceof ZU)return o.value;var u=n.coerceScalarToNumberOrError(r.value),l=n.coerceScalarToNumberOrError(o.value);Zj(u)&&Zj(l)&&(i+=Wj(u)*Wj(l))}return i}))}}],n&&tZ(t.prototype,n),a}(PF);function aZ(e){return aZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aZ(e)}function sZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lZ(e,t){return lZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lZ(e,t)}function cZ(e,t){if(t&&("object"===aZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fZ(e){return fZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fZ(e)}iZ.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]}},n(51142);var hZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fZ(r);if(o){var n=fZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return cZ(this,e)});function a(){return sZ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"concatenate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(function(){var e;return(e="").concat.apply(e,arguments)}))}},{key:"split",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(function(e,t){var n=e.split(" ");return t>=n.length||t<0?new ZU(BU.VALUE,IH.IndexBounds):n[t]}))}},{key:"len",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(function(e){return e.length}))}},{key:"lower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(function(e){return e.toLowerCase()}))}},{key:"trim",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(function(e){return e.replace(/^ +| +$/g,"").replace(/ +/g," ")}))}},{key:"proper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))}))}},{key:"clean",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(function(e){return e.replace(/[\u0000-\u001F]/g,"")}))}},{key:"exact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(function(e,t){return e===t}))}},{key:"rept",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(function(e,t){return t<0?new ZU(BU.VALUE,IH.NegativeCount):e.repeat(t)}))}},{key:"right",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(function(e,t){return t<0?new ZU(BU.VALUE,IH.NegativeLength):0===t?"":e.slice(-t)}))}},{key:"left",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(function(e,t){return t<0?new ZU(BU.VALUE,IH.NegativeLength):e.slice(0,t)}))}},{key:"mid",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(function(e,t,n){return t<1?new ZU(BU.VALUE,IH.LessThanOne):n<0?new ZU(BU.VALUE,IH.NegativeLength):e.substring(t-1,t+n-1)}))}},{key:"replace",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(function(e,t,n,r){return t<1?new ZU(BU.VALUE,IH.LessThanOne):n<0?new ZU(BU.VALUE,IH.NegativeLength):e.substring(0,t-1)+r+e.substring(t+n-1)}))}},{key:"search",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SEARCH"),(function(e,t,r){if(r<1||r>t.length)return new ZU(BU.VALUE,IH.LengthBounds);var o,i=t.substring(r-1).toLowerCase();return o=n.arithmeticHelper.requiresRegex(e)?n.arithmeticHelper.searchString(e,i):i.indexOf(e.toLowerCase()),(o+=r)>0?o:new ZU(BU.VALUE,IH.PatternNotFound)}))}},{key:"substitute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(function(e,t,n,r){var o,i=new RegExp(t,"g");if(void 0===r)return e.replace(i,n);if(r<1)return new ZU(BU.VALUE,IH.LessThanOne);for(var a=0;null!==(o=i.exec(e));)if(r===++a)return e.substring(0,o.index)+n+e.substring(i.lastIndex);return e}))}},{key:"find",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(function(e,t,n){if(n<1||n>t.length)return new ZU(BU.VALUE,IH.IndexBounds);var r=t.substring(n-1).indexOf(e)+n;return r>0?r:new ZU(BU.VALUE,IH.PatternNotFound)}))}},{key:"t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T"),(function(e){return e instanceof ZU||"string"==typeof e?e:""}))}},{key:"upper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(function(e){return e.toUpperCase()}))}}],n&&uZ(t.prototype,n),a}(PF);function dZ(e){return dZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dZ(e)}function pZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yZ(e,t){return yZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yZ(e,t)}function vZ(e,t){if(t&&("object"===dZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gZ(e){return gZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gZ(e)}hZ.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:bF.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:bF.STRING},{argumentType:bF.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:bF.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:bF.STRING}]},MID:{method:"mid",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:bF.STRING}]},T:{method:"t",parameters:[{argumentType:bF.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:bF.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:bF.STRING}]},REPT:{method:"rept",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:bF.STRING},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:bF.STRING},{argumentType:bF.STRING},{argumentType:bF.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:bF.STRING},{argumentType:bF.STRING},{argumentType:bF.STRING},{argumentType:bF.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:bF.STRING},{argumentType:bF.STRING},{argumentType:bF.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:bF.STRING}]}},n(17388),n(28743),n(74779),n(27680),n(94593),n(59295);var bZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gZ(r);if(o){var n=gZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vZ(this,e)});function a(){return pZ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"acos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(function(e,t){return 0===e&&0===t?new ZU(BU.DIV_BY_ZERO):Math.atan2(t,e)}))}},{key:"cot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(function(e){return 0===e?new ZU(BU.DIV_BY_ZERO):1/Math.tan(e)}))}},{key:"acot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(function(e){return 0===e?Yq/2:Math.atan(1/e)}))}},{key:"sec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(function(e){return 1/Math.cos(e)}))}},{key:"csc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(function(e){return 0===e?new ZU(BU.DIV_BY_ZERO):1/Math.sin(e)}))}},{key:"sinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(function(e){return 0===e?new ZU(BU.DIV_BY_ZERO):1/Math.tanh(e)}))}},{key:"acoth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(function(e){return 0===e?new ZU(BU.NUM,IH.NonZero):Math.atanh(1/e)}))}},{key:"sech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(function(e){return 1/Math.cosh(e)}))}},{key:"csch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(function(e){return 0===e?new ZU(BU.DIV_BY_ZERO):1/Math.sinh(e)}))}}],n&&mZ(t.prototype,n),a}(PF);function wZ(e){return wZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wZ(e)}function _Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SZ(e,t){return SZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},SZ(e,t)}function EZ(e,t){if(t&&("object"===wZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kZ(e){return kZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kZ(e)}bZ.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:bF.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:bF.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:bF.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:bF.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:bF.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:bF.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:bF.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:bF.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:bF.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:bF.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:bF.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:bF.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:bF.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:bF.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:bF.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:bF.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:bF.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:bF.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:bF.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:bF.NUMBER}]}};var RZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kZ(r);if(o){var n=kZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return EZ(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t)).config=e,n.dependencyGraph=t,n}return t=a,n=[{key:"find",value:function(e,t,n){"string"==typeof e&&(e=CF(e));var r=t.range;return void 0===r?t.valuesFromTopLeftCorner().map(Wj).indexOf(e):n?BG(r,e,this.dependencyGraph,"col"):this.dependencyGraph.computeListOfValuesInRange(r).findIndex((function(t){return(t="string"==typeof(t=Wj(t))?CF(t):t)===e}))}}],n&&_Z(t.prototype,n),a}(zG);function TZ(e){return TZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TZ(e)}function CZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OZ(e,t){return OZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},OZ(e,t)}function AZ(e,t){if(t&&("object"===TZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function LZ(e){return LZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},LZ(e)}var xZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=LZ(r);if(o){var n=LZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return AZ(this,e)});function a(){var e;return CZ(this,a),(e=i.apply(this,arguments)).rowSearch=new RZ(e.config,e.dependencyGraph),e}return t=a,n=[{key:"vlookup",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(function(e,t,r,o){var i=t.range;return void 0===i?new ZU(BU.VALUE,IH.WrongType):r<1?new ZU(BU.VALUE,IH.LessThanOne):r>i.width()?new ZU(BU.REF,IH.IndexLarge):n.doVlookup(pF(e),t,r-1,o)}))}},{key:"hlookup",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(function(e,t,r,o){var i=t.range;return void 0===i?new ZU(BU.VALUE,IH.WrongType):r<1?new ZU(BU.VALUE,IH.LessThanOne):r>i.height()?new ZU(BU.REF,IH.IndexLarge):n.doHlookup(pF(e),t,r-1,o)}))}},{key:"match",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MATCH"),(function(e,t,r){return n.doMatch(pF(e),t,r)}))}},{key:"doVlookup",value:function(e,t,n,r){this.dependencyGraph.stats.start(QF.VLOOKUP);var o,i=t.range;o=void 0===i?XF.onlyValues(t.data.map((function(e){return[e[0]]}))):XF.onlyRange(Cj.spanFrom(i.start,1,i.height()),this.dependencyGraph);var a,s=this.searchInRange(e,o,r,this.columnSearch);if(this.dependencyGraph.stats.end(QF.VLOOKUP),-1===s)return new ZU(BU.NA,IH.ValueNotFound);if(void 0===i)a=t.data[s][n];else{var u=oB(i.sheet,i.start.col+n,i.start.row+s);a=this.dependencyGraph.getCellValue(u)}return a instanceof XF?new ZU(BU.VALUE,IH.WrongType):a}},{key:"doHlookup",value:function(e,t,n,r){var o,i=t.range;o=void 0===i?XF.onlyValues([t.data[0]]):XF.onlyRange(Cj.spanFrom(i.start,i.width(),1),this.dependencyGraph);var a,s=this.searchInRange(e,o,r,this.rowSearch);if(-1===s)return new ZU(BU.NA,IH.ValueNotFound);if(void 0===i)a=t.data[n][s];else{var u=oB(i.sheet,i.start.col+s,i.start.row+n);a=this.dependencyGraph.getCellValue(u)}return a instanceof XF?new ZU(BU.VALUE,IH.WrongType):a}},{key:"doMatch",value:function(e,t,n){if(t.width()>1&&t.height()>1)return new ZU(BU.NA);if(1===t.width()){var r=this.columnSearch.find(e,t,0!==n);return-1===r?new ZU(BU.NA,IH.ValueNotFound):r+1}var o=this.rowSearch.find(e,t,0!==n);return-1===o?new ZU(BU.NA,IH.ValueNotFound):o+1}},{key:"searchInRange",value:function(e,t,n,r){return!n&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?r.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t):r.find(e,t,n)}}],n&&MZ(t.prototype,n),a}(PF);function NZ(e){return NZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NZ(e)}function IZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PZ(e,t){return PZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},PZ(e,t)}function HZ(e,t){if(t&&("object"===NZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jZ(e){return jZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jZ(e)}xZ.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:bF.NOERROR},{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:bF.NOERROR},{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:bF.NOERROR},{argumentType:bF.RANGE},{argumentType:bF.NUMBER,defaultValue:1}]}};var FZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=jZ(r);if(o){var n=jZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return HZ(this,e)});function a(){return IZ(this,a),i.apply(this,arguments)}return t=a,n=[{key:"roman",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("ROMAN"),(function(e,t){return e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=Wj(n.coerceScalarToNumberOrError(t)))instanceof ZU?t:(t=Math.trunc(t))<0?new ZU(BU.VALUE,IH.ValueSmall):t>4?new ZU(BU.VALUE,IH.ValueLarge):function(e,t){var n={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(UZ(n,"IM",999,1e3),UZ(n,"ID",499,500)),t>=3&&(UZ(n,"VM",995,1e3),UZ(n,"VD",495,500)),t>=2&&(UZ(n,"XM",990,1e3),UZ(n,"XD",490,500)),t>=1&&(UZ(n,"LM",950,1e3),UZ(n,"LD",450,500)),UZ(n,"CM",900,1e3),UZ(n,"CD",400,500),UZ(n,"D",500,900),n.acc+="C".repeat(Math.floor(n.val/100)),n.val%=100,t>=2&&(UZ(n,"IC",99,100),UZ(n,"IL",49,50)),t>=1&&(UZ(n,"VC",95,100),UZ(n,"VL",45,50)),UZ(n,"XC",90,100),UZ(n,"XL",40,50),UZ(n,"L",50,90),n.acc+="X".repeat(Math.floor(n.val/10)),n.val%=10,UZ(n,"IX",9,10),UZ(n,"IV",4,5),UZ(n,"V",5,9),n.acc+="I".repeat(n.val),n.acc}(e,t)}))}},{key:"arabic",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(function(e){var t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new ZU(BU.VALUE,IH.InvalidRoman);var n={input:e,acc:0};return YZ(n,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),YZ(n,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),YZ(n,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),YZ(n,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),YZ(n,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),YZ(n,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),YZ(n,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),YZ(n,{token:"IX",val:9}),YZ(n,{token:"V",val:5},{token:"IV",val:4}),YZ(n,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==n.input?new ZU(BU.VALUE,IH.InvalidRoman):t?-n.acc:n.acc}))}}],n&&DZ(t.prototype,n),a}(PF);function YZ(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=i[o];if(e.input.startsWith(a.token)){e.input=e.input.slice(a.token.length),e.acc+=a.val;break}}}function UZ(e,t,n,r){e.val>=n&&e.val<r&&(e.val-=n,e.acc+=t)}function BZ(e){return BZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BZ(e)}function VZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zZ(e,t){return zZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},zZ(e,t)}function GZ(e,t){if(t&&("object"===BZ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function KZ(e){return KZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},KZ(e)}FZ.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:bF.NUMBER,minValue:1,lessThan:4e3},{argumentType:bF.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:bF.STRING}]}};var XZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zZ(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=KZ(r);if(o){var n=KZ(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return GZ(this,e)});function a(){return VZ(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"add",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}},{key:"divide",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}},{key:"eq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}},{key:"gt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}},{key:"gte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}},{key:"lt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}},{key:"lte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}},{key:"minus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}},{key:"multiply",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}},{key:"ne",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}},{key:"pow",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}},{key:"uminus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}])&&WZ(t.prototype,n),a}(PF);XZ.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:bF.NUMBER,passSubtype:!0},{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:bF.STRING,passSubtype:!0},{argumentType:bF.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:bF.NUMBER,passSubtype:!0},{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:bF.NUMBER,passSubtype:!0},{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:bF.NUMBER,passSubtype:!0},{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:bF.NOERROR,passSubtype:!0},{argumentType:bF.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:bF.NUMBER,passSubtype:!0},{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:bF.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:bF.NUMBER,passSubtype:!0}]}};var $Z=Math;function qZ(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function JZ(e,t,n,r,o){if(0===t)return n;if(1===t)return r;for(var i=2/e,a=r,s=1;s<t;++s)a=r*s*i+o*n,n=r,r=a;return a}function QZ(e,t,n,r,o){return function(n,i){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===i?e(n):1===i?t(n):i<0?NaN:JZ(n,i|=0,e(n),t(n),o)}}var ZZ,e1,t1,n1,r1,o1,i1,a1,s1,u1,l1,c1,f1,h1=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),n=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),o=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function i(i){var a=0,s=0,u=0,l=i*i;if(i<8)a=(s=qZ(t,l))/(u=qZ(n,l));else{var c=i-.785398164;s=qZ(r,l=64/l),u=qZ(o,l),a=$Z.sqrt(e/i)*($Z.cos(c)*s-$Z.sin(c)*u*8/i)}return a}var a=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function c(t){var n=0,r=0,o=0,i=t*t,c=$Z.abs(t)-2.356194491;return Math.abs(t)<8?n=(r=t*qZ(a,i))/(o=qZ(s,i)):(r=qZ(u,i=64/i),o=qZ(l,i),n=$Z.sqrt(e/$Z.abs(t))*($Z.cos(c)*r-$Z.sin(c)*o*8/$Z.abs(t)),t<0&&(n=-n)),n}return function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return i(t);if(1===n)return c(t);if(0===t)return 0;var r=0;if(t>n)r=JZ(t,n,i(t),c(t),-1);else{for(var o=!1,a=0,s=0,u=1,l=0,f=2/t,h=2*$Z.floor((n+$Z.floor($Z.sqrt(40*n)))/2);h>0;h--)l=h*f*u-a,a=u,u=l,$Z.abs(u)>1e10&&(u*=1e-10,a*=1e-10,r*=1e-10,s*=1e-10),o&&(s+=u),o=!o,h==n&&(r=a);r/=s=2*s-u}return r}}(),d1=(ZZ=.636619772,e1=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),t1=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n1=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),r1=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),o1=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),i1=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),a1=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),s1=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),QZ((function(e){var t=0,n=0,r=0,o=e*e,i=e-.785398164;return e<8?t=(n=qZ(e1,o))/(r=qZ(t1,o))+ZZ*h1(e,0)*$Z.log(e):(n=qZ(n1,o=64/o),r=qZ(r1,o),t=$Z.sqrt(ZZ/e)*($Z.sin(i)*n+$Z.cos(i)*r*8/e)),t}),(function(e){var t=0,n=0,r=0,o=e*e,i=e-2.356194491;return e<8?t=(n=e*qZ(o1,o))/(r=qZ(i1,o))+ZZ*(h1(e,1)*$Z.log(e)-1/e):(n=qZ(a1,o=64/o),r=qZ(s1,o),t=$Z.sqrt(ZZ/e)*($Z.sin(i)*n+$Z.cos(i)*r*8/e)),t}),0,1,-1)),p1=(u1=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l1=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),c1=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),f1=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,n){if(0===(n=Math.round(n)))return function(e){return e<=3.75?qZ(u1,e*e/14.0625):$Z.exp($Z.abs(e))/$Z.sqrt($Z.abs(e))*qZ(l1,3.75/$Z.abs(e))}(t);if(1===n)return function(e){return e<3.75?e*qZ(c1,e*e/14.0625):(e<0?-1:1)*$Z.exp($Z.abs(e))/$Z.sqrt($Z.abs(e))*qZ(f1,3.75/$Z.abs(e))}(t);if(n<0)return NaN;if(0===$Z.abs(t))return 0;if(t==1/0)return 1/0;var r,o=0,i=2/$Z.abs(t),a=0,s=1,u=0;for(r=2*$Z.round((n+$Z.round($Z.sqrt(40*n)))/2);r>0;r--)u=r*i*s+a,a=s,s=u,$Z.abs(s)>1e10&&(s*=1e-10,a*=1e-10,o*=1e-10),r==n&&(o=a);return o*=e(t,0)/s,t<0&&n%2?-o:o}),m1=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),r=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return QZ((function(n){return n<=2?-$Z.log(n/2)*p1(n,0)+qZ(e,n*n/4):$Z.exp(-n)/$Z.sqrt(n)*qZ(t,2/n)}),(function(e){return e<=2?$Z.log(e/2)*p1(e,1)+1/e*qZ(n,e*e/4):$Z.exp(-e)/$Z.sqrt(e)*qZ(r,2/e)}),0,2,1)}();function y1(e){var t,n,r,o,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=i.length-1,s=!1,u=0,l=0;if(0===e)return 0;for(e<0&&(e=-e,s=!0),n=4*(t=2/(2+e))-2;a>0;a--)r=u,u=n*u-l+i[a],l=r;return o=t*Math.exp(-e*e+.5*(i[0]+n*u)-l),s?o-1:1-o}function v1(e){return 1-y1(e)}function g1(e){var t,n,r,o,i=0;if(e>=2)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,t=-.70711*((2.30753+.27061*(r=Math.sqrt(-2*Math.log(o/2))))/(1+r*(.99229+.04481*r))-r);i<2;i++)t+=(n=v1(t)-o)/(1.1283791670955126*Math.exp(-t*t)-t*n);return e<1?t:-t}function b1(e){var t,n,r,o,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,u=0,l=0,c=0,f=e;if(e>171.6243769536076)return 1/0;if(f<=0){if(!(o=f%1))return 1/0;s=(1&f?-1:1)*Math.PI/Math.sin(Math.PI*o),f=1-f}for(r=f,n=f<1?f++:(f-=u=(0|f)-1)-1,t=0;t<8;++t)c=(c+i[t])*n,l=l*n+a[t];if(o=c/l+1,r<f)o/=r;else if(r>f)for(t=0;t<u;++t)o*=f,f++;return s&&(o=s/o),o}var w1=function(e,t,n){return E1(e,t)*n};function _1(e){var t,n,r,o=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=t=e)+5.5,r-=(t+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.5066282746310007*a/t)-r}function S1(e,t){var n,r=_1(e),o=e,i=1/e,a=i,s=t+1-e,u=1/1e-30,l=1/s,c=l,f=1,h=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;f<=h;f++)i+=a*=t/++o;return i*Math.exp(-t+e*Math.log(t)-r)}for(;f<=h;f++)c*=(l=1/(l=(n=-f*(f-e))*l+(s+=2)))*(u=s+n/u);return 1-c*Math.exp(-t+e*Math.log(t)-r)}function E1(e,t){var n,r,o,i,a,s,u=0,l=t-1,c=_1(t);if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(a=Math.log(l),s=Math.exp(l*(a-1)-c),i=e<.5?e:1-e,n=(2.30753+.27061*(r=Math.sqrt(-2*Math.log(i))))/(1+r*(.99229+.04481*r))-r,e<.5&&(n=-n),n=Math.max(.001,t*Math.pow(1-1/(9*t)-n/(3*Math.sqrt(t)),3))):n=e<(r=1-t*(.253+.12*t))?Math.pow(e/r,1/t):1-Math.log(1-(e-r)/(1-r));u<12;u++){if(n<=0)return 0;if((n-=r=(o=(S1(t,n)-e)/(r=t>1?s*Math.exp(-(n-l)+l*(Math.log(n)-a)):Math.exp(-n+l*Math.log(n)-c)))/(1-.5*Math.min(1,o*((t-1)/n-1))))<=0&&(n=.5*(n+r)),Math.abs(r)<1e-8*n)break}return n}var k1=function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},R1=function(e,t,n){return.5*(1+y1((e-t)/Math.sqrt(2*n*n)))},T1=function(e,t,n){return-1.4142135623730951*n*g1(2*e)+t};function C1(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(M1(e,t)):b1(e)*b1(t)/b1(e+t)}function M1(e,t){return _1(e)+_1(t)-_1(e+t)}function O1(e,t,n){var r,o,i,a,s,u,l,c,f,h,d=t-1,p=n-1,m=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(i=e<.5?e:1-e,u=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,e<.5&&(u=-u),l=(u*u-3)/6,c=2/(1/(2*t-1)+1/(2*n-1)),f=u*Math.sqrt(l+c)/c-(1/(2*n-1)-1/(2*t-1))*(l+5/6-2/(3*c)),u=t/(t+n*Math.exp(2*f))):(r=Math.log(t/(t+n)),o=Math.log(n/(t+n)),u=e<(a=Math.exp(t*r)/t)/(f=a+(s=Math.exp(n*o)/n))?Math.pow(t*f*e,1/t):1-Math.pow(n*f*(1-e),1/n)),h=-_1(t)-_1(n)+_1(t+n);m<10;m++){if(0===u||1===u)return u;if((u-=a=(s=(A1(u,t,n)-e)/(a=Math.exp(d*Math.log(u)+p*Math.log(1-u)+h)))/(1-.5*Math.min(1,s*(d/u-p/(1-u)))))<=0&&(u=.5*(u+a)),u>=1&&(u=.5*(u+a+1)),Math.abs(a)<1e-8*u&&m>0)break}return u}function A1(e,t,n){var r=0===e||1===e?0:Math.exp(_1(t+n)-_1(t)-_1(n)+t*Math.log(e)+n*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+n+2)?r*L1(e,t,n)/t:1-r*L1(1-e,n,t)/n)}function L1(e,t,n){var r,o,i,a,s=1e-30,u=1,l=t+n,c=t+1,f=t-1,h=1,d=1-l*e/c;for(Math.abs(d)<s&&(d=s),a=d=1/d;u<=100&&(d=1+(o=u*(n-u)*e/((f+(r=2*u))*(t+r)))*d,Math.abs(d)<s&&(d=s),h=1+o/h,Math.abs(h)<s&&(h=s),a*=(d=1/d)*h,d=1+(o=-(t+u)*(l+u)*e/((t+r)*(c+r)))*d,Math.abs(d)<s&&(d=s),h=1+o/h,Math.abs(h)<s&&(h=s),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));u++);return a}var x1=function(e,t,n){return 0===n||1===n?t*n===e?1:0:D1(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)},N1=function(e,t,n){var r,o=1e-10;if(e<0)return 0;if(e>=t)return 1;if(n<0||n>1||t<=0)return NaN;var i=n,a=(e=Math.floor(e))+1,s=t-e,u=a+s,l=Math.exp(_1(u)-_1(s)-_1(a)+a*Math.log(i)+s*Math.log(1-i));return r=i<(a+1)/(u+2)?l*I1(i,a,s,o):1-l*I1(1-i,s,a,o),Math.round(1/o*(1-r))/(1/o)};function I1(e,t,n,r){for(var o,i=0,a=1,s=1,u=1,l=0,c=0;Math.abs((s-c)/s)>r;)c=s,a=u+(o=-(t+l)*(t+n+l)*e/(t+2*l)/(t+2*l+1))*a,s=(i=s+o*i)+(o=(l+=1)*(n-l)*e/(t+2*l-1)/(t+2*l))*s,i/=u=a+o*u,a/=u,s/=u,u=1;return s/t}function D1(e,t){return e>170||t>170?Math.exp(function(e,t){return P1(e)-P1(t)-P1(e-t)}(e,t)):H1(e)/H1(t)/H1(e-t)}function P1(e){return e<0?NaN:_1(e+1)}function H1(e){return e<0?NaN:b1(e+1)}var j1=function(e,t){return e<0?0:S1(t/2,e/2)},F1=function(e,t){return 2*E1(e,.5*t)},Y1=function(e,t,n){return e<0?0:A1(t*e/(t*e+n),t/2,n/2)},U1=function(e,t,n){return n/(t*(1/O1(e,t/2,n/2)-1))},B1={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/H1(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var r=0;n<=e;n++)r+=B1.pdf(n,t);return r}},V1={pdf:function(e,t,n,r){if(e<0||e<n-(t-r))return 0;if(e>r||e>n)return 0;if(2*n>t)return 2*r>t?V1.pdf(t-n-r+e,t,t-n,t-r):V1.pdf(r-e,t,t-n,r);if(2*r>t)return V1.pdf(n-e,t,n,t-r);if(n<r)return V1.pdf(e,t,r,n);for(var o=1,i=0,a=0;a<e;a++){for(;o>1&&i<r;)o*=1-n/(t-i),i++;o*=(r-a)*(n-a)/((a+1)*(t-n-r+a+1))}for(;i<r;i++)o*=1-n/(t-i);return Math.min(1,Math.max(0,o))},cdf:function e(t,n,r,o){if(t<0||t<r-(n-o))return 0;if(t>=o||t>=r)return 1;if(2*r>n)return 2*o>n?e(n-r-o+t,n,n-r,n-o):1-V1.cdf(o-t-1,n,n-r,o);if(2*o>n)return 1-V1.cdf(r-t-1,n,r,n-o);if(r<o)return V1.cdf(t,n,o,r);for(var i=1,a=1,s=0,u=0;u<t;u++){for(;i>1&&s<o;){var l=1-r/(n-s);a*=l,i*=l,s++}i+=a*=(o-u)*(r-u)/((u+1)*(n-r-o+u+1))}for(;s<o;s++)i*=1-r/(n-s);return Math.min(1,Math.max(0,i))}},W1=function(e,t){var n=t/2;return A1((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},z1=function(e,t){var n=O1(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n},G1={pdf:function(e,t,n){return e===e>>>0&&(e<0?0:D1(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t))},cdf:function(e,t,n){var r=0,o=0;if(e<0)return 0;for(;o<=e;o++)r+=G1.pdf(o,t,n);return r}};function K1(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t}function X1(e){return K1(e)/e.length}function $1(e){for(var t,n=X1(e),r=0,o=e.length;--o>=0;)r+=(t=e[o]-n)*t;return r}function q1(e,t){return $1(e)/(e.length-(t?1:0))}function J1(e,t){return Math.sqrt(q1(e,t))}function Q1(e){return Math.pow(function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t}(e),1/e.length)}function Z1(e,t){var n,r=X1(e),o=X1(t),i=e.length,a=new Array(i);for(n=0;n<i;n++)a[n]=(e[n]-r)*(t[n]-o);return K1(a)/(i-1)}function e0(e,t){return Z1(e,t)/J1(e,1)/J1(t,1)}function t0(e){return t0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t0(e)}function n0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o0(e,t){return o0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o0(e,t)}function i0(e,t){if(t&&("object"===t0(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a0(e){return a0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a0(e)}var s0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o0(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=a0(r);if(o){var n=a0(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return i0(this,e)});function a(){return n0(this,a),i.apply(this,arguments)}return t=a,n=[{key:"erf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(function(e,t){return void 0===t?y1(e):y1(t)-y1(e)}))}},{key:"erfc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),v1)}},{key:"expondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(function(e,t,n){return n?function(e,t){return e<0?0:1-Math.exp(-t*e)}(e,t):function(e,t){return e<0?0:t*Math.exp(-t*e)}(e,t)}))}},{key:"fisher",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(function(e){return Math.log((1+e)/(1-e))/2}))}},{key:"fisherinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(function(e){return 1-2/(Math.exp(2*e)+1)}))}},{key:"gamma",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),b1)}},{key:"gammadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(function(e,t,n,r){return r?function(e,t,n){return e<0?0:S1(t,e/n)}(e,t,n):function(e,t,n){return e<0?0:0===e&&1===t?1/n:Math.exp((t-1)*Math.log(e)-e/n-_1(t)-t*Math.log(n))}(e,t,n)}))}},{key:"gammaln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),_1)}},{key:"gammainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),w1)}},{key:"gauss",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(function(e){return R1(e,0,1)-.5}))}},{key:"betadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(function(e,t,n,r,o,i){return e<=o?new ZU(BU.NUM,IH.ValueSmall):e>=i?new ZU(BU.NUM,IH.ValueLarge):(e=(e-o)/(i-o),r?function(e,t,n){return e>1||e<0?+(e>1):A1(e,t,n)}(e,t,n):function(e,t,n){return e>1||e<0?0:1==t&&1==n?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/C1(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-M1(t,n))}(e,t,n))}))}},{key:"betainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(function(e,t,n,r,o){return r>=o?new ZU(BU.NUM,IH.WrongOrder):function(e,t,n){return O1(e,t,n)}(e,t,n)*(o-r)+r}))}},{key:"binomialdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(function(e,t,n,r){return e>t?new ZU(BU.NUM,IH.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),r?N1(e,t,n):x1(e,t,n))}))}},{key:"binomialinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(function(e,t,n){for(var r=-1,o=e=Math.trunc(e);o>r+1;){var i=Math.trunc((r+o)/2);N1(i,e,t)>=n?o=i:r=i}return o}))}},{key:"besselifn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(function(e,t){return p1(e,Math.trunc(t))}))}},{key:"besseljfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(function(e,t){return h1(e,Math.trunc(t))}))}},{key:"besselkfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(function(e,t){return m1(e,Math.trunc(t))}))}},{key:"besselyfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(function(e,t){return d1(e,Math.trunc(t))}))}},{key:"chisqdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(function(e,t,n){return t=Math.trunc(t),n?j1(e,t):function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-_1(t/2))}(e,t)}))}},{key:"chisqdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(function(e,t){return 1-j1(e,Math.trunc(t))}))}},{key:"chisqinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(function(e,t){return F1(e,Math.trunc(t))}))}},{key:"chisqinvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(function(e,t){return F1(1-e,Math.trunc(t))}))}},{key:"fdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(function(e,t,n,r){return t=Math.trunc(t),n=Math.trunc(n),r?Y1(e,t,n):function(e,t,n){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/C1(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):t*(n/(n+e*t))/2*x1((t-2)/2,(t+n-2)/2,t*e/(n+e*t))}(e,t,n)}))}},{key:"fdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(function(e,t,n){return 1-Y1(e,Math.trunc(t),Math.trunc(n))}))}},{key:"finv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(function(e,t,n){return U1(e,Math.trunc(t),Math.trunc(n))}))}},{key:"finvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(function(e,t,n){return U1(1-e,Math.trunc(t),Math.trunc(n))}))}},{key:"weibulldist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(function(e,t,n,r){return r?function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}(e,n,t):function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))}(e,n,t)}))}},{key:"poissondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(function(e,t,n){return e=Math.trunc(e),n?B1.cdf(e,t):B1.pdf(e,t)}))}},{key:"hypgeomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(function(e,t,n,r,o){return e>t||e>n||t>r||n>r||e+r<n+t?new ZU(BU.NUM,IH.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),o?V1.cdf(e,r,n,t):V1.pdf(e,r,n,t))}))}},{key:"tdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(function(e,t,n){return t=Math.trunc(t),n?W1(e,t):function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*C1(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)}(e,t)}))}},{key:"tdist2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(function(e,t){return 2*(1-W1(e,Math.trunc(t)))}))}},{key:"tdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(function(e,t){return 1-W1(e,Math.trunc(t))}))}},{key:"tdistold",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(function(e,t,n){return n*(1-W1(e,Math.trunc(t)))}))}},{key:"tinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(function(e,t){return z1(e,Math.trunc(t))}))}},{key:"tinv2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(function(e,t){return z1(1-e/2,Math.trunc(t))}))}},{key:"lognormdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(function(e,t,n,r){return r?function(e,t,n){return e<0?0:.5+.5*y1((Math.log(e)-t)/Math.sqrt(2*n*n))}(e,t,n):function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))}(e,t,n)}))}},{key:"lognorminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(function(e,t,n){return function(e,t,n){return Math.exp(-1.4142135623730951*n*g1(2*e)+t)}(e,t,n)}))}},{key:"normdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(function(e,t,n,r){return r?R1(e,t,n):k1(e,t,n)}))}},{key:"norminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(function(e,t,n){return T1(e,t,n)}))}},{key:"normsdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(function(e,t){return t?R1(e,0,1):k1(e,0,1)}))}},{key:"normsinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(function(e){return T1(e,0,1)}))}},{key:"phi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(function(e){return k1(e,0,1)}))}},{key:"negbinomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(function(e,t,n,r){return e=Math.trunc(e),t=Math.trunc(t),r?G1.cdf(e,t,n):G1.pdf(e,t,n)}))}},{key:"confidencenorm",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(function(e,t,n){return function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(T1(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(T1(t[1]/2,0,1)*J1(t[2])/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,Math.trunc(n))[1]-1}))}},{key:"confidencet",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(function(e,t,n){return 1===(n=Math.trunc(n))?new ZU(BU.DIV_BY_ZERO):function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(z1(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(z1(t[1]/2,t[2].length-1)*J1(t[2],!0)/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,n)[1]-1}))}},{key:"standardize",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(function(e,t,n){return(e-t)/n}))}}],n&&r0(t.prototype,n),a}(PF);function u0(e){return u0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u0(e)}function l0(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c0(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function c0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d0(e,t){return d0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d0(e,t)}function p0(e,t){if(t&&("object"===u0(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m0(e){return m0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m0(e)}s0.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:bF.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:bF.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:bF.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:bF.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:bF.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:bF.NUMBER,minValue:0,lessThan:1},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:bF.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:bF.NUMBER,greaterThan:0,maxValue:1},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,defaultValue:0},{argumentType:bF.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:1,maxValue:1e10},{argumentType:bF.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1},{argumentType:bF.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:bF.NUMBER,greaterThan:0,maxValue:1},{argumentType:bF.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:bF.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:1},{argumentType:bF.NUMBER,minValue:0,maxValue:1},{argumentType:bF.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:bF.NUMBER,greaterThan:0,lessThan:1},{argumentType:bF.NUMBER,greaterThan:0},{argumentType:bF.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,greaterThan:0}]}},s0.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"},n(66474);var y0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d0(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m0(r);if(o){var n=m0(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p0(this,e)});function a(){return f0(this,a),i.apply(this,arguments)}return t=a,n=[{key:"fact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(function(e){e=Math.trunc(e);for(var t=1,n=1;n<=e;n++)t*=n;return t}))}},{key:"factdouble",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(function(e){for(var t=1,n=e=Math.trunc(e);n>=1;n-=2)t*=n;return t}))}},{key:"combin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(function(e,t){return t>e?new ZU(BU.NUM,IH.WrongOrder):v0(e=Math.trunc(e),t=Math.trunc(t))}))}},{key:"combina",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(function(e,t){return(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new ZU(BU.NUM,IH.ValueLarge):0===e&&0===t?1:v0(e+t-1,t)}))}},{key:"gcd",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("GCD"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(o instanceof ZU)return o;var i,a=0,s=l0(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u<0)return new ZU(BU.NUM,IH.ValueSmall);a=g0(a,Math.trunc(u))}}catch(e){s.e(e)}finally{s.f()}return a>Number.MAX_SAFE_INTEGER?new ZU(BU.NUM,IH.ValueLarge):a}))}},{key:"lcm",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("LCM"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(o instanceof ZU)return o;var i,a=1,s=l0(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u<0)return new ZU(BU.NUM,IH.ValueSmall);a=b0(a,Math.trunc(u))}}catch(e){s.e(e)}finally{s.f()}return a>Number.MAX_SAFE_INTEGER?new ZU(BU.NUM,IH.ValueLarge):a}))}},{key:"mround",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(function(e,t){return 0===t?0:e>0&&t<0||e<0&&t>0?new ZU(BU.NUM,IH.DistinctSigns):Math.round(e/t)*t}))}},{key:"multinomial",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(function(){for(var e=0,t=1,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var i=0,a=r;i<a.length;i++){var s=a[i];if(s<0)return new ZU(BU.NUM,IH.ValueSmall);s=Math.trunc(s);for(var u=1;u<=s;u++)t*=(e+u)/u;e+=s}return Math.round(t)}))}},{key:"quotient",value:function(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(function(e,t){return 0===t?new ZU(BU.DIV_BY_ZERO):Math.trunc(e/t)}))}},{key:"seriessum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(function(e,t,r,o){var i=n.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(i instanceof ZU)return i;var a=0;i.reverse();var s,u=l0(i);try{for(u.s();!(s=u.n()).done;){var l=s.value;a*=Math.pow(e,r),a+=l}}catch(e){u.e(e)}finally{u.f()}return a*Math.pow(e,t)}))}},{key:"sign",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(function(e){return e>0?1:e<0?-1:0}))}},{key:"sumx2my2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new ZU(BU.NA,IH.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof ZU)return s;if(u instanceof ZU)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s,2)-Math.pow(u,2))}return i}))}},{key:"sumx2py2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new ZU(BU.NA,IH.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof ZU)return s;if(u instanceof ZU)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s,2)+Math.pow(u,2))}return i}))}},{key:"sumxmy2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new ZU(BU.NA,IH.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof ZU)return s;if(u instanceof ZU)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s-u,2))}return i}))}}],n&&h0(t.prototype,n),a}(PF);function v0(e,t){2*t>e&&(t=e-t);for(var n=1,r=1;r<=t;r++)n*=(e-t+r)/r;return Math.round(n)}function g0(e,t){if(e<t){var n=[t,e];e=n[0],t=n[1]}for(;t>0;){var r=[t,e%t];e=r[0],t=r[1]}return e}function b0(e,t){return 0===e||0===t?0:e*(t/g0(e,t))}function w0(e){return w0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w0(e)}function _0(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=E0(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function S0(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||E0(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E0(e,t){if(e){if("string"==typeof e)return k0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k0(e,t):void 0}}function k0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C0(e,t){return C0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C0(e,t)}function M0(e,t){if(t&&("object"===w0(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O0(e){return O0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O0(e)}y0.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:bF.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:bF.NUMBER,minValue:0,lessThan:1030},{argumentType:bF.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:bF.NUMBER,minValue:0},{argumentType:bF.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:bF.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:bF.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]}};var A0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C0(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O0(r);if(o){var n=O0(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return M0(this,e)});function a(){return R0(this,a),i.apply(this,arguments)}return t=a,n=[{key:"complex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(function(e,t,n){return"i"!==n&&"j"!==n?new ZU(BU.VALUE,IH.ShouldBeIorJ):uF([e,t],n)}))}},{key:"imabs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),F0)}},{key:"imaginary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(function(e){var t=S0(e,2);return t[0],t[1]}))}},{key:"imreal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(function(e){var t=S0(e,2),n=t[0];return t[1],n}))}},{key:"imargument",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(function(e){var t=S0(e,2),n=t[0],r=t[1];return 0===n&&0===r?new ZU(BU.DIV_BY_ZERO):Math.atan2(r,n)}))}},{key:"imconjugate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(function(e){var t=S0(e,2);return uF([t[0],-t[1]])}))}},{key:"imcos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(function(e){return uF(I0(e))}))}},{key:"imcosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(function(e){return uF(D0(e))}))}},{key:"imcot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(function(e){return uF(N0(I0(e),P0(e)))}))}},{key:"imcsc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(function(e){return uF(N0([1,0],P0(e)))}))}},{key:"imcsch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(function(e){return uF(N0([1,0],H0(e)))}))}},{key:"imsec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(function(e){return uF(N0([1,0],I0(e)))}))}},{key:"imsech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(function(e){return uF(N0([1,0],D0(e)))}))}},{key:"imsin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(function(e){return uF(P0(e))}))}},{key:"imsinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(function(e){return uF(H0(e))}))}},{key:"imtan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(function(e){return uF(N0(P0(e),I0(e)))}))}},{key:"imdiv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(function(e,t){return uF(N0(e,t))}))}},{key:"improduct",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceComplexExactRanges(t);if(o instanceof ZU)return o;var i,a=[1,0],s=_0(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;a=x0(a,u)}}catch(e){s.e(e)}finally{s.f()}return uF(a)}))}},{key:"imsum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("IMSUM"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceComplexExactRanges(t);if(o instanceof ZU)return o;var i,a=[0,0],s=_0(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;a=L0(a,u)}}catch(e){s.e(e)}finally{s.f()}return uF(a)}))}},{key:"imsub",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(function(e,t){return uF((n=t,o=(r=S0(e,2))[0],i=r[1],[o-(a=S0(n,2))[0],i-a[1]]));var n,r,o,i,a}))}},{key:"imexp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(function(e){return uF(j0(e))}))}},{key:"imln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(function(e){return uF(Y0(e))}))}},{key:"imlog10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(function(e){var t=S0(Y0(e),2),n=t[0],r=t[1],o=Math.log(10);return uF([n/o,r/o])}))}},{key:"imlog2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(function(e){var t=S0(Y0(e),2),n=t[0],r=t[1],o=Math.log(2);return uF([n/o,r/o])}))}},{key:"impower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(function(e,t){return uF(U0(e,t))}))}},{key:"imsqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(function(e){return uF(U0(e,.5))}))}}],n&&T0(t.prototype,n),a}(PF);function L0(e,t){var n=S0(e,2),r=n[0],o=n[1],i=S0(t,2);return[r+i[0],o+i[1]]}function x0(e,t){var n=S0(e,2),r=n[0],o=n[1],i=S0(t,2),a=i[0],s=i[1];return[r*a-o*s,r*s+a*o]}function N0(e,t){var n=S0(e,2),r=n[0],o=n[1],i=S0(t,2),a=i[0],s=i[1],u=Math.pow(a,2)+Math.pow(s,2),l=S0(x0([r,o],[a,-s]),2);return[l[0]/u,l[1]/u]}function I0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.cos(n)*Math.cosh(r),-Math.sin(n)*Math.sinh(r)]}function D0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.cosh(n)*Math.cos(r),Math.sinh(n)*Math.sin(r)]}function P0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.sin(n)*Math.cosh(r),Math.cos(n)*Math.sinh(r)]}function H0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.sinh(n)*Math.cos(r),Math.cosh(n)*Math.sin(r)]}function j0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.exp(n)*Math.cos(r),Math.exp(n)*Math.sin(r)]}function F0(e){var t=S0(e,2),n=t[0],r=t[1];return Math.sqrt(n*n+r*r)}function Y0(e){var t=S0(e,2),n=t[0],r=t[1];return[Math.log(F0([n,r])),Math.atan2(r,n)]}function U0(e,t){var n=S0(Y0(e),2);return j0([t*n[0],t*n[1]])}function B0(e){return B0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B0(e)}function V0(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return W0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W0(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function W0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K0(e,t){return K0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},K0(e,t)}function X0(e,t){if(t&&("object"===B0(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $0(e){return $0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$0(e)}A0.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:bF.NUMBER},{argumentType:bF.NUMBER},{argumentType:bF.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:bF.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:bF.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:bF.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:bF.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:bF.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:bF.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:bF.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:bF.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:bF.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:bF.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:bF.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:bF.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:bF.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:bF.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:bF.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:bF.COMPLEX},{argumentType:bF.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:bF.COMPLEX},{argumentType:bF.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:bF.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:bF.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:bF.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:bF.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:bF.COMPLEX},{argumentType:bF.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:bF.COMPLEX}]}};var q0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K0(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$0(r);if(o){var n=$0(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return X0(this,e)});function a(){return z0(this,a),i.apply(this,arguments)}return t=a,n=[{key:"avedev",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("AVEDEV"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof ZU)return o;if(0===o.length)return new ZU(BU.DIV_BY_ZERO);var i=X1(o);return o.reduce((function(e,t){return e+Math.abs(t-i)}),0)/o.length}))}},{key:"devsq",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DEVSQ"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);return o instanceof ZU?o:0===o.length?0:$1(o)}))}},{key:"geomean",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof ZU)return o;if(0===o.length)return new ZU(BU.NUM,IH.OneValue);var i,a=V0(o);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s<=0)return new ZU(BU.NUM,IH.ValueSmall)}}catch(e){a.e(e)}finally{a.f()}return Q1(o)}))}},{key:"harmean",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("HARMEAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof ZU)return o;if(0===o.length)return new ZU(BU.NUM,IH.OneValue);var i,a=V0(o);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s<=0)return new ZU(BU.NUM,IH.ValueSmall)}}catch(e){a.e(e)}finally{a.f()}return o.length/o.reduce((function(e,t){return e+1/t}),0)}))}},{key:"correl",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);return n instanceof ZU?n:n[0].length<=1?new ZU(BU.DIV_BY_ZERO,IH.TwoValues):e0(n[0],n[1])}))}},{key:"rsq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);return n instanceof ZU?n:n[0].length<=1?new ZU(BU.DIV_BY_ZERO,IH.TwoValues):Math.pow(e0(n[0],n[1]),2)}))}},{key:"covariancep",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);if(n instanceof ZU)return n;var r=n[0].length;return r<1?new ZU(BU.DIV_BY_ZERO,IH.OneValue):1===r?0:Z1(n[0],n[1])*(r-1)/r}))}},{key:"covariances",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);return n instanceof ZU?n:n[0].length<=1?new ZU(BU.DIV_BY_ZERO,IH.TwoValues):Z1(n[0],n[1])}))}},{key:"ztest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("Z.TEST"),(function(e,t,r){var o=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(o instanceof ZU)return o;var i=o.length;if(void 0===r){if(i<2)return new ZU(BU.DIV_BY_ZERO,IH.TwoValues);r=J1(o,!0)}return i<1?new ZU(BU.NA,IH.OneValue):0===r?new ZU(BU.DIV_BY_ZERO):1-R1((X1(o)-t)/(r/Math.sqrt(i)),0,1)}))}},{key:"ftest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("F.TEST"),(function(e,t){var r=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=n.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof ZU)return r;if(o instanceof ZU)return o;if(r.length<=1||o.length<=1)return new ZU(BU.DIV_BY_ZERO);var i=q1(r,!0),a=q1(o,!0);if(0===i||0===a)return new ZU(BU.DIV_BY_ZERO);var s=Y1(i/a,r.length-1,o.length-1);return 2*Math.min(s,1-s)}))}},{key:"steyx",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);if(n instanceof ZU)return n;var r=n[0].length;return r<=2?new ZU(BU.DIV_BY_ZERO,IH.ThreeValues):Math.sqrt(($1(n[0])-Math.pow(Z1(n[0],n[1])*(r-1),2)/$1(n[1]))/(r-2))}))}},{key:"slope",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new ZU(BU.NA,IH.EqualLength);var n=J0(e,t);if(n instanceof ZU)return n;var r=n[0].length;return r<=1?new ZU(BU.DIV_BY_ZERO,IH.TwoValues):Z1(n[0],n[1])*(r-1)/$1(n[1])}))}},{key:"chisqtest",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(function(e,t){var n=e.height(),r=e.width();if(t.height()!==n||t.width()!==r)return new ZU(BU.NA,IH.EqualLength);var o=J0(e,t);if(o instanceof ZU)return o;if(o[0].length<=1)return new ZU(BU.DIV_BY_ZERO,IH.TwoValues);for(var i=0,a=0;a<o[0].length;a++){if(0===o[1][a])return new ZU(BU.DIV_BY_ZERO);i+=Math.pow(o[0][a]-o[1][a],2)/o[1][a]}return i<0?new ZU(BU.NUM,IH.NaN):1-j1(i,n>1&&r>1?(n-1)*(r-1):n*r-1)}))}},{key:"ttest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("T.TEST"),(function(e,t,r,o){var i=n.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),a=n.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof ZU)return i;if(a instanceof ZU)return a;var s=i.length,u=a.length;if(1===o){if(u!==s)return new ZU(BU.NA,IH.EqualLength);if(s<=1)return new ZU(BU.DIV_BY_ZERO,IH.TwoValues);for(var l=Array(s),c=0;c<s;c++)l[c]=i[c]-a[c];var f=J1(l,!0);if(0===f)return new ZU(BU.DIV_BY_ZERO);var h=Math.abs(Math.sqrt(s)*X1(l)/f);return r*(1-W1(h,s-1))}if(2===o){if(s<=1||u<=1)return new ZU(BU.DIV_BY_ZERO,IH.TwoValues);var d=($1(i)+$1(a))/(s+u-2);if(0===d)return new ZU(BU.DIV_BY_ZERO);var p=Math.abs((X1(i)-X1(a))/Math.sqrt(d*(1/s+1/u)));return r*(1-W1(p,s+u-2))}if(s<=1||u<=1)return new ZU(BU.DIV_BY_ZERO,IH.TwoValues);var m=q1(i,!0),y=q1(a,!0);if(0===m&&0===y)return new ZU(BU.DIV_BY_ZERO);var v=Math.abs((X1(i)-X1(a))/Math.sqrt(m/s+y/u)),g=Math.pow(m/s+y/u,2)/(Math.pow(m/s,2)/(s-1)+Math.pow(y/u,2)/(u-1));return r*(1-W1(v,g))}))}},{key:"skew",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SKEW"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof ZU)return o;var i=o.length;if(i<3)return new ZU(BU.DIV_BY_ZERO,IH.ThreeValues);var a=X1(o),s=J1(o,!0);return 0===s?new ZU(BU.DIV_BY_ZERO):o.reduce((function(e,t){return e+Math.pow((t-a)/s,3)}),0)*i/(i-1)/(i-2)}))}},{key:"skewp",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SKEW.P"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof ZU)return o;var i=o.length;if(i<3)return new ZU(BU.DIV_BY_ZERO,IH.ThreeValues);var a=X1(o),s=J1(o,!1);return 0===s?new ZU(BU.DIV_BY_ZERO):o.reduce((function(e,t){return e+Math.pow((t-a)/s,3)}),0)/i}))}}],n&&G0(t.prototype,n),a}(PF);function J0(e,t){for(var n,r,o=e.iterateValuesFromTopLeftCorner(),i=t.iterateValuesFromTopLeftCorner(),a=[],s=[];n=o.next(),r=i.next(),!n.done&&!r.done;){var u=n.value,l=r.value;if(u instanceof ZU)return u;if(l instanceof ZU)return l;Zj(u)&&Zj(l)&&(a.push(Wj(u)),s.push(Wj(l)))}return[a,s]}function Q0(e){return Q0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q0(e)}function Z0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function e2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t2(e,t){return t2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t2(e,t)}function n2(e,t){if(t&&("object"===Q0(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function r2(e){return r2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r2(e)}q0.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:bF.RANGE},{argumentType:bF.NUMBER},{argumentType:bF.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:bF.RANGE},{argumentType:bF.RANGE},{argumentType:bF.INTEGER,minValue:1,maxValue:2},{argumentType:bF.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:bF.ANY}],repeatLastArgs:1}},q0.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};var o2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t2(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=r2(t);if(n){var o=r2(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return n2(this,e)});function o(){return e2(this,o),r.apply(this,arguments)}return o}(xK);o2.HyperFormula=xK,o2.ErrorType=BU,o2.CellType=VU,o2.CellValueType=$U,o2.CellValueDetailedType=qU,o2.DetailedCellError=hB,o2.ExportedCellChange=qz,o2.ExportedNamedExpressionChange=Jz,o2.ConfigValueTooBigError=eP,o2.ConfigValueTooSmallError=ZD,o2.EvaluationSuspendedError=nP,o2.ExpectedOneOfValuesError=tP,o2.ExpectedValueOfTypeError=JD,o2.FunctionPlugin=PF,o2.FunctionPluginValidationError=sP,o2.InvalidAddressError=FD,o2.InvalidArgumentsError=YD,o2.LanguageNotRegisteredError=iP,o2.LanguageAlreadyRegisteredError=aP,o2.MissingTranslationError=rP,o2.NamedExpressionDoesNotExistError=WD,o2.NamedExpressionNameIsAlreadyTakenError=BD,o2.NamedExpressionNameIsInvalidError=VD,o2.NoOperationToRedoError=GD,o2.NoOperationToUndoError=zD,o2.NoRelativeAddressesAllowedError=fP,o2.NoSheetWithIdError=ID,o2.NoSheetWithNameError=DD,o2.NotAFormulaError=jD,o2.NothingToPasteError=KD,o2.ProtectedFunctionTranslationError=oP,o2.SheetNameAlreadyTakenError=PD,o2.SheetSizeLimitExceededError=HD,o2.SourceLocationHasArrayError=lP,o2.TargetLocationHasArrayError=cP,o2.UnableToParseError=qD;var i2=FK.defaultConfig.language;xK.registerLanguage(i2,YK),xK.languages[YK.langCode]=YK;var a2,s2=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Z0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z0(e,t):void 0}}(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(Object.getOwnPropertyNames(y));try{for(s2.s();!(a2=s2.n()).done;){var u2=a2.value;u2.startsWith("_")||xK.registerFunctionPlugin(y[u2])}}catch(e){s2.e(e)}finally{s2.f()}n(35224),n(84849),zo(rg),zo(pg),zo(Nw),zo(Sw),zo(pM),zo(Q_),zo(ZS),zo(vI);const l2=ExampleSpreadsheet;var c2=Retool.connectReactComponent(l2);document.body.setAttribute("style","margin: 0;"),g.render(v.createElement(c2,null),document.body.appendChild(document.createElement("div")))})()})();